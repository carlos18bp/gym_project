import{u as S,r as l,o as I,d as C,e as p,f,g as e,h as _,w as m,v as g,n as V,t as b,i as w,j as q,k as N,m as x,F as E,_ as U,p as y}from"./index.js";import{_ as j,s}from"./notification_message.js";import"./sweetalert2.esm.all.js";const B=e("div",{class:"absolute"},[e("div",{class:"flex justify-center p-4"},[e("img",{src:U})])],-1),D={class:"flex h-screen items-center"},F=e("h1",{class:"font-bold text-center text-2xl xl:text-3xl 2xl:text-4xl"}," No te preocupes, vamos ayudarte ",-1),M={class:"grid"},T=e("label",{for:"email",class:"block mb-2 text-sm font-medium text-gray-900"}," Correo electronico ",-1),L=e("label",{for:"passcode",class:"block mb-2 text-sm font-medium text-gray-900"}," Código de verificación ",-1),z=["disabled"],A={key:0,class:"text-start text-sm mt-2 text-gray-600"},G=e("span",{class:"font-regular"},"Enviar nuevo código en ",-1),H={class:"font-bold"},J=e("span",{class:"font-regular"}," segundos.",-1),K=e("label",{for:"password",class:"block mb-2 text-sm font-medium text-gray-900"}," Contraseña ",-1),O=e("label",{for:"confirm_password",class:"block mb-2 text-sm font-medium text-gray-900"}," Confirmar contraseña ",-1),Q={class:"grid"},W=e("button",{type:"submit",class:"w-full text-white bg-blue-700 hover:bg-blue-800 font-medium rounded-lg text-sm px-5 py-2.5 text-center"}," Iniciar sesión ",-1),X={class:"w-full font-medium rounded-lg text-sm py-2.5 text-start"},Y=e("span",null,"¿Recordaste tu contraseña? ",-1),Z=e("span",{class:"text-blue-800"},"Volver a iniciar sesión",-1),$={key:0,class:"text-center mt-2 text-gray-600"},ee={class:"font-bold"},se=e("div",{class:"h-screen hidden overflow-hidden order-1 xl:w-1/2 2xl:w-1/3 xl:block"},[e("img",{src:j,alt:"illustration",class:"w-full h-full object-cover"})],-1),le={__name:"ForgetPassword",setup(te){const h=S(),d=l(""),u=l(""),n=l(""),c=l(""),t=l(0),i=l(!1);I(()=>{parseInt(localStorage.getItem("forgetPasswordSecondsRemaining"),10)&&v()});const P=async()=>{if(!d.value){s("Email is required!","warning");return}try{await y.post("/api/send_passcode/",{email:d.value,subject_email:"Password Reset Code"}),s("Password reset code sent to your email","info"),v()}catch(a){console.error("Error when password reset is requested:",a),s("User not found","warning")}},v=()=>{parseInt(localStorage.getItem("forgetPasswordSecondsRemaining"),10)||localStorage.setItem("forgetPasswordSecondsRemaining",180),i.value=!0,t.value=parseInt(localStorage.getItem("forgetPasswordSecondsRemaining"),10);const a=setInterval(()=>{t.value--,localStorage.setItem("forgetPasswordSecondsRemaining",t.value),t.value<=0&&(clearInterval(a),i.value=!1,localStorage.removeItem("forgetPasswordSecondsRemaining"))},1e3)},k=async()=>{if(!u.value){s("Passcode is required!","warning");return}if(!n.value){s("New Password is required!","warning");return}if(!c.value){s("Confirm Password is required!","warning");return}if(n.value!==c.value){s("Passwords do not match!","warning");return}try{await y.post("/api/verify_passcode_and_reset_password/",{passcode:u.value,new_password:n.value}),s("Password reset successful!","success"),h.push({name:"sign_in"})}catch(a){s(a.response.data.error,"error")}};return(a,o)=>{const R=C("RouterLink");return p(),f(E,null,[B,e("section",D,[e("form",{class:"space-y-5 px-8 w-full md:px-32 2xl:px-72 xl:w-1/2 2xl:w-2/3 order-2",onSubmit:_(k,["prevent"])},[F,e("div",M,[e("div",null,[T,m(e("input",{"onUpdate:modelValue":o[0]||(o[0]=r=>d.value=r),type:"email",id:"email",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5",required:""},null,512),[[g,d.value]])])]),e("div",null,[L,m(e("input",{"onUpdate:modelValue":o[1]||(o[1]=r=>u.value=r),type:"number",id:"passcode",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"},null,512),[[g,u.value]]),e("button",{class:V({"text-sm font-medium text-blue-800 cursor-pointer":!i.value,hidden:i.value}),onClick:_(P,["prevent"]),disabled:i.value}," Enviar código ",10,z),t.value>0?(p(),f("div",A,[G,e("span",H,b(t.value),1),J])):w("",!0)]),e("div",null,[K,m(e("input",{"onUpdate:modelValue":o[2]||(o[2]=r=>n.value=r),type:"password",id:"password",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"},null,512),[[g,n.value]])]),e("div",null,[O,m(e("input",{"onUpdate:modelValue":o[3]||(o[3]=r=>c.value=r),type:"password",id:"confirm_password",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"},null,512),[[g,c.value]])]),e("div",Q,[W,e("p",X,[Y,q(R,{to:{name:"sign_in"}},{default:N(()=>[Z]),_:1})])]),t.value>0?(p(),f("div",$,[x(" Por favor espere "),e("span",ee,b(t.value),1),x(" antes de enviar un nuevo código. ")])):w("",!0)],32),se])],64)}}};export{le as default};
