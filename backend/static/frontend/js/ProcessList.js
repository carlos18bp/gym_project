import{ab as he,u as ve,I as _e,H as be,c as C,r as A,o as we,T as Y,d as ke,e as p,f as w,a9 as Ce,g as t,n as f,l as U,h as r,j as o,p as T,w as $e,v as Le,i as n,t as g,k as V,F,N as I,ac as N,ad as P,ae as v,af as B,G as Se,m as ee,J as Ae}from"./index.js";import{r as te}from"./PlusIcon.js";import{r as Te}from"./MagnifyingGlassIcon.js";import{r as W,a as O,b as Ee}from"./FunnelIcon.js";import{r as Ne}from"./ArrowDownTrayIcon.js";import{r as se}from"./EllipsisVerticalIcon.js";const Pe={class:"min-h-screen bg-gray-50"},Be={class:"py-6 px-4 sm:px-6 lg:px-8"},je={class:"border-b border-gray-200 mb-6"},De={class:"flex items-center justify-between"},Me={class:"-mb-px flex space-x-8"},ze={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6"},Ue={class:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between"},Ve={class:"flex flex-col sm:flex-row gap-3 flex-1 w-full lg:w-auto"},qe={class:"relative flex-1 min-w-[200px]"},Re={class:"max-w-[120px] truncate"},Fe={class:"py-1"},Ie=["onClick"],Oe={class:"max-w-[120px] truncate"},We={class:"py-1"},Ze=["onClick"],He={class:"max-w-[120px] truncate"},Je={class:"py-1"},Qe=["onClick"],Ge={class:"flex items-center gap-3 w-full lg:w-auto"},Ke={class:"text-sm text-gray-500 whitespace-nowrap"},Xe={class:"py-1"},Ye={class:"py-1"},et={key:0,class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},tt={class:"overflow-x-auto"},st={class:"min-w-full divide-y divide-gray-200"},at={class:"bg-gray-50"},ot={scope:"col",class:"w-12 px-6 py-3"},rt=["checked"],lt=t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Nombre ",-1),nt=t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," E-mail ",-1),it=t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Tipo Proceso ",-1),ct=t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Dte./Accionante ",-1),dt=t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Dte./Accionado ",-1),ut=t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etapa ",-1),pt=t("th",{scope:"col",class:"w-16 px-6 py-3"},null,-1),gt={class:"bg-white divide-y divide-gray-200"},yt=["onClick"],mt=["checked","onChange"],ft={class:"px-6 py-4 whitespace-nowrap"},xt={class:"flex items-center"},ht={class:"h-10 w-10 flex-shrink-0"},vt=["src","alt"],_t={class:"ml-4"},bt={class:"text-sm font-medium text-gray-900"},wt={class:"px-6 py-4 whitespace-nowrap"},kt={class:"text-sm text-gray-900"},Ct={class:"px-6 py-4 whitespace-nowrap"},$t={class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800"},Lt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},St={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},At={class:"px-6 py-4 whitespace-nowrap"},Tt={class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800"},Et={class:"py-1"},Nt={key:1,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center"},Pt=t("h3",{class:"mt-4 text-lg font-medium text-gray-900"},"No hay procesos disponibles",-1),Bt={class:"mt-2 text-sm text-gray-500"},Rt={__name:"ProcessList",setup(jt){const q=he(),Z=ve(),H=_e(),E=be(),ae=Ae,_=C(()=>H.getCurrentUser),y=A("my_processes"),R=A(""),$=A(null),L=A(null),S=A(null),j=A("recent"),b=A([]);we(async()=>{await E.init(),await H.init(),q.params.display==="history"?y.value="archived_processes":q.query.group==="general"?y.value="all_processes":y.value="my_processes"}),Y(()=>q.params.display,a=>{a==="history"&&(y.value="archived_processes")}),Y(()=>q.query.group,a=>{a==="general"?y.value="all_processes":a==="default"&&(y.value="my_processes")});const oe=C(()=>{const a=new Set;return E.processes.forEach(s=>{var l;(l=s.case)!=null&&l.type&&a.add(s.case.type)}),Array.from(a).sort()}),re=C(()=>{const a=new Set;return E.processes.forEach(s=>{s.authority&&a.add(s.authority)}),Array.from(a).sort()}),le=C(()=>{const a=new Set;return E.processes.forEach(s=>{s.stages&&s.stages.length>0&&s.stages.forEach(l=>{l.status&&a.add(l.status)})}),Array.from(a).sort()}),ne=C(()=>{var m,h,u,x,e,i;let a=[];const s=((m=_.value)==null?void 0:m.role)==="client"||((h=_.value)==null?void 0:h.role)==="basic"||((u=_.value)==null?void 0:u.role)==="corporate_client",l=(x=_.value)==null?void 0:x.id;return y.value==="archived_processes"?(a=E.processesWithClosedStatus,s?a=a.filter(c=>{var d;return((d=c.client)==null?void 0:d.id)===l}):((e=_.value)==null?void 0:e.role)==="lawyer"&&(a=a.filter(c=>{var d;return((d=c.lawyer)==null?void 0:d.id)===l}))):(a=E.processesWithoutClosedStatus,y.value==="my_processes"&&(s?a=a.filter(c=>{var d;return((d=c.client)==null?void 0:d.id)===l}):((i=_.value)==null?void 0:i.role)==="lawyer"&&(a=a.filter(c=>{var d;return((d=c.lawyer)==null?void 0:d.id)===l})))),a}),k=C(()=>{let a=[...ne.value];if(R.value){const s=R.value.toLowerCase();a=a.filter(l=>{var m,h,u,x,e,i,c,d,D,M,z,Q,G,K;return((h=(m=l.client)==null?void 0:m.first_name)==null?void 0:h.toLowerCase().includes(s))||((x=(u=l.client)==null?void 0:u.last_name)==null?void 0:x.toLowerCase().includes(s))||((i=(e=l.client)==null?void 0:e.email)==null?void 0:i.toLowerCase().includes(s))||((d=(c=l.case)==null?void 0:c.type)==null?void 0:d.toLowerCase().includes(s))||((D=l.subcase)==null?void 0:D.toLowerCase().includes(s))||((M=l.ref)==null?void 0:M.toLowerCase().includes(s))||((z=l.plaintiff)==null?void 0:z.toLowerCase().includes(s))||((Q=l.defendant)==null?void 0:Q.toLowerCase().includes(s))||((G=l.authority)==null?void 0:G.toLowerCase().includes(s))||((K=l.stages)==null?void 0:K.some(xe=>{var X;return(X=xe.status)==null?void 0:X.toLowerCase().includes(s)}))})}return $.value&&(a=a.filter(s=>{var l;return((l=s.case)==null?void 0:l.type)===$.value})),L.value&&(a=a.filter(s=>s.authority===L.value)),S.value&&(a=a.filter(s=>{var m;const l=(m=s.stages)==null?void 0:m[s.stages.length-1];return(l==null?void 0:l.status)===S.value})),j.value==="name"?a.sort((s,l)=>{var u,x,e,i;const m=`${(u=s.client)==null?void 0:u.first_name} ${(x=s.client)==null?void 0:x.last_name}`.toLowerCase(),h=`${(e=l.client)==null?void 0:e.first_name} ${(i=l.client)==null?void 0:i.last_name}`.toLowerCase();return m.localeCompare(h)}):j.value==="recent"&&a.sort((s,l)=>l.id-s.id),a}),ie=C(()=>{switch(j.value){case"name":return"Nombre (A-Z)";case"recent":default:return"Más recientes"}}),ce=()=>{$.value=null,L.value=null,S.value=null},J=C(()=>k.value.length>0&&b.value.length===k.value.length),de=()=>{J.value?b.value=[]:b.value=k.value.map(a=>a.id)},ue=a=>{const s=b.value.indexOf(a);s>-1?b.value.splice(s,1):b.value.push(a)},pe=()=>{b.value=k.value.map(a=>a.id)},ge=()=>{b.value=[]},ye=a=>{Z.push({name:"process_detail",params:{process_id:a}})},me=()=>{Z.push("/legal_request_create")},fe=()=>{const a=b.value.length>0?k.value.filter(e=>b.value.includes(e.id)):k.value,s=["Nombre","Email","Tipo Proceso","Dte./Accionante","Dte./Accionado","Etapa"],l=a.map(e=>{var i,c,d,D,M,z;return[`${((i=e.client)==null?void 0:i.first_name)||""} ${((c=e.client)==null?void 0:c.last_name)||""}`,((d=e.client)==null?void 0:d.email)||"",((D=e.case)==null?void 0:D.type)||"",e.plaintiff||"-",e.defendant||"-",((z=(M=e.stages)==null?void 0:M[e.stages.length-1])==null?void 0:z.status)||"Sin estado"]}),m=[s.join(","),...l.map(e=>e.map(i=>`"${i}"`).join(","))].join(`
`),h=new Blob([m],{type:"text/csv;charset=utf-8;"}),u=document.createElement("a"),x=URL.createObjectURL(h);u.setAttribute("href",x),u.setAttribute("download",`procesos_${new Date().toISOString().split("T")[0]}.csv`),u.style.visibility="hidden",document.body.appendChild(u),u.click(),document.body.removeChild(u)};return(a,s)=>{var m,h,u,x;const l=ke("router-link");return p(),w("div",Pe,[Ce(a.$slots,"default"),t("div",Be,[t("div",je,[t("div",De,[t("nav",Me,[t("button",{onClick:s[0]||(s[0]=e=>y.value="my_processes"),class:f([y.value==="my_processes"?"border-secondary text-secondary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Mis Procesos ",2),((m=_.value)==null?void 0:m.role)==="lawyer"?(p(),w("button",{key:0,onClick:s[1]||(s[1]=e=>y.value="all_processes"),class:f([y.value==="all_processes"?"border-secondary text-secondary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Todos los Procesos ",2)):U("",!0),t("button",{onClick:s[2]||(s[2]=e=>y.value="archived_processes"),class:f([y.value==="archived_processes"?"border-secondary text-secondary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Procesos Archivados ",2)]),((h=_.value)==null?void 0:h.role)==="client"||((u=_.value)==null?void 0:u.role)==="corporate_client"?(p(),w("button",{key:0,onClick:me,class:"inline-flex items-center gap-2 px-4 py-2 mb-4 rounded-lg border border-secondary bg-secondary text-sm font-medium text-white hover:bg-blue-700 transition-all duration-200"},[r(o(te),{class:"h-5 w-5"}),T(" Solicitar Información ")])):U("",!0)])]),t("div",ze,[t("div",Ue,[t("div",Ve,[t("div",qe,[r(o(Te),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),$e(t("input",{"onUpdate:modelValue":s[3]||(s[3]=e=>R.value=e),type:"text",placeholder:"Buscar...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent"},null,512),[[Le,R.value]])]),r(o(B),{as:"div",class:"relative"},{default:n(()=>[r(o(N),{class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:n(()=>[r(o(W),{class:"h-4 w-4"}),t("span",Re,g($.value||"Tipo"),1),r(o(O),{class:"h-4 w-4"})]),_:1}),r(o(P),{class:"absolute left-0 z-10 mt-2 w-56 origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:n(()=>[t("div",Fe,[r(o(v),null,{default:n(({active:e})=>[t("a",{onClick:s[4]||(s[4]=i=>$.value=null),class:f([e?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Todos ",2)]),_:1}),(p(!0),w(F,null,I(oe.value,e=>(p(),V(o(v),{key:e},{default:n(({active:i})=>[t("a",{onClick:c=>$.value=e,class:f([i?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])},g(e),11,Ie)]),_:2},1024))),128))])]),_:1})]),_:1}),r(o(B),{as:"div",class:"relative"},{default:n(()=>[r(o(N),{class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:n(()=>[r(o(W),{class:"h-4 w-4"}),t("span",Oe,g(L.value||"Autoridad"),1),r(o(O),{class:"h-4 w-4"})]),_:1}),r(o(P),{class:"absolute left-0 z-10 mt-2 w-56 origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none max-h-60 overflow-y-auto"},{default:n(()=>[t("div",We,[r(o(v),null,{default:n(({active:e})=>[t("a",{onClick:s[5]||(s[5]=i=>L.value=null),class:f([e?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Todos ",2)]),_:1}),(p(!0),w(F,null,I(re.value,e=>(p(),V(o(v),{key:e},{default:n(({active:i})=>[t("a",{onClick:c=>L.value=e,class:f([i?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])},g(e),11,Ze)]),_:2},1024))),128))])]),_:1})]),_:1}),r(o(B),{as:"div",class:"relative"},{default:n(()=>[r(o(N),{class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:n(()=>[r(o(W),{class:"h-4 w-4"}),t("span",He,g(S.value||"Etapa"),1),r(o(O),{class:"h-4 w-4"})]),_:1}),r(o(P),{class:"absolute left-0 z-10 mt-2 w-56 origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none max-h-60 overflow-y-auto"},{default:n(()=>[t("div",Je,[r(o(v),null,{default:n(({active:e})=>[t("a",{onClick:s[6]||(s[6]=i=>S.value=null),class:f([e?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Todos ",2)]),_:1}),(p(!0),w(F,null,I(le.value,e=>(p(),V(o(v),{key:e},{default:n(({active:i})=>[t("a",{onClick:c=>S.value=e,class:f([i?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])},g(e),11,Qe)]),_:2},1024))),128))])]),_:1})]),_:1}),$.value||L.value||S.value?(p(),w("button",{key:0,onClick:ce,class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",title:"Limpiar filtros"},[r(o(Se),{class:"h-4 w-4"}),T(" Limpiar ")])):U("",!0)]),t("div",Ge,[t("span",Ke," Mostrando "+g(k.value.length)+" resultados ",1),r(o(B),{as:"div",class:"relative"},{default:n(()=>[r(o(N),{class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:n(()=>[T(" Ordenar: "+g(ie.value)+" ",1),r(o(O),{class:"h-4 w-4"})]),_:1}),r(o(P),{class:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:n(()=>[t("div",Xe,[r(o(v),null,{default:n(({active:e})=>[t("a",{onClick:s[7]||(s[7]=i=>j.value="recent"),class:f([e?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Más recientes ",2)]),_:1}),r(o(v),null,{default:n(({active:e})=>[t("a",{onClick:s[8]||(s[8]=i=>j.value="name"),class:f([e?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Nombre (A-Z) ",2)]),_:1})])]),_:1})]),_:1}),((x=_.value)==null?void 0:x.role)==="lawyer"?(p(),V(l,{key:0,to:{name:"process_form",params:{action:"create"}},class:"inline-flex items-center gap-2 px-4 py-2 bg-secondary text-white rounded-md hover:bg-blue-700 transition-colors text-sm font-medium whitespace-nowrap"},{default:n(()=>[r(o(te),{class:"h-5 w-5"}),T(" Nuevo ")]),_:1})):U("",!0),t("button",{onClick:fe,class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},[r(o(Ne),{class:"h-4 w-4"}),T(" Exportar ")]),r(o(B),{as:"div",class:"relative"},{default:n(()=>[r(o(N),{class:"inline-flex items-center justify-center w-10 h-10 rounded-md hover:bg-gray-100"},{default:n(()=>[r(o(se),{class:"h-5 w-5 text-gray-500"})]),_:1}),r(o(P),{class:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:n(()=>[t("div",Ye,[r(o(v),null,{default:n(({active:e})=>[t("a",{onClick:pe,class:f([e?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Seleccionar todo ",2)]),_:1}),r(o(v),null,{default:n(({active:e})=>[t("a",{onClick:ge,class:f([e?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Deseleccionar todo ",2)]),_:1})])]),_:1})]),_:1})])])]),k.value.length?(p(),w("div",et,[t("div",tt,[t("table",st,[t("thead",at,[t("tr",null,[t("th",ot,[t("input",{type:"checkbox",checked:J.value,onChange:de,class:"h-4 w-4 text-secondary focus:ring-secondary border-gray-300 rounded"},null,40,rt)]),lt,nt,it,ct,dt,ut,pt])]),t("tbody",gt,[(p(!0),w(F,null,I(k.value,e=>{var i;return p(),w("tr",{key:e.id,class:"hover:bg-gray-50 transition-colors cursor-pointer",onClick:c=>ye(e.id)},[t("td",{class:"px-6 py-4 whitespace-nowrap",onClick:s[9]||(s[9]=ee(()=>{},["stop"]))},[t("input",{type:"checkbox",checked:b.value.includes(e.id),onChange:c=>ue(e.id),class:"h-4 w-4 text-secondary focus:ring-secondary border-gray-300 rounded"},null,40,mt)]),t("td",ft,[t("div",xt,[t("div",ht,[t("img",{class:"h-10 w-10 rounded-full object-cover",src:e.client.photo_profile||o(ae),alt:e.client.first_name},null,8,vt)]),t("div",_t,[t("div",bt,g(e.client.first_name)+" "+g(e.client.last_name),1)])])]),t("td",wt,[t("div",kt,g(e.client.email),1)]),t("td",Ct,[t("span",$t,g(e.case.type),1)]),t("td",Lt,g(e.plaintiff||"-"),1),t("td",St,g(e.defendant||"-"),1),t("td",At,[t("span",Tt,g(((i=e.stages[e.stages.length-1])==null?void 0:i.status)||"Sin estado"),1)]),t("td",{class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",onClick:s[10]||(s[10]=ee(()=>{},["stop"]))},[r(o(B),{as:"div",class:"relative inline-block text-left"},{default:n(()=>[r(o(N),{class:"inline-flex items-center justify-center w-8 h-8 rounded-md hover:bg-gray-100"},{default:n(()=>[r(o(se),{class:"h-5 w-5 text-gray-500"})]),_:1}),r(o(P),{class:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:n(()=>{var c;return[t("div",Et,[r(o(v),null,{default:n(({active:d})=>[r(l,{to:{name:"process_detail",params:{process_id:e.id}},class:f([d?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700"])},{default:n(()=>[T(" Ver detalles ")]),_:2},1032,["to","class"])]),_:2},1024),((c=_.value)==null?void 0:c.role)==="lawyer"?(p(),V(o(v),{key:0},{default:n(({active:d})=>[r(l,{to:{name:"process_form",params:{action:"edit",process_id:e.id}},class:f([d?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700"])},{default:n(()=>[T(" Editar ")]),_:2},1032,["to","class"])]),_:2},1024)):U("",!0)])]}),_:2},1024)]),_:2},1024)])],8,yt)}),128))])])])])):(p(),w("div",Nt,[r(o(Ee),{class:"mx-auto h-24 w-24 text-gray-400"}),Pt,t("p",Bt,g(y.value==="archived_processes"?"No hay procesos archivados para mostrar.":"Contacta a tu abogado para gestionar tus procesos."),1)]))])])}}};export{Rt as default};
