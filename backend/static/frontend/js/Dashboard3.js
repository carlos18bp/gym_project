import{e as o,f as l,g as e,u as Xe,r as P,aH as Rt,o as qe,ap as ut,c as L,h as s,j as t,G as Pe,w as Ae,v as Oe,n as h,l as D,t as f,m as fe,p as se,s as _e,b3 as Yt,i as m,b2 as Je,a9 as Vt,b4 as Xt,Q as kt,k as te,a2 as Ye,F as de,D as $t,E as es,b5 as ts,a0 as ss,C as os,T as $e,N as me,I as He,a1 as Ve,af as Se,ac as Ee,ad as Fe,ae,b6 as rs,O as mt,P as gt,ag as pt,b7 as ht,a5 as ns,aV as ls,b8 as _t,b9 as It}from"./index.js";import{u as Re,o as as,s as st,p as Tt}from"./index2.js";import{g as it,a as dt}from"./DocumentPermissionsManager.js";import{B as is,a as ft,b as vt,c as Ct,d as Dt,L as bt,e as St,r as ds,f as cs,_ as Mt,D as Qt,g as us}from"./index3.js";import{_ as yt}from"./_plugin-vue_export-helper.js";import{r as wt,_ as ms}from"./DocumentCard.js";import{r as Ke}from"./PlusIcon.js";import{r as ot,a as et}from"./EllipsisVerticalIcon.js";import{r as ct}from"./DocumentIcon.js";import{r as Gt}from"./EyeIcon.js";import{_ as jt}from"./SignatureDocumentCard.js";import{r as Bt,a as gs,b as ps}from"./TagIcon.js";import{r as ze,a as tt,b as rt}from"./FunnelIcon.js";import{r as Qe}from"./MagnifyingGlassIcon.js";import{r as hs}from"./ArrowLeftIcon.js";import{r as Ut}from"./PencilIcon.js";import{r as Zt}from"./TrashIcon.js";import{r as nt}from"./ArrowDownTrayIcon.js";import{a as fs,r as Ht}from"./LinkIcon.js";import{r as Wt}from"./PhotoIcon.js";import{r as Nt}from"./InformationCircleIcon.js";import{r as vs}from"./CloudArrowUpIcon.js";import{r as bs}from"./ExclamationTriangleIcon.js";import"./useRecentViews.js";import"./loading_message.js";function zt(r,v){return o(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"})])}function ys(r,v){return o(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z"})])}function xs(r,v){return o(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7.217 10.907a2.25 2.25 0 1 0 0 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186 9.566-5.314m-9.566 7.5 9.566 5.314m0 0a2.25 2.25 0 1 0 3.935 2.186 2.25 2.25 0 0 0-3.935-2.186Zm0-12.814a2.25 2.25 0 1 0 3.933-2.185 2.25 2.25 0 0 0-3.933 2.185Z"})])}const _s={class:"bg-white rounded-lg p-6 shadow-xl max-w-lg w-full"},ws={class:"flex justify-end"},$s=e("label",{for:"document-name",class:"block text-base font-medium leading-6 text-primary"},[se(" Nombre "),e("span",{class:"text-red-500"},"*")],-1),ks={class:"mt-2"},Cs={class:"flex gap-2 mt-2.5"},Ds=["disabled"],Ss=e("span",null,"Actualizar nombre",-1),Es=[Ss],Fs=["disabled"],As={__name:"UseDocumentByClient",props:{documentId:{type:[Number,null],required:!1,default:null}},emits:["close"],setup(r,{emit:v}){const i=r,c=Xe(),S=Re(),x=v,u=P(""),$=P(""),F=()=>{x("close")};Rt(()=>{var w,g;S.selectedDocument?(u.value=((w=S.selectedDocument)==null?void 0:w.title)||"",$.value=((g=S.selectedDocument)==null?void 0:g.title)||""):(u.value="",$.value="")});const B=w=>{w.key==="Escape"&&F()};qe(()=>{document.addEventListener("keydown",B)}),ut(()=>{document.removeEventListener("keydown",B)});const J=L(()=>u.value.trim().length>0),R=L(()=>{var w;return!!((w=S.selectedDocument)!=null&&w.id)}),Y=L(()=>R.value&&u.value.trim()!==$.value.trim()&&u.value.trim().length>0);async function E(){if(R.value&&Y.value)try{const w={title:u.value.trim()};await S.updateDocument(S.selectedDocument.id,w),$.value=u.value.trim(),S.selectedDocument.title=u.value.trim();const g=S.selectedDocument.id;_e("Document name successfully updated.","success"),x("close",{updatedDocId:g});const _=window.location.pathname;_==="/dynamic_document_dashboard"||_==="/dynamic_document_dashboard/"||setTimeout(()=>{window.location.href="/dynamic_document_dashboard"},1e3)}catch(w){console.error("Error updating document name:",w),_e("Error updating document name.","error")}}function n(){const w=encodeURIComponent(u.value.trim());i.documentId&&!S.selectedDocument?c.push(`/dynamic_document_dashboard/document/use/creator/${i.documentId}/${w}`):S.selectedDocument?(S.selectedDocument.title=u.value.trim(),c.push(`/dynamic_document_dashboard/document/use/editor/${S.selectedDocument.id}/${w}`)):_e("Error: No se pudo continuar. Documento no seleccionado.","error")}return(w,g)=>(o(),l("div",_s,[e("div",ws,[e("button",{onClick:F},[s(t(Pe),{class:"size-6"})])]),e("form",{onSubmit:fe(n,["prevent"])},[e("div",null,[$s,e("div",ks,[Ae(e("input",{"onUpdate:modelValue":g[0]||(g[0]=A=>u.value=A),type:"text",id:"document-name",class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm ring-1 ring-inset ring-gray-300",required:""},null,512),[[Oe,u.value]])])]),e("div",Cs,[R.value?(o(),l("button",{key:0,type:"button",onClick:E,disabled:!Y.value,class:h(["p-2.5 text-sm font-medium rounded-md flex gap-2",Y.value?"bg-primary text-white cursor-pointer":"bg-gray-200 text-gray-400 cursor-not-allowed opacity-70"])},Es,10,Ds)):D("",!0),e("button",{type:"submit",class:h(["p-2.5 text-sm font-medium rounded-md flex gap-2",J.value?"bg-secondary text-white":"bg-gray-200 text-secondary border-2 border-dashed border-secondary cursor-not-allowed bg-opacity-50"]),disabled:!J.value},[e("span",null,f(R.value?"Editar Documento":"Continuar"),1)],10,Fs)])],32)]))}},Ts={class:"mt-3 pt-2 border-t border-gray-100"},Ms={class:"flex items-center gap-2 text-xs text-gray-500"},Ps=e("span",null,"Hacer clic para usar este documento",-1),Ls={__name:"UseDocumentCard",props:{document:{type:Object,required:!0},showTags:{type:Boolean,default:!0},cardType:{type:String,default:"default"},cardContext:{type:String,default:"list"},documentStore:{type:Object,default:null},userStore:{type:Object,default:null},menuOptions:{type:Array,default:null},disableInternalActions:{type:Boolean,default:!1},showMenuOptions:{type:Boolean,default:null}},emits:["click","remove-from-folder","document-created"],setup(r,{emit:v}){const i=r,c=v,S=P(!1),x=P(null),u=it(9),$=L(()=>"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium !bg-purple-100 !text-purple-700 !border !border-purple-200"),F=L(()=>u.dark),B=L(()=>"group !border-purple-400 !bg-purple-50/50 !shadow-purple-100"),J=L(()=>i.menuOptions!==null?i.menuOptions:[{label:"Usar",action:"use",icon:ys,iconClasses:"w-4 h-4 text-purple-600"},{label:"Previsualizaci√≥n",action:"preview",icon:Gt,iconClasses:"w-4 h-4 text-gray-600"}]),R=L(()=>!1),Y=(g,A)=>{i.disableInternalActions?c("click",g,A):n(g.id)},E=(g,A)=>{switch(g){case"use":n(A.id);break;case"preview":as(A);break;default:console.warn("Unknown menu action:",g)}};function n(g){g?(x.value=g,S.value=!0):console.error("Document ID is required:",g)}function w(g){if(S.value=!1,x.value=null,g&&g.updatedDocId){c("document-created",g);const A=window.location.pathname;A==="/dynamic_document_dashboard"||A==="/dynamic_document_dashboard/"?setTimeout(()=>{window.forceDocumentHighlight&&window.forceDocumentHighlight(g.updatedDocId)},100):setTimeout(()=>{window.location.href="/dynamic_document_dashboard"},500)}}return(g,A)=>(o(),l(de,null,[s(is,{document:r.document,"card-type":r.cardType,"card-context":r.cardContext,"status-icon":t(Xt),"status-text":"Disponible","status-badge-classes":$.value,"menu-options":J.value,"highlighted-doc-id":null,"show-tags":r.showTags,"document-store":r.documentStore,"user-store":r.userStore,"additional-classes":B.value,"disable-internal-actions":r.disableInternalActions,"show-menu-options":r.showMenuOptions,onClick:Y,onMenuAction:E,onRemoveFromFolder:A[0]||(A[0]=_=>g.$emit("remove-from-folder",_))},Yt({"additional-actions":m(()=>[Vt(g.$slots,"additional-actions")]),_:2},[R.value?{name:"right-action",fn:m(()=>[s(t(ot),{class:"w-5 h-5 text-gray-400 group-hover:text-gray-600 transition-colors"})]),key:"0"}:void 0,r.disableInternalActions?void 0:{name:"footer",fn:m(()=>[e("div",Ts,[e("div",Ms,[e("div",{class:"w-2 h-2 rounded-full",style:Je({backgroundColor:F.value})},null,4),Ps])])]),key:"1"}]),1032,["document","card-type","card-context","status-icon","status-badge-classes","menu-options","show-tags","document-store","user-store","additional-classes","disable-internal-actions","show-menu-options"]),Ae(s(Ye,null,{default:m(()=>[x.value!==null?(o(),te(As,{key:0,"document-id":x.value,onClose:w},null,8,["document-id"])):D("",!0)]),_:1},512),[[kt,S.value]])],64))}},Is=()=>({folders:[],currentFolder:null,isLoading:!1,error:null,lastUpdatedFolderId:null}),js={sortedFolders:r=>[...r.folders].sort((v,i)=>new Date(i.created_at)-new Date(v.created_at)),getFolderById:r=>v=>r.folders.find(i=>i.id===v),getFoldersByColor:r=>v=>r.folders.filter(i=>i.color_id===v),getFolderWithColor:r=>v=>{const i=r.folders.find(c=>c.id===v);return i?{...i,color:it(i.color_id)}:null},getFoldersContainingDocument:r=>v=>r.folders.filter(i=>i.document_ids&&i.document_ids.includes(v)),totalDocumentsInFolders:r=>r.folders.reduce((v,i)=>v+(i.document_ids?i.document_ids.length:0),0),hasFolders:r=>r.folders.length>0,availableColors:()=>dt()},Bs={async init(r=!1){if(!(this.folders.length>0&&!r)){this.isLoading=!0,this.error=null;try{await this.fetchFolders()}catch(v){console.error("Error initializing document folder store:",v),this.error="Error al inicializar las carpetas"}finally{this.isLoading=!1}}},async fetchFolders(){try{const r=await $t("dynamic-documents/folders/");if(r.status===200)return this.folders=r.data,r.data;throw new Error(`Error fetching folders: ${r.status}`)}catch(r){throw console.error("Error fetching folders:",r),this.error="Error al obtener las carpetas",r}},async fetchFolder(r){this.isLoading=!0,this.error=null;try{const v=await $t(`dynamic-documents/folders/${r}/`);if(v.status===200){const i=v.data,c=this.folders.findIndex(S=>S.id===i.id);return c!==-1?this.folders[c]=i:this.folders.push(i),this.currentFolder=i,i}else throw new Error(`Error fetching folder: ${v.status}`)}catch(v){throw console.error("Error fetching folder:",v),this.error="Error al obtener la carpeta",v}finally{this.isLoading=!1}},async createFolder(r){this.isLoading=!0,this.error=null;try{if(!r.name||r.name.trim()==="")throw new Error("El nombre de la carpeta es requerido");const v=r.color_id??0;if(v<0||v>=dt().length)throw new Error("Color de carpeta no v√°lido");const i={name:r.name.trim(),color_id:v,...r.document_ids&&{document_ids:r.document_ids}},c=await es("dynamic-documents/folders/create/",i);if(c.status===200||c.status===201){const S=c.data;return this.folders.push(S),this.lastUpdatedFolderId=S.id,await _e("Carpeta creada exitosamente","success"),S}else throw new Error(`Error creating folder: ${c.status}`)}catch(v){throw console.error("Error creating folder:",v),this.error=v.message||"Error al crear la carpeta",await _e(this.error,"error"),v}finally{this.isLoading=!1}},async updateFolder(r,v){this.isLoading=!0,this.error=null;try{if(v.name&&v.name.trim()==="")throw new Error("El nombre de la carpeta no puede estar vac√≠o");if(v.color_id!==void 0){const S=v.color_id;if(S<0||S>=dt().length)throw new Error("Color de carpeta no v√°lido")}const i={};v.name&&(i.name=v.name.trim()),v.color_id!==void 0&&(i.color_id=v.color_id),v.document_ids!==void 0&&(i.document_ids=v.document_ids);const c=await ts(`dynamic-documents/folders/${r}/update/`,i);if(c.status===200){const S=c.data,x=this.folders.findIndex(u=>u.id===r);return x!==-1&&(this.folders[x]=S),this.currentFolder&&this.currentFolder.id===r&&(this.currentFolder=S),this.lastUpdatedFolderId=r,await _e("Carpeta actualizada exitosamente","success"),S}else throw new Error(`Error updating folder: ${c.status}`)}catch(i){throw console.error("Error updating folder:",i),this.error=i.message||"Error al actualizar la carpeta",await _e(this.error,"error"),i}finally{this.isLoading=!1}},async deleteFolder(r){this.isLoading=!0,this.error=null;try{const v=await ss(`dynamic-documents/folders/${r}/delete/`);if(v.status===204||v.status===200)return this.folders=this.folders.filter(i=>i.id!==r),this.currentFolder&&this.currentFolder.id===r&&(this.currentFolder=null),await _e("Carpeta eliminada exitosamente","success"),!0;throw new Error(`Error deleting folder: ${v.status}`)}catch(v){throw console.error("Error deleting folder:",v),this.error=v.message||"Error al eliminar la carpeta",await _e(this.error,"error"),v}finally{this.isLoading=!1}},setCurrentFolder(r){this.currentFolder=r},clearCurrentFolder(){this.currentFolder=null},reset(){this.folders=[],this.currentFolder=null,this.isLoading=!1,this.error=null,this.lastUpdatedFolderId=null}},Us={async addDocumentsToFolder(r,v){const i=this.getFolderById(r);if(!i)throw new Error("Carpeta no encontrada");const c=i.document_ids||[],S=[...new Set([...c,...v])];return await this.updateFolder(r,{document_ids:S})},async removeDocumentsFromFolder(r,v){const i=this.getFolderById(r);if(!i)throw new Error("Carpeta no encontrada");const S=(i.document_ids||[]).filter(x=>!v.includes(x));return await this.updateFolder(r,{document_ids:S})},async moveDocumentsBetweenFolders(r,v,i){try{v&&await this.removeDocumentsFromFolder(v,r),i&&await this.addDocumentsToFolder(i,r),await _e("Documentos movidos exitosamente","success")}catch(c){throw console.error("Error moving documents between folders:",c),await _e("Error al mover documentos","error"),c}},getFolderColor(r){const v=this.getFolderById(r);return v?it(v.color_id):it(0)},validateFolderData(r){const v=[];if((!r.name||r.name.trim()==="")&&v.push("El nombre de la carpeta es requerido"),r.name&&r.name.length>100&&v.push("El nombre de la carpeta no puede exceder 100 caracteres"),r.color_id!==void 0){const i=r.color_id;(i<0||i>=dt().length)&&v.push("Color de carpeta no v√°lido")}return r.document_ids&&!Array.isArray(r.document_ids)&&v.push("Los IDs de documentos deben ser un array"),{isValid:v.length===0,errors:v}}},Pt=os("documentFolder",{state:Is,getters:js,actions:{...Bs,...Us}}),Ns={class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},zs={class:"bg-white rounded-xl shadow-xl max-w-md w-full"},qs={class:"flex justify-between items-center p-6 border-b"},Os={class:"text-lg font-semibold text-gray-900"},Rs={class:"mb-4"},Vs=e("label",{for:"folderName",class:"block text-sm font-medium text-gray-700 mb-2"}," Nombre de la carpeta ",-1),Qs={class:"mb-6"},Gs=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"}," Color de la carpeta ",-1),Zs={class:"grid grid-cols-8 gap-2"},Hs=["onClick","title"],Ws={class:"flex gap-3"},Ks=["disabled"],Js={__name:"CreateEditFolderModal",props:{isVisible:{type:Boolean,required:!0},editingFolder:{type:Object,default:null}},emits:["close","success"],setup(r,{emit:v}){const i=r,c=v,S=Pt(),x=P(!1),u=P({name:"",color_id:0}),$=L(()=>dt()),F=()=>{u.value={name:"",color_id:0}};$e(()=>i.editingFolder,R=>{R?u.value={name:R.name,color_id:R.color_id}:F()},{immediate:!0}),$e(()=>i.isVisible,R=>{R||F()});const B=()=>{c("close")},J=async()=>{if(u.value.name.trim()){x.value=!0;try{i.editingFolder?(await S.updateFolder(i.editingFolder.id,u.value),_e("Carpeta actualizada correctamente","success")):(await S.createFolder(u.value),_e("Carpeta creada correctamente","success")),c("success")}catch(R){const Y=i.editingFolder?"actualizar":"crear";_e(`Error al ${Y} la carpeta`,"error"),console.error(`Error ${Y} folder:`,R)}finally{x.value=!1}}};return(R,Y)=>r.isVisible?(o(),te(Ye,{key:0},{default:m(()=>[e("div",Ns,[e("div",zs,[e("div",qs,[e("h3",Os,f(r.editingFolder?"Editar Carpeta":"Nueva Carpeta"),1),e("button",{onClick:B,class:"text-gray-400 hover:text-gray-500"},[s(t(Pe),{class:"w-6 h-6"})])]),e("form",{onSubmit:fe(J,["prevent"]),class:"p-6"},[e("div",Rs,[Vs,Ae(e("input",{id:"folderName","onUpdate:modelValue":Y[0]||(Y[0]=E=>u.value.name=E),type:"text",required:"",maxlength:"100",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Ej: Contratos Laborales"},null,512),[[Oe,u.value.name]])]),e("div",Qs,[Gs,e("div",Zs,[(o(!0),l(de,null,me($.value,E=>(o(),l("button",{key:E.id,type:"button",onClick:n=>u.value.color_id=E.id,class:h(["w-8 h-8 rounded-full border-2 transition-all",u.value.color_id===E.id?"border-gray-800 scale-110":"border-gray-300 hover:border-gray-400"]),style:Je({backgroundColor:E.hex}),title:E.name},null,14,Hs))),128))])]),e("div",Ws,[e("button",{type:"button",onClick:B,class:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"}," Cancelar "),e("button",{type:"submit",disabled:!u.value.name.trim()||x.value,class:"flex-1 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},f(x.value?"Guardando...":r.editingFolder?"Actualizar":"Crear"),9,Ks)])],32)])])]),_:1})):D("",!0)}},Ys={class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},Xs={class:"bg-white rounded-xl shadow-xl max-w-6xl w-full max-h-[90vh] overflow-hidden flex flex-col"},eo={class:"border-b px-6 py-4 flex-shrink-0"},to={class:"flex justify-between items-center"},so={class:"flex items-center gap-3"},oo={class:"text-xl font-semibold text-gray-900"},ro={class:"text-sm text-gray-600"},no={class:"flex items-center gap-2"},lo={class:"flex-1 overflow-y-auto p-6"},ao={key:0,class:"bg-white rounded-lg shadow-sm border border-gray-200"},io={class:"overflow-x-auto"},co={class:"min-w-full divide-y divide-gray-200"},uo=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Documento "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Tipo "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etiquetas "),e("th",{scope:"col",class:"w-16 px-6 py-3"})])],-1),mo={class:"bg-white divide-y divide-gray-200"},go=["onClick"],po={class:"px-6 py-4 whitespace-nowrap"},ho={class:"flex items-center"},fo={class:"flex-shrink-0 h-10 w-10"},vo={class:"h-10 w-10 rounded-lg bg-blue-100 flex items-center justify-center"},bo={class:"ml-4"},yo={class:"text-sm font-medium text-gray-900"},xo={class:"px-6 py-4 whitespace-nowrap"},_o={class:"text-sm text-gray-600"},wo={class:"px-6 py-4 whitespace-nowrap"},$o={class:"px-6 py-4 whitespace-nowrap"},ko={class:"flex flex-wrap gap-1"},Co={key:0,class:"text-sm text-gray-400"},Do={class:"py-1"},So=["onClick"],Eo=["onClick"],Fo={key:1,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center"},Ao=e("h4",{class:"text-lg font-medium text-gray-900 mb-2"},"Esta carpeta est√° vac√≠a",-1),To=e("p",{class:"text-gray-600 mb-4"},"Agrega documentos para organizar tu trabajo",-1),Mo={__name:"FolderDetailsModalTable",props:{folder:{type:Object,default:null}},emits:["close","add-documents","remove-document","view-document","use-document","document-action"],setup(r,{emit:v}){const i=r,c=v;He(),Re();const S=[{name:"blue",hex:"#3B82F6"},{name:"purple",hex:"#8B5CF6"},{name:"pink",hex:"#EC4899"},{name:"green",hex:"#10B981"},{name:"yellow",hex:"#F59E0B"},{name:"red",hex:"#EF4444"},{name:"indigo",hex:"#6366F1"},{name:"teal",hex:"#14B8A6"}],x=L(()=>{if(!i.folder)return S[0];if(i.folder.color)return S.find(w=>w.name===i.folder.color)||S[0];const n=i.folder.id%S.length;return S[n]}),u=n=>n.state==="Published"||n.state==="Draft"?"Formato":n.state==="PendingSignatures"||n.state==="FullySigned"?"Para Firmar":n.state==="Progress"||n.state==="Completed"?"Mis Documentos":"Documento",$=n=>({Published:"Publicado",Draft:"Borrador",Progress:"En Progreso",Completed:"Completado",PendingSignatures:"Pendiente Firma",FullySigned:"Firmado"})[n.state]||n.state,F=n=>({Published:"bg-green-100 text-green-700 border border-green-200",Draft:"bg-gray-100 text-gray-700 border border-gray-200",Progress:"bg-blue-100 text-blue-700 border border-blue-200",Completed:"bg-green-100 text-green-700 border border-green-200",PendingSignatures:"bg-yellow-100 text-yellow-700 border border-yellow-200",FullySigned:"bg-green-100 text-green-700 border border-green-200"})[n.state]||"bg-gray-100 text-gray-700 border border-gray-200",B=n=>{const w=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],g=n.id%w.length;return w[g]},J=()=>{c("close")},R=()=>{c("add-documents",i.folder)},Y=n=>{c("remove-document",{folderId:i.folder.id,documentId:n.id})},E=n=>{const w=u(n);c(w==="Formato"?"use-document":"view-document",n)};return(n,w)=>r.folder?(o(),te(Ye,{key:0},{default:m(()=>[e("div",Ys,[e("div",Xs,[e("div",eo,[e("div",to,[e("div",so,[e("div",{class:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",style:Je({backgroundColor:x.value.hex+"20"})},[s(t(wt),{class:"h-6 w-6",style:Je({color:x.value.hex})},null,8,["style"])],4),e("div",null,[e("h3",oo,f(r.folder.name),1),e("p",ro,f(r.folder.documents.length)+" documento"+f(r.folder.documents.length!==1?"s":""),1)])]),e("div",no,[e("button",{onClick:R,class:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-blue-600 hover:bg-blue-50 rounded-lg transition-colors"},[s(t(Ke),{class:"w-5 h-5"}),se(" Agregar documentos ")]),e("button",{onClick:J,class:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors"},[s(t(Pe),{class:"w-6 h-6"})])])])]),e("div",lo,[r.folder.documents.length>0?(o(),l("div",ao,[e("div",io,[e("table",co,[uo,e("tbody",mo,[(o(!0),l(de,null,me(r.folder.documents,g=>(o(),l("tr",{key:g.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:A=>E(g)},[e("td",po,[e("div",ho,[e("div",fo,[e("div",vo,[s(t(Ve),{class:"h-5 w-5 text-blue-600"})])]),e("div",bo,[e("div",yo,f(g.title),1)])])]),e("td",xo,[e("span",_o,f(u(g)),1)]),e("td",wo,[e("span",{class:h(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",F(g)])},f($(g)),3)]),e("td",$o,[e("div",ko,[(o(!0),l(de,null,me(g.tags,A=>(o(),l("span",{key:A.id,class:h(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",B(A)])},f(A.name),3))),128)),!g.tags||g.tags.length===0?(o(),l("span",Co,"-")):D("",!0)])]),e("td",{class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",onClick:w[0]||(w[0]=fe(()=>{},["stop"]))},[s(t(Se),{as:"div",class:"relative inline-block text-left"},{default:m(()=>[s(t(Ee),{class:"inline-flex items-center justify-center w-8 h-8 rounded-md hover:bg-gray-100"},{default:m(()=>[s(t(et),{class:"h-5 w-5 text-gray-500"})]),_:1}),s(t(Fe),{class:"absolute right-0 z-[9999] mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",Do,[s(t(ae),null,{default:m(({active:A})=>[e("a",{onClick:_=>E(g),class:h([A?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Ver documento ",10,So)]),_:2},1024),s(t(ae),null,{default:m(({active:A})=>[e("a",{onClick:_=>Y(g),class:h([A?"bg-gray-100":"","block px-4 py-2 text-sm text-red-600 cursor-pointer"])}," Quitar de carpeta ",10,Eo)]),_:2},1024)])]),_:2},1024)]),_:2},1024)])],8,go))),128))])])])])):(o(),l("div",Fo,[s(t(ct),{class:"w-12 h-12 text-gray-300 mx-auto mb-4"}),Ao,To,e("button",{onClick:R,class:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"},[s(t(Ke),{class:"w-5 h-5"}),se(" Agregar documentos ")])]))])])])]),_:1})):D("",!0)}},xt=r=>(mt("data-v-d403a707"),r=r(),gt(),r),Po={class:"tag-filter-container"},Lo={class:"relative"},Io={class:"flex items-center"},jo={key:0,class:"ml-2 inline-flex items-center justify-center h-5 w-5 bg-primary text-white text-xs rounded-full font-medium"},Bo={key:0,class:"absolute left-0 mt-2 w-full sm:w-80 bg-white rounded-xl shadow-xl ring-1 ring-black ring-opacity-5 border border-gray-100 z-50 overflow-hidden"},Uo={class:"bg-gray-50 p-4 border-b border-gray-200"},No={class:"flex items-center justify-between mb-3"},zo=xt(()=>e("h3",{class:"text-sm font-semibold text-gray-900"},"Filtrar por etiquetas",-1)),qo={key:0,class:"text-xs text-gray-500"},Oo={class:"relative"},Ro={key:0,class:"px-4 py-2 bg-blue-50 border-b border-blue-100"},Vo={class:"flex items-center justify-between"},Qo={class:"text-xs font-medium text-blue-700"},Go={class:"max-h-52 overflow-y-auto"},Zo={key:0,class:"px-4 py-8 text-center"},Ho=xt(()=>e("p",{class:"text-gray-500 text-sm"},"No hay etiquetas disponibles",-1)),Wo={key:1,class:"px-4 py-8 text-center"},Ko={class:"text-gray-500 text-sm"},Jo={key:2,class:"px-4 py-8 text-center"},Yo=xt(()=>e("div",{class:"flex items-center justify-center"},[e("div",{class:"animate-spin rounded-full h-5 w-5 border-2 border-primary border-t-transparent"}),e("span",{class:"ml-3 text-sm text-gray-600"},"Cargando etiquetas...")],-1)),Xo=[Yo],er={key:3,class:"py-2"},tr=["onClick"],sr={class:"flex items-center h-5"},or={class:"relative"},rr=["id","checked","onChange"],nr={key:0,class:"w-2.5 h-2.5 text-white",fill:"currentColor",viewBox:"0 0 20 20"},lr=xt(()=>e("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"},null,-1)),ar=[lr],ir={class:"ml-3 flex items-center flex-1 min-w-0"},dr={class:"text-sm font-medium text-gray-900 truncate"},cr={key:0,class:"mt-4"},ur={class:"flex items-start gap-2"},mr=xt(()=>e("span",{class:"text-xs font-medium text-gray-500 mt-1.5 flex-shrink-0"},"Activos:",-1)),gr={class:"flex flex-wrap gap-2"},pr=["onClick"],hr={class:"mr-1"},fr={class:"ml-1 p-0.5 rounded-full hover:bg-white/50 transition-colors duration-150"},vr={__name:"TagFilter",props:{modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue"],setup(r,{emit:v}){const i=r,c=v,S=Re(),x=P(!1),u=P([]),$=P(!1),F=P(""),B=L(()=>S.sortedTags),J=L(()=>{if(!F.value.trim())return B.value;const A=F.value.toLowerCase().trim();return B.value.filter(_=>_.name.toLowerCase().includes(A))}),R=A=>{const _=it(A.color_id);return{hex:_&&_.hex?_.hex:"#9CA3AF",dark:_&&_.dark?_.dark:"#374151"}},Y=()=>{x.value=!x.value,x.value&&(F.value="")},E=A=>u.value.some(_=>_.id===A.id),n=A=>{const _=u.value.findIndex(j=>j.id===A.id);_>=0?u.value.splice(_,1):u.value.push(A),c("update:modelValue",u.value)},w=()=>{u.value=[],c("update:modelValue",[])},g=A=>{A.target.closest(".tag-filter-container")||(x.value=!1,F.value="")};return qe(async()=>{try{$.value=!0,await S.initTags()}catch(A){console.error("Error loading tags:",A)}finally{$.value=!1}document.addEventListener("click",g)}),$e(()=>i.modelValue,A=>{u.value=A||[]},{immediate:!0}),ut(()=>{document.removeEventListener("click",g)}),(A,_)=>(o(),l("div",Po,[e("div",Lo,[e("button",{onClick:Y,class:h(["group inline-flex items-center justify-between w-full sm:w-auto sm:min-w-[200px] px-4 py-3 border border-gray-200 rounded-xl shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 hover:border-gray-300 focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-primary transition-all duration-200",{"ring-2 ring-primary border-primary bg-blue-50":x.value,"border-primary bg-primary/5":u.value.length>0&&!x.value}])},[e("div",Io,[s(t(Bt),{class:h(["h-5 w-5 mr-2.5 text-gray-500 group-hover:text-gray-600",{"text-primary":u.value.length>0||x.value}])},null,8,["class"]),e("span",{class:h(["text-gray-700",{"text-primary font-semibold":u.value.length>0||x.value}])}," Filtrar por etiquetas ",2),u.value.length>0?(o(),l("span",jo,f(u.value.length),1)):D("",!0)]),s(t(ze),{class:h(["ml-3 h-4 w-4 text-gray-400 transition-all duration-200 group-hover:text-gray-600",{"rotate-180 text-primary":x.value,"text-primary":u.value.length>0&&!x.value}])},null,8,["class"])],2),s(rs,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:m(()=>[x.value?(o(),l("div",Bo,[e("div",Uo,[e("div",No,[zo,B.value.length>0?(o(),l("span",qo,f(B.value.length)+" disponibles ",1)):D("",!0)]),e("div",Oo,[s(t(Qe),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),Ae(e("input",{"onUpdate:modelValue":_[0]||(_[0]=j=>F.value=j),type:"text",placeholder:"Buscar etiquetas...",class:"w-full pl-9 pr-4 py-2.5 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-200"},null,512),[[Oe,F.value]])])]),u.value.length>0?(o(),l("div",Ro,[e("div",Vo,[e("span",Qo,f(u.value.length)+" etiqueta"+f(u.value.length!==1?"s":"")+" seleccionada"+f(u.value.length!==1?"s":""),1),e("button",{onClick:w,class:"text-xs text-red-600 hover:text-red-700 font-medium px-2 py-1 rounded-md hover:bg-red-50 transition-all duration-200"}," Limpiar todo ")])])):D("",!0),e("div",Go,[!$.value&&J.value.length===0&&F.value.trim()===""?(o(),l("div",Zo,[s(t(Bt),{class:"h-8 w-8 text-gray-300 mx-auto mb-2"}),Ho])):D("",!0),!$.value&&J.value.length===0&&F.value.trim()!==""?(o(),l("div",Wo,[s(t(Qe),{class:"h-8 w-8 text-gray-300 mx-auto mb-2"}),e("p",Ko,'Sin resultados para "'+f(F.value)+'"',1),e("button",{onClick:_[1]||(_[1]=j=>F.value=""),class:"text-xs text-primary hover:text-primary-dark mt-2 font-medium"}," Ver todas las etiquetas ")])):D("",!0),$.value?(o(),l("div",Jo,Xo)):D("",!0),!$.value&&J.value.length>0?(o(),l("div",er,[(o(!0),l(de,null,me(J.value,j=>(o(),l("div",{key:j.id,class:"group flex items-center px-4 py-2.5 hover:bg-gray-50 cursor-pointer transition-colors duration-150",onClick:oe=>n(j)},[e("div",sr,[e("div",or,[e("input",{id:`tag-${j.id}`,type:"checkbox",checked:E(j),onChange:oe=>n(j),class:"sr-only"},null,40,rr),e("div",{class:h(["w-4 h-4 border-2 rounded transition-all duration-200 flex items-center justify-center",E(j)?"bg-primary border-primary":"border-gray-300 group-hover:border-gray-400"])},[E(j)?(o(),l("svg",nr,ar)):D("",!0)],2)])]),e("div",ir,[e("div",{class:"w-3 h-3 rounded-full mr-2.5 border flex-shrink-0 shadow-sm",style:Je({backgroundColor:R(j).hex})},null,4),e("span",dr,f(j.name),1)])],8,tr))),128))])):D("",!0)])])):D("",!0)]),_:1})]),u.value.length>0?(o(),l("div",cr,[e("div",ur,[mr,e("div",gr,[(o(!0),l(de,null,me(u.value,j=>(o(),l("div",{key:j.id,class:"group inline-flex items-center pl-2.5 pr-1.5 py-1.5 rounded-lg text-xs font-medium border shadow-sm cursor-pointer transition-all duration-200 hover:shadow-md",style:Je({backgroundColor:R(j).hex+"20",borderColor:R(j).hex+"40",color:R(j).dark}),onClick:oe=>n(j)},[e("div",{class:"w-2 h-2 rounded-full mr-2 flex-shrink-0",style:Je({backgroundColor:R(j).hex})},null,4),e("span",hr,f(j.name),1),e("div",fr,[s(t(Pe),{class:"h-3 w-3 opacity-60 group-hover:opacity-100"})])],12,pr))),128))])])])):D("",!0)]))}},br=yt(vr,[["__scopeId","data-v-d403a707"]]),yr={class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},xr={class:"bg-white rounded-xl shadow-xl max-w-5xl w-full max-h-[90vh] overflow-hidden"},_r={class:"border-b"},wr={class:"hidden sm:flex justify-between items-center p-6"},$r=e("h3",{class:"text-lg font-semibold text-gray-900"},"Agregar Documentos",-1),kr={class:"text-sm text-gray-600"},Cr={class:"sm:hidden p-4"},Dr={class:"flex justify-between items-start mb-2"},Sr={class:"flex-1 min-w-0 mr-3"},Er=e("h3",{class:"text-lg font-semibold text-gray-900"},"Agregar Documentos",-1),Fr={class:"text-sm text-gray-600 truncate"},Ar={class:"border-b"},Tr={class:"hidden sm:flex space-x-8 px-6","aria-label":"Tabs"},Mr=["onClick"],Pr={class:"ml-2 bg-gray-100 text-gray-600 py-0.5 px-2 rounded-full text-xs"},Lr={class:"sm:hidden relative px-4 py-3"},Ir={class:"flex items-center"},jr={class:"ml-2 bg-gray-100 text-gray-600 py-0.5 px-2 rounded-full text-xs"},Br=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1),Ur=[Br],Nr={class:"absolute top-full left-4 right-4 z-50 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg overflow-hidden"},zr=["onClick"],qr={class:"border-b bg-gray-50 p-4 sm:p-6"},Or={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},Rr={class:"flex-1"},Vr={key:0,class:"flex items-center gap-3"},Qr={class:"text-sm text-gray-600"},Gr={class:"p-4 sm:p-6 overflow-y-auto max-h-[calc(90vh-350px)]"},Zr={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4"},Hr={key:4,class:"absolute top-2 left-2 w-6 h-6 bg-primary text-white rounded-full flex items-center justify-center shadow-sm"},Wr={key:0,class:"text-center py-8 sm:py-12"},Kr={class:"text-lg font-medium text-gray-900 mb-2"},Jr={class:"text-gray-600 text-sm sm:text-base"},Yr={class:"border-t bg-gray-50"},Xr={class:"hidden sm:flex justify-between items-center p-6"},en={class:"text-sm text-gray-600"},tn={class:"flex gap-3"},sn=["disabled"],on={class:"sm:hidden p-4 space-y-3"},rn={class:"text-center text-sm text-gray-600"},nn={class:"flex gap-3"},ln=["disabled"],an={__name:"AddDocumentsModal",props:{isVisible:{type:Boolean,required:!0},folder:{type:Object,default:null}},emits:["close","add-documents"],setup(r,{emit:v}){const i=r,c=v,S=Re(),x=He(),u=P([]),$=P([]),F=P("my-documents"),B=P(!1),J=P(!1),R=[{name:"my-documents",label:"Mis Documentos"},{name:"use-documents",label:"Formatos Disponibles"},{name:"pending-signatures",label:"Firmas Pendientes"},{name:"signed-documents",label:"Documentos Firmados"}],Y=L(()=>x.currentUser);$e(()=>i.isVisible,y=>{y&&(u.value=[],$.value=[],F.value="my-documents")}),$e(F,()=>{u.value=[]}),$e($,()=>{u.value=[]},{deep:!0});const E=L(()=>{const y=w(F.value);return y.length===0?!1:y.every(N=>u.value.includes(N.id))}),n=y=>{var q;if(!i.folder)return[];const N=i.folder.documents.map(X=>X.id);let V=[];switch(y){case"my-documents":V=S.progressAndCompletedDocumentsByClient((q=Y.value)==null?void 0:q.id);break;case"use-documents":V=S.publishedDocumentsUnassigned;break;case"pending-signatures":V=S.documents.filter(X=>{var ee,K;return X.state==="PendingSignatures"&&(X.assigned_to===((ee=Y.value)==null?void 0:ee.id)||((K=X.signatures)==null?void 0:K.some(O=>{var le;return O.signer_email===((le=Y.value)==null?void 0:le.email)})))});break;case"signed-documents":V=S.documents.filter(X=>{var ee,K;return X.state==="FullySigned"&&(X.assigned_to===((ee=Y.value)==null?void 0:ee.id)||((K=X.signatures)==null?void 0:K.some(O=>{var le;return O.signer_email===((le=Y.value)==null?void 0:le.email)})))});break;default:V=[]}return V.filter(X=>!N.includes(X.id))},w=y=>{const N=n(y);if(!$.value||$.value.length===0)return N;const V=$.value.map(q=>q.id);return N.filter(q=>!q.tags||q.tags.length===0?!1:q.tags.some(X=>V.includes(X.id)))},g=y=>{const N=u.value.indexOf(y);N>-1?u.value.splice(N,1):u.value.push(y)},A=()=>{const N=w(F.value).map(V=>V.id);if(E.value)u.value=u.value.filter(V=>!N.includes(V));else{const V=N.filter(q=>!u.value.includes(q));u.value.push(...V)}},_=()=>{c("close")},j=async()=>{if(u.value.length!==0){B.value=!0;try{await c("add-documents",u.value)}finally{B.value=!1}}},oe=y=>{F.value=y,J.value=!1},I=y=>{y.target.closest(".relative")||(J.value=!1)};return qe(()=>{document.addEventListener("click",I)}),ut(()=>{document.removeEventListener("click",I)}),(y,N)=>r.isVisible&&r.folder?(o(),te(Ye,{key:0},{default:m(()=>{var V;return[e("div",yr,[e("div",xr,[e("div",_r,[e("div",wr,[e("div",null,[$r,e("p",kr,'Selecciona documentos para agregar a "'+f(r.folder.name)+'"',1)]),e("button",{onClick:_,class:"text-gray-400 hover:text-gray-500 hover:bg-gray-100 p-2 rounded-lg transition-colors"},[s(t(Pe),{class:"w-5 h-5"})])]),e("div",Cr,[e("div",Dr,[e("div",Sr,[Er,e("p",Fr,'Para "'+f(r.folder.name)+'"',1)]),e("button",{onClick:_,class:"text-gray-400 hover:text-gray-500 hover:bg-gray-100 p-2 rounded-lg transition-colors flex-shrink-0"},[s(t(Pe),{class:"w-5 h-5"})])])])]),e("div",Ar,[e("nav",Tr,[(o(),l(de,null,me(R,q=>e("button",{key:q.name,onClick:X=>F.value=q.name,class:h([F.value===q.name?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])},[se(f(q.label)+" ",1),e("span",Pr,f(w(q.name).length),1)],10,Mr)),64))]),e("div",Lr,[e("button",{onClick:N[0]||(N[0]=q=>J.value=!J.value),class:"w-full flex items-center justify-between py-3 px-4 bg-white border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary"},[e("div",Ir,[e("span",null,f(((V=R.find(q=>q.name===F.value))==null?void 0:V.label)||"Seleccionar categor√≠a"),1),e("span",jr,f(w(F.value).length),1)]),(o(),l("svg",{class:h(["ml-2 h-5 w-5 transition-transform duration-200",J.value?"transform rotate-180":""]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ur,2))]),Ae(e("div",Nr,[(o(),l(de,null,me(R,q=>e("button",{key:q.name,onClick:X=>oe(q.name),class:h(["w-full text-left px-4 py-3 text-sm transition-colors duration-150 flex items-center justify-between",F.value===q.name?"bg-primary text-white":"text-gray-700 hover:bg-gray-50"])},[e("span",null,f(q.label),1),e("span",{class:h(["py-0.5 px-2 rounded-full text-xs",F.value===q.name?"bg-white/20 text-white":"bg-gray-100 text-gray-600"])},f(w(q.name).length),3)],10,zr)),64))],512),[[kt,J.value]])])]),e("div",qr,[e("div",Or,[e("div",Rr,[s(br,{modelValue:$.value,"onUpdate:modelValue":N[1]||(N[1]=q=>$.value=q),class:"max-w-md"},null,8,["modelValue"])]),w(F.value).length>0?(o(),l("div",Vr,[e("span",Qr,f(w(F.value).length)+" documento(s) disponible(s) ",1),e("button",{onClick:A,class:h(["px-4 py-2 rounded-lg border font-medium text-sm transition-colors",E.value?"bg-red-50 border-red-200 text-red-700 hover:bg-red-100":"bg-primary text-white border-primary hover:bg-primary-dark"])},f(E.value?"Deseleccionar todos":"Seleccionar todos"),3)])):D("",!0)])]),e("div",Gr,[e("div",Zr,[(o(!0),l(de,null,me(w(F.value),q=>(o(),l("div",{key:q.id,class:"relative"},[F.value==="my-documents"?(o(),te(t(ms),{key:0,document:q,"highlighted-doc-id":null,"show-tags":!0,"show-client-name":!1,"menu-options":[],"disable-internal-actions":!0,"additional-classes":u.value.includes(q.id)?"ring-2 ring-primary bg-primary-50":"",onClick:X=>g(q.id)},null,8,["document","additional-classes","onClick"])):D("",!0),F.value==="use-documents"?(o(),te(t(Ls),{key:1,document:q,"show-tags":!0,"menu-options":[],"show-menu-options":!1,"disable-internal-actions":!0,"additional-classes":u.value.includes(q.id)?"ring-2 ring-primary bg-primary-50":"",onClick:X=>g(q.id)},null,8,["document","additional-classes","onClick"])):D("",!0),F.value==="pending-signatures"?(o(),te(t(jt),{key:2,document:q,"highlighted-doc-id":null,"show-tags":!0,"menu-options":[],"disable-internal-actions":!0,"additional-classes":u.value.includes(q.id)?"ring-2 ring-primary bg-primary-50":"",onClick:X=>g(q.id)},null,8,["document","additional-classes","onClick"])):D("",!0),F.value==="signed-documents"?(o(),te(t(jt),{key:3,document:q,"highlighted-doc-id":null,"show-tags":!0,"menu-options":[],"disable-internal-actions":!0,"additional-classes":u.value.includes(q.id)?"ring-2 ring-primary bg-primary-50":"",onClick:X=>g(q.id)},null,8,["document","additional-classes","onClick"])):D("",!0),u.value.includes(q.id)?(o(),l("div",Hr,[s(t(gs),{class:"w-4 h-4"})])):D("",!0)]))),128))]),w(F.value).length===0?(o(),l("div",Wr,[s(t(ct),{class:"w-12 h-12 sm:w-16 sm:h-16 text-gray-300 mx-auto mb-4"}),e("h4",Kr,f($.value.length>0?"No hay documentos que coincidan con el filtro":"No hay documentos disponibles"),1),e("p",Jr,f($.value.length>0?"Intenta ajustar los filtros de etiquetas o selecciona otra categor√≠a":"No tienes documentos de esta categor√≠a que no est√©n ya en la carpeta"),1)])):D("",!0)]),e("div",Yr,[e("div",Xr,[e("div",en,f(u.value.length)+" documento(s) seleccionado(s) ",1),e("div",tn,[e("button",{onClick:_,class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"}," Cancelar "),e("button",{onClick:j,disabled:u.value.length===0||B.value,class:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},f(B.value?"Agregando...":`Agregar ${u.value.length} documento(s)`),9,sn)])]),e("div",on,[e("div",rn,f(u.value.length)+" documento(s) seleccionado(s) ",1),e("div",nn,[e("button",{onClick:_,class:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-center font-medium"}," Cancelar "),e("button",{onClick:j,disabled:u.value.length===0||B.value,class:"flex-1 px-4 py-3 bg-primary text-white rounded-lg hover:bg-primary-dark disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-center font-medium"},f(B.value?"Agregando...":"Agregar"),9,ln)])])])])])]}),_:1})):D("",!0)}},lt=r=>(mt("data-v-9d7e4724"),r=r(),gt(),r),dn={class:"folders-table",style:{overflow:"visible !important"}},cn={key:0,style:{overflow:"visible !important"}},un={style:{overflow:"visible !important"}},mn={class:"min-w-full divide-y divide-gray-200",style:{overflow:"visible !important"}},gn=lt(()=>e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Carpeta "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Documentos "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Creada "),e("th",{scope:"col",class:"w-16 px-6 py-3"})])],-1)),pn={class:"bg-white divide-y divide-gray-200",style:{overflow:"visible !important"}},hn=["onClick"],fn={class:"px-6 py-4 whitespace-nowrap"},vn={class:"flex items-center"},bn={class:"flex-shrink-0 h-10 w-10"},yn={class:"ml-4"},xn={class:"text-sm font-medium text-gray-900"},_n={class:"px-6 py-4 whitespace-nowrap"},wn={class:"flex items-center gap-2"},$n={class:"text-sm text-gray-900"},kn={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Cn={class:"py-1"},Dn=["onClick"],Sn=["onClick"],En=["onClick"],Fn=["onClick"],An={key:1,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center"},Tn=lt(()=>e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No tienes carpetas a√∫n",-1)),Mn=lt(()=>e("p",{class:"text-gray-600 mb-6"},"Crea tu primera carpeta para organizar tus documentos",-1)),Pn={key:2,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center"},Ln=lt(()=>e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No se encontraron carpetas",-1)),In=lt(()=>e("p",{class:"text-gray-600"},"No hay carpetas que coincidan con tu b√∫squeda",-1)),jn={key:3,class:"flex justify-center items-center py-12"},Bn=lt(()=>e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"},null,-1)),Un=[Bn],Nn={__name:"FoldersTable",props:{sortedFolders:{type:Array,required:!0},searchQuery:{type:String,default:""},isLoading:{type:Boolean,default:!1}},emits:["folder-click","edit-folder","delete-folder","add-documents","create-folder"],setup(r,{emit:v}){const i=r,c=v,S=L(()=>{if(!i.searchQuery.trim())return i.sortedFolders;const E=i.searchQuery.toLowerCase();return i.sortedFolders.filter(n=>n.name.toLowerCase().includes(E))}),x=[{name:"blue",hex:"#3B82F6"},{name:"purple",hex:"#8B5CF6"},{name:"pink",hex:"#EC4899"},{name:"green",hex:"#10B981"},{name:"yellow",hex:"#F59E0B"},{name:"red",hex:"#EF4444"},{name:"indigo",hex:"#6366F1"},{name:"teal",hex:"#14B8A6"}],u=E=>{if(E.color)return x.find(w=>w.name===E.color)||x[0];const n=E.id%x.length;return x[n]},$=E=>{if(!E)return"-";const n=new Date(E),g=Math.abs(new Date-n),A=Math.ceil(g/(1e3*60*60*24));return A===0?"Hoy":A===1?"Ayer":A<7?`Hace ${A} d√≠as`:A<30?`Hace ${Math.floor(A/7)} semanas`:A<365?`Hace ${Math.floor(A/30)} meses`:n.toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"})},F=E=>{c("folder-click",E)},B=E=>{c("edit-folder",E)},J=E=>{c("delete-folder",E)},R=E=>{c("add-documents",E)},Y=()=>{c("create-folder")};return(E,n)=>(o(),l("div",dn,[!r.isLoading&&S.value.length>0?(o(),l("div",cn,[e("div",un,[e("table",mn,[gn,e("tbody",pn,[(o(!0),l(de,null,me(S.value,w=>{var g,A;return o(),l("tr",{key:w.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",style:{overflow:"visible !important"},onClick:_=>F(w)},[e("td",fn,[e("div",vn,[e("div",bn,[e("div",{class:"h-10 w-10 rounded-lg flex items-center justify-center",style:Je({backgroundColor:u(w).hex+"20"})},[s(t(wt),{class:"h-6 w-6",style:Je({color:u(w).hex})},null,8,["style"])],4)]),e("div",yn,[e("div",xn,f(w.name),1)])])]),e("td",_n,[e("div",wn,[s(t(Ve),{class:"h-5 w-5 text-gray-400"}),e("span",$n,f(((g=w.documents)==null?void 0:g.length)||0)+" documento"+f((((A=w.documents)==null?void 0:A.length)||0)!==1?"s":""),1)])]),e("td",kn,f($(w.created_at)),1),e("td",{class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",style:{overflow:"visible !important"},onClick:n[0]||(n[0]=fe(()=>{},["stop"]))},[s(t(Se),{as:"div",class:"relative inline-block text-left",style:{overflow:"visible !important"}},{default:m(()=>[s(t(Ee),{class:"inline-flex items-center justify-center w-8 h-8 rounded-md hover:bg-gray-100"},{default:m(()=>[s(t(et),{class:"h-5 w-5 text-gray-500"})]),_:1}),s(t(Fe),{class:"absolute right-0 z-[9999] mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",Cn,[s(t(ae),null,{default:m(({active:_})=>[e("a",{onClick:j=>F(w),class:h([_?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Ver carpeta ",10,Dn)]),_:2},1024),s(t(ae),null,{default:m(({active:_})=>[e("a",{onClick:j=>R(w),class:h([_?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Agregar documentos ",10,Sn)]),_:2},1024),s(t(ae),null,{default:m(({active:_})=>[e("a",{onClick:j=>B(w),class:h([_?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Editar ",10,En)]),_:2},1024),s(t(ae),null,{default:m(({active:_})=>[e("a",{onClick:j=>J(w),class:h([_?"bg-gray-100":"","block px-4 py-2 text-sm text-red-600 cursor-pointer"])}," Eliminar ",10,Fn)]),_:2},1024)])]),_:2},1024)]),_:2},1024)])],8,hn)}),128))])])])])):!r.isLoading&&r.sortedFolders.length===0?(o(),l("div",An,[s(t(wt),{class:"w-16 h-16 text-gray-300 mx-auto mb-4"}),Tn,Mn,e("button",{onClick:Y,class:"inline-flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors"},[s(t(Ke),{class:"w-5 h-5"}),se(" Crear Primera Carpeta ")])])):!r.isLoading&&r.sortedFolders.length>0&&S.value.length===0?(o(),l("div",Pn,[s(t(wt),{class:"w-16 h-16 text-gray-300 mx-auto mb-4"}),Ln,In])):D("",!0),r.isLoading?(o(),l("div",jn,Un)):D("",!0)]))}},zn=yt(Nn,[["__scopeId","data-v-9d7e4724"]]),Kt=r=>(mt("data-v-ab5666d5"),r=r(),gt(),r),qn={class:"folder-management"},On={class:"mb-6"},Rn={class:"hidden sm:flex justify-between items-center"},Vn=Kt(()=>e("div",null,[e("h2",{class:"text-xl font-semibold text-gray-900"},"Mis Carpetas"),e("p",{class:"text-sm text-gray-600 mt-1"},"Organiza tus documentos, firmas y formatos en carpetas personalizadas")],-1)),Qn={class:"sm:hidden"},Gn=Kt(()=>e("div",{class:"text-center mb-4"},[e("h2",{class:"text-xl font-semibold text-gray-900"},"Mis Carpetas"),e("p",{class:"text-sm text-gray-600 mt-1 px-2"},"Organiza tus documentos, firmas y formatos en carpetas personalizadas")],-1)),Zn={__name:"FolderManagement",props:{searchQuery:{type:String,default:""},selectedTags:{type:Array,default:()=>[]}},emits:["refresh","navigate-to-main"],setup(r,{emit:v}){const i=r,c=v,S=Pt(),x=Re(),u=He(),$=P(!1),F=P(null),B=P(null),J=P(!1),R=P(null),Y=L(()=>S.isLoading),E=L(()=>S.sortedFolders);L(()=>u.currentUser),qe(async()=>{await S.init(),await x.init()}),$e(()=>i.searchQuery,()=>{}),$e(()=>S.folders,O=>{var le,he;if(B.value&&O&&O.length>0){const be=O.find(ie=>ie.id===B.value.id);if(be){const ie=((le=B.value.documents)==null?void 0:le.length)||0,ye=((he=be.documents)==null?void 0:he.length)||0;JSON.stringify(B.value)!==JSON.stringify(be)&&(B.value={...be},console.log(`üîÑ FolderManagement: Synced selectedFolder "${be.name}" with store. Documents: ${ie} ‚Üí ${ye}`))}}},{deep:!0});const n=()=>{F.value=null,$.value=!0},w=O=>{F.value=O,$.value=!0},g=()=>{$.value=!1,F.value=null},A=()=>{g()},_=O=>{B.value=O},j=()=>{B.value=null},oe=async O=>{if(confirm(`¬øEst√°s seguro de que quieres eliminar la carpeta "${O.name}"?`))try{await S.deleteFolder(O.id),_e(`Carpeta "${O.name}" eliminada correctamente`,"success")}catch(le){_e("Error al eliminar la carpeta","error"),console.error("Error deleting folder:",le)}},I=O=>{R.value=O,J.value=!0},y=async(O=!1)=>{if(J.value=!1,R.value=null,O&&B.value)try{await N()}catch(le){console.warn("Error refreshing folder after adding documents:",le)}},N=async()=>{if(B.value)try{await S.fetchFolderById(B.value.id,!0);const O=S.getFolderById(B.value.id);O&&(B.value={...O},console.log("‚úÖ Selected folder refreshed successfully"))}catch(O){throw console.error("‚ùå Error refreshing selected folder:",O),O}},V=async O=>{var le,he,be;if(!(!R.value||O.length===0))try{const ie=R.value.documents.map(pe=>pe.id).filter(pe=>pe!=null&&!isNaN(parseInt(pe))).map(pe=>parseInt(pe)),ye=O.filter(pe=>pe!=null&&!isNaN(parseInt(pe))).map(pe=>parseInt(pe)),ve=[...new Set([...ie,...ye])];if(console.log("Current document IDs:",ie),console.log("Selected document IDs:",ye),console.log("Updated document IDs:",ve),ve.some(pe=>!Number.isInteger(pe)||pe<=0))throw new Error("IDs de documentos inv√°lidos detectados");await S.updateFolder(R.value.id,{document_ids:ve}),await y(!0),_e(`${ye.length} documento(s) agregado(s) a la carpeta`,"success"),c("navigate-to-main")}catch(ie){console.error("Error adding documents to folder:",ie),console.error("Error details:",((le=ie.response)==null?void 0:le.data)||ie.message),(he=ie.response)!=null&&he.status?_e(`Error al agregar documentos: ${((be=ie.response.data)==null?void 0:be.detail)||ie.message}`,"error"):_e("Error al agregar documentos a la carpeta","error")}},q=async O=>{var le,he,be;if(B.value)try{const ie=parseInt(O);if(!Number.isInteger(ie)||ie<=0)throw new Error("ID de documento inv√°lido");const ye=B.value.documents.map(ve=>ve.id).filter(ve=>ve!=null&&!isNaN(parseInt(ve))).map(ve=>parseInt(ve)).filter(ve=>ve!==ie);console.log("Removing document ID:",ie),console.log("Updated document IDs after removal:",ye),await S.updateFolder(B.value.id,{document_ids:ye}),_e("Documento removido de la carpeta","success"),B.value=null,c("navigate-to-main");try{await S.fetchFolderById(B.value.id,!0);const ve=S.getFolderById(B.value.id);ve&&(B.value=ve),console.log("Folder data refreshed successfully after removal")}catch(ve){console.warn("Error refreshing folder data:",ve);try{B.value={...B.value,documents:B.value.documents.filter(pe=>pe.id!==ie)},console.log("Applied optimistic removal for document ID:",ie)}catch(pe){console.warn("Optimistic update failed:",pe)}}}catch(ie){console.error("Error removing document from folder:",ie),console.error("Error details:",((le=ie.response)==null?void 0:le.data)||ie.message),(he=ie.response)!=null&&he.status?_e(`Error al remover documento: ${((be=ie.response.data)==null?void 0:be.detail)||ie.message}`,"error"):_e("Error al remover el documento de la carpeta","error")}},X=O=>{console.log("View document:",O)},ee=O=>{console.log("Use document:",O)},K=(O,le)=>{console.log("Document action:",O,le)};return(O,le)=>(o(),l("div",qn,[e("div",On,[e("div",Rn,[Vn,e("button",{onClick:n,class:"inline-flex items-center gap-2 px-4 py-2.5 bg-primary text-white rounded-xl hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-all duration-200 shadow-sm hover:shadow-md"},[s(t(Ke),{class:"w-5 h-5"}),se(" Nueva Carpeta ")])]),e("div",Qn,[Gn,e("button",{onClick:n,class:"w-full flex items-center justify-center gap-3 px-4 py-4 bg-primary text-white rounded-xl hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-all duration-200 shadow-sm hover:shadow-md font-medium text-base"},[s(t(Ke),{class:"w-6 h-6"}),se(" Nueva Carpeta ")])])]),s(t(zn),{"sorted-folders":E.value,"search-query":r.searchQuery,"is-loading":Y.value,onFolderClick:_,onEditFolder:w,onDeleteFolder:oe,onAddDocuments:I,onCreateFolder:n},null,8,["sorted-folders","search-query","is-loading"]),s(t(Js),{"is-visible":$.value,"editing-folder":F.value,onClose:g,onSuccess:A},null,8,["is-visible","editing-folder"]),s(t(Mo),{folder:B.value,onClose:j,onAddDocuments:I,onRemoveDocument:q,onViewDocument:X,onUseDocument:ee,onDocumentAction:K},null,8,["folder"]),s(t(an),{"is-visible":J.value,folder:R.value,onClose:y,onAddDocuments:V},null,8,["is-visible","folder"])]))}},Hn=yt(Zn,[["__scopeId","data-v-ab5666d5"]]);function Lt(){const r=He(),v=L(()=>{var x;return((x=r.currentUser)==null?void 0:x.role)==="basic"}),i=x=>{_e("Esta funcionalidad est√° restringida para usuarios b√°sicos. Por favor, contacta a tu abogado para obtener acceso completo.","warning")};return{isBasicUser:v,showRestrictionNotification:i,handleFeatureAccess:(x,u)=>v.value?(i(),!1):(u&&u(),!0),getRestrictedButtonClasses:x=>x?"opacity-60 cursor-not-allowed":""}}const Wn={class:"document-list-client-table",style:{overflow:"visible !important"}},Kn={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6",style:{overflow:"visible !important"}},Jn={class:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between"},Yn={class:"flex flex-col sm:flex-row gap-3 flex-1 w-full lg:w-auto"},Xn={class:"relative flex-1 min-w-[200px]"},el={class:"max-w-[120px] truncate"},tl={class:"p-2"},sl={class:"relative mb-2"},ol={class:"max-h-60 overflow-y-auto"},rl=["onClick"],nl={class:"truncate"},ll={key:0,class:"px-3 py-2 text-sm text-gray-500 text-center"},al={class:"flex items-center gap-3 w-full lg:w-auto"},il={class:"text-sm text-gray-500 whitespace-nowrap"},dl={class:"py-1"},cl={style:{overflow:"visible !important"}},ul={class:"min-w-full divide-y divide-gray-200",style:{overflow:"visible !important"}},ml=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Documento "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Firma "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etiqueta "),e("th",{scope:"col",class:"w-16 px-6 py-3"})])],-1),gl={class:"bg-white divide-y divide-gray-200",style:{overflow:"visible !important"}},pl=["onClick"],hl={class:"px-6 py-4 whitespace-nowrap"},fl={class:"flex items-center"},vl={class:"flex-shrink-0 h-10 w-10"},bl={class:"h-10 w-10 rounded-lg bg-blue-100 flex items-center justify-center"},yl={class:"ml-4"},xl={class:"text-sm font-medium text-gray-900"},_l={class:"px-6 py-4 whitespace-nowrap"},wl={class:"px-6 py-4 whitespace-nowrap"},$l={class:"px-6 py-4 whitespace-nowrap"},kl={class:"flex flex-wrap gap-1"},Cl={key:0,class:"text-sm text-gray-400"},Dl={class:"py-1"},Sl=["onClick"],El=["onClick"],Fl=["onClick"],Al=["onClick"],Tl=["onClick"],Ml=["onClick"],Pl=["onClick"],Ll=["onClick"],Il=["onClick"],jl=["onClick"],Bl={key:0,class:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"},Ul={class:"flex flex-1 justify-between sm:hidden"},Nl=["disabled"],zl=["disabled"],ql={class:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between"},Ol={class:"text-sm text-gray-700"},Rl={class:"font-medium"},Vl={class:"font-medium"},Ql={class:"font-medium"},Gl={class:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination"},Zl=["disabled"],Hl=e("span",{class:"sr-only"},"Anterior",-1),Wl=["onClick"],Kl={key:1,class:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700"},Jl=["disabled"],Yl=e("span",{class:"sr-only"},"Siguiente",-1),Xl={key:1,class:"text-center py-12"},ea=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No hay documentos",-1),ta=e("p",{class:"mt-1 text-sm text-gray-500"},"Los documentos asignados por tu abogado aparecer√°n aqu√≠.",-1),sa={__name:"DocumentListClientTable",props:{searchQuery:String,selectedTags:{type:Array,default:()=>[]}},emits:["refresh","open-letterhead","open-relationships"],setup(r,{emit:v}){const i=Re(),c=He(),S=Xe(),x=v,{handleFeatureAccess:u}=Lt(),{activeModals:$,openModal:F,closeModal:B}=ft(i,c),{handlePreviewDocument:J,deleteDocument:R,downloadPDFDocument:Y,downloadWordDocument:E}=vt(i,c,x);$e($,k=>{},{deep:!0}),qe(()=>{});const n=P(""),w=P(""),g=P(null),A=P("recent");qe(()=>{i.init(),c.init()});const _=L(()=>c.getCurrentUser),j=L(()=>_.value?i.progressAndCompletedDocumentsByClient(_.value.id):[]),oe=L(()=>{let k=[...j.value];const T=n.value.toLowerCase();return T&&(k=k.filter(C=>{var re,ue;return((re=C.title)==null?void 0:re.toLowerCase().includes(T))||((ue=C.tags)==null?void 0:ue.some(Q=>{var z;return(z=Q.name)==null?void 0:z.toLowerCase().includes(T)}))})),g.value&&(k=k.filter(C=>C.tags&&C.tags.some(re=>re.id===g.value))),A.value==="name"?k.sort((C,re)=>{const ue=(C.title||"").toLowerCase(),Q=(re.title||"").toLowerCase();return ue.localeCompare(Q)}):A.value==="recent"&&k.sort((C,re)=>re.id-C.id),k}),I=P(1),y=P(10),N=L(()=>{const k=(I.value-1)*y.value,T=k+y.value;return oe.value.slice(k,T)}),V=L(()=>Math.ceil(oe.value.length/y.value)),q=L(()=>{const k=(I.value-1)*y.value+1,T=Math.min(I.value*y.value,oe.value.length);return{start:k,end:T,total:oe.value.length}});$e([n,g,A],()=>{I.value=1});const X=L(()=>{const k=V.value,T=I.value,C=[];if(k<=7)for(let re=1;re<=k;re++)C.push(re);else if(T<=4){for(let re=1;re<=5;re++)C.push(re);C.push("..."),C.push(k)}else if(T>=k-3){C.push(1),C.push("...");for(let re=k-4;re<=k;re++)C.push(re)}else C.push(1),C.push("..."),C.push(T-1),C.push(T),C.push(T+1),C.push("..."),C.push(k);return C}),ee=()=>{I.value>1&&I.value--},K=()=>{I.value<V.value&&I.value++},O=k=>{k>=1&&k<=V.value&&(I.value=k)},le=L(()=>{const k=new Map;return j.value.forEach(T=>{T.tags&&T.tags.length>0&&T.tags.forEach(C=>{k.has(C.id)||k.set(C.id,C)})}),Array.from(k.values()).sort((T,C)=>T.name.localeCompare(C.name))}),he=L(()=>{if(!w.value)return le.value;const k=w.value.toLowerCase();return le.value.filter(T=>T.name.toLowerCase().includes(k))}),be=L(()=>{if(!g.value)return null;const k=le.value.find(T=>T.id===g.value);return k?k.name:null}),ie=L(()=>{switch(A.value){case"name":return"Nombre (A-Z)";case"recent":default:return"M√°s recientes"}}),ye=k=>k.state==="Completed"?"Completado":k.state==="Progress"?"En Progreso":k.state||"Sin estado",ve=k=>k.state==="Completed"?"bg-green-100 text-green-700 border border-green-200":k.state==="Progress"?"bg-blue-100 text-blue-700 border border-blue-200":"bg-gray-100 text-gray-700 border border-gray-200",pe=k=>{if(!k.signatures||k.signatures.length===0)return"Sin Firma";if(k.fully_signed)return"Firmado";const T=k.signatures.find(re=>{var ue;return re.user_id===((ue=_.value)==null?void 0:ue.id)});return T?T.signed?"Firmado":"Pendiente Firmar":k.signatures.some(re=>!re.signed)?"Pendiente Firmar":"Sin Firma"},Le=k=>{const T=pe(k);return T==="Sin Firma"?"bg-yellow-100 text-yellow-700 border border-yellow-200":T==="Firmado"?"bg-green-100 text-green-700 border border-green-200":T==="Pendiente Firmar"?"bg-blue-100 text-blue-700 border border-blue-200":T==="Devuelto Sin Firma"?"bg-red-100 text-red-700 border border-red-200":"bg-gray-100 text-gray-700 border border-gray-200"},Be=k=>{const T=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],C=k.id%T.length;return T[C]},ge=k=>{const T=["bg-blue-500","bg-purple-500","bg-pink-500","bg-yellow-500","bg-green-500","bg-red-500","bg-indigo-500","bg-orange-500"],C=k.id%T.length;return T[C]},ne=()=>{g.value=null},Ce=k=>{const T=`/dynamic_document_dashboard/document/use/editor/${k.id}/${encodeURIComponent(k.title.trim())}`;S.push(T)},Te=k=>{var T;F("edit",k,{userRole:((T=c.currentUser)==null?void 0:T.role)||"client"})},W=k=>{S.push(`/dynamic_document_dashboard/client/editor/edit/${k.id}`)},Ie=async k=>{await J(k)},Me=async k=>{await R(k)},Ge=k=>{u("Membrete Individual",()=>{F("letterhead",k)})},p=k=>{F("relationships",k)},d=async k=>{await Y(k)},a=async k=>{await E(k)},G=k=>{F("email",k)};return(k,T)=>(o(),l(de,null,[e("div",Wn,[e("div",Kn,[e("div",Jn,[e("div",Yn,[e("div",Xn,[s(t(Qe),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),Ae(e("input",{"onUpdate:modelValue":T[0]||(T[0]=C=>n.value=C),type:"text",placeholder:"Buscar...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent"},null,512),[[Oe,n.value]])]),s(t(Se),{as:"div",class:"relative"},{default:m(()=>[s(t(Ee),{class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:m(()=>[s(t(tt),{class:"h-4 w-4"}),e("span",el,f(be.value||"Etiqueta"),1),s(t(ze),{class:"h-4 w-4"})]),_:1}),s(t(Fe),{class:"absolute left-0 z-10 mt-2 w-64 origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",tl,[e("div",sl,[s(t(Qe),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),Ae(e("input",{"onUpdate:modelValue":T[1]||(T[1]=C=>w.value=C),type:"text",placeholder:"Buscar etiquetas...",class:"w-full pl-9 pr-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent",onClick:T[2]||(T[2]=fe(()=>{},["stop"]))},null,512),[[Oe,w.value]])]),e("div",ol,[s(t(ae),null,{default:m(({active:C})=>[e("a",{onClick:T[3]||(T[3]=re=>g.value=null),class:h([C?"bg-gray-100":"","block px-3 py-2 text-sm text-gray-700 cursor-pointer rounded-md"])}," Todos ",2)]),_:1}),(o(!0),l(de,null,me(he.value,C=>(o(),te(t(ae),{key:C.id},{default:m(({active:re})=>[e("a",{onClick:ue=>g.value=C.id,class:h([re?"bg-gray-100":"","flex items-center gap-2 px-3 py-2 text-sm cursor-pointer rounded-md"])},[e("span",{class:h(["w-3 h-3 rounded-full flex-shrink-0",ge(C)])},null,2),e("span",nl,f(C.name),1)],10,rl)]),_:2},1024))),128)),he.value.length===0?(o(),l("div",ll," No se encontraron etiquetas ")):D("",!0)])])]),_:1})]),_:1}),g.value?(o(),l("button",{key:0,onClick:ne,class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",title:"Limpiar filtros"},[s(t(Pe),{class:"h-4 w-4"}),se(" Limpiar ")])):D("",!0)]),e("div",al,[e("span",il,f(oe.value.length)+" "+f(oe.value.length===1?"resultado":"resultados"),1),s(t(Se),{as:"div",class:"relative"},{default:m(()=>[s(t(Ee),{class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:m(()=>[se(" Ordenar: "+f(ie.value)+" ",1),s(t(ze),{class:"h-4 w-4"})]),_:1}),s(t(Fe),{class:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",dl,[s(t(ae),null,{default:m(({active:C})=>[e("a",{onClick:T[4]||(T[4]=re=>A.value="recent"),class:h([C?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," M√°s recientes ",2)]),_:1}),s(t(ae),null,{default:m(({active:C})=>[e("a",{onClick:T[5]||(T[5]=re=>A.value="name"),class:h([C?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Nombre (A-Z) ",2)]),_:1})])]),_:1})]),_:1})])])]),e("div",{style:{overflow:"visible !important"},class:h(oe.value.length<=3?"pl-52":"")},[e("div",cl,[e("table",ul,[ml,e("tbody",gl,[(o(!0),l(de,null,me(N.value,(C,re)=>(o(),l("tr",{key:C.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",style:{overflow:"visible !important"},onClick:ue=>Ce(C)},[e("td",hl,[e("div",fl,[e("div",vl,[e("div",bl,[s(t(Ve),{class:"h-5 w-5 text-blue-600"})])]),e("div",yl,[e("div",xl,f(C.title),1)])])]),e("td",_l,[e("span",{class:h(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",ve(C)])},f(ye(C)),3)]),e("td",wl,[e("span",{class:h(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",Le(C)])},f(pe(C)),3)]),e("td",$l,[e("div",kl,[(o(!0),l(de,null,me(C.tags,ue=>(o(),l("span",{key:ue.id,class:h(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",Be(ue)])},f(ue.name),3))),128)),!C.tags||C.tags.length===0?(o(),l("span",Cl,"-")):D("",!0)])]),e("td",{class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",style:{overflow:"visible !important"},onClick:T[6]||(T[6]=fe(()=>{},["stop"]))},[s(t(Se),{as:"div",class:"relative inline-block text-left",style:{overflow:"visible !important"}},{default:m(()=>[s(t(Ee),{class:"inline-flex items-center justify-center w-8 h-8 rounded-md hover:bg-gray-100"},{default:m(()=>[s(t(et),{class:"h-5 w-5 text-gray-500"})]),_:1}),s(t(Fe),{class:h([N.value.length<=3?"absolute right-full mr-2 top-0 z-[9999] w-56 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none":re>=N.value.length-3?"absolute right-0 z-[9999] bottom-full mb-2 w-56 origin-bottom-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none":"absolute right-0 z-[9999] mt-2 w-56 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"])},{default:m(()=>[e("div",Dl,[C.state==="Completed"?(o(),te(t(ae),{key:0},{default:m(({active:ue})=>[e("a",{onClick:Q=>Te(C),class:h([ue?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Editar Formulario ",10,Sl)]),_:2},1024)):D("",!0),C.state==="Completed"?(o(),te(t(ae),{key:1},{default:m(({active:ue})=>[e("a",{onClick:Q=>W(C),class:h([ue?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Editar Documento ",10,El)]),_:2},1024)):D("",!0),C.state!=="Completed"?(o(),te(t(ae),{key:2},{default:m(({active:ue})=>[e("a",{onClick:Q=>Te(C),class:h([ue?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Completar ",10,Fl)]),_:2},1024)):D("",!0),C.state==="Completed"?(o(),te(t(ae),{key:3},{default:m(({active:ue})=>[e("a",{onClick:Q=>Ie(C),class:h([ue?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Previsualizar ",10,Al)]),_:2},1024)):D("",!0),s(t(ae),null,{default:m(({active:ue})=>[e("a",{onClick:Q=>Me(C),class:h([ue?"bg-gray-100":"","block px-4 py-2 text-sm text-red-600 cursor-pointer"])}," Eliminar ",10,Tl)]),_:2},1024),s(t(ae),null,{default:m(({active:ue})=>{var Q;return[e("a",{onClick:z=>Ge(C),class:h([ue?"bg-gray-100":"",((Q=_.value)==null?void 0:Q.role)==="basic"?"opacity-60 cursor-not-allowed text-gray-400":"text-gray-700 cursor-pointer","block px-4 py-2 text-sm"])}," Gestionar Membrete ",10,Ml)]}),_:2},1024),s(t(ae),null,{default:m(({active:ue})=>[e("a",{onClick:Q=>p(C),class:h([ue?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Administrar Asociaciones ",10,Pl)]),_:2},1024),C.state==="Completed"?(o(),te(t(ae),{key:4},{default:m(({active:ue})=>[e("a",{onClick:Q=>d(C),class:h([ue?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Descargar PDF ",10,Ll)]),_:2},1024)):D("",!0),C.state==="Completed"?(o(),te(t(ae),{key:5},{default:m(({active:ue})=>[e("a",{onClick:Q=>a(C),class:h([ue?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Descargar Word ",10,Il)]),_:2},1024)):D("",!0),C.state==="Completed"?(o(),te(t(ae),{key:6},{default:m(({active:ue})=>[e("a",{onClick:Q=>G(C),class:h([ue?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Enviar ",10,jl)]),_:2},1024)):D("",!0)])]),_:2},1032,["class"])]),_:2},1024)])],8,pl))),128))])])]),V.value>1?(o(),l("div",Bl,[e("div",Ul,[e("button",{onClick:ee,disabled:I.value===1,class:h(["relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",I.value===1?"opacity-50 cursor-not-allowed":""])}," Anterior ",10,Nl),e("button",{onClick:K,disabled:I.value===V.value,class:h(["relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",I.value===V.value?"opacity-50 cursor-not-allowed":""])}," Siguiente ",10,zl)]),e("div",ql,[e("div",null,[e("p",Ol,[se(" Mostrando "),e("span",Rl,f(q.value.start),1),se(" a "),e("span",Vl,f(q.value.end),1),se(" de "),e("span",Ql,f(q.value.total),1),se(" resultados ")])]),e("div",null,[e("nav",Gl,[e("button",{onClick:ee,disabled:I.value===1,class:h(["relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",I.value===1?"opacity-50 cursor-not-allowed":""])},[Hl,s(t(pt),{class:"h-5 w-5","aria-hidden":"true"})],10,Zl),(o(!0),l(de,null,me(X.value,C=>(o(),l(de,{key:C},[C!=="..."?(o(),l("button",{key:0,onClick:re=>O(C),class:h(["relative inline-flex items-center px-4 py-2 text-sm font-semibold focus:z-20 focus:outline-offset-0",I.value===C?"z-10 bg-secondary text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-secondary":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50"])},f(C),11,Wl)):(o(),l("span",Kl," ... "))],64))),128)),e("button",{onClick:K,disabled:I.value===V.value,class:h(["relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",I.value===V.value?"opacity-50 cursor-not-allowed":""])},[Yl,s(t(ot),{class:"h-5 w-5","aria-hidden":"true"})],10,Jl)])])])])):D("",!0),oe.value.length===0?(o(),l("div",Xl,[s(t(rt),{class:"mx-auto h-12 w-12 text-gray-400"}),ea,ta])):D("",!0)],2)]),(o(),te(ht,{to:"body"},[t($).edit.isOpen?(o(),te(Ct,{key:0,document:t($).edit.document,"user-role":t($).edit.userRole,onClose:T[7]||(T[7]=C=>t(B)("edit")),onRefresh:T[8]||(T[8]=C=>x("refresh"))},null,8,["document","user-role"])):D("",!0),t($).email.isOpen?(o(),te(Dt,{key:1,document:t($).email.document,onClose:T[9]||(T[9]=C=>t(B)("email"))},null,8,["document"])):D("",!0),t($).letterhead.isOpen?(o(),te(bt,{key:2,"is-visible":!0,document:t($).letterhead.document,onClose:T[10]||(T[10]=C=>t(B)("letterhead")),onRefresh:T[11]||(T[11]=C=>x("refresh"))},null,8,["document"])):D("",!0),t($).relationships.isOpen?(o(),te(St,{key:3,"is-open":!0,document:t($).relationships.document,onClose:T[12]||(T[12]=C=>t(B)("relationships")),onRefresh:T[13]||(T[13]=C=>x("refresh"))},null,8,["document"])):D("",!0)]))],64))}},oa={class:"mb-4"},ra={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6"},na={class:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between"},la={class:"flex flex-col sm:flex-row gap-3 flex-1 w-full lg:w-auto"},aa={class:"relative flex-1 min-w-[200px]"},ia={class:"max-w-[120px] truncate"},da={class:"p-2"},ca={class:"relative mb-2"},ua={class:"max-h-60 overflow-y-auto"},ma=["onClick"],ga={class:"truncate"},pa={key:0,class:"px-3 py-2 text-sm text-gray-500 text-center"},ha={class:"flex items-center gap-3 w-full lg:w-auto"},fa={class:"text-sm text-gray-500 whitespace-nowrap"},va={class:"py-1"},ba={key:0,class:"bg-white rounded-lg shadow-sm border border-gray-200"},ya={class:"overflow-x-auto"},xa={class:"min-w-full divide-y divide-gray-200"},_a=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Plantilla "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etiquetas "),e("th",{scope:"col",class:"w-16 px-6 py-3"})])],-1),wa={class:"bg-white divide-y divide-gray-200"},$a=["onClick"],ka={class:"px-6 py-4 whitespace-nowrap"},Ca={class:"flex items-center"},Da={class:"flex-shrink-0 h-10 w-10"},Sa={class:"h-10 w-10 rounded-lg bg-purple-100 flex items-center justify-center"},Ea={class:"ml-4"},Fa={class:"text-sm font-medium text-gray-900"},Aa=e("td",{class:"px-6 py-4 whitespace-nowrap"},[e("span",{class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-purple-100 text-purple-700 border border-purple-200"}," Disponible ")],-1),Ta={class:"px-6 py-4 whitespace-nowrap"},Ma={class:"flex flex-wrap gap-1"},Pa={key:0,class:"text-sm text-gray-400"},La={class:"py-1"},Ia=["onClick"],ja={key:1,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center"},Ba=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No hay plantillas disponibles",-1),Ua={class:"mt-1 text-sm text-gray-500"},Na=e("div",{class:"mt-4"},[e("div",{class:"text-xs text-gray-400 bg-gray-100 px-3 py-2 rounded-lg inline-block"},[se(" üí° "),e("strong",null,"Tip:"),se(" Las plantillas son creadas por los abogados ")])],-1),za={__name:"UseDocumentTable",props:{searchQuery:String,selectedTags:{type:Array,default:()=>[]}},emits:["go-back"],setup(r,{emit:v}){const i=Re();He();const c=Xe(),S=v,x=P(""),u=P(""),$=P(null),F=P("recent"),B=L(()=>i.publishedDocumentsUnassigned||[]),J=L(()=>{let I=[...B.value];const y=x.value.toLowerCase();return y&&(I=I.filter(N=>{var V,q;return((V=N.title)==null?void 0:V.toLowerCase().includes(y))||((q=N.tags)==null?void 0:q.some(X=>{var ee;return(ee=X.name)==null?void 0:ee.toLowerCase().includes(y)}))})),$.value&&(I=I.filter(N=>N.tags&&N.tags.some(V=>V.id===$.value))),F.value==="name"?I.sort((N,V)=>{const q=(N.title||"").toLowerCase(),X=(V.title||"").toLowerCase();return q.localeCompare(X)}):F.value==="recent"&&I.sort((N,V)=>V.id-N.id),I}),R=L(()=>{const I=new Map;return B.value.forEach(y=>{y.tags&&y.tags.length>0&&y.tags.forEach(N=>{I.has(N.id)||I.set(N.id,N)})}),Array.from(I.values()).sort((y,N)=>y.name.localeCompare(N.name))}),Y=L(()=>{if(!u.value)return R.value;const I=u.value.toLowerCase();return R.value.filter(y=>y.name.toLowerCase().includes(I))}),E=L(()=>{if(!$.value)return null;const I=R.value.find(y=>y.id===$.value);return I?I.name:null}),n=L(()=>{switch(F.value){case"name":return"Nombre (A-Z)";case"recent":default:return"M√°s recientes"}}),w=L(()=>{const I=x.value&&x.value.trim().length>0,y=$.value!==null;return I&&y?"No se encontraron plantillas que coincidan con tu b√∫squeda y filtros":I?"No se encontraron plantillas que coincidan con tu b√∫squeda":y?"No se encontraron plantillas con la etiqueta seleccionada":"A√∫n no hay plantillas disponibles para usar"}),g=I=>{const y=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],N=I.id%y.length;return y[N]},A=I=>{const y=["bg-blue-500","bg-purple-500","bg-pink-500","bg-yellow-500","bg-green-500","bg-red-500","bg-indigo-500","bg-orange-500"],N=I.id%y.length;return y[N]},_=()=>{$.value=null},j=I=>{const V=`/dynamic_document_dashboard/document/use/${I.state==="Published"&&!I.assigned_to?"creator":"editor"}/${I.id}/${encodeURIComponent(I.title.trim())}`;c.push(V)},oe=()=>{S("go-back")};return qe(async()=>{(!i.documents||i.documents.length===0)&&await i.init(!0)}),(I,y)=>(o(),l("div",null,[e("div",oa,[e("button",{onClick:oe,class:"inline-flex items-center gap-2 px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 rounded-lg transition-colors border border-gray-300"},[s(t(hs),{class:"h-4 w-4"}),se(" Volver a Mis Documentos ")])]),e("div",ra,[e("div",na,[e("div",la,[e("div",aa,[s(t(Qe),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),Ae(e("input",{"onUpdate:modelValue":y[0]||(y[0]=N=>x.value=N),type:"text",placeholder:"Buscar plantillas...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent"},null,512),[[Oe,x.value]])]),s(t(Se),{as:"div",class:"relative"},{default:m(()=>[s(t(Ee),{class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:m(()=>[s(t(tt),{class:"h-4 w-4"}),e("span",ia,f(E.value||"Etiqueta"),1),s(t(ze),{class:"h-4 w-4"})]),_:1}),s(t(Fe),{class:"absolute left-0 z-10 mt-2 w-64 origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",da,[e("div",ca,[s(t(Qe),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),Ae(e("input",{"onUpdate:modelValue":y[1]||(y[1]=N=>u.value=N),type:"text",placeholder:"Buscar etiquetas...",class:"w-full pl-9 pr-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent",onClick:y[2]||(y[2]=fe(()=>{},["stop"]))},null,512),[[Oe,u.value]])]),e("div",ua,[s(t(ae),null,{default:m(({active:N})=>[e("a",{onClick:y[3]||(y[3]=V=>$.value=null),class:h([N?"bg-gray-100":"","block px-3 py-2 text-sm text-gray-700 cursor-pointer rounded-md"])}," Todos ",2)]),_:1}),(o(!0),l(de,null,me(Y.value,N=>(o(),te(t(ae),{key:N.id},{default:m(({active:V})=>[e("a",{onClick:q=>$.value=N.id,class:h([V?"bg-gray-100":"","flex items-center gap-2 px-3 py-2 text-sm cursor-pointer rounded-md"])},[e("span",{class:h(["w-3 h-3 rounded-full flex-shrink-0",A(N)])},null,2),e("span",ga,f(N.name),1)],10,ma)]),_:2},1024))),128)),Y.value.length===0?(o(),l("div",pa," No se encontraron etiquetas ")):D("",!0)])])]),_:1})]),_:1}),$.value?(o(),l("button",{key:0,onClick:_,class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",title:"Limpiar filtros"},[s(t(Pe),{class:"h-4 w-4"}),se(" Limpiar ")])):D("",!0)]),e("div",ha,[e("span",fa," Mostrando "+f(J.value.length)+" plantillas ",1),s(t(Se),{as:"div",class:"relative"},{default:m(()=>[s(t(Ee),{class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:m(()=>[se(" Ordenar: "+f(n.value)+" ",1),s(t(ze),{class:"h-4 w-4"})]),_:1}),s(t(Fe),{class:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",va,[s(t(ae),null,{default:m(({active:N})=>[e("a",{onClick:y[4]||(y[4]=V=>F.value="recent"),class:h([N?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," M√°s recientes ",2)]),_:1}),s(t(ae),null,{default:m(({active:N})=>[e("a",{onClick:y[5]||(y[5]=V=>F.value="name"),class:h([N?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Nombre (A-Z) ",2)]),_:1})])]),_:1})]),_:1})])])]),J.value.length>0?(o(),l("div",ba,[e("div",ya,[e("table",xa,[_a,e("tbody",wa,[(o(!0),l(de,null,me(J.value,N=>(o(),l("tr",{key:N.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:V=>j(N)},[e("td",ka,[e("div",Ca,[e("div",Da,[e("div",Sa,[s(t(Ve),{class:"h-5 w-5 text-purple-600"})])]),e("div",Ea,[e("div",Fa,f(N.title),1)])])]),Aa,e("td",Ta,[e("div",Ma,[(o(!0),l(de,null,me(N.tags,V=>(o(),l("span",{key:V.id,class:h(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",g(V)])},f(V.name),3))),128)),!N.tags||N.tags.length===0?(o(),l("span",Pa,"-")):D("",!0)])]),e("td",{class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",onClick:y[6]||(y[6]=fe(()=>{},["stop"]))},[s(t(Se),{as:"div",class:"relative inline-block text-left"},{default:m(()=>[s(t(Ee),{class:"inline-flex items-center justify-center w-8 h-8 rounded-md hover:bg-gray-100"},{default:m(()=>[s(t(et),{class:"h-5 w-5 text-gray-500"})]),_:1}),s(t(Fe),{class:"absolute right-0 z-[9999] mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",La,[s(t(ae),null,{default:m(({active:V})=>[e("a",{onClick:q=>j(N),class:h([V?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Usar plantilla ",10,Ia)]),_:2},1024)])]),_:2},1024)]),_:2},1024)])],8,$a))),128))])])])])):(o(),l("div",ja,[s(t(rt),{class:"mx-auto h-12 w-12 text-gray-400"}),Ba,e("p",Ua,f(w.value),1),Na]))]))}};function qa(r){return!r.variables||r.variables.length===0?!0:r.variables.every(v=>v.name_es&&v.name_es.trim().length>0)}function qt(r,v){var S;if(!r.requires_signature||r.state!=="PendingSignatures"||!r.signatures||r.signatures.length===0)return!1;const i=(S=v==null?void 0:v.currentUser)==null?void 0:S.email,c=r.signatures.find(x=>x.signer_email===i);return!(!c||c.signed)}const Oa={lawyer:{getMenuOptions:(r,v,i)=>{const c=[{label:"Editar",action:"edit"},{label:"Permisos",action:"permissions"},{label:"Administrar Asociaciones",action:"relationships"},{label:"Eliminar",action:"delete"},{label:"Previsualizaci√≥n",action:"preview"},{label:"Crear una Copia",action:"copy"},{label:"Gestionar Membrete",action:"letterhead"}];return r.state==="Draft"?c.push({label:"Publicar",action:"publish",disabled:!qa(r)}):r.state==="Published"&&(c.push({label:"Mover a Borrador",action:"draft"}),c.push({label:"Formalizar y Agregar Firmas",action:"formalize"})),(r.state==="Completed"||r.state==="Published")&&c.push({label:"Descargar PDF",action:"downloadPDF"},{label:"Descargar Word",action:"downloadWord"},{label:"Enviar por Email",action:"email"}),r.requires_signature&&(c.push({label:"Ver Firmas",action:"viewSignatures"}),qt(r,i)&&c.push({label:"Firmar documento",action:"sign"})),c}},signatures:{getMenuOptions:(r,v,i)=>{const c=[{label:"Previsualizar",action:"preview"},{label:"Gestionar Membrete",action:"letterhead"}];return r.requires_signature&&(r.state==="PendingSignatures"||r.state==="FullySigned")&&c.push({label:"Estado de las firmas",action:"viewSignatures"}),qt(r,i)&&c.push({label:"Firmar documento",action:"sign"}),r.state==="FullySigned"&&c.push({label:"Descargar Documento firmado",action:"downloadSignedDocument"}),r.state==="PendingSignatures"&&c.push({label:"Descargar PDF",action:"downloadPDF"}),c}},client:{getMenuOptions:(r,v,i)=>{var x;const c=[],S=((x=i==null?void 0:i.currentUser)==null?void 0:x.role)==="basic";return r.state==="Completed"?c.push({label:"Editar",action:"edit-submenu",isGroup:!0,children:[{label:"Editar Formulario",action:"editForm"},{label:"Editar Documento",action:"editDocument"}]}):c.push({label:"Completar",action:"editForm"}),r.state==="Completed"&&c.push({label:"Previsualizar",action:"preview"}),c.push({label:"Eliminar",action:"delete"}),S?c.push({label:"Gestionar Membrete",action:"letterhead",disabled:!0}):c.push({label:"Gestionar Membrete",action:"letterhead"}),c.push({label:"Administrar Asociaciones",action:"relationships"}),r.state==="Completed"&&c.push({label:"Descargar PDF",action:"downloadPDF"},{label:"Descargar Word",action:"downloadWord"},{label:"Enviar",action:"email"}),c}}};function Ra(r,v,i="list",c=null){const S=Oa[r];return S?S.getMenuOptions(v,i,c):[]}const Va={class:"relative bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col"},Qa={class:"px-6 py-4 border-b border-gray-200"},Ga=e("h2",{class:"text-xl font-semibold text-gray-800"},"Acciones del Documento",-1),Za={class:"text-sm text-gray-500 mt-1"},Ha={class:"p-6 overflow-y-auto flex-grow"},Wa={class:"space-y-4"},Ka={key:0,class:"text-sm font-semibold text-gray-700 uppercase tracking-wide px-2"},Ja={class:"grid grid-cols-1 sm:grid-cols-2 gap-2"},Ya=["onClick","disabled"],Xa={class:"text-sm font-medium"},ei={key:1,class:"border-t border-gray-200 my-4"},ti={key:0,class:"text-center py-12"},si=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No hay acciones disponibles",-1),oi=e("p",{class:"mt-1 text-sm text-gray-500"}," No hay opciones disponibles para este documento. ",-1),Et={__name:"DocumentActionsModal",props:{isVisible:{type:Boolean,default:!1},document:{type:Object,default:null},cardType:{type:String,required:!0,validator:r=>["lawyer","client","signatures"].includes(r)},context:{type:String,default:"table"},userStore:{type:Object,default:null}},emits:["close","action"],setup(r,{emit:v}){const i=r,c=v,S=L(()=>i.document?Ra(i.cardType,i.document,i.context,i.userStore):[]),x=L(()=>{const E=S.value;if(!E||E.length===0)return[];const n=[],w={edit:"Edici√≥n",view:"Visualizaci√≥n",share:"Compartir",manage:"Gesti√≥n",signatures:"Firmas",delete:"Eliminaci√≥n"},g={edit:[],view:[],share:[],manage:[],signatures:[],delete:[]};return E.forEach(A=>{if(A.children&&Array.isArray(A.children))A.children.forEach(_=>{const j=_.action.toLowerCase();u(_,j,g)});else{const _=A.action.toLowerCase();u(A,_,g)}}),g.edit.length>0&&n.push({title:w.edit,options:g.edit}),g.view.length>0&&n.push({title:w.view,options:g.view}),g.share.length>0&&n.push({title:w.share,options:g.share}),g.signatures.length>0&&n.push({title:w.signatures,options:g.signatures}),g.manage.length>0&&n.push({title:w.manage,options:g.manage}),g.delete.length>0&&n.push({title:w.delete,options:g.delete}),n}),u=(E,n,w)=>{n.includes("edit")||n.includes("editar")||n==="copy"||n==="draft"||n==="publish"||n==="formalize"||n==="completar"?w.edit.push(E):n.includes("view")||n.includes("preview")||n.includes("ver")||n.includes("previsualizaci√≥n")?w.view.push(E):n.includes("download")||n.includes("email")||n.includes("enviar")||n.includes("descargar")?w.share.push(E):n.includes("signature")||n.includes("firma")||n.includes("sign")?w.signatures.push(E):n.includes("permission")||n.includes("relationship")||n.includes("letterhead")||n.includes("permiso")||n.includes("asociaci√≥n")||n.includes("membrete")?w.manage.push(E):n.includes("delete")||n.includes("eliminar")?w.delete.push(E):w.manage.push(E)},$=E=>{const n=E.toLowerCase();return n==="editform"||n.includes("completar")?zt:n==="editdocument"||n.includes("editar documento")?Ut:n.includes("edit")||n==="editar"?Ut:n.includes("delete")||n==="eliminar"?Zt:n.includes("preview")||n.includes("ver")||n.includes("previsualizaci√≥n")?Gt:n==="copy"||n.includes("copia")?cs:n.includes("download")||n.includes("descargar")?nt:n.includes("email")||n.includes("enviar")?ls:n.includes("permission")||n.includes("permiso")?ps:n.includes("relationship")||n.includes("asociaci√≥n")?fs:n.includes("letterhead")||n.includes("membrete")?Wt:n.includes("signature")||n.includes("firma")?Ht:n==="publish"||n.includes("publicar")?xs:n==="draft"||n.includes("borrador")?Ve:n==="formalize"||n.includes("formalizar")?zt:ct},F=E=>{const n=E.toLowerCase();return n.includes("delete")||n==="eliminar"?"text-red-600":n.includes("download")||n.includes("descargar")?"text-blue-600":n.includes("email")||n.includes("enviar")?"text-green-600":n.includes("signature")||n.includes("firma")?"text-purple-600":"text-gray-600"},B=E=>{const n=E.toLowerCase();return n.includes("delete")||n==="eliminar"?"border-red-200 bg-red-50 text-red-700 hover:bg-red-100 hover:border-red-300":n.includes("download")||n.includes("descargar")?"border-blue-200 bg-blue-50 text-blue-700 hover:bg-blue-100 hover:border-blue-300":n.includes("email")||n.includes("enviar")?"border-green-200 bg-green-50 text-green-700 hover:bg-green-100 hover:border-green-300":n.includes("signature")||n.includes("firma")?"border-purple-200 bg-purple-50 text-purple-700 hover:bg-purple-100 hover:border-purple-300":"border-gray-200 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-300"},{handleFeatureAccess:J}=Lt(),R=E=>{const n=S.value.find(g=>g.action===E?g:g.children?g.children.find(A=>A.action===E):null),w=n!=null&&n.children?n.children.find(g=>g.action===E):n;if(w!=null&&w.disabled){J("Esta funcionalidad",null);return}c("action",E,i.document)},Y=()=>{c("close")};return(E,n)=>Ae((o(),te(Ye,null,{default:m(()=>{var w;return[e("div",Va,[e("div",Qa,[Ga,e("p",Za,f(((w=r.document)==null?void 0:w.title)||"Cargando..."),1),e("button",{onClick:Y,class:"absolute top-4 right-4 text-gray-400 hover:text-gray-500 transition-colors"},[s(t(Pe),{class:"h-6 w-6"})])]),e("div",Ha,[e("div",Wa,[(o(!0),l(de,null,me(x.value,(g,A)=>(o(),l("div",{key:A,class:"space-y-2"},[g.title?(o(),l("h3",Ka,f(g.title),1)):D("",!0),e("div",Ja,[(o(!0),l(de,null,me(g.options,_=>(o(),l("button",{key:_.action,onClick:j=>R(_.action),disabled:_.disabled,class:h(["flex items-center justify-start px-4 py-3 rounded-lg border transition-all duration-200",_.disabled?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed opacity-60":B(_.action),"hover:shadow-md hover:scale-[1.02]"])},[(o(),te(ns($(_.action)),{class:h(["h-5 w-5 mr-3 flex-shrink-0",_.disabled?"text-gray-400":F(_.action)])},null,8,["class"])),e("span",Xa,f(_.label),1),_.disabled?(o(),te(t(ds),{key:0,class:"h-4 w-4 ml-auto text-gray-400"})):D("",!0)],10,Ya))),128))]),A<x.value.length-1?(o(),l("div",ei)):D("",!0)]))),128)),x.value.length===0?(o(),l("div",ti,[s(t(ct),{class:"mx-auto h-12 w-12 text-gray-400"}),si,oi])):D("",!0)])])])]}),_:1},512)),[[kt,r.isVisible]])}},We=r=>(mt("data-v-f7aff6da"),r=r(),gt(),r),ri={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-3 sm:p-4 mb-6"},ni={class:"mb-4"},li={class:"relative w-full"},ai={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-4"},ii={class:"flex items-center gap-2 min-w-0"},di={class:"truncate"},ci={class:"py-1"},ui=["onClick"],mi={class:"flex items-center gap-2 min-w-0"},gi={class:"truncate"},pi={class:"p-2"},hi={class:"relative mb-2"},fi={class:"max-h-60 overflow-y-auto"},vi=["onClick"],bi={class:"truncate"},yi={key:0,class:"px-3 py-2 text-sm text-gray-500 text-center"},xi={class:"flex items-center justify-stretch"},_i=We(()=>e("span",null,"Limpiar",-1)),wi={class:"flex flex-col gap-3 pt-4 border-t border-gray-200"},$i={class:"flex flex-col sm:flex-row gap-3 items-start sm:items-center justify-between"},ki={class:"text-sm text-gray-500"},Ci={class:"font-medium"},Di=We(()=>e("span",{class:"hidden sm:inline"},"Ordenar:",-1)),Si={class:"py-1"},Ei={class:"flex items-center gap-2"},Fi=We(()=>e("span",{class:"hidden sm:inline"},"Exportar",-1)),Ai={class:"py-1"},Ti={class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",style:{"overflow-x":"visible","overflow-y":"hidden"}},Mi={class:"overflow-x-auto",style:{"overflow-y":"visible"}},Pi={class:"min-w-full divide-y divide-gray-200"},Li={class:"bg-gray-50"},Ii={scope:"col",class:"w-12 px-6 py-3"},ji=["checked"],Bi=We(()=>e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Nombre Minuta ",-1)),Ui=We(()=>e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado ",-1)),Ni=We(()=>e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etiqueta ",-1)),zi={class:"bg-white divide-y divide-gray-200"},qi=["onClick"],Oi=["checked","onChange"],Ri={class:"px-6 py-4 whitespace-nowrap"},Vi={class:"flex items-center"},Qi={class:"flex-shrink-0 h-10 w-10"},Gi={class:"h-10 w-10 rounded-lg bg-blue-100 flex items-center justify-center"},Zi={class:"ml-4"},Hi={class:"text-sm font-medium text-gray-900"},Wi={class:"px-6 py-4 whitespace-nowrap"},Ki={class:"px-6 py-4 whitespace-nowrap"},Ji={class:"flex flex-wrap gap-1"},Yi={key:0,class:"text-sm text-gray-400"},Xi={key:0,class:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"},ed={class:"flex flex-1 justify-between sm:hidden"},td=["disabled"],sd=["disabled"],od={class:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between"},rd={class:"text-sm text-gray-700"},nd={class:"font-medium"},ld={class:"font-medium"},ad={class:"font-medium"},id={class:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination"},dd=["disabled"],cd=We(()=>e("span",{class:"sr-only"},"Anterior",-1)),ud=["onClick"],md={key:1,class:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700"},gd=["disabled"],pd=We(()=>e("span",{class:"sr-only"},"Siguiente",-1)),hd={key:0,class:"text-center py-12"},fd=We(()=>e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No hay documentos",-1)),vd=We(()=>e("p",{class:"mt-1 text-sm text-gray-500"},"No se encontraron documentos con los filtros seleccionados.",-1)),bd={__name:"DocumentListLawyer",props:{searchQuery:String,selectedTags:{type:Array,default:()=>[]},promptDocuments:{type:Array,default:null}},emits:["refresh"],setup(r,{emit:v}){const i=Re(),c=He(),S=Xe(),x=v,{activeModals:u,openModal:$,closeModal:F,getUserRole:B}=ft(i,c),{handlePreviewDocument:J,deleteDocument:R,downloadPDFDocument:Y,downloadWordDocument:E,copyDocument:n,publishDocument:w,moveToDraft:g,formalizeDocument:A,signDocument:_,downloadSignedDocument:j}=vt(i,c,x),oe=P([]),I=P([]),y=r,N=P(""),V=P(""),q=P(null),X=P(null),ee=P("recent"),K=P([]),O=P(1),le=P(10),he=M=>{switch(M.state){case"Published":return"Publicado";case"Draft":return"Borrador";case"Progress":return"En progreso";case"Completed":return"Completado";case"PendingSignatures":return"Pendiente de firmas";case"FullySigned":return"Completamente firmado";default:return"Desconocido"}},be=M=>{switch(M.state){case"Published":case"FullySigned":return"bg-green-100 text-green-700 border border-green-200";case"Draft":case"Progress":return"bg-blue-100 text-blue-700 border border-blue-200";case"PendingSignatures":return"bg-yellow-100 text-yellow-700 border border-yellow-200";case"Completed":return"bg-purple-100 text-purple-700 border border-purple-200";default:return"bg-gray-100 text-gray-700 border border-gray-200"}},ie=M=>{const b=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],Z=M.id%b.length;return b[Z]},ye=M=>{switch(M){case"Published":return"Publicado";case"Draft":return"Borrador";case"Progress":return"En progreso";case"Completed":return"Completado";case"PendingSignatures":return"Pendiente de firmas";case"FullySigned":return"Completamente firmado";default:return M}},ve=L(()=>{const M=new Set;return ne.value.forEach(b=>{b.state&&M.add(b.state)}),Array.from(M).sort()}),pe=L(()=>{const M=new Map;return ne.value.forEach(b=>{b.tags&&b.tags.length>0&&b.tags.forEach(Z=>{M.has(Z.id)||M.set(Z.id,Z)})}),Array.from(M.values()).sort((b,Z)=>b.name.localeCompare(Z.name))}),Le=L(()=>{if(!V.value)return pe.value;const M=V.value.toLowerCase();return pe.value.filter(b=>b.name.toLowerCase().includes(M))}),Be=L(()=>{if(!X.value)return null;const M=pe.value.find(b=>b.id===X.value);return M?M.name:null}),ge=M=>{const b=["bg-blue-500","bg-purple-500","bg-pink-500","bg-yellow-500","bg-green-500","bg-red-500","bg-indigo-500","bg-orange-500"],Z=M.id%b.length;return b[Z]},ne=L(()=>{if(y.promptDocuments)return[];const b=(i.getDocumentsByLawyerId(c.currentUser.id)||[]).filter(we=>we.state!=="FullySigned"),Z=y.selectedTags?y.selectedTags.map(we=>we.id):[];return i.filteredDocumentsBySearchAndTags(y.searchQuery,c,Z).filter(we=>b.some(xe=>xe.id===we.id))}),Ce=L(()=>{if(y.promptDocuments&&y.promptDocuments.length>0){let M=y.promptDocuments.filter(b=>b.title&&b.title.toLowerCase().includes((y.searchQuery||"").toLowerCase()));if(y.selectedTags&&y.selectedTags.length>0){const b=y.selectedTags.map(Z=>Z.id);M=M.filter(Z=>!Z.tags||Z.tags.length===0?!1:Z.tags.some(U=>b.includes(U.id)))}return M}return[]}),Te=L(()=>y.promptDocuments?Ce.value:ne.value),W=L(()=>{let M=[...Te.value];const b=N.value.toLowerCase();return b&&(M=M.filter(Z=>{var U,we,xe;return((U=Z.title)==null?void 0:U.toLowerCase().includes(b))||((we=Z.state)==null?void 0:we.toLowerCase().includes(b))||((xe=Z.tags)==null?void 0:xe.some(Ft=>{var Ze;return(Ze=Ft.name)==null?void 0:Ze.toLowerCase().includes(b)}))})),q.value&&(M=M.filter(Z=>Z.state===q.value)),X.value&&(M=M.filter(Z=>Z.tags&&Z.tags.some(U=>U.id===X.value))),ee.value==="name"?M.sort((Z,U)=>{const we=(Z.title||"").toLowerCase(),xe=(U.title||"").toLowerCase();return we.localeCompare(xe)}):ee.value==="recent"&&M.sort((Z,U)=>U.id-Z.id),M}),Ie=L(()=>{const M=(O.value-1)*le.value,b=M+le.value;return W.value.slice(M,b)}),Me=L(()=>Math.ceil(W.value.length/le.value)),Ge=L(()=>{const M=(O.value-1)*le.value+1,b=Math.min(O.value*le.value,W.value.length);return{start:M,end:b,total:W.value.length}});$e([N,q,X],()=>{O.value=1});const p=L(()=>{switch(ee.value){case"name":return"Nombre (A-Z)";case"recent":default:return"M√°s recientes"}});L(()=>{if(y.promptDocuments)return null;const M=i.lastUpdatedDocumentId,b=localStorage.getItem("lastUpdatedDocumentId"),Z=[...ne.value];return M&&Z.some(xe=>String(xe.id)===String(M))?M:b&&Z.some(xe=>String(xe.id)===String(b))?b:null});const d=async()=>{try{const M=c.currentUser.id,b=await $t(`dynamic-documents/user/${M}/pending-documents-full/`),Z=await $t(`dynamic-documents/user/${M}/signed-documents/`);b.status===200&&(oe.value=b.data),Z.status===200&&(I.value=Z.data)}catch(M){console.error("Error fetching lawyer documents:",M),M.response&&(console.error("Error response data:",M.response.data),console.error("Error status:",M.response.status))}};$e(Te,M=>{if(!y.promptDocuments&&i.lastUpdatedDocumentId&&!M.some(Z=>String(Z.id)===String(i.lastUpdatedDocumentId))&&M.length>0){const U=[...M].sort((we,xe)=>xe.id-we.id)[0].id;i.lastUpdatedDocumentId=U,localStorage.setItem("lastUpdatedDocumentId",U)}});const a=M=>{M&&setTimeout(()=>{try{const b=document.querySelectorAll(`[data-document-id="${M}"]`);if(b.length>0){const Z=b[0];Z.classList.remove("animate-pulse-highlight-green","animate-pulse-highlight-blue"),Z.offsetWidth,(Z.querySelector("[data-document-id]")||Z).classList.contains("border-green-400")?Z.classList.add("animate-pulse-highlight-green"):Z.classList.add("animate-pulse-highlight-blue"),Z.scrollIntoView({behavior:"smooth",block:"center"})}}catch(b){console.error("Error forcing highlight:",b)}},100)};window.forceDocumentHighlight=a,qe(async()=>{if(y.promptDocuments)return;await i.init();const M=localStorage.getItem("lastUpdatedDocumentId");M&&(i.lastUpdatedDocumentId=M,setTimeout(()=>{Te.value.some(Z=>String(Z.id)===String(M))&&a(M)},500)),d()});const G=L(()=>W.value.length>0&&K.value.length===W.value.length),k=()=>{G.value?K.value=[]:K.value=W.value.map(M=>M.id)},T=M=>{const b=K.value.indexOf(M);b>-1?K.value.splice(b,1):K.value.push(M)},C=()=>{K.value=W.value.map(M=>M.id)},re=()=>{K.value=[]},ue=()=>{q.value=null,X.value=null},Q=()=>{O.value>1&&O.value--},z=()=>{O.value<Me.value&&O.value++},ce=M=>{M>=1&&M<=Me.value&&(O.value=M)},H=L(()=>{const M=Me.value,b=O.value,Z=[];if(M<=7)for(let U=1;U<=M;U++)Z.push(U);else if(b<=4){for(let U=1;U<=5;U++)Z.push(U);Z.push("..."),Z.push(M)}else if(b>=M-3){Z.push(1),Z.push("...");for(let U=M-4;U<=M;U++)Z.push(U)}else Z.push(1),Z.push("..."),Z.push(b-1),Z.push(b),Z.push(b+1),Z.push("..."),Z.push(M);return Z}),ke=()=>{const M=K.value.length>0?W.value.filter(Ze=>K.value.includes(Ze.id)):W.value,b=["Nombre Minuta","Estado","Etiquetas"],Z=M.map(Ze=>[Ze.title||"",he(Ze),Ze.tags?Ze.tags.map(At=>At.name).join(", "):""]),U=[b.join(","),...Z.map(Ze=>Ze.map(At=>`"${At}"`).join(","))].join(`
`),we=new Blob([U],{type:"text/csv;charset=utf-8;"}),xe=document.createElement("a"),Ft=URL.createObjectURL(we);xe.setAttribute("href",Ft),xe.setAttribute("download",`documentos_${new Date().toISOString().split("T")[0]}.csv`),xe.style.visibility="hidden",document.body.appendChild(xe),xe.click(),document.body.removeChild(xe)},De=async(M,b)=>{try{switch(M){case"edit":S.push(`/dynamic_document_dashboard/lawyer/editor/edit/${b.id}`);break;case"permissions":$("permissions",b);break;case"relationships":$("relationships",b);break;case"preview":await J(b);break;case"delete":await R(b);break;case"downloadPDF":await Y(b);break;case"downloadWord":await E(b);break;case"email":$("email",b);break;case"copy":await n(b);break;case"publish":await w(b);break;case"draft":await g(b);break;case"formalize":await A(b);break;case"viewSignatures":$("signatures",b);break;case"sign":await _(b,$);break;case"letterhead":$("letterhead",b);break;default:console.warn("Unknown action:",M)}}catch(Z){console.error(`Error executing action ${M}:`,Z)}},je=P(!1),Ue=P(null),at=M=>{Ue.value=M,je.value=!0},Jt=async(M,b)=>{je.value=!1,await De(M,b)};return(M,b)=>{var Z;return o(),l("div",null,[e("div",ri,[e("div",ni,[e("div",li,[s(t(Qe),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),Ae(e("input",{"onUpdate:modelValue":b[0]||(b[0]=U=>N.value=U),type:"text",placeholder:"Buscar...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent text-sm"},null,512),[[Oe,N.value]])])]),e("div",ai,[s(t(Se),{as:"div",class:"relative"},{default:m(()=>[s(t(Ee),{class:"w-full inline-flex items-center justify-between gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:m(()=>[e("div",ii,[s(t(tt),{class:"h-4 w-4 flex-shrink-0"}),e("span",di,f(q.value||"Estado"),1)]),s(t(ze),{class:"h-4 w-4 flex-shrink-0"})]),_:1}),s(t(Fe),{class:"absolute left-0 z-10 mt-2 w-full min-w-[14rem] origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",ci,[s(t(ae),null,{default:m(({active:U})=>[e("a",{onClick:b[1]||(b[1]=we=>q.value=null),class:h([U?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Todos ",2)]),_:1}),(o(!0),l(de,null,me(ve.value,U=>(o(),te(t(ae),{key:U},{default:m(({active:we})=>[e("a",{onClick:xe=>q.value=U,class:h([we?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])},f(ye(U)),11,ui)]),_:2},1024))),128))])]),_:1})]),_:1}),s(t(Se),{as:"div",class:"relative"},{default:m(()=>[s(t(Ee),{class:"w-full inline-flex items-center justify-between gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:m(()=>[e("div",mi,[s(t(tt),{class:"h-4 w-4 flex-shrink-0"}),e("span",gi,f(Be.value||"Etiqueta"),1)]),s(t(ze),{class:"h-4 w-4 flex-shrink-0"})]),_:1}),s(t(Fe),{class:"absolute left-0 z-10 mt-2 w-full min-w-[16rem] origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",pi,[e("div",hi,[s(t(Qe),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),Ae(e("input",{"onUpdate:modelValue":b[2]||(b[2]=U=>V.value=U),type:"text",placeholder:"Buscar etiquetas...",class:"w-full pl-9 pr-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent",onClick:b[3]||(b[3]=fe(()=>{},["stop"]))},null,512),[[Oe,V.value]])]),e("div",fi,[s(t(ae),null,{default:m(({active:U})=>[e("a",{onClick:b[4]||(b[4]=we=>X.value=null),class:h([U?"bg-gray-100":"","block px-3 py-2 text-sm text-gray-700 cursor-pointer rounded-md"])}," Todos ",2)]),_:1}),(o(!0),l(de,null,me(Le.value,U=>(o(),te(t(ae),{key:U.id},{default:m(({active:we})=>[e("a",{onClick:xe=>X.value=U.id,class:h([we?"bg-gray-100":"","flex items-center gap-2 px-3 py-2 text-sm cursor-pointer rounded-md"])},[e("span",{class:h(["w-3 h-3 rounded-full flex-shrink-0",ge(U)])},null,2),e("span",bi,f(U.name),1)],10,vi)]),_:2},1024))),128)),Le.value.length===0?(o(),l("div",yi," No se encontraron etiquetas ")):D("",!0)])])]),_:1})]),_:1}),e("div",xi,[q.value||X.value?(o(),l("button",{key:0,onClick:ue,class:"w-full inline-flex items-center justify-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",title:"Limpiar filtros"},[s(t(Pe),{class:"h-4 w-4 flex-shrink-0"}),_i])):D("",!0)])]),e("div",wi,[e("div",$i,[e("div",ki,[e("span",Ci,f(W.value.length),1),se(" resultados ")]),s(t(Se),{as:"div",class:"relative"},{default:m(()=>[s(t(Ee),{class:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:m(()=>[Di,se(" "+f(p.value)+" ",1),s(t(ze),{class:"h-4 w-4"})]),_:1}),s(t(Fe),{class:"absolute left-0 sm:left-auto sm:right-0 z-10 mt-2 w-48 origin-top-left sm:origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",Si,[s(t(ae),null,{default:m(({active:U})=>[e("a",{onClick:b[5]||(b[5]=we=>ee.value="recent"),class:h([U?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," M√°s recientes ",2)]),_:1}),s(t(ae),null,{default:m(({active:U})=>[e("a",{onClick:b[6]||(b[6]=we=>ee.value="name"),class:h([U?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Nombre (A-Z) ",2)]),_:1})])]),_:1})]),_:1})]),e("div",Ei,[e("button",{onClick:ke,class:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},[s(t(nt),{class:"h-4 w-4"}),Fi]),s(t(Se),{as:"div",class:"relative"},{default:m(()=>[s(t(Ee),{class:"inline-flex items-center justify-center w-10 h-10 rounded-md hover:bg-gray-100"},{default:m(()=>[s(t(et),{class:"h-5 w-5 text-gray-500"})]),_:1}),s(t(Fe),{class:"absolute left-0 sm:left-auto sm:right-0 z-10 mt-2 w-48 origin-top-left sm:origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",Ai,[s(t(ae),null,{default:m(({active:U})=>[e("a",{onClick:C,class:h([U?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Seleccionar todo ",2)]),_:1}),s(t(ae),null,{default:m(({active:U})=>[e("a",{onClick:re,class:h([U?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Deseleccionar todo ",2)]),_:1})])]),_:1})]),_:1})])])]),e("div",Ti,[e("div",Mi,[e("table",Pi,[e("thead",Li,[e("tr",null,[e("th",Ii,[e("input",{type:"checkbox",checked:G.value,onChange:k,class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,ji)]),Bi,Ui,Ni])]),e("tbody",zi,[(o(!0),l(de,null,me(Ie.value,(U,we)=>(o(),l("tr",{key:U.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:xe=>at(U)},[e("td",{class:"px-6 py-4 whitespace-nowrap",onClick:b[7]||(b[7]=fe(()=>{},["stop"]))},[e("input",{type:"checkbox",checked:K.value.includes(U.id),onChange:xe=>T(U.id),class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,Oi)]),e("td",Ri,[e("div",Vi,[e("div",Qi,[e("div",Gi,[s(t(Ve),{class:"h-5 w-5 text-blue-600"})])]),e("div",Zi,[e("div",Hi,f(U.title),1)])])]),e("td",Wi,[e("span",{class:h(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",be(U)])},f(he(U)),3)]),e("td",Ki,[e("div",Ji,[(o(!0),l(de,null,me(U.tags,xe=>(o(),l("span",{key:xe.id,class:h(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",ie(xe)])},f(xe.name),3))),128)),!U.tags||U.tags.length===0?(o(),l("span",Yi,"-")):D("",!0)])])],8,qi))),128))])])]),Me.value>1?(o(),l("div",Xi,[e("div",ed,[e("button",{onClick:Q,disabled:O.value===1,class:h(["relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",O.value===1?"opacity-50 cursor-not-allowed":""])}," Anterior ",10,td),e("button",{onClick:z,disabled:O.value===Me.value,class:h(["relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",O.value===Me.value?"opacity-50 cursor-not-allowed":""])}," Siguiente ",10,sd)]),e("div",od,[e("div",null,[e("p",rd,[se(" Mostrando "),e("span",nd,f(Ge.value.start),1),se(" a "),e("span",ld,f(Ge.value.end),1),se(" de "),e("span",ad,f(Ge.value.total),1),se(" resultados ")])]),e("div",null,[e("nav",id,[e("button",{onClick:Q,disabled:O.value===1,class:h(["relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",O.value===1?"opacity-50 cursor-not-allowed":""])},[cd,s(t(pt),{class:"h-5 w-5","aria-hidden":"true"})],10,dd),(o(!0),l(de,null,me(H.value,U=>(o(),l(de,{key:U},[U!=="..."?(o(),l("button",{key:0,onClick:we=>ce(U),class:h(["relative inline-flex items-center px-4 py-2 text-sm font-semibold focus:z-20 focus:outline-offset-0",O.value===U?"z-10 bg-secondary text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-secondary":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50"])},f(U),11,ud)):(o(),l("span",md," ... "))],64))),128)),e("button",{onClick:z,disabled:O.value===Me.value,class:h(["relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",O.value===Me.value?"opacity-50 cursor-not-allowed":""])},[pd,s(t(ot),{class:"h-5 w-5","aria-hidden":"true"})],10,gd)])])])])):D("",!0)]),W.value.length===0?(o(),l("div",hd,[s(t(rt),{class:"mx-auto h-12 w-12 text-gray-400"}),fd,vd])):D("",!0),s(Mt,{isVisible:t(st),documentData:t(Tt),onClose:b[8]||(b[8]=U=>st.value=!1)},null,8,["isVisible","documentData"]),(o(),te(ht,{to:"body"},[t(u).edit.isOpen?(o(),te(t(Ct),{key:0,document:t(u).edit.document,"user-role":t(B)(),onClose:b[9]||(b[9]=U=>t(F)("edit")),onRefresh:b[10]||(b[10]=U=>x("refresh"))},null,8,["document","user-role"])):D("",!0),t(u).email.isOpen?(o(),te(t(Dt),{key:1,document:t(u).email.document,onClose:b[11]||(b[11]=U=>t(F)("email"))},null,8,["document"])):D("",!0),t(u).signatures.isOpen?(o(),te(t(Qt),{key:2,"document-id":(Z=t(u).signatures.document)==null?void 0:Z.id,onClose:b[12]||(b[12]=U=>t(F)("signatures")),onRefresh:b[13]||(b[13]=U=>x("refresh"))},null,8,["document-id"])):D("",!0),t(u).permissions.isOpen?(o(),te(t(us),{key:3,"is-open":t(u).permissions.isOpen,document:t(u).permissions.document,onClose:b[14]||(b[14]=U=>t(F)("permissions")),onSaved:b[15]||(b[15]=U=>x("refresh"))},null,8,["is-open","document"])):D("",!0),t(u).letterhead.isOpen?(o(),te(bt,{key:4,"is-visible":t(u).letterhead.isOpen,document:t(u).letterhead.document,onClose:b[16]||(b[16]=U=>t(F)("letterhead")),onUploaded:b[17]||(b[17]=U=>x("refresh")),onDeleted:b[18]||(b[18]=U=>x("refresh"))},null,8,["is-visible","document"])):D("",!0),t(u).relationships.isOpen?(o(),te(St,{key:5,"is-open":t(u).relationships.isOpen,document:t(u).relationships.document,onClose:b[19]||(b[19]=U=>t(F)("relationships")),onRefresh:b[20]||(b[20]=U=>x("refresh"))},null,8,["is-open","document"])):D("",!0),je.value?(o(),te(Et,{key:6,"is-visible":je.value,document:Ue.value,"card-type":"lawyer",context:"table","user-store":t(c),onClose:b[21]||(b[21]=U=>je.value=!1),onAction:Jt},null,8,["is-visible","document","user-store"])):D("",!0)]))])}}},yd=yt(bd,[["__scopeId","data-v-f7aff6da"]]),xd={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-3 sm:p-4 mb-6"},_d={class:"mb-4"},wd={class:"relative w-full"},$d={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-4"},kd={class:"flex items-center gap-2 min-w-0"},Cd={class:"truncate"},Dd={class:"py-1"},Sd=["onClick"],Ed={class:"flex items-center justify-stretch"},Fd=e("span",null,"Limpiar",-1),Ad={class:"flex flex-col gap-3 pt-4 border-t border-gray-200"},Td={class:"flex flex-col sm:flex-row gap-3 items-start sm:items-center justify-between"},Md={class:"text-sm text-gray-500"},Pd={class:"font-medium"},Ld=e("span",{class:"hidden sm:inline"},"Ordenar:",-1),Id={class:"py-1"},jd={class:"flex items-center gap-2"},Bd=e("span",{class:"hidden sm:inline"},"Exportar",-1),Ud={class:"py-1"},Nd={class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",style:{"overflow-x":"visible","overflow-y":"hidden"}},zd={class:"min-w-full divide-y divide-gray-200"},qd={class:"bg-gray-50"},Od={scope:"col",class:"w-12 px-6 py-3"},Rd=["checked"],Vd=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Nombre Documento ",-1),Qd=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Cliente ",-1),Gd=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado ",-1),Zd=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etiqueta ",-1),Hd={class:"bg-white divide-y divide-gray-200"},Wd=["onClick"],Kd=["checked","onChange"],Jd={class:"px-6 py-4 whitespace-nowrap"},Yd={class:"flex items-center"},Xd={class:"flex-shrink-0 h-10 w-10"},ec={class:"h-10 w-10 rounded-lg bg-green-100 flex items-center justify-center"},tc={class:"ml-4"},sc={class:"text-sm font-medium text-gray-900"},oc={class:"px-6 py-4 whitespace-nowrap"},rc={class:"text-sm text-gray-900"},nc=e("td",{class:"px-6 py-4 whitespace-nowrap"},[e("span",{class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-700 border border-green-200"}," Completado ")],-1),lc={class:"px-6 py-4 whitespace-nowrap"},ac={class:"flex flex-wrap gap-1"},ic={key:0,class:"text-sm text-gray-400"},dc={key:0,class:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"},cc={class:"flex flex-1 justify-between sm:hidden"},uc=["disabled"],mc=["disabled"],gc={class:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between"},pc={class:"text-sm text-gray-700"},hc={class:"font-medium"},fc={class:"font-medium"},vc={class:"font-medium"},bc={class:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination"},yc=["disabled"],xc=e("span",{class:"sr-only"},"Anterior",-1),_c=["onClick"],wc={key:1,class:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700"},$c=["disabled"],kc=e("span",{class:"sr-only"},"Siguiente",-1),Cc={key:0,class:"text-center py-12"},Dc=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No hay documentos completados",-1),Sc=e("p",{class:"mt-1 text-sm text-gray-500"},"Los documentos completados por clientes aparecer√°n aqu√≠.",-1),Ec={__name:"DocumentFinishedByClientListTable",props:{searchQuery:String,selectedTags:{type:Array,default:()=>[]}},emits:["refresh"],setup(r,{emit:v}){const i=Re(),c=He(),S=Xe(),x=r,u=v,{activeModals:$,openModal:F,closeModal:B,getUserRole:J}=ft(i,c),{handlePreviewDocument:R,deleteDocument:Y,downloadPDFDocument:E,downloadWordDocument:n}=vt(i,c,u),w=P(""),g=P(null),A=P("recent"),_=P([]),j=P(1),oe=P(10);qe(()=>{i.init(),c.init()});const I=L(()=>{const p=i.completedDocumentsByClient,d=x.selectedTags?x.selectedTags.map(G=>G.id):[];return i.filteredDocumentsBySearchAndTags(x.searchQuery,c,d).filter(G=>p.some(k=>k.id===G.id))}),y=L(()=>{let p=[...I.value];const d=w.value.toLowerCase();return d&&(p=p.filter(a=>{var G,k;return((G=a.title)==null?void 0:G.toLowerCase().includes(d))||((k=a.tags)==null?void 0:k.some(T=>{var C;return(C=T.name)==null?void 0:C.toLowerCase().includes(d)}))})),g.value&&(p=p.filter(a=>a.tags&&a.tags.some(G=>G.id===g.value))),A.value==="name"?p.sort((a,G)=>{const k=(a.title||"").toLowerCase(),T=(G.title||"").toLowerCase();return k.localeCompare(T)}):A.value==="recent"&&p.sort((a,G)=>G.id-a.id),p}),N=L(()=>{const p=(j.value-1)*oe.value,d=p+oe.value;return y.value.slice(p,d)}),V=L(()=>Math.ceil(y.value.length/oe.value)),q=L(()=>{const p=(j.value-1)*oe.value+1,d=Math.min(j.value*oe.value,y.value.length);return{start:p,end:d,total:y.value.length}});$e([w,g],()=>{j.value=1});const X=L(()=>{const p=new Map;return I.value.forEach(d=>{d.tags&&d.tags.length>0&&d.tags.forEach(a=>{p.has(a.id)||p.set(a.id,a)})}),Array.from(p.values()).sort((d,a)=>d.name.localeCompare(a.name))}),ee=L(()=>{if(!g.value)return null;const p=X.value.find(d=>d.id===g.value);return p?p.name:null}),K=L(()=>{switch(A.value){case"name":return"Nombre (A-Z)";case"recent":default:return"M√°s recientes"}}),O=p=>p.client_name?p.client_name:p.client?`${p.client.first_name||""} ${p.client.last_name||""}`.trim():"Cliente",le=p=>{const d=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],a=p.id%d.length;return d[a]},he=L(()=>y.value.length>0&&_.value.length===y.value.length),be=()=>{he.value?_.value=[]:_.value=y.value.map(p=>p.id)},ie=p=>{const d=_.value.indexOf(p);d>-1?_.value.splice(d,1):_.value.push(p)},ye=()=>{_.value=y.value.map(p=>p.id)},ve=()=>{_.value=[]},pe=()=>{g.value=null},Le=()=>{j.value>1&&j.value--},Be=()=>{j.value<V.value&&j.value++},ge=p=>{p>=1&&p<=V.value&&(j.value=p)},ne=L(()=>{const p=V.value,d=j.value,a=[];if(p<=7)for(let G=1;G<=p;G++)a.push(G);else if(d<=4){for(let G=1;G<=5;G++)a.push(G);a.push("..."),a.push(p)}else if(d>=p-3){a.push(1),a.push("...");for(let G=p-4;G<=p;G++)a.push(G)}else a.push(1),a.push("..."),a.push(d-1),a.push(d),a.push(d+1),a.push("..."),a.push(p);return a}),Ce=()=>{const p=_.value.length>0?y.value.filter(re=>_.value.includes(re.id)):y.value,d=["Nombre Documento","Cliente","Estado","Etiquetas"],a=p.map(re=>[re.title||"",O(re),"Completado",re.tags?re.tags.map(ue=>ue.name).join(", "):""]),G=[d.join(","),...a.map(re=>re.map(ue=>`"${ue}"`).join(","))].join(`
`),k=new Blob([G],{type:"text/csv;charset=utf-8;"}),T=document.createElement("a"),C=URL.createObjectURL(k);T.setAttribute("href",C),T.setAttribute("download",`documentos_completados_${new Date().toISOString().split("T")[0]}.csv`),T.style.visibility="hidden",document.body.appendChild(T),T.click(),document.body.removeChild(T)},Te=async(p,d)=>{try{switch(p){case"editForm":F("edit",d,{userRole:J()});break;case"editDocument":S.push(`/dynamic_document_dashboard/client/editor/edit/${d.id}`);break;case"preview":await R(d);break;case"delete":await Y(d);break;case"letterhead":F("letterhead",d);break;case"relationships":F("relationships",d);break;case"downloadPDF":await E(d);break;case"downloadWord":await n(d);break;case"email":F("email",d);break;default:console.warn("Unknown action:",p)}}catch(a){console.error(`Error executing action ${p}:`,a)}},W=P(!1),Ie=P(null),Me=p=>{Ie.value=p,W.value=!0},Ge=async(p,d)=>{W.value=!1,await Te(p,d)};return(p,d)=>(o(),l("div",null,[e("div",xd,[e("div",_d,[e("div",wd,[s(t(Qe),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),Ae(e("input",{"onUpdate:modelValue":d[0]||(d[0]=a=>w.value=a),type:"text",placeholder:"Buscar...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent text-sm"},null,512),[[Oe,w.value]])])]),e("div",$d,[s(t(Se),{as:"div",class:"relative"},{default:m(()=>[s(t(Ee),{class:"w-full inline-flex items-center justify-between gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:m(()=>[e("div",kd,[s(t(tt),{class:"h-4 w-4 flex-shrink-0"}),e("span",Cd,f(ee.value||"Etiqueta"),1)]),s(t(ze),{class:"h-4 w-4 flex-shrink-0"})]),_:1}),s(t(Fe),{class:"absolute left-0 z-10 mt-2 w-full min-w-[16rem] origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none max-h-60 overflow-y-auto"},{default:m(()=>[e("div",Dd,[s(t(ae),null,{default:m(({active:a})=>[e("a",{onClick:d[1]||(d[1]=G=>g.value=null),class:h([a?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Todos ",2)]),_:1}),(o(!0),l(de,null,me(X.value,a=>(o(),te(t(ae),{key:a.id},{default:m(({active:G})=>[e("a",{onClick:k=>g.value=a.id,class:h([G?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])},f(a.name),11,Sd)]),_:2},1024))),128))])]),_:1})]),_:1}),e("div",Ed,[g.value?(o(),l("button",{key:0,onClick:pe,class:"w-full inline-flex items-center justify-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",title:"Limpiar filtros"},[s(t(Pe),{class:"h-4 w-4 flex-shrink-0"}),Fd])):D("",!0)])]),e("div",Ad,[e("div",Td,[e("div",Md,[e("span",Pd,f(y.value.length),1),se(" resultados ")]),s(t(Se),{as:"div",class:"relative"},{default:m(()=>[s(t(Ee),{class:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:m(()=>[Ld,se(" "+f(K.value)+" ",1),s(t(ze),{class:"h-4 w-4"})]),_:1}),s(t(Fe),{class:"absolute left-0 sm:left-auto sm:right-0 z-10 mt-2 w-48 origin-top-left sm:origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",Id,[s(t(ae),null,{default:m(({active:a})=>[e("a",{onClick:d[2]||(d[2]=G=>A.value="recent"),class:h([a?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," M√°s recientes ",2)]),_:1}),s(t(ae),null,{default:m(({active:a})=>[e("a",{onClick:d[3]||(d[3]=G=>A.value="name"),class:h([a?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Nombre (A-Z) ",2)]),_:1})])]),_:1})]),_:1})]),e("div",jd,[e("button",{onClick:Ce,class:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},[s(t(nt),{class:"h-4 w-4"}),Bd]),s(t(Se),{as:"div",class:"relative"},{default:m(()=>[s(t(Ee),{class:"inline-flex items-center justify-center w-10 h-10 rounded-md hover:bg-gray-100"},{default:m(()=>[s(t(et),{class:"h-5 w-5 text-gray-500"})]),_:1}),s(t(Fe),{class:"absolute left-0 sm:left-auto sm:right-0 z-10 mt-2 w-48 origin-top-left sm:origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",Ud,[s(t(ae),null,{default:m(({active:a})=>[e("a",{onClick:ye,class:h([a?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Seleccionar todo ",2)]),_:1}),s(t(ae),null,{default:m(({active:a})=>[e("a",{onClick:ve,class:h([a?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Deseleccionar todo ",2)]),_:1})])]),_:1})]),_:1})])])]),e("div",Nd,[e("div",{class:h(["overflow-x-auto",y.value.length<=3?"pl-52":""]),style:{"overflow-y":"visible"}},[e("table",zd,[e("thead",qd,[e("tr",null,[e("th",Od,[e("input",{type:"checkbox",checked:he.value,onChange:be,class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,Rd)]),Vd,Qd,Gd,Zd])]),e("tbody",Hd,[(o(!0),l(de,null,me(N.value,(a,G)=>(o(),l("tr",{key:a.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:k=>Me(a)},[e("td",{class:"px-6 py-4 whitespace-nowrap",onClick:d[4]||(d[4]=fe(()=>{},["stop"]))},[e("input",{type:"checkbox",checked:_.value.includes(a.id),onChange:k=>ie(a.id),class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,Kd)]),e("td",Jd,[e("div",Yd,[e("div",Xd,[e("div",ec,[s(t(Ve),{class:"h-5 w-5 text-green-600"})])]),e("div",tc,[e("div",sc,f(a.title),1)])])]),e("td",oc,[e("div",rc,f(O(a)),1)]),nc,e("td",lc,[e("div",ac,[(o(!0),l(de,null,me(a.tags,k=>(o(),l("span",{key:k.id,class:h(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",le(k)])},f(k.name),3))),128)),!a.tags||a.tags.length===0?(o(),l("span",ic,"-")):D("",!0)])])],8,Wd))),128))])])],2),V.value>1?(o(),l("div",dc,[e("div",cc,[e("button",{onClick:Le,disabled:j.value===1,class:h(["relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",j.value===1?"opacity-50 cursor-not-allowed":""])}," Anterior ",10,uc),e("button",{onClick:Be,disabled:j.value===V.value,class:h(["relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",j.value===V.value?"opacity-50 cursor-not-allowed":""])}," Siguiente ",10,mc)]),e("div",gc,[e("div",null,[e("p",pc,[se(" Mostrando "),e("span",hc,f(q.value.start),1),se(" a "),e("span",fc,f(q.value.end),1),se(" de "),e("span",vc,f(q.value.total),1),se(" resultados ")])]),e("div",null,[e("nav",bc,[e("button",{onClick:Le,disabled:j.value===1,class:h(["relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",j.value===1?"opacity-50 cursor-not-allowed":""])},[xc,s(t(pt),{class:"h-5 w-5","aria-hidden":"true"})],10,yc),(o(!0),l(de,null,me(ne.value,a=>(o(),l(de,{key:a},[a!=="..."?(o(),l("button",{key:0,onClick:G=>ge(a),class:h(["relative inline-flex items-center px-4 py-2 text-sm font-semibold focus:z-20 focus:outline-offset-0",j.value===a?"z-10 bg-secondary text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-secondary":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50"])},f(a),11,_c)):(o(),l("span",wc," ... "))],64))),128)),e("button",{onClick:Be,disabled:j.value===V.value,class:h(["relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",j.value===V.value?"opacity-50 cursor-not-allowed":""])},[kc,s(t(ot),{class:"h-5 w-5","aria-hidden":"true"})],10,$c)])])])])):D("",!0)]),y.value.length===0?(o(),l("div",Cc,[s(t(rt),{class:"mx-auto h-12 w-12 text-gray-400"}),Dc,Sc])):D("",!0),(o(),te(ht,{to:"body"},[t($).edit.isOpen?(o(),te(t(Ct),{key:0,document:t($).edit.document,"user-role":t(J)(),onClose:d[5]||(d[5]=a=>t(B)("edit")),onRefresh:d[6]||(d[6]=a=>u("refresh"))},null,8,["document","user-role"])):D("",!0),t($).email.isOpen?(o(),te(t(Dt),{key:1,document:t($).email.document,onClose:d[7]||(d[7]=a=>t(B)("email"))},null,8,["document"])):D("",!0),t($).letterhead.isOpen?(o(),te(bt,{key:2,"is-visible":t($).letterhead.isOpen,document:t($).letterhead.document,onClose:d[8]||(d[8]=a=>t(B)("letterhead")),onUploaded:d[9]||(d[9]=a=>u("refresh")),onDeleted:d[10]||(d[10]=a=>u("refresh"))},null,8,["is-visible","document"])):D("",!0),t($).relationships.isOpen?(o(),te(St,{key:3,"is-open":t($).relationships.isOpen,document:t($).relationships.document,onClose:d[11]||(d[11]=a=>t(B)("relationships")),onRefresh:d[12]||(d[12]=a=>u("refresh"))},null,8,["is-open","document"])):D("",!0),W.value?(o(),te(Et,{key:4,"is-visible":W.value,document:Ie.value,"card-type":"client",context:"table","user-store":t(c),onClose:d[13]||(d[13]=a=>W.value=!1),onAction:Ge},null,8,["is-visible","document","user-store"])):D("",!0)]))]))}},Fc={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-3 sm:p-4 mb-6"},Ac={class:"mb-4"},Tc={class:"relative w-full"},Mc={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-4"},Pc={class:"flex items-center gap-2 min-w-0"},Lc={class:"truncate"},Ic={class:"py-1"},jc=["onClick"],Bc={class:"flex items-center justify-stretch"},Uc=e("span",null,"Limpiar",-1),Nc={class:"flex flex-col gap-3 pt-4 border-t border-gray-200"},zc={class:"flex flex-col sm:flex-row gap-3 items-start sm:items-center justify-between"},qc={class:"text-sm text-gray-500"},Oc={class:"font-medium"},Rc=e("span",{class:"hidden sm:inline"},"Ordenar:",-1),Vc={class:"py-1"},Qc={class:"flex items-center gap-2"},Gc=e("span",{class:"hidden sm:inline"},"Exportar",-1),Zc={class:"py-1"},Hc={class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",style:{"overflow-x":"visible","overflow-y":"hidden"}},Wc={class:"min-w-full divide-y divide-gray-200"},Kc={class:"bg-gray-50"},Jc={scope:"col",class:"w-12 px-6 py-3"},Yc=["checked"],Xc=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Nombre Documento ",-1),eu=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Cliente ",-1),tu=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado ",-1),su=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etiqueta ",-1),ou={class:"bg-white divide-y divide-gray-200"},ru=["onClick"],nu=["checked","onChange"],lu={class:"px-6 py-4 whitespace-nowrap"},au={class:"flex items-center"},iu={class:"flex-shrink-0 h-10 w-10"},du={class:"h-10 w-10 rounded-lg bg-blue-100 flex items-center justify-center"},cu={class:"ml-4"},uu={class:"text-sm font-medium text-gray-900"},mu={class:"px-6 py-4 whitespace-nowrap"},gu={class:"text-sm text-gray-900"},pu=e("td",{class:"px-6 py-4 whitespace-nowrap"},[e("span",{class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-700 border border-blue-200"}," En Progreso ")],-1),hu={class:"px-6 py-4 whitespace-nowrap"},fu={class:"flex flex-wrap gap-1"},vu={key:0,class:"text-sm text-gray-400"},bu={key:0,class:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"},yu={class:"flex flex-1 justify-between sm:hidden"},xu=["disabled"],_u=["disabled"],wu={class:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between"},$u={class:"text-sm text-gray-700"},ku={class:"font-medium"},Cu={class:"font-medium"},Du={class:"font-medium"},Su={class:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination"},Eu=["disabled"],Fu=e("span",{class:"sr-only"},"Anterior",-1),Au=["onClick"],Tu={key:1,class:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700"},Mu=["disabled"],Pu=e("span",{class:"sr-only"},"Siguiente",-1),Lu={key:0,class:"text-center py-12"},Iu=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No hay documentos en progreso",-1),ju=e("p",{class:"mt-1 text-sm text-gray-500"},"Los documentos en progreso por clientes aparecer√°n aqu√≠.",-1),Bu={__name:"DocumentInProgressByClientListTable",props:{searchQuery:String,selectedTags:{type:Array,default:()=>[]}},emits:["refresh"],setup(r,{emit:v}){const i=Re(),c=He(),S=Xe(),x=r,u=v,{activeModals:$,openModal:F,closeModal:B,getUserRole:J}=ft(i,c),{handlePreviewDocument:R,deleteDocument:Y,downloadPDFDocument:E,downloadWordDocument:n}=vt(i,c,u),w=P(""),g=P(null),A=P("recent"),_=P([]),j=P(1),oe=P(10);qe(()=>{i.init(),c.init()});const I=L(()=>{const p=i.progressDocumentsByClient,d=x.selectedTags?x.selectedTags.map(G=>G.id):[];return i.filteredDocumentsBySearchAndTags(x.searchQuery,c,d).filter(G=>p.some(k=>k.id===G.id))}),y=L(()=>{let p=[...I.value];const d=w.value.toLowerCase();return d&&(p=p.filter(a=>{var G,k;return((G=a.title)==null?void 0:G.toLowerCase().includes(d))||((k=a.tags)==null?void 0:k.some(T=>{var C;return(C=T.name)==null?void 0:C.toLowerCase().includes(d)}))})),g.value&&(p=p.filter(a=>a.tags&&a.tags.some(G=>G.id===g.value))),A.value==="name"?p.sort((a,G)=>{const k=(a.title||"").toLowerCase(),T=(G.title||"").toLowerCase();return k.localeCompare(T)}):A.value==="recent"&&p.sort((a,G)=>G.id-a.id),p}),N=L(()=>{const p=(j.value-1)*oe.value,d=p+oe.value;return y.value.slice(p,d)}),V=L(()=>Math.ceil(y.value.length/oe.value)),q=L(()=>{const p=(j.value-1)*oe.value+1,d=Math.min(j.value*oe.value,y.value.length);return{start:p,end:d,total:y.value.length}});$e([w,g],()=>{j.value=1});const X=L(()=>{const p=new Map;return I.value.forEach(d=>{d.tags&&d.tags.length>0&&d.tags.forEach(a=>{p.has(a.id)||p.set(a.id,a)})}),Array.from(p.values()).sort((d,a)=>d.name.localeCompare(a.name))}),ee=L(()=>{if(!g.value)return null;const p=X.value.find(d=>d.id===g.value);return p?p.name:null}),K=L(()=>{switch(A.value){case"name":return"Nombre (A-Z)";case"recent":default:return"M√°s recientes"}}),O=p=>p.client_name?p.client_name:p.client?`${p.client.first_name||""} ${p.client.last_name||""}`.trim():"Cliente",le=p=>{const d=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],a=p.id%d.length;return d[a]},he=L(()=>y.value.length>0&&_.value.length===y.value.length),be=()=>{he.value?_.value=[]:_.value=y.value.map(p=>p.id)},ie=p=>{const d=_.value.indexOf(p);d>-1?_.value.splice(d,1):_.value.push(p)},ye=()=>{_.value=y.value.map(p=>p.id)},ve=()=>{_.value=[]},pe=()=>{g.value=null},Le=()=>{j.value>1&&j.value--},Be=()=>{j.value<V.value&&j.value++},ge=p=>{p>=1&&p<=V.value&&(j.value=p)},ne=L(()=>{const p=V.value,d=j.value,a=[];if(p<=7)for(let G=1;G<=p;G++)a.push(G);else if(d<=4){for(let G=1;G<=5;G++)a.push(G);a.push("..."),a.push(p)}else if(d>=p-3){a.push(1),a.push("...");for(let G=p-4;G<=p;G++)a.push(G)}else a.push(1),a.push("..."),a.push(d-1),a.push(d),a.push(d+1),a.push("..."),a.push(p);return a}),Ce=()=>{const p=_.value.length>0?y.value.filter(re=>_.value.includes(re.id)):y.value,d=["Nombre Documento","Cliente","Estado","Etiquetas"],a=p.map(re=>[re.title||"",O(re),"En Progreso",re.tags?re.tags.map(ue=>ue.name).join(", "):""]),G=[d.join(","),...a.map(re=>re.map(ue=>`"${ue}"`).join(","))].join(`
`),k=new Blob([G],{type:"text/csv;charset=utf-8;"}),T=document.createElement("a"),C=URL.createObjectURL(k);T.setAttribute("href",C),T.setAttribute("download",`documentos_en_progreso_${new Date().toISOString().split("T")[0]}.csv`),T.style.visibility="hidden",document.body.appendChild(T),T.click(),document.body.removeChild(T)},Te=async(p,d)=>{try{switch(p){case"editForm":F("edit",d,{userRole:J()});break;case"editDocument":S.push(`/dynamic_document_dashboard/client/editor/edit/${d.id}`);break;case"preview":await R(d);break;case"delete":await Y(d);break;case"letterhead":F("letterhead",d);break;case"relationships":F("relationships",d);break;case"downloadPDF":await E(d);break;case"downloadWord":await n(d);break;case"email":F("email",d);break;default:console.warn("Unknown action:",p)}}catch(a){console.error(`Error executing action ${p}:`,a)}},W=P(!1),Ie=P(null),Me=p=>{Ie.value=p,W.value=!0},Ge=async(p,d)=>{W.value=!1,await Te(p,d)};return(p,d)=>(o(),l("div",null,[e("div",Fc,[e("div",Ac,[e("div",Tc,[s(t(Qe),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),Ae(e("input",{"onUpdate:modelValue":d[0]||(d[0]=a=>w.value=a),type:"text",placeholder:"Buscar...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent text-sm"},null,512),[[Oe,w.value]])])]),e("div",Mc,[s(t(Se),{as:"div",class:"relative"},{default:m(()=>[s(t(Ee),{class:"w-full inline-flex items-center justify-between gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:m(()=>[e("div",Pc,[s(t(tt),{class:"h-4 w-4 flex-shrink-0"}),e("span",Lc,f(ee.value||"Etiqueta"),1)]),s(t(ze),{class:"h-4 w-4 flex-shrink-0"})]),_:1}),s(t(Fe),{class:"absolute left-0 z-10 mt-2 w-full min-w-[16rem] origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none max-h-60 overflow-y-auto"},{default:m(()=>[e("div",Ic,[s(t(ae),null,{default:m(({active:a})=>[e("a",{onClick:d[1]||(d[1]=G=>g.value=null),class:h([a?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Todos ",2)]),_:1}),(o(!0),l(de,null,me(X.value,a=>(o(),te(t(ae),{key:a.id},{default:m(({active:G})=>[e("a",{onClick:k=>g.value=a.id,class:h([G?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])},f(a.name),11,jc)]),_:2},1024))),128))])]),_:1})]),_:1}),e("div",Bc,[g.value?(o(),l("button",{key:0,onClick:pe,class:"w-full inline-flex items-center justify-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",title:"Limpiar filtros"},[s(t(Pe),{class:"h-4 w-4 flex-shrink-0"}),Uc])):D("",!0)])]),e("div",Nc,[e("div",zc,[e("div",qc,[e("span",Oc,f(y.value.length),1),se(" resultados ")]),s(t(Se),{as:"div",class:"relative"},{default:m(()=>[s(t(Ee),{class:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:m(()=>[Rc,se(" "+f(K.value)+" ",1),s(t(ze),{class:"h-4 w-4"})]),_:1}),s(t(Fe),{class:"absolute left-0 sm:left-auto sm:right-0 z-10 mt-2 w-48 origin-top-left sm:origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",Vc,[s(t(ae),null,{default:m(({active:a})=>[e("a",{onClick:d[2]||(d[2]=G=>A.value="recent"),class:h([a?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," M√°s recientes ",2)]),_:1}),s(t(ae),null,{default:m(({active:a})=>[e("a",{onClick:d[3]||(d[3]=G=>A.value="name"),class:h([a?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Nombre (A-Z) ",2)]),_:1})])]),_:1})]),_:1})]),e("div",Qc,[e("button",{onClick:Ce,class:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},[s(t(nt),{class:"h-4 w-4"}),Gc]),s(t(Se),{as:"div",class:"relative"},{default:m(()=>[s(t(Ee),{class:"inline-flex items-center justify-center w-10 h-10 rounded-md hover:bg-gray-100"},{default:m(()=>[s(t(et),{class:"h-5 w-5 text-gray-500"})]),_:1}),s(t(Fe),{class:"absolute left-0 sm:left-auto sm:right-0 z-10 mt-2 w-48 origin-top-left sm:origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",Zc,[s(t(ae),null,{default:m(({active:a})=>[e("a",{onClick:ye,class:h([a?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Seleccionar todo ",2)]),_:1}),s(t(ae),null,{default:m(({active:a})=>[e("a",{onClick:ve,class:h([a?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Deseleccionar todo ",2)]),_:1})])]),_:1})]),_:1})])])]),e("div",Hc,[e("div",{class:h(["overflow-x-auto",N.value.length<=3?"pl-52":""]),style:{"overflow-y":"visible"}},[e("table",Wc,[e("thead",Kc,[e("tr",null,[e("th",Jc,[e("input",{type:"checkbox",checked:he.value,onChange:be,class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,Yc)]),Xc,eu,tu,su])]),e("tbody",ou,[(o(!0),l(de,null,me(N.value,(a,G)=>(o(),l("tr",{key:a.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:k=>Me(a)},[e("td",{class:"px-6 py-4 whitespace-nowrap",onClick:d[4]||(d[4]=fe(()=>{},["stop"]))},[e("input",{type:"checkbox",checked:_.value.includes(a.id),onChange:k=>ie(a.id),class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,nu)]),e("td",lu,[e("div",au,[e("div",iu,[e("div",du,[s(t(Ve),{class:"h-5 w-5 text-blue-600"})])]),e("div",cu,[e("div",uu,f(a.title),1)])])]),e("td",mu,[e("div",gu,f(O(a)),1)]),pu,e("td",hu,[e("div",fu,[(o(!0),l(de,null,me(a.tags,k=>(o(),l("span",{key:k.id,class:h(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",le(k)])},f(k.name),3))),128)),!a.tags||a.tags.length===0?(o(),l("span",vu,"-")):D("",!0)])])],8,ru))),128))])])],2),V.value>1?(o(),l("div",bu,[e("div",yu,[e("button",{onClick:Le,disabled:j.value===1,class:h(["relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",j.value===1?"opacity-50 cursor-not-allowed":""])}," Anterior ",10,xu),e("button",{onClick:Be,disabled:j.value===V.value,class:h(["relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",j.value===V.value?"opacity-50 cursor-not-allowed":""])}," Siguiente ",10,_u)]),e("div",wu,[e("div",null,[e("p",$u,[se(" Mostrando "),e("span",ku,f(q.value.start),1),se(" a "),e("span",Cu,f(q.value.end),1),se(" de "),e("span",Du,f(q.value.total),1),se(" resultados ")])]),e("div",null,[e("nav",Su,[e("button",{onClick:Le,disabled:j.value===1,class:h(["relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",j.value===1?"opacity-50 cursor-not-allowed":""])},[Fu,s(t(pt),{class:"h-5 w-5","aria-hidden":"true"})],10,Eu),(o(!0),l(de,null,me(ne.value,a=>(o(),l(de,{key:a},[a!=="..."?(o(),l("button",{key:0,onClick:G=>ge(a),class:h(["relative inline-flex items-center px-4 py-2 text-sm font-semibold focus:z-20 focus:outline-offset-0",j.value===a?"z-10 bg-secondary text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-secondary":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50"])},f(a),11,Au)):(o(),l("span",Tu," ... "))],64))),128)),e("button",{onClick:Be,disabled:j.value===V.value,class:h(["relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",j.value===V.value?"opacity-50 cursor-not-allowed":""])},[Pu,s(t(ot),{class:"h-5 w-5","aria-hidden":"true"})],10,Mu)])])])])):D("",!0)]),y.value.length===0?(o(),l("div",Lu,[s(t(rt),{class:"mx-auto h-12 w-12 text-gray-400"}),Iu,ju])):D("",!0),(o(),te(ht,{to:"body"},[t($).edit.isOpen?(o(),te(t(Ct),{key:0,document:t($).edit.document,"user-role":t(J)(),onClose:d[5]||(d[5]=a=>t(B)("edit")),onRefresh:d[6]||(d[6]=a=>u("refresh"))},null,8,["document","user-role"])):D("",!0),t($).email.isOpen?(o(),te(t(Dt),{key:1,document:t($).email.document,onClose:d[7]||(d[7]=a=>t(B)("email"))},null,8,["document"])):D("",!0),t($).letterhead.isOpen?(o(),te(bt,{key:2,"is-visible":t($).letterhead.isOpen,document:t($).letterhead.document,onClose:d[8]||(d[8]=a=>t(B)("letterhead")),onUploaded:d[9]||(d[9]=a=>u("refresh")),onDeleted:d[10]||(d[10]=a=>u("refresh"))},null,8,["is-visible","document"])):D("",!0),t($).relationships.isOpen?(o(),te(St,{key:3,"is-open":t($).relationships.isOpen,document:t($).relationships.document,onClose:d[11]||(d[11]=a=>t(B)("relationships")),onRefresh:d[12]||(d[12]=a=>u("refresh"))},null,8,["is-open","document"])):D("",!0),W.value?(o(),te(Et,{key:4,"is-visible":W.value,document:Ie.value,"card-type":"client",context:"table","user-store":t(c),onClose:d[13]||(d[13]=a=>W.value=!1),onAction:Ge},null,8,["is-visible","document","user-store"])):D("",!0)]))]))}},Uu={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-3 sm:p-4 mb-6"},Nu={class:"mb-4"},zu={class:"relative w-full"},qu={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-4"},Ou={class:"flex items-center gap-2 min-w-0"},Ru={class:"truncate"},Vu={class:"p-2"},Qu={class:"relative mb-2"},Gu={class:"max-h-60 overflow-y-auto"},Zu=["onClick"],Hu={class:"truncate"},Wu={key:0,class:"px-3 py-2 text-sm text-gray-500 text-center"},Ku={class:"flex items-center justify-stretch"},Ju=e("span",null,"Limpiar",-1),Yu={class:"flex flex-col gap-3 pt-4 border-t border-gray-200"},Xu={class:"flex flex-col sm:flex-row gap-3 items-start sm:items-center justify-between"},em={class:"text-sm text-gray-500"},tm={class:"font-medium"},sm=e("span",{class:"hidden sm:inline"},"Ordenar:",-1),om={class:"py-1"},rm={class:"flex items-center gap-2"},nm=e("span",{class:"hidden sm:inline"},"Exportar",-1),lm={class:"py-1"},am={class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",style:{"overflow-x":"visible","overflow-y":"hidden"}},im={class:"min-w-full divide-y divide-gray-200"},dm={class:"bg-gray-50"},cm={scope:"col",class:"w-12 px-6 py-3"},um=["checked"],mm=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Nombre Documento ",-1),gm=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado Firma ",-1),pm=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etiqueta ",-1),hm={class:"bg-white divide-y divide-gray-200"},fm=["onClick"],vm=["checked","onChange"],bm={class:"px-6 py-4 whitespace-nowrap"},ym={class:"flex items-center"},xm={class:"flex-shrink-0 h-10 w-10"},_m={class:"h-10 w-10 rounded-lg bg-purple-100 flex items-center justify-center"},wm={class:"ml-4"},$m={class:"text-sm font-medium text-gray-900"},km={class:"px-6 py-4 whitespace-nowrap"},Cm={class:"px-6 py-4 whitespace-nowrap"},Dm={class:"flex flex-wrap gap-1"},Sm={key:0,class:"text-sm text-gray-400"},Em={key:0,class:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"},Fm={class:"flex flex-1 justify-between sm:hidden"},Am=["disabled"],Tm=["disabled"],Mm={class:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between"},Pm={class:"text-sm text-gray-700"},Lm={class:"font-medium"},Im={class:"font-medium"},jm={class:"font-medium"},Bm={class:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination"},Um=["disabled"],Nm=e("span",{class:"sr-only"},"Anterior",-1),zm=["onClick"],qm={key:1,class:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700"},Om=["disabled"],Rm=e("span",{class:"sr-only"},"Siguiente",-1),Vm={key:0,class:"text-center py-12"},Qm={class:"mt-2 text-sm font-medium text-gray-900"},Gm={class:"mt-1 text-sm text-gray-500"},Zm={key:1,class:"text-center py-12"},Hm=e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-secondary"},null,-1),Wm=e("p",{class:"mt-2 text-sm text-gray-500"},"Cargando documentos...",-1),Km=[Hm,Wm],Ot={__name:"SignaturesListTable",props:{state:{type:String,required:!0,validator:r=>["PendingSignatures","FullySigned"].includes(r)},searchQuery:{type:String,default:""},selectedTags:{type:Array,default:()=>[]}},emits:["refresh"],setup(r,{expose:v,emit:i}){const c=r,S=i,x=He(),u=Re();Xe();const{activeModals:$,openModal:F,closeModal:B,getUserRole:J}=ft(u,x),{handlePreviewDocument:R,downloadPDFDocument:Y,signDocument:E,downloadSignedDocument:n}=vt(u,x,S);P([]);const w=P(!1),g=P(""),A=P(""),_=P(null),j=P("recent"),oe=P([]),I=P(1),y=P(10),N=L(()=>c.state==="PendingSignatures"?"No tienes documentos pendientes por firmar":"No tienes documentos firmados"),V=L(()=>c.state==="PendingSignatures"?"Cuando tengas documentos que requieran tu firma electr√≥nica aparecer√°n aqu√≠.":"Una vez que firmes documentos electr√≥nicamente, aparecer√°n aqu√≠."),q=L(()=>{const Q=x.currentUser.role,z=x.currentUser.id,ce=x.currentUser.email;let H=[];return Q==="lawyer"?c.state==="PendingSignatures"?H=u.pendingSignatureDocuments.filter(ke=>ke.created_by===z):H=u.fullySignedDocuments.filter(ke=>ke.created_by===z):c.state==="PendingSignatures"?H=u.documents.filter(ke=>{var je;return ke.state!=="PendingSignatures"?!1:(je=ke.signatures)==null?void 0:je.some(Ue=>Ue.signer_email===ce)}):H=u.documents.filter(ke=>{var je;return ke.state!=="FullySigned"?!1:(je=ke.signatures)==null?void 0:je.some(Ue=>Ue.signer_email===ce&&Ue.signed)}),H}),X=L(()=>{let Q=[...q.value];const z=g.value.toLowerCase();return z&&(Q=Q.filter(ce=>{var H,ke;return((H=ce.title)==null?void 0:H.toLowerCase().includes(z))||((ke=ce.tags)==null?void 0:ke.some(De=>{var je;return(je=De.name)==null?void 0:je.toLowerCase().includes(z)}))})),_.value&&(Q=Q.filter(ce=>ce.tags&&ce.tags.some(H=>H.id===_.value))),j.value==="name"?Q.sort((ce,H)=>{const ke=(ce.title||"").toLowerCase(),De=(H.title||"").toLowerCase();return ke.localeCompare(De)}):j.value==="recent"&&Q.sort((ce,H)=>H.id-ce.id),Q}),ee=L(()=>{const Q=(I.value-1)*y.value,z=Q+y.value;return X.value.slice(Q,z)}),K=L(()=>Math.ceil(X.value.length/y.value)),O=L(()=>{const Q=(I.value-1)*y.value+1,z=Math.min(I.value*y.value,X.value.length);return{start:Q,end:z,total:X.value.length}});$e([g,_],()=>{I.value=1});const le=L(()=>{const Q=new Map;return q.value.forEach(z=>{z.tags&&z.tags.length>0&&z.tags.forEach(ce=>{Q.has(ce.id)||Q.set(ce.id,ce)})}),Array.from(Q.values()).sort((z,ce)=>z.name.localeCompare(ce.name))}),he=L(()=>{if(!A.value)return le.value;const Q=A.value.toLowerCase();return le.value.filter(z=>z.name.toLowerCase().includes(Q))}),be=L(()=>{if(!_.value)return null;const Q=le.value.find(z=>z.id===_.value);return Q?Q.name:null}),ie=Q=>{const z=["bg-blue-500","bg-purple-500","bg-pink-500","bg-yellow-500","bg-green-500","bg-red-500","bg-indigo-500","bg-orange-500"],ce=Q.id%z.length;return z[ce]},ye=L(()=>{switch(j.value){case"name":return"Nombre (A-Z)";case"recent":default:return"M√°s recientes"}}),ve=Q=>{const z=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],ce=Q.id%z.length;return z[ce]},pe=Q=>c.state==="FullySigned"?"bg-green-100 text-green-700 border border-green-200":"bg-yellow-100 text-yellow-700 border border-yellow-200",Le=Q=>c.state==="FullySigned"?"Firmado":"Pendiente",Be=L(()=>X.value.length>0&&oe.value.length===X.value.length),ge=()=>{Be.value?oe.value=[]:oe.value=X.value.map(Q=>Q.id)},ne=Q=>{const z=oe.value.indexOf(Q);z>-1?oe.value.splice(z,1):oe.value.push(Q)},Ce=()=>{oe.value=X.value.map(Q=>Q.id)},Te=()=>{oe.value=[]},W=()=>{_.value=null},Ie=()=>{I.value>1&&I.value--},Me=()=>{I.value<K.value&&I.value++},Ge=Q=>{Q>=1&&Q<=K.value&&(I.value=Q)},p=L(()=>{const Q=K.value,z=I.value,ce=[];if(Q<=7)for(let H=1;H<=Q;H++)ce.push(H);else if(z<=4){for(let H=1;H<=5;H++)ce.push(H);ce.push("..."),ce.push(Q)}else if(z>=Q-3){ce.push(1),ce.push("...");for(let H=Q-4;H<=Q;H++)ce.push(H)}else ce.push(1),ce.push("..."),ce.push(z-1),ce.push(z),ce.push(z+1),ce.push("..."),ce.push(Q);return ce}),d=()=>{const Q=oe.value.length>0?X.value.filter(Ue=>oe.value.includes(Ue.id)):X.value,z=["Nombre Documento","Estado Firma","Etiquetas"],ce=Q.map(Ue=>[Ue.title||"",Le(),Ue.tags?Ue.tags.map(at=>at.name).join(", "):""]),H=[z.join(","),...ce.map(Ue=>Ue.map(at=>`"${at}"`).join(","))].join(`
`),ke=new Blob([H],{type:"text/csv;charset=utf-8;"}),De=document.createElement("a"),je=URL.createObjectURL(ke);De.setAttribute("href",je),De.setAttribute("download",`documentos_firmas_${new Date().toISOString().split("T")[0]}.csv`),De.style.visibility="hidden",document.body.appendChild(De),De.click(),document.body.removeChild(De)},a=P(!1),G=P(null),k=Q=>{G.value=Q,a.value=!0},T=async(Q,z)=>{a.value=!1,await C(Q,z)},C=async(Q,z)=>{try{switch(Q){case"preview":await R(z);break;case"letterhead":F("letterhead",z);break;case"viewSignatures":F("signatures",z);break;case"sign":await E(z,F);break;case"downloadSignedDocument":await n(z);break;case"downloadPDF":await Y(z);break;default:console.warn("Unknown action:",Q)}}catch(ce){console.error(`Error executing action ${Q}:`,ce)}},re=async()=>{w.value=!0;try{await u.init(!0)}catch(Q){console.error("Error refreshing documents:",Q),_e("Error al actualizar documentos","error")}finally{w.value=!1}},ue=async()=>{await re(),S("refresh")};return qe(async()=>{await re()}),v({refresh:ue}),$e(()=>x.currentUser,()=>{ue()}),(Q,z)=>{var ce;return o(),l("div",null,[e("div",Uu,[e("div",Nu,[e("div",zu,[s(t(Qe),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),Ae(e("input",{"onUpdate:modelValue":z[0]||(z[0]=H=>g.value=H),type:"text",placeholder:"Buscar...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent text-sm"},null,512),[[Oe,g.value]])])]),e("div",qu,[s(t(Se),{as:"div",class:"relative"},{default:m(()=>[s(t(Ee),{class:"w-full inline-flex items-center justify-between gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:m(()=>[e("div",Ou,[s(t(tt),{class:"h-4 w-4 flex-shrink-0"}),e("span",Ru,f(be.value||"Etiqueta"),1)]),s(t(ze),{class:"h-4 w-4 flex-shrink-0"})]),_:1}),s(t(Fe),{class:"absolute left-0 z-10 mt-2 w-full min-w-[16rem] origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",Vu,[e("div",Qu,[s(t(Qe),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),Ae(e("input",{"onUpdate:modelValue":z[1]||(z[1]=H=>A.value=H),type:"text",placeholder:"Buscar etiquetas...",class:"w-full pl-9 pr-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent",onClick:z[2]||(z[2]=fe(()=>{},["stop"]))},null,512),[[Oe,A.value]])]),e("div",Gu,[s(t(ae),null,{default:m(({active:H})=>[e("a",{onClick:z[3]||(z[3]=ke=>_.value=null),class:h([H?"bg-gray-100":"","block px-3 py-2 text-sm text-gray-700 cursor-pointer rounded-md"])}," Todos ",2)]),_:1}),(o(!0),l(de,null,me(he.value,H=>(o(),te(t(ae),{key:H.id},{default:m(({active:ke})=>[e("a",{onClick:De=>_.value=H.id,class:h([ke?"bg-gray-100":"","flex items-center gap-2 px-3 py-2 text-sm cursor-pointer rounded-md"])},[e("span",{class:h(["w-3 h-3 rounded-full flex-shrink-0",ie(H)])},null,2),e("span",Hu,f(H.name),1)],10,Zu)]),_:2},1024))),128)),he.value.length===0?(o(),l("div",Wu," No se encontraron etiquetas ")):D("",!0)])])]),_:1})]),_:1}),e("div",Ku,[_.value?(o(),l("button",{key:0,onClick:W,class:"w-full inline-flex items-center justify-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",title:"Limpiar filtros"},[s(t(Pe),{class:"h-4 w-4 flex-shrink-0"}),Ju])):D("",!0)])]),e("div",Yu,[e("div",Xu,[e("div",em,[e("span",tm,f(X.value.length),1),se(" resultados ")]),s(t(Se),{as:"div",class:"relative"},{default:m(()=>[s(t(Ee),{class:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:m(()=>[sm,se(" "+f(ye.value)+" ",1),s(t(ze),{class:"h-4 w-4"})]),_:1}),s(t(Fe),{class:"absolute left-0 sm:left-auto sm:right-0 z-10 mt-2 w-48 origin-top-left sm:origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",om,[s(t(ae),null,{default:m(({active:H})=>[e("a",{onClick:z[4]||(z[4]=ke=>j.value="recent"),class:h([H?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," M√°s recientes ",2)]),_:1}),s(t(ae),null,{default:m(({active:H})=>[e("a",{onClick:z[5]||(z[5]=ke=>j.value="name"),class:h([H?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Nombre (A-Z) ",2)]),_:1})])]),_:1})]),_:1})]),e("div",rm,[e("button",{onClick:d,class:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},[s(t(nt),{class:"h-4 w-4"}),nm]),s(t(Se),{as:"div",class:"relative"},{default:m(()=>[s(t(Ee),{class:"inline-flex items-center justify-center w-10 h-10 rounded-md hover:bg-gray-100"},{default:m(()=>[s(t(et),{class:"h-5 w-5 text-gray-500"})]),_:1}),s(t(Fe),{class:"absolute left-0 sm:left-auto sm:right-0 z-10 mt-2 w-48 origin-top-left sm:origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",lm,[s(t(ae),null,{default:m(({active:H})=>[e("a",{onClick:Ce,class:h([H?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Seleccionar todo ",2)]),_:1}),s(t(ae),null,{default:m(({active:H})=>[e("a",{onClick:Te,class:h([H?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Deseleccionar todo ",2)]),_:1})])]),_:1})]),_:1})])])]),e("div",am,[e("div",{class:h(["overflow-x-auto",X.value.length<=3?"pl-52":""]),style:{"overflow-y":"visible"}},[e("table",im,[e("thead",dm,[e("tr",null,[e("th",cm,[e("input",{type:"checkbox",checked:Be.value,onChange:ge,class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,um)]),mm,gm,pm])]),e("tbody",hm,[(o(!0),l(de,null,me(ee.value,(H,ke)=>(o(),l("tr",{key:H.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:De=>k(H)},[e("td",{class:"px-6 py-4 whitespace-nowrap",onClick:z[6]||(z[6]=fe(()=>{},["stop"]))},[e("input",{type:"checkbox",checked:oe.value.includes(H.id),onChange:De=>ne(H.id),class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,vm)]),e("td",bm,[e("div",ym,[e("div",xm,[e("div",_m,[s(t(Ve),{class:"h-5 w-5 text-purple-600"})])]),e("div",wm,[e("div",$m,f(H.title),1)])])]),e("td",km,[e("span",{class:h(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",pe()])},f(Le()),3)]),e("td",Cm,[e("div",Dm,[(o(!0),l(de,null,me(H.tags,De=>(o(),l("span",{key:De.id,class:h(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",ve(De)])},f(De.name),3))),128)),!H.tags||H.tags.length===0?(o(),l("span",Sm,"-")):D("",!0)])])],8,fm))),128))])])],2),K.value>1?(o(),l("div",Em,[e("div",Fm,[e("button",{onClick:Ie,disabled:I.value===1,class:h(["relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",I.value===1?"opacity-50 cursor-not-allowed":""])}," Anterior ",10,Am),e("button",{onClick:Me,disabled:I.value===K.value,class:h(["relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",I.value===K.value?"opacity-50 cursor-not-allowed":""])}," Siguiente ",10,Tm)]),e("div",Mm,[e("div",null,[e("p",Pm,[se(" Mostrando "),e("span",Lm,f(O.value.start),1),se(" a "),e("span",Im,f(O.value.end),1),se(" de "),e("span",jm,f(O.value.total),1),se(" resultados ")])]),e("div",null,[e("nav",Bm,[e("button",{onClick:Ie,disabled:I.value===1,class:h(["relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",I.value===1?"opacity-50 cursor-not-allowed":""])},[Nm,s(t(pt),{class:"h-5 w-5","aria-hidden":"true"})],10,Um),(o(!0),l(de,null,me(p.value,H=>(o(),l(de,{key:H},[H!=="..."?(o(),l("button",{key:0,onClick:ke=>Ge(H),class:h(["relative inline-flex items-center px-4 py-2 text-sm font-semibold focus:z-20 focus:outline-offset-0",I.value===H?"z-10 bg-secondary text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-secondary":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50"])},f(H),11,zm)):(o(),l("span",qm," ... "))],64))),128)),e("button",{onClick:Me,disabled:I.value===K.value,class:h(["relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",I.value===K.value?"opacity-50 cursor-not-allowed":""])},[Rm,s(t(ot),{class:"h-5 w-5","aria-hidden":"true"})],10,Om)])])])])):D("",!0)]),X.value.length===0&&!w.value?(o(),l("div",Vm,[s(t(rt),{class:"mx-auto h-12 w-12 text-gray-400"}),e("h3",Qm,f(N.value),1),e("p",Gm,f(V.value),1)])):D("",!0),w.value?(o(),l("div",Zm,Km)):D("",!0),s(Mt,{isVisible:t(st),documentData:t(Tt),onClose:z[7]||(z[7]=H=>st.value=!1)},null,8,["isVisible","documentData"]),(o(),te(ht,{to:"body"},[t($).signatures.isOpen?(o(),te(t(Qt),{key:0,"document-id":(ce=t($).signatures.document)==null?void 0:ce.id,onClose:z[8]||(z[8]=H=>t(B)("signatures")),onRefresh:z[9]||(z[9]=H=>S("refresh"))},null,8,["document-id"])):D("",!0),t($).letterhead.isOpen?(o(),te(bt,{key:1,"is-visible":t($).letterhead.isOpen,document:t($).letterhead.document,onClose:z[10]||(z[10]=H=>t(B)("letterhead")),onUploaded:z[11]||(z[11]=H=>S("refresh")),onDeleted:z[12]||(z[12]=H=>S("refresh"))},null,8,["is-visible","document"])):D("",!0),a.value?(o(),te(Et,{key:2,"is-visible":a.value,document:G.value,"card-type":"signatures",context:"table","user-store":t(x),onClose:z[13]||(z[13]=H=>a.value=!1),onAction:T},null,8,["is-visible","document","user-store"])):D("",!0)]))])}}},Jm={class:"bg-white rounded-lg p-6 shadow-xl max-w-lg w-full"},Ym={class:"flex justify-end"},Xm=e("label",{for:"document-name",class:"block text-base font-medium leading-6 text-primary"},[se(" Nombre "),e("span",{class:"text-red-500"},"*")],-1),eg={class:"mt-2"},tg={class:"flex gap-2 mt-2.5"},sg=["disabled"],og=e("span",null,"Actualizar nombre",-1),rg=[og],ng=["disabled"],lg={__name:"CreateDocumentByLawyer",emits:["close"],setup(r,{emit:v}){const i=Xe(),c=Re(),S=v,x=P(""),u=P("");Rt(()=>{var E;(E=c.selectedDocument)!=null&&E.title?(x.value=c.selectedDocument.title,u.value=c.selectedDocument.title):(x.value="",u.value="")});const $=E=>{E.key==="Escape"&&S("close")};qe(()=>{document.addEventListener("keydown",$)}),ut(()=>{document.removeEventListener("keydown",$)});const F=L(()=>x.value.trim().length>0),B=L(()=>{var E;return!!((E=c.selectedDocument)!=null&&E.id)}),J=L(()=>B.value&&x.value.trim()!==u.value.trim()&&x.value.trim().length>0);async function R(){if(B.value&&J.value)try{const E={title:x.value.trim()};await c.updateDocument(c.selectedDocument.id,E),u.value=x.value.trim(),c.selectedDocument.title=x.value.trim(),c.lastUpdatedDocumentId=c.selectedDocument.id,localStorage.setItem("lastUpdatedDocumentId",c.selectedDocument.id);const n=c.selectedDocument.id;S("close",{updatedDocId:n});const w=window.location.pathname;w==="/dynamic_document_dashboard"||w==="/dynamic_document_dashboard/"?setTimeout(()=>{window.forceDocumentHighlight&&window.forceDocumentHighlight(n)},100):setTimeout(()=>{window.location.href="/dynamic_document_dashboard"},1e3)}catch(E){console.error("Error updating document name:",E)}}const Y=async()=>{if(!F.value)return;const E=encodeURIComponent(x.value.trim());B.value?(c.selectedDocument.title=x.value,c.selectedDocument.id&&(c.lastUpdatedDocumentId=c.selectedDocument.id,localStorage.setItem("lastUpdatedDocumentId",c.selectedDocument.id.toString())),i.push(`/dynamic_document_dashboard/lawyer/editor/edit/${c.selectedDocument.id}`)):(c.selectedDocument={title:x.value.trim()},i.push(`/dynamic_document_dashboard/lawyer/editor/create/${E}`))};return(E,n)=>(o(),l("div",Jm,[e("div",Ym,[e("button",{onClick:n[0]||(n[0]=w=>S("close"))},[s(t(Pe),{class:"size-6"})])]),e("form",{onSubmit:fe(Y,["prevent"])},[e("div",null,[Xm,e("div",eg,[Ae(e("input",{"onUpdate:modelValue":n[1]||(n[1]=w=>x.value=w),type:"text",name:"document-name",id:"document-name",class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-secondary sm:text-sm sm:leading-6",required:""},null,512),[[Oe,x.value]])])]),e("div",tg,[B.value?(o(),l("button",{key:0,type:"button",onClick:R,disabled:!J.value,class:h(["p-2.5 text-sm font-medium rounded-md flex gap-2",J.value?"bg-primary text-white cursor-pointer":"bg-gray-200 text-gray-400 cursor-not-allowed opacity-70"])},rg,10,sg)):D("",!0),e("button",{type:"submit",class:h(["p-2.5 text-sm font-medium rounded-md flex gap-2",F.value?"bg-secondary text-white":"bg-gray-200 text-secondary border-2 border-dashed border-secondary cursor-not-allowed bg-opacity-50"]),disabled:!F.value},[e("span",null,f(B.value?"Editar Documento":"Continuar"),1)],10,ng)])],32)]))}},Ne=r=>(mt("data-v-40bbc6a4"),r=r(),gt(),r),ag={class:"relative bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col"},ig={class:"px-6 py-4 border-b border-gray-200"},dg=Ne(()=>e("h2",{class:"text-xl font-semibold text-gray-800"},"Gesti√≥n de Membrete Global",-1)),cg=Ne(()=>e("p",{class:"text-sm text-gray-500 mt-1"}," Este membrete se aplicar√° por defecto a todos tus documentos ",-1)),ug={class:"p-6 overflow-y-auto flex-grow"},mg={key:0,class:"text-center py-10"},gg=Ne(()=>e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1)),pg={class:"mt-4 text-gray-500"},hg={key:1,class:"space-y-6"},fg={key:0,class:"space-y-4"},vg=Ne(()=>e("h3",{class:"text-lg font-medium text-gray-900"},"Membrete Global Actual",-1)),bg={class:"border border-gray-200 rounded-lg p-4 bg-gray-50"},yg=["src"],xg={class:"mt-4 flex justify-center space-x-3"},_g=["disabled"],wg={key:1,class:"text-center py-8"},$g=Ne(()=>e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"Sin Membrete Global",-1)),kg=Ne(()=>e("p",{class:"mt-1 text-sm text-gray-500"}," No tienes una imagen de membrete global configurada. ",-1)),Cg=Ne(()=>e("p",{class:"mt-1 text-xs text-gray-400"}," El membrete global se aplicar√° a todos los documentos que no tengan un membrete espec√≠fico. ",-1)),Dg={class:"space-y-4"},Sg={class:"text-lg font-medium text-gray-900"},Eg={class:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-gray-400 transition-colors"},Fg={key:0},Ag={class:"mt-4"},Tg=Ne(()=>e("p",{class:"mt-2 text-sm text-gray-500"}," Solo archivos PNG, m√°ximo 10MB ",-1)),Mg=Ne(()=>e("p",{class:"text-xs text-gray-400 mt-1"}," Dimensiones ideales: 612 √ó 612 p√≠xeles (8.5:11 Carta) ",-1)),Pg={key:1,class:"space-y-4"},Lg={class:"flex items-center justify-center space-x-2 text-sm text-gray-600"},Ig={class:"text-gray-400"},jg={key:0,class:"mt-4"},Bg=["src"],Ug={class:"flex justify-center space-x-3"},Ng=["disabled"],zg={key:1,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},qg={key:2,class:"bg-blue-50 border border-blue-200 rounded-lg p-6 space-y-6"},Og={class:"flex items-center space-x-2"},Rg=Ne(()=>e("h3",{class:"text-lg font-semibold text-blue-900"},"Especificaciones del Membrete Global",-1)),Vg=Ne(()=>e("div",{class:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},[e("h4",{class:"font-medium text-yellow-800 mb-2"},"üîÑ Prioridad de Membrete"),e("div",{class:"text-sm text-yellow-700 space-y-1"},[e("div",null,[e("strong",null,"1¬∫ Prioridad:"),se(" Membrete espec√≠fico del documento")]),e("div",null,[e("strong",null,"2¬∫ Prioridad:"),se(" Membrete global del usuario (este)")]),e("div",null,[e("strong",null,"3¬∫ Prioridad:"),se(" Sin membrete")])])],-1)),Qg=Ne(()=>e("div",{class:"space-y-3"},[e("h4",{class:"font-medium text-gray-900"},"üìê Dimensiones Exactas"),e("div",{class:"bg-white rounded-lg p-4 border border-blue-200"},[e("div",{class:"grid grid-cols-2 gap-4 text-sm"},[e("div",null,[e("span",{class:"font-medium text-gray-700"},"Ancho:"),e("span",{class:"ml-2 text-blue-600 font-mono"},"612 p√≠xeles")]),e("div",null,[e("span",{class:"font-medium text-gray-700"},"Alto:"),e("span",{class:"ml-2 text-blue-600 font-mono"},"612 p√≠xeles")]),e("div",null,[e("span",{class:"font-medium text-gray-700"},"Proporci√≥n:"),e("span",{class:"ml-2 text-blue-600"},"8.5:11 (Carta)")]),e("div",null,[e("span",{class:"font-medium text-gray-700"},"Tolerancia:"),e("span",{class:"ml-2 text-orange-600"},"¬±10%")])])])],-1)),Gg=Ne(()=>e("div",{class:"space-y-3"},[e("h4",{class:"font-medium text-gray-900"},"üé® Distribuci√≥n Recomendada"),e("div",{class:"bg-white rounded-lg p-4 border border-blue-200"},[e("div",{class:"space-y-4"},[e("div",{class:"mx-auto w-40 h-44 border-2 border-gray-300 rounded bg-gradient-to-b from-blue-100 via-yellow-50 to-green-100 relative text-xs"},[e("div",{class:"absolute top-0 left-0 right-0 h-12 bg-blue-200 bg-opacity-70 border-b border-blue-300 flex items-center justify-center text-blue-800 font-medium"}," HEADER ZONE "),e("div",{class:"absolute top-10 left-1 text-blue-700 text-[10px]"},"120-150px"),e("div",{class:"absolute top-12 left-0 right-0 bottom-12 bg-yellow-100 bg-opacity-50 border-y border-yellow-300 flex items-center justify-center text-yellow-800 font-medium"},[e("div",{class:"text-center"},[e("div",null,"BODY ZONE"),e("div",{class:"text-[10px] mt-1"},"‚ö†Ô∏è ZONA CR√çTICA")])]),e("div",{class:"absolute top-20 left-1 text-yellow-700 text-[10px]"},"300-400px"),e("div",{class:"absolute bottom-0 left-0 right-0 h-12 bg-green-200 bg-opacity-70 border-t border-green-300 flex items-center justify-center text-green-800 font-medium"}," FOOTER ZONE "),e("div",{class:"absolute bottom-10 left-1 text-green-700 text-[10px]"},"80-120px")]),e("div",{class:"space-y-3 text-sm"},[e("div",{class:"flex items-start space-x-3"},[e("div",{class:"w-4 h-4 bg-blue-200 border border-blue-300 rounded mt-0.5 flex-shrink-0"}),e("div",null,[e("span",{class:"font-medium text-blue-800"},"Header (Superior):"),e("span",{class:"text-gray-600 ml-1"},"Logos, nombre de empresa. Puede tener mayor intensidad visual.")])]),e("div",{class:"flex items-start space-x-3"},[e("div",{class:"w-4 h-4 bg-yellow-100 border border-yellow-300 rounded mt-0.5 flex-shrink-0"}),e("div",null,[e("span",{class:"font-medium text-yellow-800"},"Body (Centro):"),e("span",{class:"text-gray-600 ml-1"},"Mant√©n semi-transparente. El texto del documento se superpone aqu√≠.")])]),e("div",{class:"flex items-start space-x-3"},[e("div",{class:"w-4 h-4 bg-green-200 border border-green-300 rounded mt-0.5 flex-shrink-0"}),e("div",null,[e("span",{class:"font-medium text-green-800"},"Footer (Inferior):"),e("span",{class:"text-gray-600 ml-1"},"Direcciones, tel√©fonos, emails, informaci√≥n de contacto.")])])])])])],-1)),Zg=Ne(()=>e("div",{class:"space-y-3"},[e("h4",{class:"font-medium text-gray-900"},"üîß Consideraciones T√©cnicas"),e("div",{class:"bg-white rounded-lg p-4 border border-blue-200"},[e("div",{class:"space-y-2 text-sm text-gray-700"},[e("div",{class:"flex items-start space-x-2"},[e("span",{class:"text-blue-600 font-medium"},"‚Ä¢"),e("span",null,[e("strong",null,"Posicionamiento:"),se(" La imagen se centra autom√°ticamente en el documento")])]),e("div",{class:"flex items-start space-x-2"},[e("span",{class:"text-blue-600 font-medium"},"‚Ä¢"),e("span",null,[e("strong",null,"Transparencia:"),se(" Usa PNG con canal alpha para efectos de transparencia")])]),e("div",{class:"flex items-start space-x-2"},[e("span",{class:"text-blue-600 font-medium"},"‚Ä¢"),e("span",null,[e("strong",null,"M√°rgenes:"),se(" Deja 30-50px de margen en los lados para seguridad")])]),e("div",{class:"flex items-start space-x-2"},[e("span",{class:"text-blue-600 font-medium"},"‚Ä¢"),e("span",null,[e("strong",null,"Resoluci√≥n:"),se(" 72-150 DPI es suficiente para documentos digitales")])]),e("div",{class:"flex items-start space-x-2"},[e("span",{class:"text-orange-600 font-medium"},"‚ö†Ô∏è"),e("span",null,[e("strong",null,"Zona cr√≠tica:"),se(" Evita elementos gr√°ficos densos en el centro (300-400px de altura)")])])])])],-1)),Hg=Ne(()=>e("div",{class:"bg-gradient-to-r from-green-50 to-blue-50 border border-green-200 rounded-lg p-4"},[e("h4",{class:"font-medium text-green-800 mb-2"},"üí° Tips de Dise√±o R√°pido"),e("div",{class:"text-sm text-green-700 space-y-1"},[e("div",null,"‚Ä¢ Si solo tienes header, ub√≠calo en los primeros 120-150px"),e("div",null,"‚Ä¢ El resto de la imagen debe ser transparente o blanco"),e("div",null,"‚Ä¢ Para footer, usa los √∫ltimos 80-120px"),e("div",null,"‚Ä¢ El texto se superpone en toda la imagen, mant√©n el centro claro")])],-1)),Wg={key:3,class:"space-y-2"},Kg={class:"flex"},Jg={class:"text-sm text-yellow-700"},Yg={__name:"GlobalLetterheadModal",props:{isVisible:{type:Boolean,default:!1}},emits:["close","uploaded","deleted"],setup(r,{emit:v}){const i=r,c=v;$e(()=>i.isVisible,ee=>{});const S=Re(),x=P(!1),u=P(""),$=P(!1),F=P(!1),B=P(null),J=P(null),R=P(null),Y=P([]),E=P(null),n=P(!1),w=()=>{_(),c("close")},g=ee=>{const K=ee.target.files[0];if(!K)return;if(!K.type.includes("png")){alert("Solo se permiten archivos PNG");return}if(K.size>10*1024*1024){alert("El archivo no puede ser mayor a 10MB");return}B.value=K,Y.value=[];const O=new FileReader;O.onload=le=>{J.value=le.target.result;const he=new Image;he.onload=()=>{A(he.width,he.height)},he.src=le.target.result},O.readAsDataURL(K)},A=(ee,K)=>{const be=ee/K,ie=612/612,ye=Math.abs(be-ie)/ie;if(ee===612&&K===612){Y.value.push("‚úÖ Dimensiones perfectas: 612 √ó 612 p√≠xeles");return}ye<=.1?(Y.value.push(`‚ÑπÔ∏è Buenas proporciones detectadas: ${ee} √ó ${K} p√≠xeles (${be.toFixed(3)})`),(ee!==612||K!==612)&&Y.value.push("üí° Para mejores resultados, usa exactamente 612 √ó 612 p√≠xeles")):(Y.value.push(`‚ö†Ô∏è Proporciones no ideales: ${ee} √ó ${K} p√≠xeles (${be.toFixed(3)})`),Y.value.push(`üéØ Proporciones recomendadas: ${ie.toFixed(3)} (8.5:11)`),Y.value.push("üìê Considera redimensionar tu imagen a 612 √ó 612 p√≠xeles")),(ee<300||K<300)&&Y.value.push("‚ö†Ô∏è Imagen muy peque√±a - puede verse pixelada en documentos"),(ee>1200||K>1600)&&Y.value.push("‚ÑπÔ∏è Imagen muy grande - se redimensionar√° autom√°ticamente")},_=()=>{B.value=null,J.value=null,Y.value=[],n.value=!1,E.value&&(E.value.value="")},j=async()=>{var ee;if(B.value){$.value=!0,Y.value=[];try{const K=await S.uploadGlobalLetterheadImage(B.value);(ee=K.data)!=null&&ee.warnings&&K.data.warnings.length>0&&(Y.value=K.data.warnings),await oe(),_(),c("uploaded",K.data)}catch(K){console.error("Error uploading global letterhead:",K),alert("Error al subir la imagen. Por favor intenta nuevamente.")}finally{$.value=!1}}},oe=async()=>{try{const ee=await S.getGlobalLetterheadImage();ee.data&&(R.value=URL.createObjectURL(ee.data))}catch{R.value=null}},I=()=>{confirm("¬øEst√°s seguro de que deseas eliminar la imagen de membrete global?")&&y()},y=async()=>{F.value=!0;try{await S.deleteGlobalLetterheadImage(),R.value&&URL.revokeObjectURL(R.value),R.value=null,c("deleted")}catch(ee){console.error("Error deleting global letterhead:",ee),alert("Error al eliminar la imagen. Por favor intenta nuevamente.")}finally{F.value=!1}},N=()=>{if(R.value){const ee=document.createElement("a");ee.href=R.value,ee.download="membrete-global.png",document.body.appendChild(ee),ee.click(),document.body.removeChild(ee)}},V=()=>{R.value=null},q=ee=>{if(ee===0)return"0 Bytes";const K=1024,O=["Bytes","KB","MB","GB"],le=Math.floor(Math.log(ee)/Math.log(K));return parseFloat((ee/Math.pow(K,le)).toFixed(2))+" "+O[le]};$e(()=>i.isVisible,ee=>{ee&&oe()});const X=()=>{R.value&&URL.revokeObjectURL(R.value),J.value&&URL.revokeObjectURL(J.value)};return qe(()=>{i.isVisible&&oe()}),ut(X),(ee,K)=>Ae((o(),te(Ye,null,{default:m(()=>[e("div",ag,[e("div",ig,[dg,cg,e("button",{onClick:w,class:"absolute top-4 right-4 text-gray-400 hover:text-gray-500"},[s(t(Pe),{class:"h-6 w-6"})])]),e("div",ug,[x.value?(o(),l("div",mg,[gg,e("p",pg,f(u.value),1)])):(o(),l("div",hg,[R.value?(o(),l("div",fg,[vg,e("div",bg,[e("img",{src:R.value,alt:"Membrete global actual",class:"max-w-full h-auto max-h-64 mx-auto shadow-sm",onError:V},null,40,yg),e("div",xg,[e("button",{onClick:N,class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},[s(t(nt),{class:"h-4 w-4 mr-2"}),se(" Descargar ")]),e("button",{onClick:I,disabled:F.value,class:"inline-flex items-center px-3 py-2 border border-transparent shadow-sm text-sm leading-4 font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50"},[s(t(Zt),{class:"h-4 w-4 mr-2"}),se(" "+f(F.value?"Eliminando...":"Eliminar"),1)],8,_g)])])])):(o(),l("div",wg,[s(t(ct),{class:"mx-auto h-12 w-12 text-gray-400"}),$g,kg,Cg])),e("div",Dg,[e("h3",Sg,f(R.value?"Reemplazar Membrete Global":"Subir Membrete Global"),1),e("div",Eg,[e("input",{ref_key:"fileInput",ref:E,type:"file",accept:".png",onChange:g,class:"hidden"},null,544),B.value?(o(),l("div",Pg,[e("div",Lg,[s(t(Ht),{class:"h-5 w-5 text-green-500"}),e("span",null,f(B.value.name),1),e("span",Ig,"("+f(q(B.value.size))+")",1)]),J.value?(o(),l("div",jg,[e("img",{src:J.value,alt:"Vista previa",class:"max-w-full h-auto max-h-32 mx-auto border border-gray-200 rounded"},null,8,Bg)])):D("",!0),e("div",Ug,[e("button",{onClick:_,class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"}," Cancelar "),e("button",{onClick:j,disabled:$.value,class:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50"},[$.value?(o(),l("div",zg)):(o(),te(t(vs),{key:0,class:"h-4 w-4 mr-2"})),se(" "+f($.value?"Subiendo...":"Subir Imagen"),1)],8,Ng)])])):(o(),l("div",Fg,[s(t(Wt),{class:"mx-auto h-12 w-12 text-gray-400"}),e("div",Ag,[e("button",{onClick:K[0]||(K[0]=O=>ee.$refs.fileInput.click()),class:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}," Seleccionar Imagen PNG "),e("button",{onClick:K[1]||(K[1]=O=>n.value=!n.value),class:"ml-3 inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"},[s(t(Nt),{class:"h-4 w-4 mr-2"}),se(" "+f(n.value?"Ocultar":"Ver")+" Especificaciones ",1)])]),Tg,Mg]))])]),n.value?(o(),l("div",qg,[e("div",Og,[s(t(Nt),{class:"h-6 w-6 text-blue-600"}),Rg]),Vg,Qg,Gg,Zg,Hg])):D("",!0),Y.value.length>0?(o(),l("div",Wg,[(o(!0),l(de,null,me(Y.value,(O,le)=>(o(),l("div",{key:le,class:"bg-yellow-50 border border-yellow-200 rounded-md p-3"},[e("div",Kg,[s(t(bs),{class:"h-5 w-5 text-yellow-400 mr-2 flex-shrink-0 mt-0.5"}),e("p",Jg,f(O),1)])]))),128))])):D("",!0)]))])])]),_:1},512)),[[kt,r.isVisible]])}},Xg=yt(Yg,[["__scopeId","data-v-40bbc6a4"]]),e0={class:"min-h-screen bg-gray-50"},t0={class:"sticky top-0 flex h-16 shrink-0 items-center gap-x-4 border-b border-gray-200 bg-white px-4 shadow-sm sm:gap-x-6 sm:px-6 lg:px-8"},s0={class:"p-4 sm:p-6 lg:p-8"},o0={key:0},r0={class:"mb-6 border-b border-gray-200"},n0={class:"hidden md:block"},l0={class:"flex flex-wrap gap-x-4 gap-y-2 md:gap-x-8 mb-4","aria-label":"Tabs"},a0=["onClick"],i0={class:"flex gap-3"},d0=e("span",null,"Firma Electr√≥nica",-1),c0=e("span",null,"Membrete Global",-1),u0=e("span",null,"Nueva Minuta",-1),m0={class:"md:hidden space-y-3 relative"},g0=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1),p0=[g0],h0={key:0,class:"absolute z-20 mt-2 bg-white border border-gray-300 rounded-lg shadow-lg overflow-hidden w-full"},f0=["onClick"],v0={class:"grid grid-cols-3 gap-2"},b0=e("span",{class:"font-medium text-xs leading-tight"},"Firma",-1),y0=e("span",{class:"font-medium text-xs leading-tight"},"Membrete",-1),x0=e("span",{class:"font-medium text-xs leading-tight"},"Nueva",-1),_0={key:0},w0={key:1},$0={key:2},k0={key:3},C0={key:4},D0={key:5,class:"mt-6 text-center text-gray-400 font-regular"},S0=e("p",null,"No hay documentos disponibles para mostrar.",-1),E0=[S0],F0={key:1},A0={class:"mb-6 border-b border-gray-200"},T0={class:"hidden md:flex items-center justify-between"},M0={class:"-mb-px flex flex-wrap gap-x-4 gap-y-2 md:gap-x-8","aria-label":"Tabs"},P0=["onClick"],L0={class:"flex items-center gap-2 mb-4"},I0=["disabled"],j0=["disabled"],B0={class:"md:hidden relative"},U0=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1),N0=[U0],z0={key:0,class:"absolute top-full left-0 right-0 z-50 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg overflow-hidden"},q0=["onClick"],O0={class:"md:hidden mt-4 mb-4 flex flex-col gap-2"},R0=["disabled"],V0=["disabled"],Q0={key:0},G0={key:1},Z0={class:"p-4 sm:p-6"},H0={class:"bg-white rounded-xl shadow-xl max-w-3xl w-full mx-auto"},W0={class:"flex justify-between items-center p-4 border-b"},K0=e("h2",{class:"text-lg font-medium text-primary"},"Firma Electr√≥nica",-1),J0={class:"p-4 sm:p-6"},Y0={class:"p-4 sm:p-6"},X0={class:"bg-white rounded-xl shadow-xl max-w-3xl w-full mx-auto"},ep={class:"flex justify-between items-center p-4 border-b"},tp=e("h2",{class:"text-lg font-medium text-primary"},"Firma Electr√≥nica",-1),sp={class:"p-4 sm:p-6"},Ep={__name:"Dashboard",setup(r){const v=He(),i=Re(),c=Pt(),S=Xe(),{isBasicUser:x,handleFeatureAccess:u}=Lt(),$=P(""),F=P("default"),B=P(!1),J=P("folders"),R=P("legal-documents"),Y=P(!1),E=P(!1),n=P(!1),w=P(!1),g=P(!1),A=P(null),_=P([]),j=P("recent");$e(R,(ge,ne)=>{},{immediate:!0}),L(()=>[]),L(()=>j.value==="recent"?"M√°s recientes":"Nombre (A-Z)");const oe=L(()=>v.currentUser),I=L(()=>oe.value?oe.value.role:(S.push("/login"),null)),y=L(()=>{let ge=[];I.value==="lawyer"?ge=i.draftAndPublishedDocumentsUnassigned:(I.value==="client"||I.value==="basic"||I.value==="corporate_client")&&(ge=i.progressAndCompletedDocumentsByClient(oe.value.id));const ne=_.value&&Array.isArray(_.value)?_.value.map(Ce=>Ce.id):[];return i.filteredDocumentsBySearchAndTags($.value,v,ne).filter(Ce=>ge.some(Te=>Te.id===Ce.id))}),N=async ge=>{F.value=ge,i.selectedDocument=null;try{await i.init(!0)}catch(ne){console.error("Error loading documents for useDocument section:",ne)}},V=()=>{B.value=!1,F.value="default",i.selectedDocument=null},q=async()=>{await i.init(!0)},X=()=>{u("Firma Electr√≥nica",()=>{Y.value=!0})},ee=()=>{u("Membrete Global",()=>{n.value=!0})},K=ge=>{_e("Membrete global subido correctamente","success")},O=()=>{_e("Membrete global eliminado correctamente","success")},le=async()=>{if(F.value==="useDocument"){F.value="default",J.value="my-documents";return}J.value="folders";try{await new Promise(ge=>setTimeout(ge,100)),await c.fetchFolders(!0)}catch{}};$e(()=>i.lastUpdatedDocumentId,(ge,ne)=>{if(ge&&ge!==ne&&F.value==="default"){const Ce=Date.now();(!$e.lastExecutionTime||Ce-$e.lastExecutionTime>100)&&($e.lastExecutionTime=Ce,F.value="default")}},{immediate:!1}),$e(w,ge=>{}),$e(g,ge=>{}),$e(A,ge=>{});const he=[{name:"folders",label:"Carpetas"},{name:"my-documents",label:"Mis Documentos"}],be=[{name:"legal-documents",label:"Minutas"},{name:"pending-signatures",label:"Dcs. Por Firmar"},{name:"signed-documents",label:"Dcs. Firmados"},{name:"finished-documents",label:"Dcs. Clientes"},{name:"in-progress-documents",label:"Dcs. Clientes en Progreso"}],ie=P(!1),ye=P(!1),ve=()=>{ie.value=!1,ye.value=!1},pe=ge=>{R.value=ge,ie.value=!1,ve()},Le=ge=>{J.value=ge,ye.value=!1,ve()};qe(async()=>{await v.init(),await i.init(),await c.init(),i.selectedDocument=null,F.value="default";const ge=localStorage.getItem("lastUpdatedDocumentId");ge&&i.documents.some(Ce=>Ce.id.toString()===ge)&&(i.lastUpdatedDocumentId=parseInt(ge))});const Be=async ge=>{await v.getUserInfo(),v.currentUser&&(v.currentUser.has_signature=!0),_e("Firma electr√≥nica guardada correctamente","success"),setTimeout(()=>{E.value=!1},500)};return(ge,ne)=>{var Ce,Te;return o(),l(de,null,[e("div",e0,[e("div",t0,[Vt(ge.$slots,"default")]),e("div",s0,[I.value==="lawyer"?(o(),l("div",o0,[e("div",r0,[e("div",n0,[e("nav",l0,[(o(),l(de,null,me(be,W=>e("button",{key:W.name,onClick:fe(Ie=>pe(W.name),["stop"]),class:h([R.value===W.name?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm cursor-pointer"])},f(W.label),11,a0)),64))]),e("div",i0,[e("button",{onClick:ne[0]||(ne[0]=fe(W=>E.value=!0,["stop"])),class:"inline-flex items-center gap-2 px-4 py-2 rounded-lg border border-purple-200 bg-white text-sm font-medium text-gray-700 hover:bg-purple-50 hover:border-purple-300 transition-all duration-200"},[s(t(_t),{class:"size-5 text-purple-500"}),d0]),e("button",{onClick:ne[1]||(ne[1]=fe(W=>n.value=!0,["stop"])),class:"inline-flex items-center gap-2 px-4 py-2 rounded-lg border border-green-200 bg-white text-sm font-medium text-gray-700 hover:bg-green-50 hover:border-green-300 transition-all duration-200"},[s(t(Ve),{class:"size-5 text-green-500"}),c0]),e("button",{onClick:ne[2]||(ne[2]=fe(W=>B.value=!0,["stop"])),class:"inline-flex items-center gap-2 px-4 py-2 rounded-lg border border-secondary bg-secondary text-sm font-medium text-white hover:bg-blue-700 transition-all duration-200"},[s(t(Ke),{class:"size-5"}),u0])])]),e("div",m0,[e("button",{onClick:ne[3]||(ne[3]=fe(W=>ie.value=!ie.value,["stop"])),class:"dropdown-button w-full flex items-center justify-between py-4 px-3 bg-white border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary"},[e("span",null,f(((Ce=be.find(W=>W.name===R.value))==null?void 0:Ce.label)||"Seleccionar secci√≥n"),1),(o(),l("svg",{class:h(["ml-2 h-5 w-5 transition-transform duration-200",ie.value?"transform rotate-180":""]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},p0,2))]),ie.value?(o(),l("div",h0,[(o(),l(de,null,me(be,W=>e("button",{key:W.name,onClick:fe(Ie=>pe(W.name),["stop"]),class:h(["w-full text-left px-4 py-3 text-sm transition-colors duration-150",R.value===W.name?"bg-primary text-white":"text-gray-700 hover:bg-gray-50"])},f(W.label),11,f0)),64))])):D("",!0),e("div",v0,[e("button",{onClick:ne[4]||(ne[4]=fe(W=>E.value=!0,["stop"])),class:"flex flex-col items-center justify-center py-3 px-2 rounded-lg border border-purple-200 bg-white text-center transition-all duration-200 hover:bg-purple-50"},[s(t(_t),{class:"size-6 text-purple-500 mb-1"}),b0]),e("button",{onClick:ne[5]||(ne[5]=fe(W=>n.value=!0,["stop"])),class:"flex flex-col items-center justify-center py-3 px-2 rounded-lg border border-green-200 bg-white text-center transition-all duration-200 hover:bg-green-50"},[s(t(Ve),{class:"size-6 text-green-500 mb-1"}),y0]),e("button",{onClick:ne[6]||(ne[6]=fe(W=>B.value=!0,["stop"])),class:"flex flex-col items-center justify-center py-3 px-2 rounded-lg border border-secondary bg-secondary text-white text-center transition-all duration-200 hover:bg-blue-700"},[s(t(Ke),{class:"size-6 mb-1"}),x0])])])]),R.value==="legal-documents"?(o(),l("div",_0,[s(yd,{searchQuery:$.value,selectedTags:_.value},null,8,["searchQuery","selectedTags"])])):D("",!0),R.value==="pending-signatures"?(o(),l("div",w0,[s(Ot,{state:"PendingSignatures",searchQuery:$.value,selectedTags:_.value},null,8,["searchQuery","selectedTags"])])):D("",!0),R.value==="signed-documents"?(o(),l("div",$0,[s(Ot,{state:"FullySigned",searchQuery:$.value,selectedTags:_.value},null,8,["searchQuery","selectedTags"])])):D("",!0),R.value==="finished-documents"?(o(),l("div",k0,[s(Ec,{searchQuery:$.value,selectedTags:_.value},null,8,["searchQuery","selectedTags"])])):D("",!0),R.value==="in-progress-documents"?(o(),l("div",C0,[s(Bu,{searchQuery:$.value,selectedTags:_.value},null,8,["searchQuery","selectedTags"])])):D("",!0),y.value.length===0?(o(),l("div",D0,E0)):D("",!0)])):D("",!0),I.value==="client"||I.value==="basic"||I.value==="corporate_client"?(o(),l("div",F0,[e("div",A0,[e("div",T0,[e("nav",M0,[(o(),l(de,null,me(he,W=>e("button",{key:W.name,onClick:fe(Ie=>Le(W.name),["stop"]),class:h([J.value===W.name?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])},f(W.label),11,P0)),64))]),e("div",L0,[e("button",{onClick:fe(X,["stop"]),disabled:t(x),class:h(["inline-flex items-center gap-2 px-3 py-2 text-sm font-medium rounded-lg transition-colors border",t(x)?"text-purple-400 bg-gray-50 border-gray-200 cursor-not-allowed opacity-60":"text-purple-600 hover:bg-purple-50 border-purple-200"])},[s(t(_t),{class:"h-4 w-4"}),se(" Firma Electr√≥nica ")],10,I0),e("button",{onClick:fe(ee,["stop"]),disabled:t(x),class:h(["inline-flex items-center gap-2 px-3 py-2 text-sm font-medium rounded-lg transition-colors border",t(x)?"text-green-400 bg-gray-50 border-gray-200 cursor-not-allowed opacity-60":"text-green-600 hover:bg-green-50 border-green-200"])},[s(t(Ve),{class:"h-4 w-4"}),se(" Membrete Global ")],10,j0),e("button",{onClick:ne[7]||(ne[7]=fe(W=>N("useDocument"),["stop"])),class:"inline-flex items-center gap-2 px-3 py-2 text-sm font-medium text-white bg-secondary hover:bg-blue-700 rounded-lg transition-colors",type:"button"},[s(t(Ke),{class:"h-4 w-4"}),se(" Nuevo Documento ")])])]),e("div",B0,[e("button",{onClick:ne[8]||(ne[8]=fe(W=>ye.value=!ye.value,["stop"])),class:"w-full flex items-center justify-between py-4 px-3 bg-white border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary"},[e("span",null,f(((Te=he.find(W=>W.name===J.value))==null?void 0:Te.label)||"Seleccionar secci√≥n"),1),(o(),l("svg",{class:h(["ml-2 h-5 w-5 transition-transform duration-200",ye.value?"transform rotate-180":""]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},N0,2))]),ye.value?(o(),l("div",z0,[(o(),l(de,null,me(he,W=>e("button",{key:W.name,onClick:fe(Ie=>Le(W.name),["stop"]),class:h(["w-full text-left px-4 py-3 text-sm transition-colors duration-150",J.value===W.name?"bg-primary text-white":"text-gray-700 hover:bg-gray-50"])},f(W.label),11,q0)),64))])):D("",!0)]),e("div",O0,[e("button",{onClick:fe(X,["stop"]),disabled:t(x),class:h(["w-full flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium rounded-lg transition-colors",t(x)?"text-purple-400 bg-gray-50 cursor-not-allowed opacity-60":"text-purple-600 bg-purple-50 hover:bg-purple-100"])},[s(t(_t),{class:"h-5 w-5"}),se(" Firma Electr√≥nica ")],10,R0),e("button",{onClick:fe(ee,["stop"]),disabled:t(x),class:h(["w-full flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium rounded-lg transition-colors",t(x)?"text-green-400 bg-gray-50 cursor-not-allowed opacity-60":"text-green-600 bg-green-50 hover:bg-green-100"])},[s(t(Ve),{class:"h-5 w-5"}),se(" Membrete Global ")],10,V0),e("button",{onClick:ne[9]||(ne[9]=fe(W=>N("useDocument"),["stop"])),class:"w-full flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium text-white bg-secondary hover:bg-blue-700 rounded-lg transition-colors",type:"button"},[s(t(Ke),{class:"h-5 w-5"}),se(" Nuevo Documento ")])])]),F.value==="useDocument"?(o(),l("div",Q0,[s(za,{searchQuery:$.value,selectedTags:_.value,onGoBack:le},null,8,["searchQuery","selectedTags"])])):(o(),l("div",G0,[J.value==="my-documents"?(o(),te(sa,{key:0,searchQuery:$.value,selectedTags:_.value,onRefresh:q},null,8,["searchQuery","selectedTags"])):D("",!0),J.value==="folders"?(o(),te(Hn,{key:1,searchQuery:$.value,selectedTags:_.value,onRefresh:q,onNavigateToMain:le},null,8,["searchQuery","selectedTags"])):D("",!0)]))])):D("",!0)])]),B.value?(o(),te(Ye,{key:0},{default:m(()=>[s(lg,{onClose:V})]),_:1})):D("",!0),E.value?(o(),te(Ye,{key:1},{default:m(()=>[e("div",Z0,[e("div",H0,[e("div",W0,[K0,e("button",{onClick:ne[10]||(ne[10]=W=>E.value=!1),class:"text-gray-400 hover:text-gray-500 p-1 rounded-full hover:bg-gray-100"},[s(t(Pe),{class:"h-6 w-6"})])]),e("div",J0,[s(It,{"user-id":oe.value.id,"initial-show-options":!oe.value.has_signature,onSignatureSaved:Be,onCancel:ne[11]||(ne[11]=W=>E.value=!1)},null,8,["user-id","initial-show-options"])])])])]),_:1})):D("",!0),Y.value?(o(),te(Ye,{key:2},{default:m(()=>[e("div",Y0,[e("div",X0,[e("div",ep,[tp,e("button",{onClick:ne[12]||(ne[12]=W=>Y.value=!1),class:"text-gray-400 hover:text-gray-500 p-1 rounded-full hover:bg-gray-100"},[s(t(Pe),{class:"h-6 w-6"})])]),e("div",sp,[s(It,{"user-id":oe.value.id,"initial-show-options":!oe.value.has_signature,onSignatureSaved:Be,onCancel:ne[13]||(ne[13]=W=>Y.value=!1)},null,8,["user-id","initial-show-options"])])])])]),_:1})):D("",!0),s(Mt,{isVisible:t(st),documentData:t(Tt),onClose:ne[14]||(ne[14]=W=>st.value=!1)},null,8,["isVisible","documentData"]),s(Xg,{isVisible:n.value,onClose:ne[15]||(ne[15]=W=>n.value=!1),onUploaded:K,onDeleted:O},null,8,["isVisible"])],64)}}};export{Ep as default};
