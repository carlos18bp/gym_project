import{e as o,f as d,g as e,u as Se,r as U,aG as rt,o as ve,ao as Ie,c as z,h as s,j as t,G as he,w as me,v as xe,n as C,l as N,t as w,m as pe,p as X,s as ue,b2 as at,i as n,b0 as De,a9 as nt,b3 as it,Q as Le,k as le,a2 as Ee,F as se,D as Ge,E as dt,b4 as ct,a0 as ut,C as mt,T as ge,N as ae,I as ke,a1 as _e,af as ie,ac as de,ad as ce,ae as H,b5 as gt,O as Pe,P as qe,b6 as pt,b7 as Ve,b8 as ht}from"./index.js";import{u as be,o as ft,s as Ae,p as Ze}from"./index2.js";import{g as Ue,a as Ne}from"./DocumentPermissionsManager.js";import{B as yt,a as xt,b as bt,L as Ye,c as Xe,d as vt,e as _t,_ as He}from"./index3.js";import{_ as ze}from"./_plugin-vue_export-helper.js";import{r as Qe,_ as wt}from"./DocumentCard.js";import{r as Ce}from"./PlusIcon.js";import{r as we}from"./EllipsisVerticalIcon.js";import{r as We}from"./DocumentIcon.js";import{r as $t}from"./EyeIcon.js";import{r as kt,a as Ct}from"./LinkIcon.js";import{_ as et}from"./SignatureDocumentCard.js";import{r as tt,a as Dt}from"./TagIcon.js";import{a as ye,r as Te,b as Me}from"./FunnelIcon.js";import{r as $e}from"./MagnifyingGlassIcon.js";import{r as St}from"./ArrowLeftIcon.js";import{r as Re}from"./ArrowDownTrayIcon.js";import{r as Et}from"./TrashIcon.js";import{r as Ft}from"./PhotoIcon.js";import{r as st}from"./InformationCircleIcon.js";import{r as Tt}from"./CloudArrowUpIcon.js";import{r as Lt}from"./ExclamationTriangleIcon.js";import"./useRecentViews.js";import"./PencilIcon.js";import"./loading_message.js";function At(a,x){return o(),d("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z"})])}const It={class:"bg-white rounded-lg p-6 shadow-xl max-w-lg w-full"},Mt={class:"flex justify-end"},jt=e("label",{for:"document-name",class:"block text-base font-medium leading-6 text-primary"},[X(" Nombre "),e("span",{class:"text-red-500"},"*")],-1),Bt={class:"mt-2"},Ut={class:"flex gap-2 mt-2.5"},Nt=["disabled"],Pt=e("span",null,"Actualizar nombre",-1),qt=[Pt],zt=["disabled"],Rt={__name:"UseDocumentByClient",props:{documentId:{type:[Number,null],required:!1,default:null}},emits:["close"],setup(a,{emit:x}){const h=a,$=Se(),E=be(),S=x,i=U(""),F=U(""),_=()=>{S("close")};rt(()=>{var k,A;E.selectedDocument?(i.value=((k=E.selectedDocument)==null?void 0:k.title)||"",F.value=((A=E.selectedDocument)==null?void 0:A.title)||""):(i.value="",F.value="")});const y=k=>{k.key==="Escape"&&_()};ve(()=>{document.addEventListener("keydown",y)}),Ie(()=>{document.removeEventListener("keydown",y)});const q=z(()=>i.value.trim().length>0),b=z(()=>{var k;return!!((k=E.selectedDocument)!=null&&k.id)}),P=z(()=>b.value&&i.value.trim()!==F.value.trim()&&i.value.trim().length>0);async function L(){if(b.value&&P.value)try{const k={title:i.value.trim()};await E.updateDocument(E.selectedDocument.id,k),F.value=i.value.trim(),E.selectedDocument.title=i.value.trim();const A=E.selectedDocument.id;ue("Document name successfully updated.","success"),S("close",{updatedDocId:A});const O=window.location.pathname;O==="/dynamic_document_dashboard"||O==="/dynamic_document_dashboard/"||setTimeout(()=>{window.location.href="/dynamic_document_dashboard"},1e3)}catch(k){console.error("Error updating document name:",k),ue("Error updating document name.","error")}}function I(){const k=encodeURIComponent(i.value.trim());h.documentId&&!E.selectedDocument?$.push(`/dynamic_document_dashboard/document/use/creator/${h.documentId}/${k}`):E.selectedDocument?(E.selectedDocument.title=i.value.trim(),$.push(`/dynamic_document_dashboard/document/use/editor/${E.selectedDocument.id}/${k}`)):ue("Error: No se pudo continuar. Documento no seleccionado.","error")}return(k,A)=>(o(),d("div",It,[e("div",Mt,[e("button",{onClick:_},[s(t(he),{class:"size-6"})])]),e("form",{onSubmit:pe(I,["prevent"])},[e("div",null,[jt,e("div",Bt,[me(e("input",{"onUpdate:modelValue":A[0]||(A[0]=T=>i.value=T),type:"text",id:"document-name",class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm ring-1 ring-inset ring-gray-300",required:""},null,512),[[xe,i.value]])])]),e("div",Ut,[b.value?(o(),d("button",{key:0,type:"button",onClick:L,disabled:!P.value,class:C(["p-2.5 text-sm font-medium rounded-md flex gap-2",P.value?"bg-primary text-white cursor-pointer":"bg-gray-200 text-gray-400 cursor-not-allowed opacity-70"])},qt,10,Nt)):N("",!0),e("button",{type:"submit",class:C(["p-2.5 text-sm font-medium rounded-md flex gap-2",q.value?"bg-secondary text-white":"bg-gray-200 text-secondary border-2 border-dashed border-secondary cursor-not-allowed bg-opacity-50"]),disabled:!q.value},[e("span",null,w(b.value?"Editar Documento":"Continuar"),1)],10,zt)])],32)]))}},Ot={class:"mt-3 pt-2 border-t border-gray-100"},Vt={class:"flex items-center gap-2 text-xs text-gray-500"},Qt=e("span",null,"Hacer clic para usar este documento",-1),Gt={__name:"UseDocumentCard",props:{document:{type:Object,required:!0},showTags:{type:Boolean,default:!0},cardType:{type:String,default:"default"},cardContext:{type:String,default:"list"},documentStore:{type:Object,default:null},userStore:{type:Object,default:null},menuOptions:{type:Array,default:null},disableInternalActions:{type:Boolean,default:!1},showMenuOptions:{type:Boolean,default:null}},emits:["click","remove-from-folder","document-created"],setup(a,{emit:x}){const h=a,$=x,E=U(!1),S=U(null),i=Ue(9),F=z(()=>"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium !bg-purple-100 !text-purple-700 !border !border-purple-200"),_=z(()=>i.dark),y=z(()=>"group !border-purple-400 !bg-purple-50/50 !shadow-purple-100"),q=z(()=>h.menuOptions!==null?h.menuOptions:[{label:"Usar",action:"use",icon:At,iconClasses:"w-4 h-4 text-purple-600"},{label:"Previsualizaci√≥n",action:"preview",icon:$t,iconClasses:"w-4 h-4 text-gray-600"}]),b=z(()=>!1),P=(A,T)=>{h.disableInternalActions?$("click",A,T):I(A.id)},L=(A,T)=>{switch(A){case"use":I(T.id);break;case"preview":ft(T);break;default:console.warn("Unknown menu action:",A)}};function I(A){A?(S.value=A,E.value=!0):console.error("Document ID is required:",A)}function k(A){if(E.value=!1,S.value=null,A&&A.updatedDocId){$("document-created",A);const T=window.location.pathname;T==="/dynamic_document_dashboard"||T==="/dynamic_document_dashboard/"?setTimeout(()=>{window.forceDocumentHighlight&&window.forceDocumentHighlight(A.updatedDocId)},100):setTimeout(()=>{window.location.href="/dynamic_document_dashboard"},500)}}return(A,T)=>(o(),d(se,null,[s(yt,{document:a.document,"card-type":a.cardType,"card-context":a.cardContext,"status-icon":t(it),"status-text":"Disponible","status-badge-classes":F.value,"menu-options":q.value,"highlighted-doc-id":null,"show-tags":a.showTags,"document-store":a.documentStore,"user-store":a.userStore,"additional-classes":y.value,"disable-internal-actions":a.disableInternalActions,"show-menu-options":a.showMenuOptions,onClick:P,onMenuAction:L,onRemoveFromFolder:T[0]||(T[0]=O=>A.$emit("remove-from-folder",O))},at({"additional-actions":n(()=>[nt(A.$slots,"additional-actions")]),_:2},[b.value?{name:"right-action",fn:n(()=>[s(t(kt),{class:"w-5 h-5 text-gray-400 group-hover:text-gray-600 transition-colors"})]),key:"0"}:void 0,a.disableInternalActions?void 0:{name:"footer",fn:n(()=>[e("div",Ot,[e("div",Vt,[e("div",{class:"w-2 h-2 rounded-full",style:De({backgroundColor:_.value})},null,4),Qt])])]),key:"1"}]),1032,["document","card-type","card-context","status-icon","status-badge-classes","menu-options","show-tags","document-store","user-store","additional-classes","disable-internal-actions","show-menu-options"]),me(s(Ee,null,{default:n(()=>[S.value!==null?(o(),le(Rt,{key:0,"document-id":S.value,onClose:k},null,8,["document-id"])):N("",!0)]),_:1},512),[[Le,E.value]])],64))}},Zt=()=>({folders:[],currentFolder:null,isLoading:!1,error:null,lastUpdatedFolderId:null}),Ht={sortedFolders:a=>[...a.folders].sort((x,h)=>new Date(h.created_at)-new Date(x.created_at)),getFolderById:a=>x=>a.folders.find(h=>h.id===x),getFoldersByColor:a=>x=>a.folders.filter(h=>h.color_id===x),getFolderWithColor:a=>x=>{const h=a.folders.find($=>$.id===x);return h?{...h,color:Ue(h.color_id)}:null},getFoldersContainingDocument:a=>x=>a.folders.filter(h=>h.document_ids&&h.document_ids.includes(x)),totalDocumentsInFolders:a=>a.folders.reduce((x,h)=>x+(h.document_ids?h.document_ids.length:0),0),hasFolders:a=>a.folders.length>0,availableColors:()=>Ne()},Wt={async init(a=!1){if(!(this.folders.length>0&&!a)){this.isLoading=!0,this.error=null;try{await this.fetchFolders()}catch(x){console.error("Error initializing document folder store:",x),this.error="Error al inicializar las carpetas"}finally{this.isLoading=!1}}},async fetchFolders(){try{const a=await Ge("dynamic-documents/folders/");if(a.status===200)return this.folders=a.data,a.data;throw new Error(`Error fetching folders: ${a.status}`)}catch(a){throw console.error("Error fetching folders:",a),this.error="Error al obtener las carpetas",a}},async fetchFolder(a){this.isLoading=!0,this.error=null;try{const x=await Ge(`dynamic-documents/folders/${a}/`);if(x.status===200){const h=x.data,$=this.folders.findIndex(E=>E.id===h.id);return $!==-1?this.folders[$]=h:this.folders.push(h),this.currentFolder=h,h}else throw new Error(`Error fetching folder: ${x.status}`)}catch(x){throw console.error("Error fetching folder:",x),this.error="Error al obtener la carpeta",x}finally{this.isLoading=!1}},async createFolder(a){this.isLoading=!0,this.error=null;try{if(!a.name||a.name.trim()==="")throw new Error("El nombre de la carpeta es requerido");const x=a.color_id??0;if(x<0||x>=Ne().length)throw new Error("Color de carpeta no v√°lido");const h={name:a.name.trim(),color_id:x,...a.document_ids&&{document_ids:a.document_ids}},$=await dt("dynamic-documents/folders/create/",h);if($.status===200||$.status===201){const E=$.data;return this.folders.push(E),this.lastUpdatedFolderId=E.id,await ue("Carpeta creada exitosamente","success"),E}else throw new Error(`Error creating folder: ${$.status}`)}catch(x){throw console.error("Error creating folder:",x),this.error=x.message||"Error al crear la carpeta",await ue(this.error,"error"),x}finally{this.isLoading=!1}},async updateFolder(a,x){this.isLoading=!0,this.error=null;try{if(x.name&&x.name.trim()==="")throw new Error("El nombre de la carpeta no puede estar vac√≠o");if(x.color_id!==void 0){const E=x.color_id;if(E<0||E>=Ne().length)throw new Error("Color de carpeta no v√°lido")}const h={};x.name&&(h.name=x.name.trim()),x.color_id!==void 0&&(h.color_id=x.color_id),x.document_ids!==void 0&&(h.document_ids=x.document_ids);const $=await ct(`dynamic-documents/folders/${a}/update/`,h);if($.status===200){const E=$.data,S=this.folders.findIndex(i=>i.id===a);return S!==-1&&(this.folders[S]=E),this.currentFolder&&this.currentFolder.id===a&&(this.currentFolder=E),this.lastUpdatedFolderId=a,await ue("Carpeta actualizada exitosamente","success"),E}else throw new Error(`Error updating folder: ${$.status}`)}catch(h){throw console.error("Error updating folder:",h),this.error=h.message||"Error al actualizar la carpeta",await ue(this.error,"error"),h}finally{this.isLoading=!1}},async deleteFolder(a){this.isLoading=!0,this.error=null;try{const x=await ut(`dynamic-documents/folders/${a}/delete/`);if(x.status===204||x.status===200)return this.folders=this.folders.filter(h=>h.id!==a),this.currentFolder&&this.currentFolder.id===a&&(this.currentFolder=null),await ue("Carpeta eliminada exitosamente","success"),!0;throw new Error(`Error deleting folder: ${x.status}`)}catch(x){throw console.error("Error deleting folder:",x),this.error=x.message||"Error al eliminar la carpeta",await ue(this.error,"error"),x}finally{this.isLoading=!1}},setCurrentFolder(a){this.currentFolder=a},clearCurrentFolder(){this.currentFolder=null},reset(){this.folders=[],this.currentFolder=null,this.isLoading=!1,this.error=null,this.lastUpdatedFolderId=null}},Kt={async addDocumentsToFolder(a,x){const h=this.getFolderById(a);if(!h)throw new Error("Carpeta no encontrada");const $=h.document_ids||[],E=[...new Set([...$,...x])];return await this.updateFolder(a,{document_ids:E})},async removeDocumentsFromFolder(a,x){const h=this.getFolderById(a);if(!h)throw new Error("Carpeta no encontrada");const E=(h.document_ids||[]).filter(S=>!x.includes(S));return await this.updateFolder(a,{document_ids:E})},async moveDocumentsBetweenFolders(a,x,h){try{x&&await this.removeDocumentsFromFolder(x,a),h&&await this.addDocumentsToFolder(h,a),await ue("Documentos movidos exitosamente","success")}catch($){throw console.error("Error moving documents between folders:",$),await ue("Error al mover documentos","error"),$}},getFolderColor(a){const x=this.getFolderById(a);return x?Ue(x.color_id):Ue(0)},validateFolderData(a){const x=[];if((!a.name||a.name.trim()==="")&&x.push("El nombre de la carpeta es requerido"),a.name&&a.name.length>100&&x.push("El nombre de la carpeta no puede exceder 100 caracteres"),a.color_id!==void 0){const h=a.color_id;(h<0||h>=Ne().length)&&x.push("Color de carpeta no v√°lido")}return a.document_ids&&!Array.isArray(a.document_ids)&&x.push("Los IDs de documentos deben ser un array"),{isValid:x.length===0,errors:x}}},Ke=mt("documentFolder",{state:Zt,getters:Ht,actions:{...Wt,...Kt}}),Jt={class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},Yt={class:"bg-white rounded-xl shadow-xl max-w-md w-full"},Xt={class:"flex justify-between items-center p-6 border-b"},es={class:"text-lg font-semibold text-gray-900"},ts={class:"mb-4"},ss=e("label",{for:"folderName",class:"block text-sm font-medium text-gray-700 mb-2"}," Nombre de la carpeta ",-1),os={class:"mb-6"},rs=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"}," Color de la carpeta ",-1),ls={class:"grid grid-cols-8 gap-2"},as=["onClick","title"],ns={class:"flex gap-3"},is=["disabled"],ds={__name:"CreateEditFolderModal",props:{isVisible:{type:Boolean,required:!0},editingFolder:{type:Object,default:null}},emits:["close","success"],setup(a,{emit:x}){const h=a,$=x,E=Ke(),S=U(!1),i=U({name:"",color_id:0}),F=z(()=>Ne()),_=()=>{i.value={name:"",color_id:0}};ge(()=>h.editingFolder,b=>{b?i.value={name:b.name,color_id:b.color_id}:_()},{immediate:!0}),ge(()=>h.isVisible,b=>{b||_()});const y=()=>{$("close")},q=async()=>{if(i.value.name.trim()){S.value=!0;try{h.editingFolder?(await E.updateFolder(h.editingFolder.id,i.value),ue("Carpeta actualizada correctamente","success")):(await E.createFolder(i.value),ue("Carpeta creada correctamente","success")),$("success")}catch(b){const P=h.editingFolder?"actualizar":"crear";ue(`Error al ${P} la carpeta`,"error"),console.error(`Error ${P} folder:`,b)}finally{S.value=!1}}};return(b,P)=>a.isVisible?(o(),le(Ee,{key:0},{default:n(()=>[e("div",Jt,[e("div",Yt,[e("div",Xt,[e("h3",es,w(a.editingFolder?"Editar Carpeta":"Nueva Carpeta"),1),e("button",{onClick:y,class:"text-gray-400 hover:text-gray-500"},[s(t(he),{class:"w-6 h-6"})])]),e("form",{onSubmit:pe(q,["prevent"]),class:"p-6"},[e("div",ts,[ss,me(e("input",{id:"folderName","onUpdate:modelValue":P[0]||(P[0]=L=>i.value.name=L),type:"text",required:"",maxlength:"100",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Ej: Contratos Laborales"},null,512),[[xe,i.value.name]])]),e("div",os,[rs,e("div",ls,[(o(!0),d(se,null,ae(F.value,L=>(o(),d("button",{key:L.id,type:"button",onClick:I=>i.value.color_id=L.id,class:C(["w-8 h-8 rounded-full border-2 transition-all",i.value.color_id===L.id?"border-gray-800 scale-110":"border-gray-300 hover:border-gray-400"]),style:De({backgroundColor:L.hex}),title:L.name},null,14,as))),128))])]),e("div",ns,[e("button",{type:"button",onClick:y,class:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"}," Cancelar "),e("button",{type:"submit",disabled:!i.value.name.trim()||S.value,class:"flex-1 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},w(S.value?"Guardando...":a.editingFolder?"Actualizar":"Crear"),9,is)])],32)])])]),_:1})):N("",!0)}},cs={class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},us={class:"bg-white rounded-xl shadow-xl max-w-6xl w-full max-h-[90vh] overflow-hidden flex flex-col"},ms={class:"border-b px-6 py-4 flex-shrink-0"},gs={class:"flex justify-between items-center"},ps={class:"flex items-center gap-3"},hs={class:"text-xl font-semibold text-gray-900"},fs={class:"text-sm text-gray-600"},ys={class:"flex items-center gap-2"},xs={class:"flex-1 overflow-y-auto p-6"},bs={key:0,class:"bg-white rounded-lg shadow-sm border border-gray-200"},vs={class:"overflow-x-auto"},_s={class:"min-w-full divide-y divide-gray-200"},ws=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Documento "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Tipo "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etiquetas "),e("th",{scope:"col",class:"w-16 px-6 py-3"})])],-1),$s={class:"bg-white divide-y divide-gray-200"},ks=["onClick"],Cs={class:"px-6 py-4 whitespace-nowrap"},Ds={class:"flex items-center"},Ss={class:"flex-shrink-0 h-10 w-10"},Es={class:"h-10 w-10 rounded-lg bg-blue-100 flex items-center justify-center"},Fs={class:"ml-4"},Ts={class:"text-sm font-medium text-gray-900"},Ls={class:"px-6 py-4 whitespace-nowrap"},As={class:"text-sm text-gray-600"},Is={class:"px-6 py-4 whitespace-nowrap"},Ms={class:"px-6 py-4 whitespace-nowrap"},js={class:"flex flex-wrap gap-1"},Bs={key:0,class:"text-sm text-gray-400"},Us={class:"py-1"},Ns=["onClick"],Ps=["onClick"],qs={key:1,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center"},zs=e("h4",{class:"text-lg font-medium text-gray-900 mb-2"},"Esta carpeta est√° vac√≠a",-1),Rs=e("p",{class:"text-gray-600 mb-4"},"Agrega documentos para organizar tu trabajo",-1),Os={__name:"FolderDetailsModalTable",props:{folder:{type:Object,default:null}},emits:["close","add-documents","remove-document","view-document","use-document","document-action"],setup(a,{emit:x}){const h=a,$=x;ke(),be();const E=[{name:"blue",hex:"#3B82F6"},{name:"purple",hex:"#8B5CF6"},{name:"pink",hex:"#EC4899"},{name:"green",hex:"#10B981"},{name:"yellow",hex:"#F59E0B"},{name:"red",hex:"#EF4444"},{name:"indigo",hex:"#6366F1"},{name:"teal",hex:"#14B8A6"}],S=z(()=>{if(!h.folder)return E[0];if(h.folder.color)return E.find(k=>k.name===h.folder.color)||E[0];const I=h.folder.id%E.length;return E[I]}),i=I=>I.state==="Published"||I.state==="Draft"?"Formato":I.state==="PendingSignatures"||I.state==="FullySigned"?"Para Firmar":I.state==="Progress"||I.state==="Completed"?"Mis Documentos":"Documento",F=I=>({Published:"Publicado",Draft:"Borrador",Progress:"En Progreso",Completed:"Completado",PendingSignatures:"Pendiente Firma",FullySigned:"Firmado"})[I.state]||I.state,_=I=>({Published:"bg-green-100 text-green-700 border border-green-200",Draft:"bg-gray-100 text-gray-700 border border-gray-200",Progress:"bg-blue-100 text-blue-700 border border-blue-200",Completed:"bg-green-100 text-green-700 border border-green-200",PendingSignatures:"bg-yellow-100 text-yellow-700 border border-yellow-200",FullySigned:"bg-green-100 text-green-700 border border-green-200"})[I.state]||"bg-gray-100 text-gray-700 border border-gray-200",y=I=>{const k=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],A=I.id%k.length;return k[A]},q=()=>{$("close")},b=()=>{$("add-documents",h.folder)},P=I=>{$("remove-document",{folderId:h.folder.id,documentId:I.id})},L=I=>{const k=i(I);$(k==="Formato"?"use-document":"view-document",I)};return(I,k)=>a.folder?(o(),le(Ee,{key:0},{default:n(()=>[e("div",cs,[e("div",us,[e("div",ms,[e("div",gs,[e("div",ps,[e("div",{class:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",style:De({backgroundColor:S.value.hex+"20"})},[s(t(Qe),{class:"h-6 w-6",style:De({color:S.value.hex})},null,8,["style"])],4),e("div",null,[e("h3",hs,w(a.folder.name),1),e("p",fs,w(a.folder.documents.length)+" documento"+w(a.folder.documents.length!==1?"s":""),1)])]),e("div",ys,[e("button",{onClick:b,class:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-blue-600 hover:bg-blue-50 rounded-lg transition-colors"},[s(t(Ce),{class:"w-5 h-5"}),X(" Agregar documentos ")]),e("button",{onClick:q,class:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors"},[s(t(he),{class:"w-6 h-6"})])])])]),e("div",xs,[a.folder.documents.length>0?(o(),d("div",bs,[e("div",vs,[e("table",_s,[ws,e("tbody",$s,[(o(!0),d(se,null,ae(a.folder.documents,A=>(o(),d("tr",{key:A.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:T=>L(A)},[e("td",Cs,[e("div",Ds,[e("div",Ss,[e("div",Es,[s(t(_e),{class:"h-5 w-5 text-blue-600"})])]),e("div",Fs,[e("div",Ts,w(A.title),1)])])]),e("td",Ls,[e("span",As,w(i(A)),1)]),e("td",Is,[e("span",{class:C(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",_(A)])},w(F(A)),3)]),e("td",Ms,[e("div",js,[(o(!0),d(se,null,ae(A.tags,T=>(o(),d("span",{key:T.id,class:C(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",y(T)])},w(T.name),3))),128)),!A.tags||A.tags.length===0?(o(),d("span",Bs,"-")):N("",!0)])]),e("td",{class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",onClick:k[0]||(k[0]=pe(()=>{},["stop"]))},[s(t(ie),{as:"div",class:"relative inline-block text-left"},{default:n(()=>[s(t(de),{class:"inline-flex items-center justify-center w-8 h-8 rounded-md hover:bg-gray-100"},{default:n(()=>[s(t(we),{class:"h-5 w-5 text-gray-500"})]),_:1}),s(t(ce),{class:"absolute right-0 z-[9999] mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:n(()=>[e("div",Us,[s(t(H),null,{default:n(({active:T})=>[e("a",{onClick:O=>L(A),class:C([T?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Ver documento ",10,Ns)]),_:2},1024),s(t(H),null,{default:n(({active:T})=>[e("a",{onClick:O=>P(A),class:C([T?"bg-gray-100":"","block px-4 py-2 text-sm text-red-600 cursor-pointer"])}," Quitar de carpeta ",10,Ps)]),_:2},1024)])]),_:2},1024)]),_:2},1024)])],8,ks))),128))])])])])):(o(),d("div",qs,[s(t(We),{class:"w-12 h-12 text-gray-300 mx-auto mb-4"}),zs,Rs,e("button",{onClick:b,class:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"},[s(t(Ce),{class:"w-5 h-5"}),X(" Agregar documentos ")])]))])])])]),_:1})):N("",!0)}},Oe=a=>(Pe("data-v-d403a707"),a=a(),qe(),a),Vs={class:"tag-filter-container"},Qs={class:"relative"},Gs={class:"flex items-center"},Zs={key:0,class:"ml-2 inline-flex items-center justify-center h-5 w-5 bg-primary text-white text-xs rounded-full font-medium"},Hs={key:0,class:"absolute left-0 mt-2 w-full sm:w-80 bg-white rounded-xl shadow-xl ring-1 ring-black ring-opacity-5 border border-gray-100 z-50 overflow-hidden"},Ws={class:"bg-gray-50 p-4 border-b border-gray-200"},Ks={class:"flex items-center justify-between mb-3"},Js=Oe(()=>e("h3",{class:"text-sm font-semibold text-gray-900"},"Filtrar por etiquetas",-1)),Ys={key:0,class:"text-xs text-gray-500"},Xs={class:"relative"},eo={key:0,class:"px-4 py-2 bg-blue-50 border-b border-blue-100"},to={class:"flex items-center justify-between"},so={class:"text-xs font-medium text-blue-700"},oo={class:"max-h-52 overflow-y-auto"},ro={key:0,class:"px-4 py-8 text-center"},lo=Oe(()=>e("p",{class:"text-gray-500 text-sm"},"No hay etiquetas disponibles",-1)),ao={key:1,class:"px-4 py-8 text-center"},no={class:"text-gray-500 text-sm"},io={key:2,class:"px-4 py-8 text-center"},co=Oe(()=>e("div",{class:"flex items-center justify-center"},[e("div",{class:"animate-spin rounded-full h-5 w-5 border-2 border-primary border-t-transparent"}),e("span",{class:"ml-3 text-sm text-gray-600"},"Cargando etiquetas...")],-1)),uo=[co],mo={key:3,class:"py-2"},go=["onClick"],po={class:"flex items-center h-5"},ho={class:"relative"},fo=["id","checked","onChange"],yo={key:0,class:"w-2.5 h-2.5 text-white",fill:"currentColor",viewBox:"0 0 20 20"},xo=Oe(()=>e("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"},null,-1)),bo=[xo],vo={class:"ml-3 flex items-center flex-1 min-w-0"},_o={class:"text-sm font-medium text-gray-900 truncate"},wo={key:0,class:"mt-4"},$o={class:"flex items-start gap-2"},ko=Oe(()=>e("span",{class:"text-xs font-medium text-gray-500 mt-1.5 flex-shrink-0"},"Activos:",-1)),Co={class:"flex flex-wrap gap-2"},Do=["onClick"],So={class:"mr-1"},Eo={class:"ml-1 p-0.5 rounded-full hover:bg-white/50 transition-colors duration-150"},Fo={__name:"TagFilter",props:{modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue"],setup(a,{emit:x}){const h=a,$=x,E=be(),S=U(!1),i=U([]),F=U(!1),_=U(""),y=z(()=>E.sortedTags),q=z(()=>{if(!_.value.trim())return y.value;const T=_.value.toLowerCase().trim();return y.value.filter(O=>O.name.toLowerCase().includes(T))}),b=T=>{const O=Ue(T.color_id);return{hex:O&&O.hex?O.hex:"#9CA3AF",dark:O&&O.dark?O.dark:"#374151"}},P=()=>{S.value=!S.value,S.value&&(_.value="")},L=T=>i.value.some(O=>O.id===T.id),I=T=>{const O=i.value.findIndex(K=>K.id===T.id);O>=0?i.value.splice(O,1):i.value.push(T),$("update:modelValue",i.value)},k=()=>{i.value=[],$("update:modelValue",[])},A=T=>{T.target.closest(".tag-filter-container")||(S.value=!1,_.value="")};return ve(async()=>{try{F.value=!0,await E.initTags()}catch(T){console.error("Error loading tags:",T)}finally{F.value=!1}document.addEventListener("click",A)}),ge(()=>h.modelValue,T=>{i.value=T||[]},{immediate:!0}),Ie(()=>{document.removeEventListener("click",A)}),(T,O)=>(o(),d("div",Vs,[e("div",Qs,[e("button",{onClick:P,class:C(["group inline-flex items-center justify-between w-full sm:w-auto sm:min-w-[200px] px-4 py-3 border border-gray-200 rounded-xl shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 hover:border-gray-300 focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-primary transition-all duration-200",{"ring-2 ring-primary border-primary bg-blue-50":S.value,"border-primary bg-primary/5":i.value.length>0&&!S.value}])},[e("div",Gs,[s(t(tt),{class:C(["h-5 w-5 mr-2.5 text-gray-500 group-hover:text-gray-600",{"text-primary":i.value.length>0||S.value}])},null,8,["class"]),e("span",{class:C(["text-gray-700",{"text-primary font-semibold":i.value.length>0||S.value}])}," Filtrar por etiquetas ",2),i.value.length>0?(o(),d("span",Zs,w(i.value.length),1)):N("",!0)]),s(t(ye),{class:C(["ml-3 h-4 w-4 text-gray-400 transition-all duration-200 group-hover:text-gray-600",{"rotate-180 text-primary":S.value,"text-primary":i.value.length>0&&!S.value}])},null,8,["class"])],2),s(gt,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:n(()=>[S.value?(o(),d("div",Hs,[e("div",Ws,[e("div",Ks,[Js,y.value.length>0?(o(),d("span",Ys,w(y.value.length)+" disponibles ",1)):N("",!0)]),e("div",Xs,[s(t($e),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),me(e("input",{"onUpdate:modelValue":O[0]||(O[0]=K=>_.value=K),type:"text",placeholder:"Buscar etiquetas...",class:"w-full pl-9 pr-4 py-2.5 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-200"},null,512),[[xe,_.value]])])]),i.value.length>0?(o(),d("div",eo,[e("div",to,[e("span",so,w(i.value.length)+" etiqueta"+w(i.value.length!==1?"s":"")+" seleccionada"+w(i.value.length!==1?"s":""),1),e("button",{onClick:k,class:"text-xs text-red-600 hover:text-red-700 font-medium px-2 py-1 rounded-md hover:bg-red-50 transition-all duration-200"}," Limpiar todo ")])])):N("",!0),e("div",oo,[!F.value&&q.value.length===0&&_.value.trim()===""?(o(),d("div",ro,[s(t(tt),{class:"h-8 w-8 text-gray-300 mx-auto mb-2"}),lo])):N("",!0),!F.value&&q.value.length===0&&_.value.trim()!==""?(o(),d("div",ao,[s(t($e),{class:"h-8 w-8 text-gray-300 mx-auto mb-2"}),e("p",no,'Sin resultados para "'+w(_.value)+'"',1),e("button",{onClick:O[1]||(O[1]=K=>_.value=""),class:"text-xs text-primary hover:text-primary-dark mt-2 font-medium"}," Ver todas las etiquetas ")])):N("",!0),F.value?(o(),d("div",io,uo)):N("",!0),!F.value&&q.value.length>0?(o(),d("div",mo,[(o(!0),d(se,null,ae(q.value,K=>(o(),d("div",{key:K.id,class:"group flex items-center px-4 py-2.5 hover:bg-gray-50 cursor-pointer transition-colors duration-150",onClick:ne=>I(K)},[e("div",po,[e("div",ho,[e("input",{id:`tag-${K.id}`,type:"checkbox",checked:L(K),onChange:ne=>I(K),class:"sr-only"},null,40,fo),e("div",{class:C(["w-4 h-4 border-2 rounded transition-all duration-200 flex items-center justify-center",L(K)?"bg-primary border-primary":"border-gray-300 group-hover:border-gray-400"])},[L(K)?(o(),d("svg",yo,bo)):N("",!0)],2)])]),e("div",vo,[e("div",{class:"w-3 h-3 rounded-full mr-2.5 border flex-shrink-0 shadow-sm",style:De({backgroundColor:b(K).hex})},null,4),e("span",_o,w(K.name),1)])],8,go))),128))])):N("",!0)])])):N("",!0)]),_:1})]),i.value.length>0?(o(),d("div",wo,[e("div",$o,[ko,e("div",Co,[(o(!0),d(se,null,ae(i.value,K=>(o(),d("div",{key:K.id,class:"group inline-flex items-center pl-2.5 pr-1.5 py-1.5 rounded-lg text-xs font-medium border shadow-sm cursor-pointer transition-all duration-200 hover:shadow-md",style:De({backgroundColor:b(K).hex+"20",borderColor:b(K).hex+"40",color:b(K).dark}),onClick:ne=>I(K)},[e("div",{class:"w-2 h-2 rounded-full mr-2 flex-shrink-0",style:De({backgroundColor:b(K).hex})},null,4),e("span",So,w(K.name),1),e("div",Eo,[s(t(he),{class:"h-3 w-3 opacity-60 group-hover:opacity-100"})])],12,Do))),128))])])])):N("",!0)]))}},To=ze(Fo,[["__scopeId","data-v-d403a707"]]),Lo={class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},Ao={class:"bg-white rounded-xl shadow-xl max-w-5xl w-full max-h-[90vh] overflow-hidden"},Io={class:"border-b"},Mo={class:"hidden sm:flex justify-between items-center p-6"},jo=e("h3",{class:"text-lg font-semibold text-gray-900"},"Agregar Documentos",-1),Bo={class:"text-sm text-gray-600"},Uo={class:"sm:hidden p-4"},No={class:"flex justify-between items-start mb-2"},Po={class:"flex-1 min-w-0 mr-3"},qo=e("h3",{class:"text-lg font-semibold text-gray-900"},"Agregar Documentos",-1),zo={class:"text-sm text-gray-600 truncate"},Ro={class:"border-b"},Oo={class:"hidden sm:flex space-x-8 px-6","aria-label":"Tabs"},Vo=["onClick"],Qo={class:"ml-2 bg-gray-100 text-gray-600 py-0.5 px-2 rounded-full text-xs"},Go={class:"sm:hidden relative px-4 py-3"},Zo={class:"flex items-center"},Ho={class:"ml-2 bg-gray-100 text-gray-600 py-0.5 px-2 rounded-full text-xs"},Wo=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1),Ko=[Wo],Jo={class:"absolute top-full left-4 right-4 z-50 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg overflow-hidden"},Yo=["onClick"],Xo={class:"border-b bg-gray-50 p-4 sm:p-6"},er={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},tr={class:"flex-1"},sr={key:0,class:"flex items-center gap-3"},or={class:"text-sm text-gray-600"},rr={class:"p-4 sm:p-6 overflow-y-auto max-h-[calc(90vh-350px)]"},lr={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4"},ar={key:4,class:"absolute top-2 left-2 w-6 h-6 bg-primary text-white rounded-full flex items-center justify-center shadow-sm"},nr={key:0,class:"text-center py-8 sm:py-12"},ir={class:"text-lg font-medium text-gray-900 mb-2"},dr={class:"text-gray-600 text-sm sm:text-base"},cr={class:"border-t bg-gray-50"},ur={class:"hidden sm:flex justify-between items-center p-6"},mr={class:"text-sm text-gray-600"},gr={class:"flex gap-3"},pr=["disabled"],hr={class:"sm:hidden p-4 space-y-3"},fr={class:"text-center text-sm text-gray-600"},yr={class:"flex gap-3"},xr=["disabled"],br={__name:"AddDocumentsModal",props:{isVisible:{type:Boolean,required:!0},folder:{type:Object,default:null}},emits:["close","add-documents"],setup(a,{emit:x}){const h=a,$=x,E=be(),S=ke(),i=U([]),F=U([]),_=U("my-documents"),y=U(!1),q=U(!1),b=[{name:"my-documents",label:"Mis Documentos"},{name:"use-documents",label:"Formatos Disponibles"},{name:"pending-signatures",label:"Firmas Pendientes"},{name:"signed-documents",label:"Documentos Firmados"}],P=z(()=>S.currentUser);ge(()=>h.isVisible,M=>{M&&(i.value=[],F.value=[],_.value="my-documents")}),ge(_,()=>{i.value=[]}),ge(F,()=>{i.value=[]},{deep:!0});const L=z(()=>{const M=k(_.value);return M.length===0?!1:M.every(B=>i.value.includes(B.id))}),I=M=>{var j;if(!h.folder)return[];const B=h.folder.documents.map(p=>p.id);let Q=[];switch(M){case"my-documents":Q=E.progressAndCompletedDocumentsByClient((j=P.value)==null?void 0:j.id);break;case"use-documents":Q=E.publishedDocumentsUnassigned;break;case"pending-signatures":Q=E.documents.filter(p=>{var c,l;return p.state==="PendingSignatures"&&(p.assigned_to===((c=P.value)==null?void 0:c.id)||((l=p.signatures)==null?void 0:l.some(f=>{var V;return f.signer_email===((V=P.value)==null?void 0:V.email)})))});break;case"signed-documents":Q=E.documents.filter(p=>{var c,l;return p.state==="FullySigned"&&(p.assigned_to===((c=P.value)==null?void 0:c.id)||((l=p.signatures)==null?void 0:l.some(f=>{var V;return f.signer_email===((V=P.value)==null?void 0:V.email)})))});break;default:Q=[]}return Q.filter(p=>!B.includes(p.id))},k=M=>{const B=I(M);if(!F.value||F.value.length===0)return B;const Q=F.value.map(j=>j.id);return B.filter(j=>!j.tags||j.tags.length===0?!1:j.tags.some(p=>Q.includes(p.id)))},A=M=>{const B=i.value.indexOf(M);B>-1?i.value.splice(B,1):i.value.push(M)},T=()=>{const B=k(_.value).map(Q=>Q.id);if(L.value)i.value=i.value.filter(Q=>!B.includes(Q));else{const Q=B.filter(j=>!i.value.includes(j));i.value.push(...Q)}},O=()=>{$("close")},K=async()=>{if(i.value.length!==0){y.value=!0;try{await $("add-documents",i.value)}finally{y.value=!1}}},ne=M=>{_.value=M,q.value=!1},Y=M=>{M.target.closest(".relative")||(q.value=!1)};return ve(()=>{document.addEventListener("click",Y)}),Ie(()=>{document.removeEventListener("click",Y)}),(M,B)=>a.isVisible&&a.folder?(o(),le(Ee,{key:0},{default:n(()=>{var Q;return[e("div",Lo,[e("div",Ao,[e("div",Io,[e("div",Mo,[e("div",null,[jo,e("p",Bo,'Selecciona documentos para agregar a "'+w(a.folder.name)+'"',1)]),e("button",{onClick:O,class:"text-gray-400 hover:text-gray-500 hover:bg-gray-100 p-2 rounded-lg transition-colors"},[s(t(he),{class:"w-5 h-5"})])]),e("div",Uo,[e("div",No,[e("div",Po,[qo,e("p",zo,'Para "'+w(a.folder.name)+'"',1)]),e("button",{onClick:O,class:"text-gray-400 hover:text-gray-500 hover:bg-gray-100 p-2 rounded-lg transition-colors flex-shrink-0"},[s(t(he),{class:"w-5 h-5"})])])])]),e("div",Ro,[e("nav",Oo,[(o(),d(se,null,ae(b,j=>e("button",{key:j.name,onClick:p=>_.value=j.name,class:C([_.value===j.name?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])},[X(w(j.label)+" ",1),e("span",Qo,w(k(j.name).length),1)],10,Vo)),64))]),e("div",Go,[e("button",{onClick:B[0]||(B[0]=j=>q.value=!q.value),class:"w-full flex items-center justify-between py-3 px-4 bg-white border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary"},[e("div",Zo,[e("span",null,w(((Q=b.find(j=>j.name===_.value))==null?void 0:Q.label)||"Seleccionar categor√≠a"),1),e("span",Ho,w(k(_.value).length),1)]),(o(),d("svg",{class:C(["ml-2 h-5 w-5 transition-transform duration-200",q.value?"transform rotate-180":""]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ko,2))]),me(e("div",Jo,[(o(),d(se,null,ae(b,j=>e("button",{key:j.name,onClick:p=>ne(j.name),class:C(["w-full text-left px-4 py-3 text-sm transition-colors duration-150 flex items-center justify-between",_.value===j.name?"bg-primary text-white":"text-gray-700 hover:bg-gray-50"])},[e("span",null,w(j.label),1),e("span",{class:C(["py-0.5 px-2 rounded-full text-xs",_.value===j.name?"bg-white/20 text-white":"bg-gray-100 text-gray-600"])},w(k(j.name).length),3)],10,Yo)),64))],512),[[Le,q.value]])])]),e("div",Xo,[e("div",er,[e("div",tr,[s(To,{modelValue:F.value,"onUpdate:modelValue":B[1]||(B[1]=j=>F.value=j),class:"max-w-md"},null,8,["modelValue"])]),k(_.value).length>0?(o(),d("div",sr,[e("span",or,w(k(_.value).length)+" documento(s) disponible(s) ",1),e("button",{onClick:T,class:C(["px-4 py-2 rounded-lg border font-medium text-sm transition-colors",L.value?"bg-red-50 border-red-200 text-red-700 hover:bg-red-100":"bg-primary text-white border-primary hover:bg-primary-dark"])},w(L.value?"Deseleccionar todos":"Seleccionar todos"),3)])):N("",!0)])]),e("div",rr,[e("div",lr,[(o(!0),d(se,null,ae(k(_.value),j=>(o(),d("div",{key:j.id,class:"relative"},[_.value==="my-documents"?(o(),le(t(wt),{key:0,document:j,"highlighted-doc-id":null,"show-tags":!0,"show-client-name":!1,"menu-options":[],"disable-internal-actions":!0,"additional-classes":i.value.includes(j.id)?"ring-2 ring-primary bg-primary-50":"",onClick:p=>A(j.id)},null,8,["document","additional-classes","onClick"])):N("",!0),_.value==="use-documents"?(o(),le(t(Gt),{key:1,document:j,"show-tags":!0,"menu-options":[],"show-menu-options":!1,"disable-internal-actions":!0,"additional-classes":i.value.includes(j.id)?"ring-2 ring-primary bg-primary-50":"",onClick:p=>A(j.id)},null,8,["document","additional-classes","onClick"])):N("",!0),_.value==="pending-signatures"?(o(),le(t(et),{key:2,document:j,"highlighted-doc-id":null,"show-tags":!0,"menu-options":[],"disable-internal-actions":!0,"additional-classes":i.value.includes(j.id)?"ring-2 ring-primary bg-primary-50":"",onClick:p=>A(j.id)},null,8,["document","additional-classes","onClick"])):N("",!0),_.value==="signed-documents"?(o(),le(t(et),{key:3,document:j,"highlighted-doc-id":null,"show-tags":!0,"menu-options":[],"disable-internal-actions":!0,"additional-classes":i.value.includes(j.id)?"ring-2 ring-primary bg-primary-50":"",onClick:p=>A(j.id)},null,8,["document","additional-classes","onClick"])):N("",!0),i.value.includes(j.id)?(o(),d("div",ar,[s(t(Dt),{class:"w-4 h-4"})])):N("",!0)]))),128))]),k(_.value).length===0?(o(),d("div",nr,[s(t(We),{class:"w-12 h-12 sm:w-16 sm:h-16 text-gray-300 mx-auto mb-4"}),e("h4",ir,w(F.value.length>0?"No hay documentos que coincidan con el filtro":"No hay documentos disponibles"),1),e("p",dr,w(F.value.length>0?"Intenta ajustar los filtros de etiquetas o selecciona otra categor√≠a":"No tienes documentos de esta categor√≠a que no est√©n ya en la carpeta"),1)])):N("",!0)]),e("div",cr,[e("div",ur,[e("div",mr,w(i.value.length)+" documento(s) seleccionado(s) ",1),e("div",gr,[e("button",{onClick:O,class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"}," Cancelar "),e("button",{onClick:K,disabled:i.value.length===0||y.value,class:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},w(y.value?"Agregando...":`Agregar ${i.value.length} documento(s)`),9,pr)])]),e("div",hr,[e("div",fr,w(i.value.length)+" documento(s) seleccionado(s) ",1),e("div",yr,[e("button",{onClick:O,class:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-center font-medium"}," Cancelar "),e("button",{onClick:K,disabled:i.value.length===0||y.value,class:"flex-1 px-4 py-3 bg-primary text-white rounded-lg hover:bg-primary-dark disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-center font-medium"},w(y.value?"Agregando...":"Agregar"),9,xr)])])])])])]}),_:1})):N("",!0)}},je=a=>(Pe("data-v-9d7e4724"),a=a(),qe(),a),vr={class:"folders-table",style:{overflow:"visible !important"}},_r={key:0,style:{overflow:"visible !important"}},wr={style:{overflow:"visible !important"}},$r={class:"min-w-full divide-y divide-gray-200",style:{overflow:"visible !important"}},kr=je(()=>e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Carpeta "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Documentos "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Creada "),e("th",{scope:"col",class:"w-16 px-6 py-3"})])],-1)),Cr={class:"bg-white divide-y divide-gray-200",style:{overflow:"visible !important"}},Dr=["onClick"],Sr={class:"px-6 py-4 whitespace-nowrap"},Er={class:"flex items-center"},Fr={class:"flex-shrink-0 h-10 w-10"},Tr={class:"ml-4"},Lr={class:"text-sm font-medium text-gray-900"},Ar={class:"px-6 py-4 whitespace-nowrap"},Ir={class:"flex items-center gap-2"},Mr={class:"text-sm text-gray-900"},jr={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Br={class:"py-1"},Ur=["onClick"],Nr=["onClick"],Pr=["onClick"],qr=["onClick"],zr={key:1,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center"},Rr=je(()=>e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No tienes carpetas a√∫n",-1)),Or=je(()=>e("p",{class:"text-gray-600 mb-6"},"Crea tu primera carpeta para organizar tus documentos",-1)),Vr={key:2,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center"},Qr=je(()=>e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No se encontraron carpetas",-1)),Gr=je(()=>e("p",{class:"text-gray-600"},"No hay carpetas que coincidan con tu b√∫squeda",-1)),Zr={key:3,class:"flex justify-center items-center py-12"},Hr=je(()=>e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"},null,-1)),Wr=[Hr],Kr={__name:"FoldersTable",props:{sortedFolders:{type:Array,required:!0},searchQuery:{type:String,default:""},isLoading:{type:Boolean,default:!1}},emits:["folder-click","edit-folder","delete-folder","add-documents","create-folder"],setup(a,{emit:x}){const h=a,$=x,E=z(()=>{if(!h.searchQuery.trim())return h.sortedFolders;const L=h.searchQuery.toLowerCase();return h.sortedFolders.filter(I=>I.name.toLowerCase().includes(L))}),S=[{name:"blue",hex:"#3B82F6"},{name:"purple",hex:"#8B5CF6"},{name:"pink",hex:"#EC4899"},{name:"green",hex:"#10B981"},{name:"yellow",hex:"#F59E0B"},{name:"red",hex:"#EF4444"},{name:"indigo",hex:"#6366F1"},{name:"teal",hex:"#14B8A6"}],i=L=>{if(L.color)return S.find(k=>k.name===L.color)||S[0];const I=L.id%S.length;return S[I]},F=L=>{if(!L)return"-";const I=new Date(L),A=Math.abs(new Date-I),T=Math.ceil(A/(1e3*60*60*24));return T===0?"Hoy":T===1?"Ayer":T<7?`Hace ${T} d√≠as`:T<30?`Hace ${Math.floor(T/7)} semanas`:T<365?`Hace ${Math.floor(T/30)} meses`:I.toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"})},_=L=>{$("folder-click",L)},y=L=>{$("edit-folder",L)},q=L=>{$("delete-folder",L)},b=L=>{$("add-documents",L)},P=()=>{$("create-folder")};return(L,I)=>(o(),d("div",vr,[!a.isLoading&&E.value.length>0?(o(),d("div",_r,[e("div",wr,[e("table",$r,[kr,e("tbody",Cr,[(o(!0),d(se,null,ae(E.value,k=>{var A,T;return o(),d("tr",{key:k.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",style:{overflow:"visible !important"},onClick:O=>_(k)},[e("td",Sr,[e("div",Er,[e("div",Fr,[e("div",{class:"h-10 w-10 rounded-lg flex items-center justify-center",style:De({backgroundColor:i(k).hex+"20"})},[s(t(Qe),{class:"h-6 w-6",style:De({color:i(k).hex})},null,8,["style"])],4)]),e("div",Tr,[e("div",Lr,w(k.name),1)])])]),e("td",Ar,[e("div",Ir,[s(t(_e),{class:"h-5 w-5 text-gray-400"}),e("span",Mr,w(((A=k.documents)==null?void 0:A.length)||0)+" documento"+w((((T=k.documents)==null?void 0:T.length)||0)!==1?"s":""),1)])]),e("td",jr,w(F(k.created_at)),1),e("td",{class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",style:{overflow:"visible !important"},onClick:I[0]||(I[0]=pe(()=>{},["stop"]))},[s(t(ie),{as:"div",class:"relative inline-block text-left",style:{overflow:"visible !important"}},{default:n(()=>[s(t(de),{class:"inline-flex items-center justify-center w-8 h-8 rounded-md hover:bg-gray-100"},{default:n(()=>[s(t(we),{class:"h-5 w-5 text-gray-500"})]),_:1}),s(t(ce),{class:"absolute right-0 z-[9999] mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:n(()=>[e("div",Br,[s(t(H),null,{default:n(({active:O})=>[e("a",{onClick:K=>_(k),class:C([O?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Ver carpeta ",10,Ur)]),_:2},1024),s(t(H),null,{default:n(({active:O})=>[e("a",{onClick:K=>b(k),class:C([O?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Agregar documentos ",10,Nr)]),_:2},1024),s(t(H),null,{default:n(({active:O})=>[e("a",{onClick:K=>y(k),class:C([O?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Editar ",10,Pr)]),_:2},1024),s(t(H),null,{default:n(({active:O})=>[e("a",{onClick:K=>q(k),class:C([O?"bg-gray-100":"","block px-4 py-2 text-sm text-red-600 cursor-pointer"])}," Eliminar ",10,qr)]),_:2},1024)])]),_:2},1024)]),_:2},1024)])],8,Dr)}),128))])])])])):!a.isLoading&&a.sortedFolders.length===0?(o(),d("div",zr,[s(t(Qe),{class:"w-16 h-16 text-gray-300 mx-auto mb-4"}),Rr,Or,e("button",{onClick:P,class:"inline-flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors"},[s(t(Ce),{class:"w-5 h-5"}),X(" Crear Primera Carpeta ")])])):!a.isLoading&&a.sortedFolders.length>0&&E.value.length===0?(o(),d("div",Vr,[s(t(Qe),{class:"w-16 h-16 text-gray-300 mx-auto mb-4"}),Qr,Gr])):N("",!0),a.isLoading?(o(),d("div",Zr,Wr)):N("",!0)]))}},Jr=ze(Kr,[["__scopeId","data-v-9d7e4724"]]),lt=a=>(Pe("data-v-ab5666d5"),a=a(),qe(),a),Yr={class:"folder-management"},Xr={class:"mb-6"},el={class:"hidden sm:flex justify-between items-center"},tl=lt(()=>e("div",null,[e("h2",{class:"text-xl font-semibold text-gray-900"},"Mis Carpetas"),e("p",{class:"text-sm text-gray-600 mt-1"},"Organiza tus documentos, firmas y formatos en carpetas personalizadas")],-1)),sl={class:"sm:hidden"},ol=lt(()=>e("div",{class:"text-center mb-4"},[e("h2",{class:"text-xl font-semibold text-gray-900"},"Mis Carpetas"),e("p",{class:"text-sm text-gray-600 mt-1 px-2"},"Organiza tus documentos, firmas y formatos en carpetas personalizadas")],-1)),rl={__name:"FolderManagement",props:{searchQuery:{type:String,default:""},selectedTags:{type:Array,default:()=>[]}},emits:["refresh","navigate-to-main"],setup(a,{emit:x}){const h=a,$=x,E=Ke(),S=be(),i=ke(),F=U(!1),_=U(null),y=U(null),q=U(!1),b=U(null),P=z(()=>E.isLoading),L=z(()=>E.sortedFolders);z(()=>i.currentUser),ve(async()=>{await E.init(),await S.init()}),ge(()=>h.searchQuery,()=>{}),ge(()=>E.folders,f=>{var V,ee;if(y.value&&f&&f.length>0){const oe=f.find(W=>W.id===y.value.id);if(oe){const W=((V=y.value.documents)==null?void 0:V.length)||0,G=((ee=oe.documents)==null?void 0:ee.length)||0;JSON.stringify(y.value)!==JSON.stringify(oe)&&(y.value={...oe},console.log(`üîÑ FolderManagement: Synced selectedFolder "${oe.name}" with store. Documents: ${W} ‚Üí ${G}`))}}},{deep:!0});const I=()=>{_.value=null,F.value=!0},k=f=>{_.value=f,F.value=!0},A=()=>{F.value=!1,_.value=null},T=()=>{A()},O=f=>{y.value=f},K=()=>{y.value=null},ne=async f=>{if(confirm(`¬øEst√°s seguro de que quieres eliminar la carpeta "${f.name}"?`))try{await E.deleteFolder(f.id),ue(`Carpeta "${f.name}" eliminada correctamente`,"success")}catch(V){ue("Error al eliminar la carpeta","error"),console.error("Error deleting folder:",V)}},Y=f=>{b.value=f,q.value=!0},M=async(f=!1)=>{if(q.value=!1,b.value=null,f&&y.value)try{await B()}catch(V){console.warn("Error refreshing folder after adding documents:",V)}},B=async()=>{if(y.value)try{await E.fetchFolderById(y.value.id,!0);const f=E.getFolderById(y.value.id);f&&(y.value={...f},console.log("‚úÖ Selected folder refreshed successfully"))}catch(f){throw console.error("‚ùå Error refreshing selected folder:",f),f}},Q=async f=>{var V,ee,oe;if(!(!b.value||f.length===0))try{const W=b.value.documents.map(te=>te.id).filter(te=>te!=null&&!isNaN(parseInt(te))).map(te=>parseInt(te)),G=f.filter(te=>te!=null&&!isNaN(parseInt(te))).map(te=>parseInt(te)),R=[...new Set([...W,...G])];if(console.log("Current document IDs:",W),console.log("Selected document IDs:",G),console.log("Updated document IDs:",R),R.some(te=>!Number.isInteger(te)||te<=0))throw new Error("IDs de documentos inv√°lidos detectados");await E.updateFolder(b.value.id,{document_ids:R}),await M(!0),ue(`${G.length} documento(s) agregado(s) a la carpeta`,"success"),$("navigate-to-main")}catch(W){console.error("Error adding documents to folder:",W),console.error("Error details:",((V=W.response)==null?void 0:V.data)||W.message),(ee=W.response)!=null&&ee.status?ue(`Error al agregar documentos: ${((oe=W.response.data)==null?void 0:oe.detail)||W.message}`,"error"):ue("Error al agregar documentos a la carpeta","error")}},j=async f=>{var V,ee,oe;if(y.value)try{const W=parseInt(f);if(!Number.isInteger(W)||W<=0)throw new Error("ID de documento inv√°lido");const G=y.value.documents.map(R=>R.id).filter(R=>R!=null&&!isNaN(parseInt(R))).map(R=>parseInt(R)).filter(R=>R!==W);console.log("Removing document ID:",W),console.log("Updated document IDs after removal:",G),await E.updateFolder(y.value.id,{document_ids:G}),ue("Documento removido de la carpeta","success"),y.value=null,$("navigate-to-main");try{await E.fetchFolderById(y.value.id,!0);const R=E.getFolderById(y.value.id);R&&(y.value=R),console.log("Folder data refreshed successfully after removal")}catch(R){console.warn("Error refreshing folder data:",R);try{y.value={...y.value,documents:y.value.documents.filter(te=>te.id!==W)},console.log("Applied optimistic removal for document ID:",W)}catch(te){console.warn("Optimistic update failed:",te)}}}catch(W){console.error("Error removing document from folder:",W),console.error("Error details:",((V=W.response)==null?void 0:V.data)||W.message),(ee=W.response)!=null&&ee.status?ue(`Error al remover documento: ${((oe=W.response.data)==null?void 0:oe.detail)||W.message}`,"error"):ue("Error al remover el documento de la carpeta","error")}},p=f=>{console.log("View document:",f)},c=f=>{console.log("Use document:",f)},l=(f,V)=>{console.log("Document action:",f,V)};return(f,V)=>(o(),d("div",Yr,[e("div",Xr,[e("div",el,[tl,e("button",{onClick:I,class:"inline-flex items-center gap-2 px-4 py-2.5 bg-primary text-white rounded-xl hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-all duration-200 shadow-sm hover:shadow-md"},[s(t(Ce),{class:"w-5 h-5"}),X(" Nueva Carpeta ")])]),e("div",sl,[ol,e("button",{onClick:I,class:"w-full flex items-center justify-center gap-3 px-4 py-4 bg-primary text-white rounded-xl hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-all duration-200 shadow-sm hover:shadow-md font-medium text-base"},[s(t(Ce),{class:"w-6 h-6"}),X(" Nueva Carpeta ")])])]),s(t(Jr),{"sorted-folders":L.value,"search-query":a.searchQuery,"is-loading":P.value,onFolderClick:O,onEditFolder:k,onDeleteFolder:ne,onAddDocuments:Y,onCreateFolder:I},null,8,["sorted-folders","search-query","is-loading"]),s(t(ds),{"is-visible":F.value,"editing-folder":_.value,onClose:A,onSuccess:T},null,8,["is-visible","editing-folder"]),s(t(Os),{folder:y.value,onClose:K,onAddDocuments:Y,onRemoveDocument:j,onViewDocument:p,onUseDocument:c,onDocumentAction:l},null,8,["folder"]),s(t(br),{"is-visible":q.value,folder:b.value,onClose:M,onAddDocuments:Q},null,8,["is-visible","folder"])]))}},ll=ze(rl,[["__scopeId","data-v-ab5666d5"]]),al={class:"document-list-client-table",style:{overflow:"visible !important"}},nl={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6",style:{overflow:"visible !important"}},il={class:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between"},dl={class:"flex flex-col sm:flex-row gap-3 flex-1 w-full lg:w-auto"},cl={class:"relative flex-1 min-w-[200px]"},ul={class:"max-w-[120px] truncate"},ml={class:"p-2"},gl={class:"relative mb-2"},pl={class:"max-h-60 overflow-y-auto"},hl=["onClick"],fl={class:"truncate"},yl={key:0,class:"px-3 py-2 text-sm text-gray-500 text-center"},xl={class:"flex items-center gap-3 w-full lg:w-auto"},bl={class:"text-sm text-gray-500 whitespace-nowrap"},vl={class:"py-1"},_l={style:{overflow:"visible !important"}},wl={style:{overflow:"visible !important"}},$l={class:"min-w-full divide-y divide-gray-200",style:{overflow:"visible !important"}},kl=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Documento "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Firma "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etiqueta "),e("th",{scope:"col",class:"w-16 px-6 py-3"})])],-1),Cl={class:"bg-white divide-y divide-gray-200",style:{overflow:"visible !important"}},Dl=["onClick"],Sl={class:"px-6 py-4 whitespace-nowrap"},El={class:"flex items-center"},Fl={class:"flex-shrink-0 h-10 w-10"},Tl={class:"h-10 w-10 rounded-lg bg-blue-100 flex items-center justify-center"},Ll={class:"ml-4"},Al={class:"text-sm font-medium text-gray-900"},Il={class:"px-6 py-4 whitespace-nowrap"},Ml={class:"px-6 py-4 whitespace-nowrap"},jl={class:"px-6 py-4 whitespace-nowrap"},Bl={class:"flex flex-wrap gap-1"},Ul={key:0,class:"text-sm text-gray-400"},Nl={class:"py-1"},Pl=["onClick"],ql=["onClick"],zl=["onClick"],Rl=["onClick"],Ol=["onClick"],Vl=["onClick"],Ql=["onClick"],Gl=["onClick"],Zl=["onClick"],Hl=["onClick"],Wl={key:0,class:"text-center py-12"},Kl=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No hay documentos",-1),Jl=e("p",{class:"mt-1 text-sm text-gray-500"},"Los documentos asignados por tu abogado aparecer√°n aqu√≠.",-1),Yl={__name:"DocumentListClientTable",props:{searchQuery:String,selectedTags:{type:Array,default:()=>[]}},emits:["refresh","open-letterhead","open-relationships"],setup(a,{emit:x}){const h=be(),$=ke(),E=Se(),S=x,{activeModals:i,openModal:F,closeModal:_}=xt(h,$),{handlePreviewDocument:y,deleteDocument:q,downloadPDFDocument:b,downloadWordDocument:P}=bt(h,$,S);ge(i,m=>{console.log("activeModals changed:",m)},{deep:!0}),ve(()=>{console.log("DocumentListClientTable mounted"),console.log("activeModals:",i.value),console.log("openModal function:",F),console.log("LetterheadModal component:",Ye),console.log("DocumentRelationshipsModal component:",Xe)});const L=U(""),I=U(""),k=U(null),A=U("recent");ve(()=>{h.init(),$.init()});const T=z(()=>$.getCurrentUser),O=z(()=>T.value?h.progressAndCompletedDocumentsByClient(T.value.id):[]),K=z(()=>{let m=[...O.value];const D=L.value.toLowerCase();return D&&(m=m.filter(v=>{var Z,re;return((Z=v.title)==null?void 0:Z.toLowerCase().includes(D))||((re=v.tags)==null?void 0:re.some(Fe=>{var Je;return(Je=Fe.name)==null?void 0:Je.toLowerCase().includes(D)}))})),k.value&&(m=m.filter(v=>v.tags&&v.tags.some(Z=>Z.id===k.value))),A.value==="name"?m.sort((v,Z)=>{const re=(v.title||"").toLowerCase(),Fe=(Z.title||"").toLowerCase();return re.localeCompare(Fe)}):A.value==="recent"&&m.sort((v,Z)=>Z.id-v.id),m}),ne=z(()=>{const m=new Map;return O.value.forEach(D=>{D.tags&&D.tags.length>0&&D.tags.forEach(v=>{m.has(v.id)||m.set(v.id,v)})}),Array.from(m.values()).sort((D,v)=>D.name.localeCompare(v.name))}),Y=z(()=>{if(!I.value)return ne.value;const m=I.value.toLowerCase();return ne.value.filter(D=>D.name.toLowerCase().includes(m))}),M=z(()=>{if(!k.value)return null;const m=ne.value.find(D=>D.id===k.value);return m?m.name:null}),B=z(()=>{switch(A.value){case"name":return"Nombre (A-Z)";case"recent":default:return"M√°s recientes"}}),Q=m=>m.state==="Completed"?"Completado":m.state==="Progress"?"En Progreso":m.state||"Sin estado",j=m=>m.state==="Completed"?"bg-green-100 text-green-700 border border-green-200":m.state==="Progress"?"bg-blue-100 text-blue-700 border border-blue-200":"bg-gray-100 text-gray-700 border border-gray-200",p=m=>{if(!m.signatures||m.signatures.length===0)return"Sin Firma";if(m.fully_signed)return"Firmado";const D=m.signatures.find(Z=>{var re;return Z.user_id===((re=T.value)==null?void 0:re.id)});return D?D.signed?"Firmado":"Pendiente Firmar":m.signatures.some(Z=>!Z.signed)?"Pendiente Firmar":"Sin Firma"},c=m=>{const D=p(m);return D==="Sin Firma"?"bg-yellow-100 text-yellow-700 border border-yellow-200":D==="Firmado"?"bg-green-100 text-green-700 border border-green-200":D==="Pendiente Firmar"?"bg-blue-100 text-blue-700 border border-blue-200":D==="Devuelto Sin Firma"?"bg-red-100 text-red-700 border border-red-200":"bg-gray-100 text-gray-700 border border-gray-200"},l=m=>{const D=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],v=m.id%D.length;return D[v]},f=m=>{const D=["bg-blue-500","bg-purple-500","bg-pink-500","bg-yellow-500","bg-green-500","bg-red-500","bg-indigo-500","bg-orange-500"],v=m.id%D.length;return D[v]},V=()=>{k.value=null},ee=m=>{const D=`/dynamic_document_dashboard/document/use/editor/${m.id}/${encodeURIComponent(m.title.trim())}`;E.push(D)},oe=m=>{var D;console.log("handleEditForm called",m),F("edit",m,{userRole:((D=$.currentUser)==null?void 0:D.role)||"client"})},W=m=>{console.log("handleEditDocument called",m),E.push(`/dynamic_document_dashboard/client/editor/edit/${m.id}`)},G=async m=>{console.log("handlePreview called",m),await y(m)},R=async m=>{console.log("handleDelete called",m),await q(m)},te=m=>{console.log("handleLetterhead called",m),F("letterhead",m)},J=m=>{console.log("handleRelationships called",m),F("relationships",m)},r=async m=>{console.log("handleDownloadPDF called",m),await b(m)},u=async m=>{console.log("handleDownloadWord called",m),await P(m)},g=m=>{console.log("handleEmail called",m),F("email",m)};return(m,D)=>(o(),d(se,null,[e("div",al,[e("div",nl,[e("div",il,[e("div",dl,[e("div",cl,[s(t($e),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),me(e("input",{"onUpdate:modelValue":D[0]||(D[0]=v=>L.value=v),type:"text",placeholder:"Buscar...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent"},null,512),[[xe,L.value]])]),s(t(ie),{as:"div",class:"relative"},{default:n(()=>[s(t(de),{class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:n(()=>[s(t(Te),{class:"h-4 w-4"}),e("span",ul,w(M.value||"Etiqueta"),1),s(t(ye),{class:"h-4 w-4"})]),_:1}),s(t(ce),{class:"absolute left-0 z-10 mt-2 w-64 origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:n(()=>[e("div",ml,[e("div",gl,[s(t($e),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),me(e("input",{"onUpdate:modelValue":D[1]||(D[1]=v=>I.value=v),type:"text",placeholder:"Buscar etiquetas...",class:"w-full pl-9 pr-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent",onClick:D[2]||(D[2]=pe(()=>{},["stop"]))},null,512),[[xe,I.value]])]),e("div",pl,[s(t(H),null,{default:n(({active:v})=>[e("a",{onClick:D[3]||(D[3]=Z=>k.value=null),class:C([v?"bg-gray-100":"","block px-3 py-2 text-sm text-gray-700 cursor-pointer rounded-md"])}," Todos ",2)]),_:1}),(o(!0),d(se,null,ae(Y.value,v=>(o(),le(t(H),{key:v.id},{default:n(({active:Z})=>[e("a",{onClick:re=>k.value=v.id,class:C([Z?"bg-gray-100":"","flex items-center gap-2 px-3 py-2 text-sm cursor-pointer rounded-md"])},[e("span",{class:C(["w-3 h-3 rounded-full flex-shrink-0",f(v)])},null,2),e("span",fl,w(v.name),1)],10,hl)]),_:2},1024))),128)),Y.value.length===0?(o(),d("div",yl," No se encontraron etiquetas ")):N("",!0)])])]),_:1})]),_:1}),k.value?(o(),d("button",{key:0,onClick:V,class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",title:"Limpiar filtros"},[s(t(he),{class:"h-4 w-4"}),X(" Limpiar ")])):N("",!0)]),e("div",xl,[e("span",bl," Mostrando "+w(K.value.length)+" resultados ",1),s(t(ie),{as:"div",class:"relative"},{default:n(()=>[s(t(de),{class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:n(()=>[X(" Ordenar: "+w(B.value)+" ",1),s(t(ye),{class:"h-4 w-4"})]),_:1}),s(t(ce),{class:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:n(()=>[e("div",vl,[s(t(H),null,{default:n(({active:v})=>[e("a",{onClick:D[4]||(D[4]=Z=>A.value="recent"),class:C([v?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," M√°s recientes ",2)]),_:1}),s(t(H),null,{default:n(({active:v})=>[e("a",{onClick:D[5]||(D[5]=Z=>A.value="name"),class:C([v?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Nombre (A-Z) ",2)]),_:1})])]),_:1})]),_:1})])])]),e("div",_l,[e("div",wl,[e("table",$l,[kl,e("tbody",Cl,[(o(!0),d(se,null,ae(K.value,v=>(o(),d("tr",{key:v.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",style:{overflow:"visible !important"},onClick:Z=>ee(v)},[e("td",Sl,[e("div",El,[e("div",Fl,[e("div",Tl,[s(t(_e),{class:"h-5 w-5 text-blue-600"})])]),e("div",Ll,[e("div",Al,w(v.title),1)])])]),e("td",Il,[e("span",{class:C(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",j(v)])},w(Q(v)),3)]),e("td",Ml,[e("span",{class:C(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",c(v)])},w(p(v)),3)]),e("td",jl,[e("div",Bl,[(o(!0),d(se,null,ae(v.tags,Z=>(o(),d("span",{key:Z.id,class:C(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",l(Z)])},w(Z.name),3))),128)),!v.tags||v.tags.length===0?(o(),d("span",Ul,"-")):N("",!0)])]),e("td",{class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",style:{overflow:"visible !important"},onClick:D[6]||(D[6]=pe(()=>{},["stop"]))},[s(t(ie),{as:"div",class:"relative inline-block text-left",style:{overflow:"visible !important"}},{default:n(()=>[s(t(de),{class:"inline-flex items-center justify-center w-8 h-8 rounded-md hover:bg-gray-100"},{default:n(()=>[s(t(we),{class:"h-5 w-5 text-gray-500"})]),_:1}),s(t(ce),{class:"absolute right-0 z-[9999] mt-2 w-56 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:n(()=>[e("div",Nl,[v.state==="Completed"?(o(),le(t(H),{key:0},{default:n(({active:Z})=>[e("a",{onClick:re=>oe(v),class:C([Z?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Editar Formulario ",10,Pl)]),_:2},1024)):N("",!0),v.state==="Completed"?(o(),le(t(H),{key:1},{default:n(({active:Z})=>[e("a",{onClick:re=>W(v),class:C([Z?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Editar Documento ",10,ql)]),_:2},1024)):N("",!0),v.state!=="Completed"?(o(),le(t(H),{key:2},{default:n(({active:Z})=>[e("a",{onClick:re=>oe(v),class:C([Z?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Completar ",10,zl)]),_:2},1024)):N("",!0),v.state==="Completed"?(o(),le(t(H),{key:3},{default:n(({active:Z})=>[e("a",{onClick:re=>G(v),class:C([Z?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Previsualizar ",10,Rl)]),_:2},1024)):N("",!0),s(t(H),null,{default:n(({active:Z})=>[e("a",{onClick:re=>R(v),class:C([Z?"bg-gray-100":"","block px-4 py-2 text-sm text-red-600 cursor-pointer"])}," Eliminar ",10,Ol)]),_:2},1024),s(t(H),null,{default:n(({active:Z})=>[e("a",{onClick:re=>te(v),class:C([Z?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Gestionar Membrete ",10,Vl)]),_:2},1024),s(t(H),null,{default:n(({active:Z})=>[e("a",{onClick:re=>J(v),class:C([Z?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Administrar Asociaciones ",10,Ql)]),_:2},1024),v.state==="Completed"?(o(),le(t(H),{key:4},{default:n(({active:Z})=>[e("a",{onClick:re=>r(v),class:C([Z?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Descargar PDF ",10,Gl)]),_:2},1024)):N("",!0),v.state==="Completed"?(o(),le(t(H),{key:5},{default:n(({active:Z})=>[e("a",{onClick:re=>u(v),class:C([Z?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Descargar Word ",10,Zl)]),_:2},1024)):N("",!0),v.state==="Completed"?(o(),le(t(H),{key:6},{default:n(({active:Z})=>[e("a",{onClick:re=>g(v),class:C([Z?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Enviar ",10,Hl)]),_:2},1024)):N("",!0)])]),_:2},1024)]),_:2},1024)])],8,Dl))),128))])])]),K.value.length===0?(o(),d("div",Wl,[s(t(Me),{class:"mx-auto h-12 w-12 text-gray-400"}),Kl,Jl])):N("",!0)])]),(o(),le(pt,{to:"body"},[t(i).edit.isOpen?(o(),le(vt,{key:0,document:t(i).edit.document,"user-role":t(i).edit.userRole,onClose:D[7]||(D[7]=v=>t(_)("edit")),onRefresh:D[8]||(D[8]=v=>S("refresh"))},null,8,["document","user-role"])):N("",!0),t(i).email.isOpen?(o(),le(_t,{key:1,document:t(i).email.document,onClose:D[9]||(D[9]=v=>t(_)("email"))},null,8,["document"])):N("",!0),t(i).letterhead.isOpen?(o(),le(Ye,{key:2,"is-visible":!0,document:t(i).letterhead.document,onClose:D[10]||(D[10]=v=>t(_)("letterhead")),onRefresh:D[11]||(D[11]=v=>S("refresh"))},null,8,["document"])):N("",!0),t(i).relationships.isOpen?(o(),le(Xe,{key:3,"is-open":!0,document:t(i).relationships.document,onClose:D[12]||(D[12]=v=>t(_)("relationships")),onRefresh:D[13]||(D[13]=v=>S("refresh"))},null,8,["document"])):N("",!0)]))],64))}},Xl={class:"mb-4"},ea={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6"},ta={class:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between"},sa={class:"flex flex-col sm:flex-row gap-3 flex-1 w-full lg:w-auto"},oa={class:"relative flex-1 min-w-[200px]"},ra={class:"max-w-[120px] truncate"},la={class:"p-2"},aa={class:"relative mb-2"},na={class:"max-h-60 overflow-y-auto"},ia=["onClick"],da={class:"truncate"},ca={key:0,class:"px-3 py-2 text-sm text-gray-500 text-center"},ua={class:"flex items-center gap-3 w-full lg:w-auto"},ma={class:"text-sm text-gray-500 whitespace-nowrap"},ga={class:"py-1"},pa={key:0,class:"bg-white rounded-lg shadow-sm border border-gray-200"},ha={class:"overflow-x-auto"},fa={class:"min-w-full divide-y divide-gray-200"},ya=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Plantilla "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etiquetas "),e("th",{scope:"col",class:"w-16 px-6 py-3"})])],-1),xa={class:"bg-white divide-y divide-gray-200"},ba=["onClick"],va={class:"px-6 py-4 whitespace-nowrap"},_a={class:"flex items-center"},wa={class:"flex-shrink-0 h-10 w-10"},$a={class:"h-10 w-10 rounded-lg bg-purple-100 flex items-center justify-center"},ka={class:"ml-4"},Ca={class:"text-sm font-medium text-gray-900"},Da=e("td",{class:"px-6 py-4 whitespace-nowrap"},[e("span",{class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-purple-100 text-purple-700 border border-purple-200"}," Disponible ")],-1),Sa={class:"px-6 py-4 whitespace-nowrap"},Ea={class:"flex flex-wrap gap-1"},Fa={key:0,class:"text-sm text-gray-400"},Ta={class:"py-1"},La=["onClick"],Aa={key:1,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center"},Ia=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No hay plantillas disponibles",-1),Ma={class:"mt-1 text-sm text-gray-500"},ja=e("div",{class:"mt-4"},[e("div",{class:"text-xs text-gray-400 bg-gray-100 px-3 py-2 rounded-lg inline-block"},[X(" üí° "),e("strong",null,"Tip:"),X(" Las plantillas son creadas por los abogados ")])],-1),Ba={__name:"UseDocumentTable",props:{searchQuery:String,selectedTags:{type:Array,default:()=>[]}},emits:["go-back"],setup(a,{emit:x}){const h=be();ke();const $=Se(),E=x,S=U(""),i=U(""),F=U(null),_=U("recent"),y=z(()=>h.publishedDocumentsUnassigned||[]),q=z(()=>{let Y=[...y.value];const M=S.value.toLowerCase();return M&&(Y=Y.filter(B=>{var Q,j;return((Q=B.title)==null?void 0:Q.toLowerCase().includes(M))||((j=B.tags)==null?void 0:j.some(p=>{var c;return(c=p.name)==null?void 0:c.toLowerCase().includes(M)}))})),F.value&&(Y=Y.filter(B=>B.tags&&B.tags.some(Q=>Q.id===F.value))),_.value==="name"?Y.sort((B,Q)=>{const j=(B.title||"").toLowerCase(),p=(Q.title||"").toLowerCase();return j.localeCompare(p)}):_.value==="recent"&&Y.sort((B,Q)=>Q.id-B.id),Y}),b=z(()=>{const Y=new Map;return y.value.forEach(M=>{M.tags&&M.tags.length>0&&M.tags.forEach(B=>{Y.has(B.id)||Y.set(B.id,B)})}),Array.from(Y.values()).sort((M,B)=>M.name.localeCompare(B.name))}),P=z(()=>{if(!i.value)return b.value;const Y=i.value.toLowerCase();return b.value.filter(M=>M.name.toLowerCase().includes(Y))}),L=z(()=>{if(!F.value)return null;const Y=b.value.find(M=>M.id===F.value);return Y?Y.name:null}),I=z(()=>{switch(_.value){case"name":return"Nombre (A-Z)";case"recent":default:return"M√°s recientes"}}),k=z(()=>{const Y=S.value&&S.value.trim().length>0,M=F.value!==null;return Y&&M?"No se encontraron plantillas que coincidan con tu b√∫squeda y filtros":Y?"No se encontraron plantillas que coincidan con tu b√∫squeda":M?"No se encontraron plantillas con la etiqueta seleccionada":"A√∫n no hay plantillas disponibles para usar"}),A=Y=>{const M=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],B=Y.id%M.length;return M[B]},T=Y=>{const M=["bg-blue-500","bg-purple-500","bg-pink-500","bg-yellow-500","bg-green-500","bg-red-500","bg-indigo-500","bg-orange-500"],B=Y.id%M.length;return M[B]},O=()=>{F.value=null},K=Y=>{const M=`/dynamic_document_dashboard/document/use/editor/${Y.id}/${encodeURIComponent(Y.title.trim())}`;$.push(M)},ne=()=>{E("go-back")};return(Y,M)=>(o(),d("div",null,[e("div",Xl,[e("button",{onClick:ne,class:"inline-flex items-center gap-2 px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 rounded-lg transition-colors border border-gray-300"},[s(t(St),{class:"h-4 w-4"}),X(" Volver a Mis Documentos ")])]),e("div",ea,[e("div",ta,[e("div",sa,[e("div",oa,[s(t($e),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),me(e("input",{"onUpdate:modelValue":M[0]||(M[0]=B=>S.value=B),type:"text",placeholder:"Buscar plantillas...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent"},null,512),[[xe,S.value]])]),s(t(ie),{as:"div",class:"relative"},{default:n(()=>[s(t(de),{class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:n(()=>[s(t(Te),{class:"h-4 w-4"}),e("span",ra,w(L.value||"Etiqueta"),1),s(t(ye),{class:"h-4 w-4"})]),_:1}),s(t(ce),{class:"absolute left-0 z-10 mt-2 w-64 origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:n(()=>[e("div",la,[e("div",aa,[s(t($e),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),me(e("input",{"onUpdate:modelValue":M[1]||(M[1]=B=>i.value=B),type:"text",placeholder:"Buscar etiquetas...",class:"w-full pl-9 pr-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent",onClick:M[2]||(M[2]=pe(()=>{},["stop"]))},null,512),[[xe,i.value]])]),e("div",na,[s(t(H),null,{default:n(({active:B})=>[e("a",{onClick:M[3]||(M[3]=Q=>F.value=null),class:C([B?"bg-gray-100":"","block px-3 py-2 text-sm text-gray-700 cursor-pointer rounded-md"])}," Todos ",2)]),_:1}),(o(!0),d(se,null,ae(P.value,B=>(o(),le(t(H),{key:B.id},{default:n(({active:Q})=>[e("a",{onClick:j=>F.value=B.id,class:C([Q?"bg-gray-100":"","flex items-center gap-2 px-3 py-2 text-sm cursor-pointer rounded-md"])},[e("span",{class:C(["w-3 h-3 rounded-full flex-shrink-0",T(B)])},null,2),e("span",da,w(B.name),1)],10,ia)]),_:2},1024))),128)),P.value.length===0?(o(),d("div",ca," No se encontraron etiquetas ")):N("",!0)])])]),_:1})]),_:1}),F.value?(o(),d("button",{key:0,onClick:O,class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",title:"Limpiar filtros"},[s(t(he),{class:"h-4 w-4"}),X(" Limpiar ")])):N("",!0)]),e("div",ua,[e("span",ma," Mostrando "+w(q.value.length)+" plantillas ",1),s(t(ie),{as:"div",class:"relative"},{default:n(()=>[s(t(de),{class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:n(()=>[X(" Ordenar: "+w(I.value)+" ",1),s(t(ye),{class:"h-4 w-4"})]),_:1}),s(t(ce),{class:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:n(()=>[e("div",ga,[s(t(H),null,{default:n(({active:B})=>[e("a",{onClick:M[4]||(M[4]=Q=>_.value="recent"),class:C([B?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," M√°s recientes ",2)]),_:1}),s(t(H),null,{default:n(({active:B})=>[e("a",{onClick:M[5]||(M[5]=Q=>_.value="name"),class:C([B?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Nombre (A-Z) ",2)]),_:1})])]),_:1})]),_:1})])])]),q.value.length>0?(o(),d("div",pa,[e("div",ha,[e("table",fa,[ya,e("tbody",xa,[(o(!0),d(se,null,ae(q.value,B=>(o(),d("tr",{key:B.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:Q=>K(B)},[e("td",va,[e("div",_a,[e("div",wa,[e("div",$a,[s(t(_e),{class:"h-5 w-5 text-purple-600"})])]),e("div",ka,[e("div",Ca,w(B.title),1)])])]),Da,e("td",Sa,[e("div",Ea,[(o(!0),d(se,null,ae(B.tags,Q=>(o(),d("span",{key:Q.id,class:C(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",A(Q)])},w(Q.name),3))),128)),!B.tags||B.tags.length===0?(o(),d("span",Fa,"-")):N("",!0)])]),e("td",{class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",onClick:M[6]||(M[6]=pe(()=>{},["stop"]))},[s(t(ie),{as:"div",class:"relative inline-block text-left"},{default:n(()=>[s(t(de),{class:"inline-flex items-center justify-center w-8 h-8 rounded-md hover:bg-gray-100"},{default:n(()=>[s(t(we),{class:"h-5 w-5 text-gray-500"})]),_:1}),s(t(ce),{class:"absolute right-0 z-[9999] mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:n(()=>[e("div",Ta,[s(t(H),null,{default:n(({active:Q})=>[e("a",{onClick:j=>K(B),class:C([Q?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Usar plantilla ",10,La)]),_:2},1024)])]),_:2},1024)]),_:2},1024)])],8,ba))),128))])])])])):(o(),d("div",Aa,[s(t(Me),{class:"mx-auto h-12 w-12 text-gray-400"}),Ia,e("p",Ma,w(k.value),1),ja]))]))}},Be=a=>(Pe("data-v-5a067907"),a=a(),qe(),a),Ua={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6"},Na={class:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between"},Pa={class:"flex flex-col sm:flex-row gap-3 flex-1 w-full lg:w-auto"},qa={class:"relative flex-1 min-w-[200px]"},za={class:"max-w-[120px] truncate"},Ra={class:"py-1"},Oa=["onClick"],Va={class:"max-w-[120px] truncate"},Qa={class:"p-2"},Ga={class:"relative mb-2"},Za={class:"max-h-60 overflow-y-auto"},Ha=["onClick"],Wa={class:"truncate"},Ka={key:0,class:"px-3 py-2 text-sm text-gray-500 text-center"},Ja={class:"flex items-center gap-3 w-full lg:w-auto"},Ya={class:"text-sm text-gray-500 whitespace-nowrap"},Xa={class:"py-1"},en={class:"py-1"},tn={class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},sn={class:"overflow-x-auto"},on={class:"min-w-full divide-y divide-gray-200"},rn={class:"bg-gray-50"},ln={scope:"col",class:"w-12 px-6 py-3"},an=["checked"],nn=Be(()=>e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Nombre Minuta ",-1)),dn=Be(()=>e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado ",-1)),cn=Be(()=>e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etiqueta ",-1)),un=Be(()=>e("th",{scope:"col",class:"w-16 px-6 py-3"},null,-1)),mn={class:"bg-white divide-y divide-gray-200"},gn=["onClick"],pn=["checked","onChange"],hn={class:"px-6 py-4 whitespace-nowrap"},fn={class:"flex items-center"},yn={class:"flex-shrink-0 h-10 w-10"},xn={class:"h-10 w-10 rounded-lg bg-blue-100 flex items-center justify-center"},bn={class:"ml-4"},vn={class:"text-sm font-medium text-gray-900"},_n={class:"px-6 py-4 whitespace-nowrap"},wn={class:"px-6 py-4 whitespace-nowrap"},$n={class:"flex flex-wrap gap-1"},kn={key:0,class:"text-sm text-gray-400"},Cn={class:"py-1"},Dn=["onClick"],Sn=["onClick"],En={key:0,class:"text-center py-12"},Fn=Be(()=>e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No hay documentos",-1)),Tn=Be(()=>e("p",{class:"mt-1 text-sm text-gray-500"},"No se encontraron documentos con los filtros seleccionados.",-1)),Ln={__name:"DocumentListLawyer",props:{searchQuery:String,selectedTags:{type:Array,default:()=>[]},promptDocuments:{type:Array,default:null}},setup(a){const x=be(),h=ke(),$=Se(),E=U([]),S=U([]),i=a,F=U(""),_=U(""),y=U(null),q=U(null),b=U("recent"),P=U([]),L=r=>{switch(r.state){case"Published":return"Publicado";case"Draft":return"Borrador";case"Progress":return"En progreso";case"Completed":return"Completado";case"PendingSignatures":return"Pendiente de firmas";case"FullySigned":return"Completamente firmado";default:return"Desconocido"}},I=r=>{switch(r.state){case"Published":case"FullySigned":return"bg-green-100 text-green-700 border border-green-200";case"Draft":case"Progress":return"bg-blue-100 text-blue-700 border border-blue-200";case"PendingSignatures":return"bg-yellow-100 text-yellow-700 border border-yellow-200";case"Completed":return"bg-purple-100 text-purple-700 border border-purple-200";default:return"bg-gray-100 text-gray-700 border border-gray-200"}},k=r=>{const u=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],g=r.id%u.length;return u[g]},A=r=>{switch(r){case"Published":return"Publicado";case"Draft":return"Borrador";case"Progress":return"En progreso";case"Completed":return"Completado";case"PendingSignatures":return"Pendiente de firmas";case"FullySigned":return"Completamente firmado";default:return r}},T=z(()=>{const r=new Set;return M.value.forEach(u=>{u.state&&r.add(u.state)}),Array.from(r).sort()}),O=z(()=>{const r=new Map;return M.value.forEach(u=>{u.tags&&u.tags.length>0&&u.tags.forEach(g=>{r.has(g.id)||r.set(g.id,g)})}),Array.from(r.values()).sort((u,g)=>u.name.localeCompare(g.name))}),K=z(()=>{if(!_.value)return O.value;const r=_.value.toLowerCase();return O.value.filter(u=>u.name.toLowerCase().includes(r))}),ne=z(()=>{if(!q.value)return null;const r=O.value.find(u=>u.id===q.value);return r?r.name:null}),Y=r=>{const u=["bg-blue-500","bg-purple-500","bg-pink-500","bg-yellow-500","bg-green-500","bg-red-500","bg-indigo-500","bg-orange-500"],g=r.id%u.length;return u[g]},M=z(()=>{if(i.promptDocuments)return[];const u=(x.getDocumentsByLawyerId(h.currentUser.id)||[]).filter(D=>D.state!=="FullySigned"),g=i.selectedTags?i.selectedTags.map(D=>D.id):[];return x.filteredDocumentsBySearchAndTags(i.searchQuery,h,g).filter(D=>u.some(v=>v.id===D.id))}),B=z(()=>{if(i.promptDocuments&&i.promptDocuments.length>0){let r=i.promptDocuments.filter(u=>u.title&&u.title.toLowerCase().includes((i.searchQuery||"").toLowerCase()));if(i.selectedTags&&i.selectedTags.length>0){const u=i.selectedTags.map(g=>g.id);r=r.filter(g=>!g.tags||g.tags.length===0?!1:g.tags.some(m=>u.includes(m.id)))}return r}return[]}),Q=z(()=>i.promptDocuments?B.value:M.value),j=z(()=>{let r=[...Q.value];const u=F.value.toLowerCase();return u&&(r=r.filter(g=>{var m,D,v;return((m=g.title)==null?void 0:m.toLowerCase().includes(u))||((D=g.state)==null?void 0:D.toLowerCase().includes(u))||((v=g.tags)==null?void 0:v.some(Z=>{var re;return(re=Z.name)==null?void 0:re.toLowerCase().includes(u)}))})),y.value&&(r=r.filter(g=>g.state===y.value)),q.value&&(r=r.filter(g=>g.tags&&g.tags.some(m=>m.id===q.value))),b.value==="name"?r.sort((g,m)=>{const D=(g.title||"").toLowerCase(),v=(m.title||"").toLowerCase();return D.localeCompare(v)}):b.value==="recent"&&r.sort((g,m)=>m.id-g.id),r}),p=z(()=>{switch(b.value){case"name":return"Nombre (A-Z)";case"recent":default:return"M√°s recientes"}});z(()=>{if(i.promptDocuments)return null;const r=x.lastUpdatedDocumentId,u=localStorage.getItem("lastUpdatedDocumentId"),g=[...M.value];return r&&g.some(v=>String(v.id)===String(r))?r:u&&g.some(v=>String(v.id)===String(u))?u:null});const c=async()=>{try{const r=h.currentUser.id,u=await Ge(`dynamic-documents/user/${r}/pending-documents-full/`),g=await Ge(`dynamic-documents/user/${r}/signed-documents/`);u.status===200&&(E.value=u.data),g.status===200&&(S.value=g.data)}catch(r){console.error("Error fetching lawyer documents:",r),r.response&&(console.error("Error response data:",r.response.data),console.error("Error status:",r.response.status))}};ge(Q,r=>{if(!i.promptDocuments&&x.lastUpdatedDocumentId&&!r.some(g=>String(g.id)===String(x.lastUpdatedDocumentId))&&r.length>0){const m=[...r].sort((D,v)=>v.id-D.id)[0].id;x.lastUpdatedDocumentId=m,localStorage.setItem("lastUpdatedDocumentId",m)}});const l=r=>{r&&setTimeout(()=>{try{const u=document.querySelectorAll(`[data-document-id="${r}"]`);if(u.length>0){const g=u[0];g.classList.remove("animate-pulse-highlight-green","animate-pulse-highlight-blue"),g.offsetWidth,(g.querySelector("[data-document-id]")||g).classList.contains("border-green-400")?g.classList.add("animate-pulse-highlight-green"):g.classList.add("animate-pulse-highlight-blue"),g.scrollIntoView({behavior:"smooth",block:"center"})}}catch(u){console.error("Error forcing highlight:",u)}},100)};window.forceDocumentHighlight=l,ve(async()=>{if(i.promptDocuments)return;await x.init();const r=localStorage.getItem("lastUpdatedDocumentId");r&&(x.lastUpdatedDocumentId=r,setTimeout(()=>{Q.value.some(g=>String(g.id)===String(r))&&l(r)},500)),c()});const f=z(()=>j.value.length>0&&P.value.length===j.value.length),V=()=>{f.value?P.value=[]:P.value=j.value.map(r=>r.id)},ee=r=>{const u=P.value.indexOf(r);u>-1?P.value.splice(u,1):P.value.push(r)},oe=()=>{P.value=j.value.map(r=>r.id)},W=()=>{P.value=[]},G=()=>{y.value=null,q.value=null},R=()=>{const r=P.value.length>0?j.value.filter(re=>P.value.includes(re.id)):j.value,u=["Nombre Minuta","Estado","Etiquetas"],g=r.map(re=>[re.title||"",L(re),re.tags?re.tags.map(Fe=>Fe.name).join(", "):""]),m=[u.join(","),...g.map(re=>re.map(Fe=>`"${Fe}"`).join(","))].join(`
`),D=new Blob([m],{type:"text/csv;charset=utf-8;"}),v=document.createElement("a"),Z=URL.createObjectURL(D);v.setAttribute("href",Z),v.setAttribute("download",`documentos_${new Date().toISOString().split("T")[0]}.csv`),v.style.visibility="hidden",document.body.appendChild(v),v.click(),document.body.removeChild(v)},te=r=>{$.push({name:"dynamic_document_detail",params:{id:r.id}})},J=r=>{$.push({name:"dynamic_document_edit",params:{id:r.id}})};return(r,u)=>(o(),d("div",null,[e("div",Ua,[e("div",Na,[e("div",Pa,[e("div",qa,[s(t($e),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),me(e("input",{"onUpdate:modelValue":u[0]||(u[0]=g=>F.value=g),type:"text",placeholder:"Buscar...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent"},null,512),[[xe,F.value]])]),s(t(ie),{as:"div",class:"relative"},{default:n(()=>[s(t(de),{class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:n(()=>[s(t(Te),{class:"h-4 w-4"}),e("span",za,w(y.value||"Estado"),1),s(t(ye),{class:"h-4 w-4"})]),_:1}),s(t(ce),{class:"absolute left-0 z-10 mt-2 w-56 origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:n(()=>[e("div",Ra,[s(t(H),null,{default:n(({active:g})=>[e("a",{onClick:u[1]||(u[1]=m=>y.value=null),class:C([g?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Todos ",2)]),_:1}),(o(!0),d(se,null,ae(T.value,g=>(o(),le(t(H),{key:g},{default:n(({active:m})=>[e("a",{onClick:D=>y.value=g,class:C([m?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])},w(A(g)),11,Oa)]),_:2},1024))),128))])]),_:1})]),_:1}),s(t(ie),{as:"div",class:"relative"},{default:n(()=>[s(t(de),{class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:n(()=>[s(t(Te),{class:"h-4 w-4"}),e("span",Va,w(ne.value||"Etiqueta"),1),s(t(ye),{class:"h-4 w-4"})]),_:1}),s(t(ce),{class:"absolute left-0 z-10 mt-2 w-64 origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:n(()=>[e("div",Qa,[e("div",Ga,[s(t($e),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),me(e("input",{"onUpdate:modelValue":u[2]||(u[2]=g=>_.value=g),type:"text",placeholder:"Buscar etiquetas...",class:"w-full pl-9 pr-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent",onClick:u[3]||(u[3]=pe(()=>{},["stop"]))},null,512),[[xe,_.value]])]),e("div",Za,[s(t(H),null,{default:n(({active:g})=>[e("a",{onClick:u[4]||(u[4]=m=>q.value=null),class:C([g?"bg-gray-100":"","block px-3 py-2 text-sm text-gray-700 cursor-pointer rounded-md"])}," Todos ",2)]),_:1}),(o(!0),d(se,null,ae(K.value,g=>(o(),le(t(H),{key:g.id},{default:n(({active:m})=>[e("a",{onClick:D=>q.value=g.id,class:C([m?"bg-gray-100":"","flex items-center gap-2 px-3 py-2 text-sm cursor-pointer rounded-md"])},[e("span",{class:C(["w-3 h-3 rounded-full flex-shrink-0",Y(g)])},null,2),e("span",Wa,w(g.name),1)],10,Ha)]),_:2},1024))),128)),K.value.length===0?(o(),d("div",Ka," No se encontraron etiquetas ")):N("",!0)])])]),_:1})]),_:1}),y.value||q.value?(o(),d("button",{key:0,onClick:G,class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",title:"Limpiar filtros"},[s(t(he),{class:"h-4 w-4"}),X(" Limpiar ")])):N("",!0)]),e("div",Ja,[e("span",Ya," Mostrando "+w(j.value.length)+" resultados ",1),s(t(ie),{as:"div",class:"relative"},{default:n(()=>[s(t(de),{class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:n(()=>[X(" Ordenar: "+w(p.value)+" ",1),s(t(ye),{class:"h-4 w-4"})]),_:1}),s(t(ce),{class:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:n(()=>[e("div",Xa,[s(t(H),null,{default:n(({active:g})=>[e("a",{onClick:u[5]||(u[5]=m=>b.value="recent"),class:C([g?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," M√°s recientes ",2)]),_:1}),s(t(H),null,{default:n(({active:g})=>[e("a",{onClick:u[6]||(u[6]=m=>b.value="name"),class:C([g?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Nombre (A-Z) ",2)]),_:1})])]),_:1})]),_:1}),e("button",{onClick:R,class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},[s(t(Re),{class:"h-4 w-4"}),X(" Exportar ")]),s(t(ie),{as:"div",class:"relative"},{default:n(()=>[s(t(de),{class:"inline-flex items-center justify-center w-10 h-10 rounded-md hover:bg-gray-100"},{default:n(()=>[s(t(we),{class:"h-5 w-5 text-gray-500"})]),_:1}),s(t(ce),{class:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:n(()=>[e("div",en,[s(t(H),null,{default:n(({active:g})=>[e("a",{onClick:oe,class:C([g?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Seleccionar todo ",2)]),_:1}),s(t(H),null,{default:n(({active:g})=>[e("a",{onClick:W,class:C([g?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Deseleccionar todo ",2)]),_:1})])]),_:1})]),_:1})])])]),e("div",tn,[e("div",sn,[e("table",on,[e("thead",rn,[e("tr",null,[e("th",ln,[e("input",{type:"checkbox",checked:f.value,onChange:V,class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,an)]),nn,dn,cn,un])]),e("tbody",mn,[(o(!0),d(se,null,ae(j.value,g=>(o(),d("tr",{key:g.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:m=>te(g)},[e("td",{class:"px-6 py-4 whitespace-nowrap",onClick:u[7]||(u[7]=pe(()=>{},["stop"]))},[e("input",{type:"checkbox",checked:P.value.includes(g.id),onChange:m=>ee(g.id),class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,pn)]),e("td",hn,[e("div",fn,[e("div",yn,[e("div",xn,[s(t(_e),{class:"h-5 w-5 text-blue-600"})])]),e("div",bn,[e("div",vn,w(g.title),1)])])]),e("td",_n,[e("span",{class:C(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",I(g)])},w(L(g)),3)]),e("td",wn,[e("div",$n,[(o(!0),d(se,null,ae(g.tags,m=>(o(),d("span",{key:m.id,class:C(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",k(m)])},w(m.name),3))),128)),!g.tags||g.tags.length===0?(o(),d("span",kn,"-")):N("",!0)])]),e("td",{class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",onClick:u[8]||(u[8]=pe(()=>{},["stop"]))},[s(t(ie),{as:"div",class:"relative inline-block text-left"},{default:n(()=>[s(t(de),{class:"inline-flex items-center justify-center w-8 h-8 rounded-md hover:bg-gray-100"},{default:n(()=>[s(t(we),{class:"h-5 w-5 text-gray-500"})]),_:1}),s(t(ce),{class:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:n(()=>[e("div",Cn,[s(t(H),null,{default:n(({active:m})=>[e("a",{onClick:D=>te(g),class:C([m?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Ver detalles ",10,Dn)]),_:2},1024),s(t(H),null,{default:n(({active:m})=>[e("a",{onClick:D=>J(g),class:C([m?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Editar ",10,Sn)]),_:2},1024)])]),_:2},1024)]),_:2},1024)])],8,gn))),128))])])]),j.value.length===0?(o(),d("div",En,[s(t(Me),{class:"mx-auto h-12 w-12 text-gray-400"}),Fn,Tn])):N("",!0)]),s(He,{isVisible:t(Ae),documentData:t(Ze),onClose:u[9]||(u[9]=g=>Ae.value=!1)},null,8,["isVisible","documentData"])]))}},An=ze(Ln,[["__scopeId","data-v-5a067907"]]),In={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6"},Mn={class:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between"},jn={class:"flex flex-col sm:flex-row gap-3 flex-1 w-full lg:w-auto"},Bn={class:"relative flex-1 min-w-[200px]"},Un={class:"max-w-[120px] truncate"},Nn={class:"py-1"},Pn=["onClick"],qn={class:"flex items-center gap-3 w-full lg:w-auto"},zn={class:"text-sm text-gray-500 whitespace-nowrap"},Rn={class:"py-1"},On={class:"py-1"},Vn={class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},Qn={class:"overflow-x-auto"},Gn={class:"min-w-full divide-y divide-gray-200"},Zn={class:"bg-gray-50"},Hn={scope:"col",class:"w-12 px-6 py-3"},Wn=["checked"],Kn=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Nombre Documento ",-1),Jn=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Cliente ",-1),Yn=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado ",-1),Xn=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etiqueta ",-1),ei=e("th",{scope:"col",class:"w-16 px-6 py-3"},null,-1),ti={class:"bg-white divide-y divide-gray-200"},si=["onClick"],oi=["checked","onChange"],ri={class:"px-6 py-4 whitespace-nowrap"},li={class:"flex items-center"},ai={class:"flex-shrink-0 h-10 w-10"},ni={class:"h-10 w-10 rounded-lg bg-green-100 flex items-center justify-center"},ii={class:"ml-4"},di={class:"text-sm font-medium text-gray-900"},ci={class:"px-6 py-4 whitespace-nowrap"},ui={class:"text-sm text-gray-900"},mi=e("td",{class:"px-6 py-4 whitespace-nowrap"},[e("span",{class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-700 border border-green-200"}," Completado ")],-1),gi={class:"px-6 py-4 whitespace-nowrap"},pi={class:"flex flex-wrap gap-1"},hi={key:0,class:"text-sm text-gray-400"},fi={class:"py-1"},yi=["onClick"],xi=["onClick"],bi={key:0,class:"text-center py-12"},vi=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No hay documentos completados",-1),_i=e("p",{class:"mt-1 text-sm text-gray-500"},"Los documentos completados por clientes aparecer√°n aqu√≠.",-1),wi={__name:"DocumentFinishedByClientListTable",props:{searchQuery:String,selectedTags:{type:Array,default:()=>[]}},emits:["refresh"],setup(a,{emit:x}){const h=be(),$=ke(),E=Se(),S=a,i=U(""),F=U(null),_=U("recent"),y=U([]);ve(()=>{h.init(),$.init()});const q=z(()=>{const p=h.completedDocumentsByClient,c=S.selectedTags?S.selectedTags.map(f=>f.id):[];return h.filteredDocumentsBySearchAndTags(S.searchQuery,$,c).filter(f=>p.some(V=>V.id===f.id))}),b=z(()=>{let p=[...q.value];const c=i.value.toLowerCase();return c&&(p=p.filter(l=>{var f,V;return((f=l.title)==null?void 0:f.toLowerCase().includes(c))||((V=l.tags)==null?void 0:V.some(ee=>{var oe;return(oe=ee.name)==null?void 0:oe.toLowerCase().includes(c)}))})),F.value&&(p=p.filter(l=>l.tags&&l.tags.some(f=>f.id===F.value))),_.value==="name"?p.sort((l,f)=>{const V=(l.title||"").toLowerCase(),ee=(f.title||"").toLowerCase();return V.localeCompare(ee)}):_.value==="recent"&&p.sort((l,f)=>f.id-l.id),p}),P=z(()=>{const p=new Map;return q.value.forEach(c=>{c.tags&&c.tags.length>0&&c.tags.forEach(l=>{p.has(l.id)||p.set(l.id,l)})}),Array.from(p.values()).sort((c,l)=>c.name.localeCompare(l.name))}),L=z(()=>{if(!F.value)return null;const p=P.value.find(c=>c.id===F.value);return p?p.name:null}),I=z(()=>{switch(_.value){case"name":return"Nombre (A-Z)";case"recent":default:return"M√°s recientes"}}),k=p=>p.client_name?p.client_name:p.client?`${p.client.first_name||""} ${p.client.last_name||""}`.trim():"Cliente",A=p=>{const c=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],l=p.id%c.length;return c[l]},T=z(()=>b.value.length>0&&y.value.length===b.value.length),O=()=>{T.value?y.value=[]:y.value=b.value.map(p=>p.id)},K=p=>{const c=y.value.indexOf(p);c>-1?y.value.splice(c,1):y.value.push(p)},ne=()=>{y.value=b.value.map(p=>p.id)},Y=()=>{y.value=[]},M=()=>{F.value=null},B=()=>{const p=y.value.length>0?b.value.filter(W=>y.value.includes(W.id)):b.value,c=["Nombre Documento","Cliente","Estado","Etiquetas"],l=p.map(W=>[W.title||"",k(W),"Completado",W.tags?W.tags.map(G=>G.name).join(", "):""]),f=[c.join(","),...l.map(W=>W.map(G=>`"${G}"`).join(","))].join(`
`),V=new Blob([f],{type:"text/csv;charset=utf-8;"}),ee=document.createElement("a"),oe=URL.createObjectURL(V);ee.setAttribute("href",oe),ee.setAttribute("download",`documentos_completados_${new Date().toISOString().split("T")[0]}.csv`),ee.style.visibility="hidden",document.body.appendChild(ee),ee.click(),document.body.removeChild(ee)},Q=p=>{const c=`/dynamic_document_dashboard/document/use/editor/${p.id}/${encodeURIComponent(p.title.trim())}`;E.push(c)},j=p=>{const c=`/dynamic_document_dashboard/document/use/editor/${p.id}/${encodeURIComponent(p.title.trim())}`;E.push(c)};return(p,c)=>(o(),d("div",null,[e("div",In,[e("div",Mn,[e("div",jn,[e("div",Bn,[s(t($e),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),me(e("input",{"onUpdate:modelValue":c[0]||(c[0]=l=>i.value=l),type:"text",placeholder:"Buscar...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent"},null,512),[[xe,i.value]])]),s(t(ie),{as:"div",class:"relative"},{default:n(()=>[s(t(de),{class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:n(()=>[s(t(Te),{class:"h-4 w-4"}),e("span",Un,w(L.value||"Etiqueta"),1),s(t(ye),{class:"h-4 w-4"})]),_:1}),s(t(ce),{class:"absolute left-0 z-10 mt-2 w-56 origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none max-h-60 overflow-y-auto"},{default:n(()=>[e("div",Nn,[s(t(H),null,{default:n(({active:l})=>[e("a",{onClick:c[1]||(c[1]=f=>F.value=null),class:C([l?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Todos ",2)]),_:1}),(o(!0),d(se,null,ae(P.value,l=>(o(),le(t(H),{key:l.id},{default:n(({active:f})=>[e("a",{onClick:V=>F.value=l.id,class:C([f?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])},w(l.name),11,Pn)]),_:2},1024))),128))])]),_:1})]),_:1}),F.value?(o(),d("button",{key:0,onClick:M,class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",title:"Limpiar filtros"},[s(t(he),{class:"h-4 w-4"}),X(" Limpiar ")])):N("",!0)]),e("div",qn,[e("span",zn," Mostrando "+w(b.value.length)+" resultados ",1),s(t(ie),{as:"div",class:"relative"},{default:n(()=>[s(t(de),{class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:n(()=>[X(" Ordenar: "+w(I.value)+" ",1),s(t(ye),{class:"h-4 w-4"})]),_:1}),s(t(ce),{class:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:n(()=>[e("div",Rn,[s(t(H),null,{default:n(({active:l})=>[e("a",{onClick:c[2]||(c[2]=f=>_.value="recent"),class:C([l?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," M√°s recientes ",2)]),_:1}),s(t(H),null,{default:n(({active:l})=>[e("a",{onClick:c[3]||(c[3]=f=>_.value="name"),class:C([l?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Nombre (A-Z) ",2)]),_:1})])]),_:1})]),_:1}),e("button",{onClick:B,class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},[s(t(Re),{class:"h-4 w-4"}),X(" Exportar ")]),s(t(ie),{as:"div",class:"relative"},{default:n(()=>[s(t(de),{class:"inline-flex items-center justify-center w-10 h-10 rounded-md hover:bg-gray-100"},{default:n(()=>[s(t(we),{class:"h-5 w-5 text-gray-500"})]),_:1}),s(t(ce),{class:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:n(()=>[e("div",On,[s(t(H),null,{default:n(({active:l})=>[e("a",{onClick:ne,class:C([l?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Seleccionar todo ",2)]),_:1}),s(t(H),null,{default:n(({active:l})=>[e("a",{onClick:Y,class:C([l?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Deseleccionar todo ",2)]),_:1})])]),_:1})]),_:1})])])]),e("div",Vn,[e("div",Qn,[e("table",Gn,[e("thead",Zn,[e("tr",null,[e("th",Hn,[e("input",{type:"checkbox",checked:T.value,onChange:O,class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,Wn)]),Kn,Jn,Yn,Xn,ei])]),e("tbody",ti,[(o(!0),d(se,null,ae(b.value,l=>(o(),d("tr",{key:l.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:f=>Q(l)},[e("td",{class:"px-6 py-4 whitespace-nowrap",onClick:c[4]||(c[4]=pe(()=>{},["stop"]))},[e("input",{type:"checkbox",checked:y.value.includes(l.id),onChange:f=>K(l.id),class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,oi)]),e("td",ri,[e("div",li,[e("div",ai,[e("div",ni,[s(t(_e),{class:"h-5 w-5 text-green-600"})])]),e("div",ii,[e("div",di,w(l.title),1)])])]),e("td",ci,[e("div",ui,w(k(l)),1)]),mi,e("td",gi,[e("div",pi,[(o(!0),d(se,null,ae(l.tags,f=>(o(),d("span",{key:f.id,class:C(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",A(f)])},w(f.name),3))),128)),!l.tags||l.tags.length===0?(o(),d("span",hi,"-")):N("",!0)])]),e("td",{class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",onClick:c[5]||(c[5]=pe(()=>{},["stop"]))},[s(t(ie),{as:"div",class:"relative inline-block text-left"},{default:n(()=>[s(t(de),{class:"inline-flex items-center justify-center w-8 h-8 rounded-md hover:bg-gray-100"},{default:n(()=>[s(t(we),{class:"h-5 w-5 text-gray-500"})]),_:1}),s(t(ce),{class:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:n(()=>[e("div",fi,[s(t(H),null,{default:n(({active:f})=>[e("a",{onClick:V=>Q(l),class:C([f?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Ver detalles ",10,yi)]),_:2},1024),s(t(H),null,{default:n(({active:f})=>[e("a",{onClick:V=>j(l),class:C([f?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Editar ",10,xi)]),_:2},1024)])]),_:2},1024)]),_:2},1024)])],8,si))),128))])])]),b.value.length===0?(o(),d("div",bi,[s(t(Me),{class:"mx-auto h-12 w-12 text-gray-400"}),vi,_i])):N("",!0)])]))}},$i={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6"},ki={class:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between"},Ci={class:"flex flex-col sm:flex-row gap-3 flex-1 w-full lg:w-auto"},Di={class:"relative flex-1 min-w-[200px]"},Si={class:"max-w-[120px] truncate"},Ei={class:"py-1"},Fi=["onClick"],Ti={class:"flex items-center gap-3 w-full lg:w-auto"},Li={class:"text-sm text-gray-500 whitespace-nowrap"},Ai={class:"py-1"},Ii={class:"py-1"},Mi={class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},ji={class:"overflow-x-auto"},Bi={class:"min-w-full divide-y divide-gray-200"},Ui={class:"bg-gray-50"},Ni={scope:"col",class:"w-12 px-6 py-3"},Pi=["checked"],qi=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Nombre Documento ",-1),zi=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Cliente ",-1),Ri=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado ",-1),Oi=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etiqueta ",-1),Vi=e("th",{scope:"col",class:"w-16 px-6 py-3"},null,-1),Qi={class:"bg-white divide-y divide-gray-200"},Gi=["onClick"],Zi=["checked","onChange"],Hi={class:"px-6 py-4 whitespace-nowrap"},Wi={class:"flex items-center"},Ki={class:"flex-shrink-0 h-10 w-10"},Ji={class:"h-10 w-10 rounded-lg bg-blue-100 flex items-center justify-center"},Yi={class:"ml-4"},Xi={class:"text-sm font-medium text-gray-900"},ed={class:"px-6 py-4 whitespace-nowrap"},td={class:"text-sm text-gray-900"},sd=e("td",{class:"px-6 py-4 whitespace-nowrap"},[e("span",{class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-700 border border-blue-200"}," En Progreso ")],-1),od={class:"px-6 py-4 whitespace-nowrap"},rd={class:"flex flex-wrap gap-1"},ld={key:0,class:"text-sm text-gray-400"},ad={class:"py-1"},nd=["onClick"],id=["onClick"],dd={key:0,class:"text-center py-12"},cd=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No hay documentos en progreso",-1),ud=e("p",{class:"mt-1 text-sm text-gray-500"},"Los documentos en progreso por clientes aparecer√°n aqu√≠.",-1),md={__name:"DocumentInProgressByClientListTable",props:{searchQuery:String,selectedTags:{type:Array,default:()=>[]}},emits:["refresh"],setup(a,{emit:x}){const h=be(),$=ke(),E=Se(),S=a,i=U(""),F=U(null),_=U("recent"),y=U([]);ve(()=>{h.init(),$.init()});const q=z(()=>{const p=h.progressDocumentsByClient,c=S.selectedTags?S.selectedTags.map(f=>f.id):[];return h.filteredDocumentsBySearchAndTags(S.searchQuery,$,c).filter(f=>p.some(V=>V.id===f.id))}),b=z(()=>{let p=[...q.value];const c=i.value.toLowerCase();return c&&(p=p.filter(l=>{var f,V;return((f=l.title)==null?void 0:f.toLowerCase().includes(c))||((V=l.tags)==null?void 0:V.some(ee=>{var oe;return(oe=ee.name)==null?void 0:oe.toLowerCase().includes(c)}))})),F.value&&(p=p.filter(l=>l.tags&&l.tags.some(f=>f.id===F.value))),_.value==="name"?p.sort((l,f)=>{const V=(l.title||"").toLowerCase(),ee=(f.title||"").toLowerCase();return V.localeCompare(ee)}):_.value==="recent"&&p.sort((l,f)=>f.id-l.id),p}),P=z(()=>{const p=new Map;return q.value.forEach(c=>{c.tags&&c.tags.length>0&&c.tags.forEach(l=>{p.has(l.id)||p.set(l.id,l)})}),Array.from(p.values()).sort((c,l)=>c.name.localeCompare(l.name))}),L=z(()=>{if(!F.value)return null;const p=P.value.find(c=>c.id===F.value);return p?p.name:null}),I=z(()=>{switch(_.value){case"name":return"Nombre (A-Z)";case"recent":default:return"M√°s recientes"}}),k=p=>p.client_name?p.client_name:p.client?`${p.client.first_name||""} ${p.client.last_name||""}`.trim():"Cliente",A=p=>{const c=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],l=p.id%c.length;return c[l]},T=z(()=>b.value.length>0&&y.value.length===b.value.length),O=()=>{T.value?y.value=[]:y.value=b.value.map(p=>p.id)},K=p=>{const c=y.value.indexOf(p);c>-1?y.value.splice(c,1):y.value.push(p)},ne=()=>{y.value=b.value.map(p=>p.id)},Y=()=>{y.value=[]},M=()=>{F.value=null},B=()=>{const p=y.value.length>0?b.value.filter(W=>y.value.includes(W.id)):b.value,c=["Nombre Documento","Cliente","Estado","Etiquetas"],l=p.map(W=>[W.title||"",k(W),"En Progreso",W.tags?W.tags.map(G=>G.name).join(", "):""]),f=[c.join(","),...l.map(W=>W.map(G=>`"${G}"`).join(","))].join(`
`),V=new Blob([f],{type:"text/csv;charset=utf-8;"}),ee=document.createElement("a"),oe=URL.createObjectURL(V);ee.setAttribute("href",oe),ee.setAttribute("download",`documentos_en_progreso_${new Date().toISOString().split("T")[0]}.csv`),ee.style.visibility="hidden",document.body.appendChild(ee),ee.click(),document.body.removeChild(ee)},Q=p=>{const c=`/dynamic_document_dashboard/document/use/editor/${p.id}/${encodeURIComponent(p.title.trim())}`;E.push(c)},j=p=>{const c=`/dynamic_document_dashboard/document/use/editor/${p.id}/${encodeURIComponent(p.title.trim())}`;E.push(c)};return(p,c)=>(o(),d("div",null,[e("div",$i,[e("div",ki,[e("div",Ci,[e("div",Di,[s(t($e),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),me(e("input",{"onUpdate:modelValue":c[0]||(c[0]=l=>i.value=l),type:"text",placeholder:"Buscar...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent"},null,512),[[xe,i.value]])]),s(t(ie),{as:"div",class:"relative"},{default:n(()=>[s(t(de),{class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:n(()=>[s(t(Te),{class:"h-4 w-4"}),e("span",Si,w(L.value||"Etiqueta"),1),s(t(ye),{class:"h-4 w-4"})]),_:1}),s(t(ce),{class:"absolute left-0 z-10 mt-2 w-56 origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none max-h-60 overflow-y-auto"},{default:n(()=>[e("div",Ei,[s(t(H),null,{default:n(({active:l})=>[e("a",{onClick:c[1]||(c[1]=f=>F.value=null),class:C([l?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Todos ",2)]),_:1}),(o(!0),d(se,null,ae(P.value,l=>(o(),le(t(H),{key:l.id},{default:n(({active:f})=>[e("a",{onClick:V=>F.value=l.id,class:C([f?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])},w(l.name),11,Fi)]),_:2},1024))),128))])]),_:1})]),_:1}),F.value?(o(),d("button",{key:0,onClick:M,class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",title:"Limpiar filtros"},[s(t(he),{class:"h-4 w-4"}),X(" Limpiar ")])):N("",!0)]),e("div",Ti,[e("span",Li," Mostrando "+w(b.value.length)+" resultados ",1),s(t(ie),{as:"div",class:"relative"},{default:n(()=>[s(t(de),{class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:n(()=>[X(" Ordenar: "+w(I.value)+" ",1),s(t(ye),{class:"h-4 w-4"})]),_:1}),s(t(ce),{class:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:n(()=>[e("div",Ai,[s(t(H),null,{default:n(({active:l})=>[e("a",{onClick:c[2]||(c[2]=f=>_.value="recent"),class:C([l?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," M√°s recientes ",2)]),_:1}),s(t(H),null,{default:n(({active:l})=>[e("a",{onClick:c[3]||(c[3]=f=>_.value="name"),class:C([l?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Nombre (A-Z) ",2)]),_:1})])]),_:1})]),_:1}),e("button",{onClick:B,class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},[s(t(Re),{class:"h-4 w-4"}),X(" Exportar ")]),s(t(ie),{as:"div",class:"relative"},{default:n(()=>[s(t(de),{class:"inline-flex items-center justify-center w-10 h-10 rounded-md hover:bg-gray-100"},{default:n(()=>[s(t(we),{class:"h-5 w-5 text-gray-500"})]),_:1}),s(t(ce),{class:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:n(()=>[e("div",Ii,[s(t(H),null,{default:n(({active:l})=>[e("a",{onClick:ne,class:C([l?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Seleccionar todo ",2)]),_:1}),s(t(H),null,{default:n(({active:l})=>[e("a",{onClick:Y,class:C([l?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Deseleccionar todo ",2)]),_:1})])]),_:1})]),_:1})])])]),e("div",Mi,[e("div",ji,[e("table",Bi,[e("thead",Ui,[e("tr",null,[e("th",Ni,[e("input",{type:"checkbox",checked:T.value,onChange:O,class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,Pi)]),qi,zi,Ri,Oi,Vi])]),e("tbody",Qi,[(o(!0),d(se,null,ae(b.value,l=>(o(),d("tr",{key:l.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:f=>Q(l)},[e("td",{class:"px-6 py-4 whitespace-nowrap",onClick:c[4]||(c[4]=pe(()=>{},["stop"]))},[e("input",{type:"checkbox",checked:y.value.includes(l.id),onChange:f=>K(l.id),class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,Zi)]),e("td",Hi,[e("div",Wi,[e("div",Ki,[e("div",Ji,[s(t(_e),{class:"h-5 w-5 text-blue-600"})])]),e("div",Yi,[e("div",Xi,w(l.title),1)])])]),e("td",ed,[e("div",td,w(k(l)),1)]),sd,e("td",od,[e("div",rd,[(o(!0),d(se,null,ae(l.tags,f=>(o(),d("span",{key:f.id,class:C(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",A(f)])},w(f.name),3))),128)),!l.tags||l.tags.length===0?(o(),d("span",ld,"-")):N("",!0)])]),e("td",{class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",onClick:c[5]||(c[5]=pe(()=>{},["stop"]))},[s(t(ie),{as:"div",class:"relative inline-block text-left"},{default:n(()=>[s(t(de),{class:"inline-flex items-center justify-center w-8 h-8 rounded-md hover:bg-gray-100"},{default:n(()=>[s(t(we),{class:"h-5 w-5 text-gray-500"})]),_:1}),s(t(ce),{class:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:n(()=>[e("div",ad,[s(t(H),null,{default:n(({active:f})=>[e("a",{onClick:V=>Q(l),class:C([f?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Ver detalles ",10,nd)]),_:2},1024),s(t(H),null,{default:n(({active:f})=>[e("a",{onClick:V=>j(l),class:C([f?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Editar ",10,id)]),_:2},1024)])]),_:2},1024)]),_:2},1024)])],8,Gi))),128))])])]),b.value.length===0?(o(),d("div",dd,[s(t(Me),{class:"mx-auto h-12 w-12 text-gray-400"}),cd,ud])):N("",!0)])]))}},gd={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6"},pd={class:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between"},hd={class:"flex flex-col sm:flex-row gap-3 flex-1 w-full lg:w-auto"},fd={class:"relative flex-1 min-w-[200px]"},yd={class:"max-w-[120px] truncate"},xd={class:"p-2"},bd={class:"relative mb-2"},vd={class:"max-h-60 overflow-y-auto"},_d=["onClick"],wd={class:"truncate"},$d={key:0,class:"px-3 py-2 text-sm text-gray-500 text-center"},kd={class:"flex items-center gap-3 w-full lg:w-auto"},Cd={class:"text-sm text-gray-500 whitespace-nowrap"},Dd={class:"py-1"},Sd={class:"py-1"},Ed={class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},Fd={class:"overflow-x-auto"},Td={class:"min-w-full divide-y divide-gray-200"},Ld={class:"bg-gray-50"},Ad={scope:"col",class:"w-12 px-6 py-3"},Id=["checked"],Md=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Nombre Documento ",-1),jd=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado Firma ",-1),Bd=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etiqueta ",-1),Ud=e("th",{scope:"col",class:"w-16 px-6 py-3"},null,-1),Nd={class:"bg-white divide-y divide-gray-200"},Pd=["onClick"],qd=["checked","onChange"],zd={class:"px-6 py-4 whitespace-nowrap"},Rd={class:"flex items-center"},Od={class:"flex-shrink-0 h-10 w-10"},Vd={class:"h-10 w-10 rounded-lg bg-purple-100 flex items-center justify-center"},Qd={class:"ml-4"},Gd={class:"text-sm font-medium text-gray-900"},Zd={class:"px-6 py-4 whitespace-nowrap"},Hd={class:"px-6 py-4 whitespace-nowrap"},Wd={class:"flex flex-wrap gap-1"},Kd={key:0,class:"text-sm text-gray-400"},Jd={class:"py-1"},Yd=["onClick"],Xd=["onClick"],ec={key:0,class:"text-center py-12"},tc={class:"mt-2 text-sm font-medium text-gray-900"},sc={class:"mt-1 text-sm text-gray-500"},oc={key:1,class:"text-center py-12"},rc=e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-secondary"},null,-1),lc=e("p",{class:"mt-2 text-sm text-gray-500"},"Cargando documentos...",-1),ac=[rc,lc],ot={__name:"SignaturesListTable",props:{state:{type:String,required:!0,validator:a=>["PendingSignatures","FullySigned"].includes(a)},searchQuery:{type:String,default:""},selectedTags:{type:Array,default:()=>[]}},emits:["refresh"],setup(a,{expose:x,emit:h}){const $=a,E=h,S=ke(),i=be(),F=Se();U([]);const _=U(!1),y=U(""),q=U(""),b=U(null),P=U("recent"),L=U([]),I=z(()=>$.state==="PendingSignatures"?"No tienes documentos pendientes por firmar":"No tienes documentos firmados"),k=z(()=>$.state==="PendingSignatures"?"Cuando tengas documentos que requieran tu firma electr√≥nica aparecer√°n aqu√≠.":"Una vez que firmes documentos electr√≥nicamente, aparecer√°n aqu√≠."),A=z(()=>{const J=S.currentUser.role,r=S.currentUser.id,u=S.currentUser.email;let g=[];return J==="lawyer"?$.state==="PendingSignatures"?g=i.pendingSignatureDocuments.filter(m=>m.created_by===r):g=i.fullySignedDocuments.filter(m=>m.created_by===r):$.state==="PendingSignatures"?g=i.documents.filter(m=>{var v;return m.state!=="PendingSignatures"?!1:(v=m.signatures)==null?void 0:v.some(Z=>Z.signer_email===u)}):g=i.documents.filter(m=>{var v;return m.state!=="FullySigned"?!1:(v=m.signatures)==null?void 0:v.some(Z=>Z.signer_email===u&&Z.signed)}),g}),T=z(()=>{let J=[...A.value];const r=y.value.toLowerCase();return r&&(J=J.filter(u=>{var g,m;return((g=u.title)==null?void 0:g.toLowerCase().includes(r))||((m=u.tags)==null?void 0:m.some(D=>{var v;return(v=D.name)==null?void 0:v.toLowerCase().includes(r)}))})),b.value&&(J=J.filter(u=>u.tags&&u.tags.some(g=>g.id===b.value))),P.value==="name"?J.sort((u,g)=>{const m=(u.title||"").toLowerCase(),D=(g.title||"").toLowerCase();return m.localeCompare(D)}):P.value==="recent"&&J.sort((u,g)=>g.id-u.id),J}),O=z(()=>{const J=new Map;return A.value.forEach(r=>{r.tags&&r.tags.length>0&&r.tags.forEach(u=>{J.has(u.id)||J.set(u.id,u)})}),Array.from(J.values()).sort((r,u)=>r.name.localeCompare(u.name))}),K=z(()=>{if(!q.value)return O.value;const J=q.value.toLowerCase();return O.value.filter(r=>r.name.toLowerCase().includes(J))}),ne=z(()=>{if(!b.value)return null;const J=O.value.find(r=>r.id===b.value);return J?J.name:null}),Y=J=>{const r=["bg-blue-500","bg-purple-500","bg-pink-500","bg-yellow-500","bg-green-500","bg-red-500","bg-indigo-500","bg-orange-500"],u=J.id%r.length;return r[u]},M=z(()=>{switch(P.value){case"name":return"Nombre (A-Z)";case"recent":default:return"M√°s recientes"}}),B=J=>{const r=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],u=J.id%r.length;return r[u]},Q=J=>$.state==="FullySigned"?"bg-green-100 text-green-700 border border-green-200":"bg-yellow-100 text-yellow-700 border border-yellow-200",j=J=>$.state==="FullySigned"?"Firmado":"Pendiente",p=z(()=>T.value.length>0&&L.value.length===T.value.length),c=()=>{p.value?L.value=[]:L.value=T.value.map(J=>J.id)},l=J=>{const r=L.value.indexOf(J);r>-1?L.value.splice(r,1):L.value.push(J)},f=()=>{L.value=T.value.map(J=>J.id)},V=()=>{L.value=[]},ee=()=>{b.value=null},oe=()=>{const J=L.value.length>0?T.value.filter(Z=>L.value.includes(Z.id)):T.value,r=["Nombre Documento","Estado Firma","Etiquetas"],u=J.map(Z=>[Z.title||"",j(),Z.tags?Z.tags.map(re=>re.name).join(", "):""]),g=[r.join(","),...u.map(Z=>Z.map(re=>`"${re}"`).join(","))].join(`
`),m=new Blob([g],{type:"text/csv;charset=utf-8;"}),D=document.createElement("a"),v=URL.createObjectURL(m);D.setAttribute("href",v),D.setAttribute("download",`documentos_firmas_${new Date().toISOString().split("T")[0]}.csv`),D.style.visibility="hidden",document.body.appendChild(D),D.click(),document.body.removeChild(D)},W=J=>{F.push({name:"dynamic_document_detail",params:{id:J.id}})},G=J=>{F.push({name:"sign_document",params:{id:J.id}})},R=async()=>{_.value=!0;try{await i.init(!0)}catch(J){console.error("Error refreshing documents:",J),ue("Error al actualizar documentos","error")}finally{_.value=!1}},te=async()=>{await R(),E("refresh")};return ve(async()=>{await R()}),x({refresh:te}),ge(()=>S.currentUser,()=>{te()}),(J,r)=>(o(),d("div",null,[e("div",gd,[e("div",pd,[e("div",hd,[e("div",fd,[s(t($e),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),me(e("input",{"onUpdate:modelValue":r[0]||(r[0]=u=>y.value=u),type:"text",placeholder:"Buscar...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent"},null,512),[[xe,y.value]])]),s(t(ie),{as:"div",class:"relative"},{default:n(()=>[s(t(de),{class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:n(()=>[s(t(Te),{class:"h-4 w-4"}),e("span",yd,w(ne.value||"Etiqueta"),1),s(t(ye),{class:"h-4 w-4"})]),_:1}),s(t(ce),{class:"absolute left-0 z-10 mt-2 w-64 origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:n(()=>[e("div",xd,[e("div",bd,[s(t($e),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),me(e("input",{"onUpdate:modelValue":r[1]||(r[1]=u=>q.value=u),type:"text",placeholder:"Buscar etiquetas...",class:"w-full pl-9 pr-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent",onClick:r[2]||(r[2]=pe(()=>{},["stop"]))},null,512),[[xe,q.value]])]),e("div",vd,[s(t(H),null,{default:n(({active:u})=>[e("a",{onClick:r[3]||(r[3]=g=>b.value=null),class:C([u?"bg-gray-100":"","block px-3 py-2 text-sm text-gray-700 cursor-pointer rounded-md"])}," Todos ",2)]),_:1}),(o(!0),d(se,null,ae(K.value,u=>(o(),le(t(H),{key:u.id},{default:n(({active:g})=>[e("a",{onClick:m=>b.value=u.id,class:C([g?"bg-gray-100":"","flex items-center gap-2 px-3 py-2 text-sm cursor-pointer rounded-md"])},[e("span",{class:C(["w-3 h-3 rounded-full flex-shrink-0",Y(u)])},null,2),e("span",wd,w(u.name),1)],10,_d)]),_:2},1024))),128)),K.value.length===0?(o(),d("div",$d," No se encontraron etiquetas ")):N("",!0)])])]),_:1})]),_:1}),b.value?(o(),d("button",{key:0,onClick:ee,class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",title:"Limpiar filtros"},[s(t(he),{class:"h-4 w-4"}),X(" Limpiar ")])):N("",!0)]),e("div",kd,[e("span",Cd," Mostrando "+w(T.value.length)+" resultados ",1),s(t(ie),{as:"div",class:"relative"},{default:n(()=>[s(t(de),{class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:n(()=>[X(" Ordenar: "+w(M.value)+" ",1),s(t(ye),{class:"h-4 w-4"})]),_:1}),s(t(ce),{class:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:n(()=>[e("div",Dd,[s(t(H),null,{default:n(({active:u})=>[e("a",{onClick:r[4]||(r[4]=g=>P.value="recent"),class:C([u?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," M√°s recientes ",2)]),_:1}),s(t(H),null,{default:n(({active:u})=>[e("a",{onClick:r[5]||(r[5]=g=>P.value="name"),class:C([u?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Nombre (A-Z) ",2)]),_:1})])]),_:1})]),_:1}),e("button",{onClick:oe,class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},[s(t(Re),{class:"h-4 w-4"}),X(" Exportar ")]),s(t(ie),{as:"div",class:"relative"},{default:n(()=>[s(t(de),{class:"inline-flex items-center justify-center w-10 h-10 rounded-md hover:bg-gray-100"},{default:n(()=>[s(t(we),{class:"h-5 w-5 text-gray-500"})]),_:1}),s(t(ce),{class:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:n(()=>[e("div",Sd,[s(t(H),null,{default:n(({active:u})=>[e("a",{onClick:f,class:C([u?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Seleccionar todo ",2)]),_:1}),s(t(H),null,{default:n(({active:u})=>[e("a",{onClick:V,class:C([u?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Deseleccionar todo ",2)]),_:1})])]),_:1})]),_:1})])])]),e("div",Ed,[e("div",Fd,[e("table",Td,[e("thead",Ld,[e("tr",null,[e("th",Ad,[e("input",{type:"checkbox",checked:p.value,onChange:c,class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,Id)]),Md,jd,Bd,Ud])]),e("tbody",Nd,[(o(!0),d(se,null,ae(T.value,u=>(o(),d("tr",{key:u.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:g=>W(u)},[e("td",{class:"px-6 py-4 whitespace-nowrap",onClick:r[6]||(r[6]=pe(()=>{},["stop"]))},[e("input",{type:"checkbox",checked:L.value.includes(u.id),onChange:g=>l(u.id),class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,qd)]),e("td",zd,[e("div",Rd,[e("div",Od,[e("div",Vd,[s(t(_e),{class:"h-5 w-5 text-purple-600"})])]),e("div",Qd,[e("div",Gd,w(u.title),1)])])]),e("td",Zd,[e("span",{class:C(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",Q()])},w(j()),3)]),e("td",Hd,[e("div",Wd,[(o(!0),d(se,null,ae(u.tags,g=>(o(),d("span",{key:g.id,class:C(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",B(g)])},w(g.name),3))),128)),!u.tags||u.tags.length===0?(o(),d("span",Kd,"-")):N("",!0)])]),e("td",{class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",onClick:r[7]||(r[7]=pe(()=>{},["stop"]))},[s(t(ie),{as:"div",class:"relative inline-block text-left"},{default:n(()=>[s(t(de),{class:"inline-flex items-center justify-center w-8 h-8 rounded-md hover:bg-gray-100"},{default:n(()=>[s(t(we),{class:"h-5 w-5 text-gray-500"})]),_:1}),s(t(ce),{class:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:n(()=>[e("div",Jd,[s(t(H),null,{default:n(({active:g})=>[e("a",{onClick:m=>W(u),class:C([g?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Ver detalles ",10,Yd)]),_:2},1024),a.state==="PendingSignatures"?(o(),le(t(H),{key:0},{default:n(({active:g})=>[e("a",{onClick:m=>G(u),class:C([g?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Firmar ",10,Xd)]),_:2},1024)):N("",!0)])]),_:2},1024)]),_:2},1024)])],8,Pd))),128))])])]),T.value.length===0&&!_.value?(o(),d("div",ec,[s(t(Me),{class:"mx-auto h-12 w-12 text-gray-400"}),e("h3",tc,w(I.value),1),e("p",sc,w(k.value),1)])):N("",!0),_.value?(o(),d("div",oc,ac)):N("",!0)]),s(He,{isVisible:t(Ae),documentData:t(Ze),onClose:r[8]||(r[8]=u=>Ae.value=!1)},null,8,["isVisible","documentData"])]))}},nc={class:"bg-white rounded-lg p-6 shadow-xl max-w-lg w-full"},ic={class:"flex justify-end"},dc=e("label",{for:"document-name",class:"block text-base font-medium leading-6 text-primary"},[X(" Nombre "),e("span",{class:"text-red-500"},"*")],-1),cc={class:"mt-2"},uc={class:"flex gap-2 mt-2.5"},mc=["disabled"],gc=e("span",null,"Actualizar nombre",-1),pc=[gc],hc=["disabled"],fc={__name:"CreateDocumentByLawyer",emits:["close"],setup(a,{emit:x}){const h=Se(),$=be(),E=x,S=U(""),i=U("");rt(()=>{var L;(L=$.selectedDocument)!=null&&L.title?(S.value=$.selectedDocument.title,i.value=$.selectedDocument.title):(S.value="",i.value="")});const F=L=>{L.key==="Escape"&&E("close")};ve(()=>{document.addEventListener("keydown",F)}),Ie(()=>{document.removeEventListener("keydown",F)});const _=z(()=>S.value.trim().length>0),y=z(()=>{var L;return!!((L=$.selectedDocument)!=null&&L.id)}),q=z(()=>y.value&&S.value.trim()!==i.value.trim()&&S.value.trim().length>0);async function b(){if(y.value&&q.value)try{const L={title:S.value.trim()};await $.updateDocument($.selectedDocument.id,L),i.value=S.value.trim(),$.selectedDocument.title=S.value.trim(),$.lastUpdatedDocumentId=$.selectedDocument.id,localStorage.setItem("lastUpdatedDocumentId",$.selectedDocument.id);const I=$.selectedDocument.id;E("close",{updatedDocId:I});const k=window.location.pathname;k==="/dynamic_document_dashboard"||k==="/dynamic_document_dashboard/"?setTimeout(()=>{window.forceDocumentHighlight&&window.forceDocumentHighlight(I)},100):setTimeout(()=>{window.location.href="/dynamic_document_dashboard"},1e3)}catch(L){console.error("Error updating document name:",L)}}const P=async()=>{if(!_.value)return;const L=encodeURIComponent(S.value.trim());y.value?($.selectedDocument.title=S.value,$.selectedDocument.id&&($.lastUpdatedDocumentId=$.selectedDocument.id,localStorage.setItem("lastUpdatedDocumentId",$.selectedDocument.id.toString())),h.push(`/dynamic_document_dashboard/lawyer/editor/edit/${$.selectedDocument.id}`)):($.selectedDocument={title:S.value.trim()},h.push(`/dynamic_document_dashboard/lawyer/editor/create/${L}`))};return(L,I)=>(o(),d("div",nc,[e("div",ic,[e("button",{onClick:I[0]||(I[0]=k=>E("close"))},[s(t(he),{class:"size-6"})])]),e("form",{onSubmit:pe(P,["prevent"])},[e("div",null,[dc,e("div",cc,[me(e("input",{"onUpdate:modelValue":I[1]||(I[1]=k=>S.value=k),type:"text",name:"document-name",id:"document-name",class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-secondary sm:text-sm sm:leading-6",required:""},null,512),[[xe,S.value]])])]),e("div",uc,[y.value?(o(),d("button",{key:0,type:"button",onClick:b,disabled:!q.value,class:C(["p-2.5 text-sm font-medium rounded-md flex gap-2",q.value?"bg-primary text-white cursor-pointer":"bg-gray-200 text-gray-400 cursor-not-allowed opacity-70"])},pc,10,mc)):N("",!0),e("button",{type:"submit",class:C(["p-2.5 text-sm font-medium rounded-md flex gap-2",_.value?"bg-secondary text-white":"bg-gray-200 text-secondary border-2 border-dashed border-secondary cursor-not-allowed bg-opacity-50"]),disabled:!_.value},[e("span",null,w(y.value?"Editar Documento":"Continuar"),1)],10,hc)])],32)]))}},fe=a=>(Pe("data-v-7e31361f"),a=a(),qe(),a),yc={class:"relative bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col"},xc={class:"px-6 py-4 border-b border-gray-200"},bc=fe(()=>e("h2",{class:"text-xl font-semibold text-gray-800"},"Gesti√≥n de Membrete Global",-1)),vc=fe(()=>e("p",{class:"text-sm text-gray-500 mt-1"}," Este membrete se aplicar√° por defecto a todos tus documentos ",-1)),_c={class:"p-6 overflow-y-auto flex-grow"},wc={key:0,class:"text-center py-10"},$c=fe(()=>e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1)),kc={class:"mt-4 text-gray-500"},Cc={key:1,class:"space-y-6"},Dc={key:0,class:"space-y-4"},Sc=fe(()=>e("h3",{class:"text-lg font-medium text-gray-900"},"Membrete Global Actual",-1)),Ec={class:"border border-gray-200 rounded-lg p-4 bg-gray-50"},Fc=["src"],Tc={class:"mt-4 flex justify-center space-x-3"},Lc=["disabled"],Ac={key:1,class:"text-center py-8"},Ic=fe(()=>e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"Sin Membrete Global",-1)),Mc=fe(()=>e("p",{class:"mt-1 text-sm text-gray-500"}," No tienes una imagen de membrete global configurada. ",-1)),jc=fe(()=>e("p",{class:"mt-1 text-xs text-gray-400"}," El membrete global se aplicar√° a todos los documentos que no tengan un membrete espec√≠fico. ",-1)),Bc={class:"space-y-4"},Uc={class:"text-lg font-medium text-gray-900"},Nc={class:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-gray-400 transition-colors"},Pc={key:0},qc={class:"mt-4"},zc=fe(()=>e("p",{class:"mt-2 text-sm text-gray-500"}," Solo archivos PNG, m√°ximo 10MB ",-1)),Rc=fe(()=>e("p",{class:"text-xs text-gray-400 mt-1"}," Dimensiones ideales: 612 √ó 612 p√≠xeles (8.5:11 Carta) ",-1)),Oc={key:1,class:"space-y-4"},Vc={class:"flex items-center justify-center space-x-2 text-sm text-gray-600"},Qc={class:"text-gray-400"},Gc={key:0,class:"mt-4"},Zc=["src"],Hc={class:"flex justify-center space-x-3"},Wc=["disabled"],Kc={key:1,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},Jc={key:2,class:"bg-blue-50 border border-blue-200 rounded-lg p-6 space-y-6"},Yc={class:"flex items-center space-x-2"},Xc=fe(()=>e("h3",{class:"text-lg font-semibold text-blue-900"},"Especificaciones del Membrete Global",-1)),eu=fe(()=>e("div",{class:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},[e("h4",{class:"font-medium text-yellow-800 mb-2"},"üîÑ Prioridad de Membrete"),e("div",{class:"text-sm text-yellow-700 space-y-1"},[e("div",null,[e("strong",null,"1¬∫ Prioridad:"),X(" Membrete espec√≠fico del documento")]),e("div",null,[e("strong",null,"2¬∫ Prioridad:"),X(" Membrete global del usuario (este)")]),e("div",null,[e("strong",null,"3¬∫ Prioridad:"),X(" Sin membrete")])])],-1)),tu=fe(()=>e("div",{class:"space-y-3"},[e("h4",{class:"font-medium text-gray-900"},"üìê Dimensiones Exactas"),e("div",{class:"bg-white rounded-lg p-4 border border-blue-200"},[e("div",{class:"grid grid-cols-2 gap-4 text-sm"},[e("div",null,[e("span",{class:"font-medium text-gray-700"},"Ancho:"),e("span",{class:"ml-2 text-blue-600 font-mono"},"612 p√≠xeles")]),e("div",null,[e("span",{class:"font-medium text-gray-700"},"Alto:"),e("span",{class:"ml-2 text-blue-600 font-mono"},"612 p√≠xeles")]),e("div",null,[e("span",{class:"font-medium text-gray-700"},"Proporci√≥n:"),e("span",{class:"ml-2 text-blue-600"},"8.5:11 (Carta)")]),e("div",null,[e("span",{class:"font-medium text-gray-700"},"Tolerancia:"),e("span",{class:"ml-2 text-orange-600"},"¬±10%")])])])],-1)),su=fe(()=>e("div",{class:"space-y-3"},[e("h4",{class:"font-medium text-gray-900"},"üé® Distribuci√≥n Recomendada"),e("div",{class:"bg-white rounded-lg p-4 border border-blue-200"},[e("div",{class:"space-y-4"},[e("div",{class:"mx-auto w-40 h-44 border-2 border-gray-300 rounded bg-gradient-to-b from-blue-100 via-yellow-50 to-green-100 relative text-xs"},[e("div",{class:"absolute top-0 left-0 right-0 h-12 bg-blue-200 bg-opacity-70 border-b border-blue-300 flex items-center justify-center text-blue-800 font-medium"}," HEADER ZONE "),e("div",{class:"absolute top-10 left-1 text-blue-700 text-[10px]"},"120-150px"),e("div",{class:"absolute top-12 left-0 right-0 bottom-12 bg-yellow-100 bg-opacity-50 border-y border-yellow-300 flex items-center justify-center text-yellow-800 font-medium"},[e("div",{class:"text-center"},[e("div",null,"BODY ZONE"),e("div",{class:"text-[10px] mt-1"},"‚ö†Ô∏è ZONA CR√çTICA")])]),e("div",{class:"absolute top-20 left-1 text-yellow-700 text-[10px]"},"300-400px"),e("div",{class:"absolute bottom-0 left-0 right-0 h-12 bg-green-200 bg-opacity-70 border-t border-green-300 flex items-center justify-center text-green-800 font-medium"}," FOOTER ZONE "),e("div",{class:"absolute bottom-10 left-1 text-green-700 text-[10px]"},"80-120px")]),e("div",{class:"space-y-3 text-sm"},[e("div",{class:"flex items-start space-x-3"},[e("div",{class:"w-4 h-4 bg-blue-200 border border-blue-300 rounded mt-0.5 flex-shrink-0"}),e("div",null,[e("span",{class:"font-medium text-blue-800"},"Header (Superior):"),e("span",{class:"text-gray-600 ml-1"},"Logos, nombre de empresa. Puede tener mayor intensidad visual.")])]),e("div",{class:"flex items-start space-x-3"},[e("div",{class:"w-4 h-4 bg-yellow-100 border border-yellow-300 rounded mt-0.5 flex-shrink-0"}),e("div",null,[e("span",{class:"font-medium text-yellow-800"},"Body (Centro):"),e("span",{class:"text-gray-600 ml-1"},"Mant√©n semi-transparente. El texto del documento se superpone aqu√≠.")])]),e("div",{class:"flex items-start space-x-3"},[e("div",{class:"w-4 h-4 bg-green-200 border border-green-300 rounded mt-0.5 flex-shrink-0"}),e("div",null,[e("span",{class:"font-medium text-green-800"},"Footer (Inferior):"),e("span",{class:"text-gray-600 ml-1"},"Direcciones, tel√©fonos, emails, informaci√≥n de contacto.")])])])])])],-1)),ou=fe(()=>e("div",{class:"space-y-3"},[e("h4",{class:"font-medium text-gray-900"},"üîß Consideraciones T√©cnicas"),e("div",{class:"bg-white rounded-lg p-4 border border-blue-200"},[e("div",{class:"space-y-2 text-sm text-gray-700"},[e("div",{class:"flex items-start space-x-2"},[e("span",{class:"text-blue-600 font-medium"},"‚Ä¢"),e("span",null,[e("strong",null,"Posicionamiento:"),X(" La imagen se centra autom√°ticamente en el documento")])]),e("div",{class:"flex items-start space-x-2"},[e("span",{class:"text-blue-600 font-medium"},"‚Ä¢"),e("span",null,[e("strong",null,"Transparencia:"),X(" Usa PNG con canal alpha para efectos de transparencia")])]),e("div",{class:"flex items-start space-x-2"},[e("span",{class:"text-blue-600 font-medium"},"‚Ä¢"),e("span",null,[e("strong",null,"M√°rgenes:"),X(" Deja 30-50px de margen en los lados para seguridad")])]),e("div",{class:"flex items-start space-x-2"},[e("span",{class:"text-blue-600 font-medium"},"‚Ä¢"),e("span",null,[e("strong",null,"Resoluci√≥n:"),X(" 72-150 DPI es suficiente para documentos digitales")])]),e("div",{class:"flex items-start space-x-2"},[e("span",{class:"text-orange-600 font-medium"},"‚ö†Ô∏è"),e("span",null,[e("strong",null,"Zona cr√≠tica:"),X(" Evita elementos gr√°ficos densos en el centro (300-400px de altura)")])])])])],-1)),ru=fe(()=>e("div",{class:"bg-gradient-to-r from-green-50 to-blue-50 border border-green-200 rounded-lg p-4"},[e("h4",{class:"font-medium text-green-800 mb-2"},"üí° Tips de Dise√±o R√°pido"),e("div",{class:"text-sm text-green-700 space-y-1"},[e("div",null,"‚Ä¢ Si solo tienes header, ub√≠calo en los primeros 120-150px"),e("div",null,"‚Ä¢ El resto de la imagen debe ser transparente o blanco"),e("div",null,"‚Ä¢ Para footer, usa los √∫ltimos 80-120px"),e("div",null,"‚Ä¢ El texto se superpone en toda la imagen, mant√©n el centro claro")])],-1)),lu={key:3,class:"space-y-2"},au={class:"flex"},nu={class:"text-sm text-yellow-700"},iu={__name:"GlobalLetterheadModal",props:{isVisible:{type:Boolean,default:!1}},emits:["close","uploaded","deleted"],setup(a,{emit:x}){const h=a,$=x,E=be(),S=U(!1),i=U(""),F=U(!1),_=U(!1),y=U(null),q=U(null),b=U(null),P=U([]),L=U(null),I=U(!1),k=()=>{O(),$("close")},A=c=>{const l=c.target.files[0];if(!l)return;if(!l.type.includes("png")){alert("Solo se permiten archivos PNG");return}if(l.size>10*1024*1024){alert("El archivo no puede ser mayor a 10MB");return}y.value=l,P.value=[];const f=new FileReader;f.onload=V=>{q.value=V.target.result;const ee=new Image;ee.onload=()=>{T(ee.width,ee.height)},ee.src=V.target.result},f.readAsDataURL(l)},T=(c,l)=>{const oe=c/l,W=612/612,G=Math.abs(oe-W)/W;if(c===612&&l===612){P.value.push("‚úÖ Dimensiones perfectas: 612 √ó 612 p√≠xeles");return}G<=.1?(P.value.push(`‚ÑπÔ∏è Buenas proporciones detectadas: ${c} √ó ${l} p√≠xeles (${oe.toFixed(3)})`),(c!==612||l!==612)&&P.value.push("üí° Para mejores resultados, usa exactamente 612 √ó 612 p√≠xeles")):(P.value.push(`‚ö†Ô∏è Proporciones no ideales: ${c} √ó ${l} p√≠xeles (${oe.toFixed(3)})`),P.value.push(`üéØ Proporciones recomendadas: ${W.toFixed(3)} (8.5:11)`),P.value.push("üìê Considera redimensionar tu imagen a 612 √ó 612 p√≠xeles")),(c<300||l<300)&&P.value.push("‚ö†Ô∏è Imagen muy peque√±a - puede verse pixelada en documentos"),(c>1200||l>1600)&&P.value.push("‚ÑπÔ∏è Imagen muy grande - se redimensionar√° autom√°ticamente")},O=()=>{y.value=null,q.value=null,P.value=[],I.value=!1,L.value&&(L.value.value="")},K=async()=>{var c;if(y.value){F.value=!0,P.value=[];try{const l=await E.uploadGlobalLetterheadImage(y.value);(c=l.data)!=null&&c.warnings&&l.data.warnings.length>0&&(P.value=l.data.warnings),await ne(),O(),$("uploaded",l.data)}catch(l){console.error("Error uploading global letterhead:",l),alert("Error al subir la imagen. Por favor intenta nuevamente.")}finally{F.value=!1}}},ne=async()=>{try{const c=await E.getGlobalLetterheadImage();c.data&&(b.value=URL.createObjectURL(c.data))}catch{b.value=null}},Y=()=>{confirm("¬øEst√°s seguro de que deseas eliminar la imagen de membrete global?")&&M()},M=async()=>{_.value=!0;try{await E.deleteGlobalLetterheadImage(),b.value&&URL.revokeObjectURL(b.value),b.value=null,$("deleted")}catch(c){console.error("Error deleting global letterhead:",c),alert("Error al eliminar la imagen. Por favor intenta nuevamente.")}finally{_.value=!1}},B=()=>{if(b.value){const c=document.createElement("a");c.href=b.value,c.download="membrete-global.png",document.body.appendChild(c),c.click(),document.body.removeChild(c)}},Q=()=>{b.value=null},j=c=>{if(c===0)return"0 Bytes";const l=1024,f=["Bytes","KB","MB","GB"],V=Math.floor(Math.log(c)/Math.log(l));return parseFloat((c/Math.pow(l,V)).toFixed(2))+" "+f[V]};ge(()=>h.isVisible,c=>{c&&ne()});const p=()=>{b.value&&URL.revokeObjectURL(b.value),q.value&&URL.revokeObjectURL(q.value)};return ve(()=>{h.isVisible&&ne()}),Ie(p),(c,l)=>me((o(),le(Ee,null,{default:n(()=>[e("div",yc,[e("div",xc,[bc,vc,e("button",{onClick:k,class:"absolute top-4 right-4 text-gray-400 hover:text-gray-500"},[s(t(he),{class:"h-6 w-6"})])]),e("div",_c,[S.value?(o(),d("div",wc,[$c,e("p",kc,w(i.value),1)])):(o(),d("div",Cc,[b.value?(o(),d("div",Dc,[Sc,e("div",Ec,[e("img",{src:b.value,alt:"Membrete global actual",class:"max-w-full h-auto max-h-64 mx-auto shadow-sm",onError:Q},null,40,Fc),e("div",Tc,[e("button",{onClick:B,class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},[s(t(Re),{class:"h-4 w-4 mr-2"}),X(" Descargar ")]),e("button",{onClick:Y,disabled:_.value,class:"inline-flex items-center px-3 py-2 border border-transparent shadow-sm text-sm leading-4 font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50"},[s(t(Et),{class:"h-4 w-4 mr-2"}),X(" "+w(_.value?"Eliminando...":"Eliminar"),1)],8,Lc)])])])):(o(),d("div",Ac,[s(t(We),{class:"mx-auto h-12 w-12 text-gray-400"}),Ic,Mc,jc])),e("div",Bc,[e("h3",Uc,w(b.value?"Reemplazar Membrete Global":"Subir Membrete Global"),1),e("div",Nc,[e("input",{ref_key:"fileInput",ref:L,type:"file",accept:".png",onChange:A,class:"hidden"},null,544),y.value?(o(),d("div",Oc,[e("div",Vc,[s(t(Ct),{class:"h-5 w-5 text-green-500"}),e("span",null,w(y.value.name),1),e("span",Qc,"("+w(j(y.value.size))+")",1)]),q.value?(o(),d("div",Gc,[e("img",{src:q.value,alt:"Vista previa",class:"max-w-full h-auto max-h-32 mx-auto border border-gray-200 rounded"},null,8,Zc)])):N("",!0),e("div",Hc,[e("button",{onClick:O,class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"}," Cancelar "),e("button",{onClick:K,disabled:F.value,class:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50"},[F.value?(o(),d("div",Kc)):(o(),le(t(Tt),{key:0,class:"h-4 w-4 mr-2"})),X(" "+w(F.value?"Subiendo...":"Subir Imagen"),1)],8,Wc)])])):(o(),d("div",Pc,[s(t(Ft),{class:"mx-auto h-12 w-12 text-gray-400"}),e("div",qc,[e("button",{onClick:l[0]||(l[0]=f=>c.$refs.fileInput.click()),class:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}," Seleccionar Imagen PNG "),e("button",{onClick:l[1]||(l[1]=f=>I.value=!I.value),class:"ml-3 inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"},[s(t(st),{class:"h-4 w-4 mr-2"}),X(" "+w(I.value?"Ocultar":"Ver")+" Especificaciones ",1)])]),zc,Rc]))])]),I.value?(o(),d("div",Jc,[e("div",Yc,[s(t(st),{class:"h-6 w-6 text-blue-600"}),Xc]),eu,tu,su,ou,ru])):N("",!0),P.value.length>0?(o(),d("div",lu,[(o(!0),d(se,null,ae(P.value,(f,V)=>(o(),d("div",{key:V,class:"bg-yellow-50 border border-yellow-200 rounded-md p-3"},[e("div",au,[s(t(Lt),{class:"h-5 w-5 text-yellow-400 mr-2 flex-shrink-0 mt-0.5"}),e("p",nu,w(f),1)])]))),128))])):N("",!0)]))])])]),_:1},512)),[[Le,a.isVisible]])}},du=ze(iu,[["__scopeId","data-v-7e31361f"]]),cu={class:"p-4 sm:p-6 lg:p-8",style:{overflow:"visible !important"}},uu={key:0,style:{overflow:"visible !important"}},mu={class:"mb-6 border-b border-gray-200"},gu={class:"hidden md:flex items-center justify-between -mb-px"},pu={class:"flex flex-wrap gap-x-4 gap-y-2 md:gap-x-8","aria-label":"Tabs"},hu=["onClick"],fu={class:"flex gap-3 pb-4"},yu=e("span",null,"Firma Electr√≥nica",-1),xu=e("span",null,"Membrete Global",-1),bu=e("span",null,"Nueva Minuta",-1),vu={class:"md:hidden space-y-3"},_u=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1),wu=[_u],$u={class:"absolute top-full left-0 right-0 z-50 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg overflow-hidden"},ku=["onClick"],Cu={class:"grid grid-cols-3 gap-2"},Du=e("span",{class:"font-medium text-xs leading-tight"},"Firma",-1),Su=e("span",{class:"font-medium text-xs leading-tight"},"Membrete",-1),Eu=e("span",{class:"font-medium text-xs leading-tight"},"Nueva",-1),Fu={key:0},Tu={key:1},Lu={key:2},Au={key:3},Iu={key:4},Mu={key:5,class:"mt-6 text-center text-gray-400 font-regular"},ju=e("p",null,"No hay documentos disponibles para mostrar.",-1),Bu=[ju],Uu={key:1,style:{overflow:"visible !important"}},Nu={class:"mb-6 border-b border-gray-200",style:{overflow:"visible !important"}},Pu={class:"hidden md:flex items-center justify-between"},qu={class:"-mb-px flex flex-wrap gap-x-4 gap-y-2 md:gap-x-8","aria-label":"Tabs"},zu=["onClick"],Ru={class:"flex items-center gap-2 mb-4"},Ou={class:"md:hidden relative"},Vu=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1),Qu=[Vu],Gu={class:"absolute top-full left-0 right-0 z-50 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg overflow-hidden"},Zu=["onClick"],Hu={class:"md:hidden mt-4 mb-4 flex flex-col gap-2"},Wu={key:0},Ku={key:1,style:{overflow:"visible !important"}},Ju={class:"p-4 sm:p-6"},Yu={class:"bg-white rounded-xl shadow-xl max-w-3xl w-full mx-auto"},Xu={class:"flex justify-between items-center p-4 border-b"},em=e("h2",{class:"text-lg font-medium text-primary"},"Firma Electr√≥nica",-1),tm={class:"p-4 sm:p-6"},Sm={__name:"Dashboard",setup(a){const x=ke(),h=be(),$=Ke(),E=Se(),S=U(""),i=U("default"),F=U(!1),_=U("folders"),y=U("legal-documents"),q=U(!1),b=U(!1),P=U(!1),L=U(!1),I=U(null),k=U([]),A=z(()=>x.currentUser),T=z(()=>A.value?A.value.role:(console.log("Current user is null, redirecting to login..."),E.push("/login"),null)),O=z(()=>{let G=[];T.value==="lawyer"?G=h.draftAndPublishedDocumentsUnassigned:(T.value==="client"||T.value==="basic"||T.value==="corporate_client")&&(G=h.progressAndCompletedDocumentsByClient(A.value.id));const R=k.value.map(te=>te.id);return h.filteredDocumentsBySearchAndTags(S.value,x,R).filter(te=>G.some(J=>J.id===te.id))}),K=G=>{i.value=G,h.selectedDocument=null},ne=()=>{F.value=!1,i.value="default",h.selectedDocument=null},Y=async()=>{await h.init(!0)},M=G=>{console.log("Global letterhead uploaded:",G)},B=()=>{console.log("Global letterhead deleted")},Q=async()=>{if(i.value==="useDocument"){i.value="default",_.value="my-documents";return}_.value="folders";try{await new Promise(G=>setTimeout(G,100)),await $.fetchFolders(!0),console.log("üìÇ Dashboard: Refreshed folders after navigate-to-main")}catch(G){console.warn("Error refreshing folders on navigate-to-main:",G)}};ge(()=>h.lastUpdatedDocumentId,(G,R)=>{if(G&&G!==R&&i.value==="default"){const te=Date.now();(!ge.lastExecutionTime||te-ge.lastExecutionTime>100)&&(ge.lastExecutionTime=te,i.value="default")}},{immediate:!1}),ge(P,G=>{console.log("showLetterheadModal changed to:",G)}),ge(L,G=>{console.log("showRelationshipsModal changed to:",G)}),ge(I,G=>{console.log("selectedDocument changed to:",G)});const j=[{name:"folders",label:"Carpetas"},{name:"my-documents",label:"Mis Documentos"}],p=[{name:"legal-documents",label:"Minutas"},{name:"pending-signatures",label:"Dcs. Por Firmar"},{name:"signed-documents",label:"Dcs. Firmados"},{name:"finished-documents",label:"Dcs. Clientes"},{name:"in-progress-documents",label:"Dcs. Clientes en Progreso"}],c=U(!1),l=U(!1),f=()=>{c.value=!1,l.value=!1},V=G=>{const R=document.querySelectorAll(".relative");let te=!1;R.forEach(J=>{J.contains(G.target)&&(te=!0)}),te||f()},ee=G=>{y.value=G,c.value=!1},oe=G=>{_.value=G,l.value=!1};ve(async()=>{await x.init(),await h.init(),await $.init(),h.selectedDocument=null,i.value="default";const G=localStorage.getItem("lastUpdatedDocumentId");G&&h.documents.some(te=>te.id.toString()===G)&&(h.lastUpdatedDocumentId=parseInt(G)),document.addEventListener("click",V)}),Ie(()=>{document.removeEventListener("click",V)});const W=async G=>{await x.getUserInfo(),x.currentUser&&(x.currentUser.has_signature=!0),showNotification("Firma electr√≥nica guardada correctamente","success"),setTimeout(()=>{q.value=!1},500)};return(G,R)=>{var te,J;return o(),d(se,null,[e("div",cu,[T.value==="lawyer"?(o(),d("div",uu,[e("div",mu,[e("div",gu,[e("nav",pu,[(o(),d(se,null,ae(p,r=>e("button",{key:r.name,onClick:u=>y.value=r.name,class:C([y.value===r.name?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])},w(r.label),11,hu)),64))]),e("div",fu,[e("button",{onClick:R[0]||(R[0]=r=>q.value=!0),class:"inline-flex items-center gap-2 px-4 py-2 rounded-lg border border-purple-200 bg-white text-sm font-medium text-gray-700 hover:bg-purple-50 hover:border-purple-300 transition-all duration-200"},[s(t(Ve),{class:"size-5 text-purple-500"}),yu]),e("button",{onClick:R[1]||(R[1]=r=>b.value=!0),class:"inline-flex items-center gap-2 px-4 py-2 rounded-lg border border-green-200 bg-white text-sm font-medium text-gray-700 hover:bg-green-50 hover:border-green-300 transition-all duration-200"},[s(t(_e),{class:"size-5 text-green-500"}),xu]),e("button",{onClick:R[2]||(R[2]=r=>F.value=!0),class:"inline-flex items-center gap-2 px-4 py-2 rounded-lg border border-secondary bg-secondary text-sm font-medium text-white hover:bg-blue-700 transition-all duration-200"},[s(t(Ce),{class:"size-5"}),bu])])]),e("div",vu,[e("button",{onClick:R[3]||(R[3]=r=>c.value=!c.value),class:"w-full flex items-center justify-between py-4 px-3 bg-white border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary"},[e("span",null,w(((te=p.find(r=>r.name===y.value))==null?void 0:te.label)||"Seleccionar secci√≥n"),1),(o(),d("svg",{class:C(["ml-2 h-5 w-5 transition-transform duration-200",c.value?"transform rotate-180":""]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},wu,2))]),me(e("div",$u,[(o(),d(se,null,ae(p,r=>e("button",{key:r.name,onClick:u=>ee(r.name),class:C(["w-full text-left px-4 py-3 text-sm transition-colors duration-150",y.value===r.name?"bg-primary text-white":"text-gray-700 hover:bg-gray-50"])},w(r.label),11,ku)),64))],512),[[Le,c.value]]),e("div",Cu,[e("button",{onClick:R[4]||(R[4]=r=>q.value=!0),class:"flex flex-col items-center justify-center py-3 px-2 rounded-lg border border-purple-200 bg-white text-center transition-all duration-200 hover:bg-purple-50"},[s(t(Ve),{class:"size-6 text-purple-500 mb-1"}),Du]),e("button",{onClick:R[5]||(R[5]=r=>b.value=!0),class:"flex flex-col items-center justify-center py-3 px-2 rounded-lg border border-green-200 bg-white text-center transition-all duration-200 hover:bg-green-50"},[s(t(_e),{class:"size-6 text-green-500 mb-1"}),Su]),e("button",{onClick:R[6]||(R[6]=r=>F.value=!0),class:"flex flex-col items-center justify-center py-3 px-2 rounded-lg border border-secondary bg-secondary text-white text-center transition-all duration-200 hover:bg-blue-700"},[s(t(Ce),{class:"size-6 mb-1"}),Eu])])])]),y.value==="legal-documents"?(o(),d("div",Fu,[s(An,{searchQuery:S.value,selectedTags:k.value},null,8,["searchQuery","selectedTags"])])):N("",!0),y.value==="pending-signatures"?(o(),d("div",Tu,[s(ot,{state:"PendingSignatures",searchQuery:S.value,selectedTags:k.value},null,8,["searchQuery","selectedTags"])])):N("",!0),y.value==="signed-documents"?(o(),d("div",Lu,[s(ot,{state:"FullySigned",searchQuery:S.value,selectedTags:k.value},null,8,["searchQuery","selectedTags"])])):N("",!0),y.value==="finished-documents"?(o(),d("div",Au,[s(wi,{searchQuery:S.value,selectedTags:k.value},null,8,["searchQuery","selectedTags"])])):N("",!0),y.value==="in-progress-documents"?(o(),d("div",Iu,[s(md,{searchQuery:S.value,selectedTags:k.value},null,8,["searchQuery","selectedTags"])])):N("",!0),O.value.length===0?(o(),d("div",Mu,Bu)):N("",!0)])):N("",!0),T.value==="client"||T.value==="basic"||T.value==="corporate_client"?(o(),d("div",Uu,[e("div",Nu,[e("div",Pu,[e("nav",qu,[(o(),d(se,null,ae(j,r=>e("button",{key:r.name,onClick:u=>_.value=r.name,class:C([_.value===r.name?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])},w(r.label),11,zu)),64))]),e("div",Ru,[e("button",{onClick:R[7]||(R[7]=r=>G.showElectronicSignatureModal=!0),class:"inline-flex items-center gap-2 px-3 py-2 text-sm font-medium text-purple-600 hover:bg-purple-50 rounded-lg transition-colors border border-purple-200"},[s(t(Ve),{class:"h-4 w-4"}),X(" Firma Electr√≥nica ")]),e("button",{onClick:R[8]||(R[8]=r=>b.value=!0),class:"inline-flex items-center gap-2 px-3 py-2 text-sm font-medium text-green-600 hover:bg-green-50 rounded-lg transition-colors border border-green-200"},[s(t(_e),{class:"h-4 w-4"}),X(" Membrete Global ")]),e("button",{onClick:R[9]||(R[9]=r=>K("useDocument")),class:"inline-flex items-center gap-2 px-3 py-2 text-sm font-medium text-white bg-secondary hover:bg-blue-700 rounded-lg transition-colors"},[s(t(Ce),{class:"h-4 w-4"}),X(" Nuevo Documento ")])])]),e("div",Ou,[e("button",{onClick:R[10]||(R[10]=r=>l.value=!l.value),class:"w-full flex items-center justify-between py-4 px-3 bg-white border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary"},[e("span",null,w(((J=j.find(r=>r.name===_.value))==null?void 0:J.label)||"Seleccionar secci√≥n"),1),(o(),d("svg",{class:C(["ml-2 h-5 w-5 transition-transform duration-200",l.value?"transform rotate-180":""]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Qu,2))]),me(e("div",Gu,[(o(),d(se,null,ae(j,r=>e("button",{key:r.name,onClick:u=>oe(r.name),class:C(["w-full text-left px-4 py-3 text-sm transition-colors duration-150",_.value===r.name?"bg-primary text-white":"text-gray-700 hover:bg-gray-50"])},w(r.label),11,Zu)),64))],512),[[Le,l.value]])]),e("div",Hu,[e("button",{onClick:R[11]||(R[11]=r=>G.showElectronicSignatureModal=!0),class:"w-full flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium text-purple-600 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors"},[s(t(Ve),{class:"h-5 w-5"}),X(" Firma Electr√≥nica ")]),e("button",{onClick:R[12]||(R[12]=r=>b.value=!0),class:"w-full flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium text-green-600 bg-green-50 hover:bg-green-100 rounded-lg transition-colors"},[s(t(_e),{class:"h-5 w-5"}),X(" Membrete Global ")]),e("button",{onClick:R[13]||(R[13]=r=>K("useDocument")),class:"w-full flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium text-white bg-secondary hover:bg-blue-700 rounded-lg transition-colors"},[s(t(Ce),{class:"h-5 w-5"}),X(" Nuevo Documento ")])])]),i.value==="useDocument"?(o(),d("div",Wu,[s(Ba,{searchQuery:S.value,selectedTags:k.value,onGoBack:Q},null,8,["searchQuery","selectedTags"])])):(o(),d("div",Ku,[_.value==="my-documents"?(o(),le(Yl,{key:0,searchQuery:S.value,selectedTags:k.value,onRefresh:Y},null,8,["searchQuery","selectedTags"])):N("",!0),_.value==="folders"?(o(),le(ll,{key:1,searchQuery:S.value,selectedTags:k.value,onRefresh:Y,onNavigateToMain:Q},null,8,["searchQuery","selectedTags"])):N("",!0)]))])):N("",!0)]),me(s(Ee,null,{default:n(()=>[s(fc,{onClose:ne})]),_:1},512),[[Le,F.value]]),q.value?(o(),le(Ee,{key:0},{default:n(()=>[e("div",Ju,[e("div",Yu,[e("div",Xu,[em,e("button",{onClick:R[14]||(R[14]=r=>q.value=!1),class:"text-gray-400 hover:text-gray-500 p-1 rounded-full hover:bg-gray-100"},[s(t(he),{class:"h-6 w-6"})])]),e("div",tm,[s(ht,{"user-id":A.value.id,"initial-show-options":!A.value.has_signature,onSignatureSaved:W,onCancel:R[15]||(R[15]=r=>q.value=!1)},null,8,["user-id","initial-show-options"])])])])]),_:1})):N("",!0),s(He,{isVisible:t(Ae),documentData:t(Ze),onClose:R[16]||(R[16]=r=>Ae.value=!1)},null,8,["isVisible","documentData"]),b.value?(o(),le(Ee,{key:1},{default:n(()=>[s(du,{onClose:R[17]||(R[17]=r=>b.value=!1),onLetterheadUploaded:M,onLetterheadDeleted:B})]),_:1})):N("",!0)],64)}}};export{Sm as default};
