import{e as n,f as a,g as e,u as et,r as w,aJ as Rt,o as Ne,ar as ut,c as j,h as o,j as t,G as Le,w as Te,v as Oe,n as _,l as F,t as f,m as he,p as Y,s as $e,b4 as Yt,i as x,ac as He,a9 as Vt,b5 as Xt,Q as Dt,k as oe,a2 as Xe,F as ae,D as Ct,E as es,b6 as ts,a0 as ss,C as os,T as be,N as ue,I as Je,a1 as Re,ag as Se,ad as Fe,ae as Ee,af as ce,b7 as ns,O as mt,P as gt,a5 as rs,ah as nt,aX as ls,ai as pt,b8 as ht,ab as as,b9 as wt,ba as jt}from"./index.js";import{u as qe,o as is,s as ot,p as Lt}from"./index2.js";import{g as it,a as dt}from"./DocumentPermissionsManager.js";import{B as ds,r as cs,a as us,b as ft,c as vt,d as St,e as Ft,L as bt,f as Et,_ as Pt,D as Qt,g as ms}from"./index3.js";import{_ as yt}from"./_plugin-vue_export-helper.js";import{r as kt}from"./FolderIcon.js";import{r as Ye}from"./PlusIcon.js";import{r as st}from"./EllipsisVerticalIcon.js";import{r as ct}from"./DocumentIcon.js";import{_ as gs}from"./DocumentCard.js";import{r as Gt}from"./EyeIcon.js";import{r as rt}from"./ChevronRightIcon.js";import{_ as Ut}from"./SignatureDocumentCard.js";import{r as zt,a as ps,b as hs}from"./TagIcon.js";import{r as ze}from"./ChevronDownIcon.js";import{r as Ze}from"./MagnifyingGlassIcon.js";import{r as Nt}from"./PencilIcon.js";import{r as Ht}from"./TrashIcon.js";import{r as fs}from"./LinkIcon.js";import{r as Zt}from"./PhotoIcon.js";import{r as Wt}from"./CheckCircleIcon.js";import{r as tt,a as lt}from"./FunnelIcon.js";import{r as vs}from"./ArrowLeftIcon.js";import{r as Ot}from"./InformationCircleIcon.js";import{r as bs}from"./CloudArrowUpIcon.js";import{r as ys}from"./ExclamationTriangleIcon.js";import"./useRecentViews.js";import"./loading_message.js";function qt(l,v){return n(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"})])}function xs(l,v){return n(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z"})])}function _s(l,v){return n(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7.217 10.907a2.25 2.25 0 1 0 0 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186 9.566-5.314m-9.566 7.5 9.566 5.314m0 0a2.25 2.25 0 1 0 3.935 2.186 2.25 2.25 0 0 0-3.935-2.186Zm0-12.814a2.25 2.25 0 1 0 3.933-2.185 2.25 2.25 0 0 0-3.933 2.185Z"})])}const ws={class:"bg-white rounded-lg p-6 shadow-xl max-w-lg w-full"},$s={class:"flex justify-end"},ks=e("label",{for:"document-name",class:"block text-base font-medium leading-6 text-primary"},[Y(" Nombre "),e("span",{class:"text-red-500"},"*")],-1),Cs={class:"mt-2"},Ds={class:"flex gap-2 mt-2.5"},Ss=["disabled"],Fs=e("span",null,"Actualizar nombre",-1),Es=[Fs],As=["disabled"],Ts={__name:"UseDocumentByClient",props:{documentId:{type:[Number,null],required:!1,default:null}},emits:["close"],setup(l,{emit:v}){const i=l,p=et(),A=qe(),$=v,u=w(""),k=w(""),y=()=>{$("close")};Rt(()=>{var M,D;A.selectedDocument?(u.value=((M=A.selectedDocument)==null?void 0:M.title)||"",k.value=((D=A.selectedDocument)==null?void 0:D.title)||""):(u.value="",k.value="")});const T=M=>{M.key==="Escape"&&y()};Ne(()=>{document.addEventListener("keydown",T)}),ut(()=>{document.removeEventListener("keydown",T)});const te=j(()=>u.value.trim().length>0),V=j(()=>{var M;return!!((M=A.selectedDocument)!=null&&M.id)}),K=j(()=>V.value&&u.value.trim()!==k.value.trim()&&u.value.trim().length>0);async function N(){if(V.value&&K.value)try{const M={title:u.value.trim()};await A.updateDocument(A.selectedDocument.id,M),k.value=u.value.trim(),A.selectedDocument.title=u.value.trim();const D=A.selectedDocument.id;$e("Document name successfully updated.","success"),$("close",{updatedDocId:D});const S=window.location.pathname;S==="/dynamic_document_dashboard"||S==="/dynamic_document_dashboard/"||setTimeout(()=>{window.location.href="/dynamic_document_dashboard"},1e3)}catch(M){console.error("Error updating document name:",M),$e("Error updating document name.","error")}}function g(){const M=encodeURIComponent(u.value.trim());i.documentId&&!A.selectedDocument?p.push(`/dynamic_document_dashboard/document/use/creator/${i.documentId}/${M}`):A.selectedDocument?(A.selectedDocument.title=u.value.trim(),p.push(`/dynamic_document_dashboard/document/use/editor/${A.selectedDocument.id}/${M}`)):$e("Error: No se pudo continuar. Documento no seleccionado.","error")}return(M,D)=>(n(),a("div",ws,[e("div",$s,[e("button",{onClick:y},[o(t(Le),{class:"size-6"})])]),e("form",{onSubmit:he(g,["prevent"])},[e("div",null,[ks,e("div",Cs,[Te(e("input",{"onUpdate:modelValue":D[0]||(D[0]=G=>u.value=G),type:"text",id:"document-name",class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm ring-1 ring-inset ring-gray-300",required:""},null,512),[[Oe,u.value]])])]),e("div",Ds,[V.value?(n(),a("button",{key:0,type:"button",onClick:N,disabled:!K.value,class:_(["p-2.5 text-sm font-medium rounded-md flex gap-2",K.value?"bg-primary text-white cursor-pointer":"bg-gray-200 text-gray-400 cursor-not-allowed opacity-70"])},Es,10,Ss)):F("",!0),e("button",{type:"submit",class:_(["p-2.5 text-sm font-medium rounded-md flex gap-2",te.value?"bg-secondary text-white":"bg-gray-200 text-secondary border-2 border-dashed border-secondary cursor-not-allowed bg-opacity-50"]),disabled:!te.value},[e("span",null,f(V.value?"Editar Documento":"Continuar"),1)],10,As)])],32)]))}},Ms={class:"mt-3 pt-2 border-t border-gray-100"},Ls={class:"flex items-center gap-2 text-xs text-gray-500"},Ps=e("span",null,"Hacer clic para usar este documento",-1),Is={__name:"UseDocumentCard",props:{document:{type:Object,required:!0},showTags:{type:Boolean,default:!0},cardType:{type:String,default:"default"},cardContext:{type:String,default:"list"},documentStore:{type:Object,default:null},userStore:{type:Object,default:null},menuOptions:{type:Array,default:null},disableInternalActions:{type:Boolean,default:!1},showMenuOptions:{type:Boolean,default:null}},emits:["click","remove-from-folder","document-created"],setup(l,{emit:v}){const i=l,p=v,A=w(!1),$=w(null),u=it(9),k=j(()=>"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium !bg-purple-100 !text-purple-700 !border !border-purple-200"),y=j(()=>u.dark),T=j(()=>"group !border-purple-400 !bg-purple-50/50 !shadow-purple-100"),te=j(()=>i.menuOptions!==null?i.menuOptions:[{label:"Usar",action:"use",icon:xs,iconClasses:"w-4 h-4 text-purple-600"},{label:"Previsualización",action:"preview",icon:Gt,iconClasses:"w-4 h-4 text-gray-600"}]),V=j(()=>!1),K=(D,G)=>{i.disableInternalActions?p("click",D,G):g(D.id)},N=(D,G)=>{switch(D){case"use":g(G.id);break;case"preview":is(G);break;default:console.warn("Unknown menu action:",D)}};function g(D){D?($.value=D,A.value=!0):console.error("Document ID is required:",D)}function M(D){if(A.value=!1,$.value=null,D&&D.updatedDocId){p("document-created",D);const G=window.location.pathname;G==="/dynamic_document_dashboard"||G==="/dynamic_document_dashboard/"?setTimeout(()=>{window.forceDocumentHighlight&&window.forceDocumentHighlight(D.updatedDocId)},100):setTimeout(()=>{window.location.href="/dynamic_document_dashboard"},500)}}return(D,G)=>(n(),a(ae,null,[o(ds,{document:l.document,"card-type":l.cardType,"card-context":l.cardContext,"status-icon":t(Xt),"status-text":"Disponible","status-badge-classes":k.value,"menu-options":te.value,"highlighted-doc-id":null,"show-tags":l.showTags,"document-store":l.documentStore,"user-store":l.userStore,"additional-classes":T.value,"disable-internal-actions":l.disableInternalActions,"show-menu-options":l.showMenuOptions,onClick:K,onMenuAction:N,onRemoveFromFolder:G[0]||(G[0]=S=>D.$emit("remove-from-folder",S))},Yt({"additional-actions":x(()=>[Vt(D.$slots,"additional-actions")]),_:2},[V.value?{name:"right-action",fn:x(()=>[o(t(rt),{class:"w-5 h-5 text-gray-400 group-hover:text-gray-600 transition-colors"})]),key:"0"}:void 0,l.disableInternalActions?void 0:{name:"footer",fn:x(()=>[e("div",Ms,[e("div",Ls,[e("div",{class:"w-2 h-2 rounded-full",style:He({backgroundColor:y.value})},null,4),Ps])])]),key:"1"}]),1032,["document","card-type","card-context","status-icon","status-badge-classes","menu-options","show-tags","document-store","user-store","additional-classes","disable-internal-actions","show-menu-options"]),Te(o(Xe,null,{default:x(()=>[$.value!==null?(n(),oe(Ts,{key:0,"document-id":$.value,onClose:M},null,8,["document-id"])):F("",!0)]),_:1},512),[[Dt,A.value]])],64))}},Bs=()=>({folders:[],currentFolder:null,isLoading:!1,error:null,lastUpdatedFolderId:null}),js={sortedFolders:l=>[...l.folders].sort((v,i)=>new Date(i.created_at)-new Date(v.created_at)),getFolderById:l=>v=>l.folders.find(i=>i.id===v),getFoldersByColor:l=>v=>l.folders.filter(i=>i.color_id===v),getFolderWithColor:l=>v=>{const i=l.folders.find(p=>p.id===v);return i?{...i,color:it(i.color_id)}:null},getFoldersContainingDocument:l=>v=>l.folders.filter(i=>i.document_ids&&i.document_ids.includes(v)),totalDocumentsInFolders:l=>l.folders.reduce((v,i)=>v+(i.document_ids?i.document_ids.length:0),0),hasFolders:l=>l.folders.length>0,availableColors:()=>dt()},Us={async init(l=!1){if(!(this.folders.length>0&&!l)){this.isLoading=!0,this.error=null;try{await this.fetchFolders()}catch(v){console.error("Error initializing document folder store:",v),this.error="Error al inicializar las carpetas"}finally{this.isLoading=!1}}},async fetchFolders(){try{const l=await Ct("dynamic-documents/folders/");if(l.status===200)return this.folders=l.data,l.data;throw new Error(`Error fetching folders: ${l.status}`)}catch(l){throw console.error("Error fetching folders:",l),this.error="Error al obtener las carpetas",l}},async fetchFolder(l){this.isLoading=!0,this.error=null;try{const v=await Ct(`dynamic-documents/folders/${l}/`);if(v.status===200){const i=v.data,p=this.folders.findIndex(A=>A.id===i.id);return p!==-1?this.folders[p]=i:this.folders.push(i),this.currentFolder=i,i}else throw new Error(`Error fetching folder: ${v.status}`)}catch(v){throw console.error("Error fetching folder:",v),this.error="Error al obtener la carpeta",v}finally{this.isLoading=!1}},async createFolder(l){this.isLoading=!0,this.error=null;try{if(!l.name||l.name.trim()==="")throw new Error("El nombre de la carpeta es requerido");const v=l.color_id??0;if(v<0||v>=dt().length)throw new Error("Color de carpeta no válido");const i={name:l.name.trim(),color_id:v,...l.document_ids&&{document_ids:l.document_ids}},p=await es("dynamic-documents/folders/create/",i);if(p.status===200||p.status===201){const A=p.data;return this.folders.push(A),this.lastUpdatedFolderId=A.id,$e("Carpeta creada exitosamente","success"),A}else throw new Error(`Error creating folder: ${p.status}`)}catch(v){throw console.error("Error creating folder:",v),this.error=v.message||"Error al crear la carpeta",$e(this.error,"error"),v}finally{this.isLoading=!1}},async updateFolder(l,v){this.isLoading=!0,this.error=null;try{if(v.name&&v.name.trim()==="")throw new Error("El nombre de la carpeta no puede estar vacío");if(v.color_id!==void 0){const A=v.color_id;if(A<0||A>=dt().length)throw new Error("Color de carpeta no válido")}const i={};v.name&&(i.name=v.name.trim()),v.color_id!==void 0&&(i.color_id=v.color_id),v.document_ids!==void 0&&(i.document_ids=v.document_ids);const p=await ts(`dynamic-documents/folders/${l}/update/`,i);if(p.status===200){const A=p.data,$=this.folders.findIndex(u=>u.id===l);return $!==-1&&(this.folders[$]=A),this.currentFolder&&this.currentFolder.id===l&&(this.currentFolder=A),this.lastUpdatedFolderId=l,$e("Carpeta actualizada exitosamente","success"),A}else throw new Error(`Error updating folder: ${p.status}`)}catch(i){throw console.error("Error updating folder:",i),this.error=i.message||"Error al actualizar la carpeta",$e(this.error,"error"),i}finally{this.isLoading=!1}},async deleteFolder(l){this.isLoading=!0,this.error=null;try{const v=await ss(`dynamic-documents/folders/${l}/delete/`);if(v.status===204||v.status===200)return this.folders=this.folders.filter(i=>i.id!==l),this.currentFolder&&this.currentFolder.id===l&&(this.currentFolder=null),await $e("Carpeta eliminada exitosamente","success"),!0;throw new Error(`Error deleting folder: ${v.status}`)}catch(v){throw console.error("Error deleting folder:",v),this.error=v.message||"Error al eliminar la carpeta",await $e(this.error,"error"),v}finally{this.isLoading=!1}},setCurrentFolder(l){this.currentFolder=l},clearCurrentFolder(){this.currentFolder=null},reset(){this.folders=[],this.currentFolder=null,this.isLoading=!1,this.error=null,this.lastUpdatedFolderId=null}},zs={async addDocumentsToFolder(l,v){const i=this.getFolderById(l);if(!i)throw new Error("Carpeta no encontrada");const p=i.document_ids||[],A=[...new Set([...p,...v])];return await this.updateFolder(l,{document_ids:A})},async removeDocumentsFromFolder(l,v){const i=this.getFolderById(l);if(!i)throw new Error("Carpeta no encontrada");const A=(i.document_ids||[]).filter($=>!v.includes($));return await this.updateFolder(l,{document_ids:A})},async moveDocumentsBetweenFolders(l,v,i){try{v&&await this.removeDocumentsFromFolder(v,l),i&&await this.addDocumentsToFolder(i,l),await $e("Documentos movidos exitosamente","success")}catch(p){throw console.error("Error moving documents between folders:",p),await $e("Error al mover documentos","error"),p}},getFolderColor(l){const v=this.getFolderById(l);return v?it(v.color_id):it(0)},validateFolderData(l){const v=[];if((!l.name||l.name.trim()==="")&&v.push("El nombre de la carpeta es requerido"),l.name&&l.name.length>100&&v.push("El nombre de la carpeta no puede exceder 100 caracteres"),l.color_id!==void 0){const i=l.color_id;(i<0||i>=dt().length)&&v.push("Color de carpeta no válido")}return l.document_ids&&!Array.isArray(l.document_ids)&&v.push("Los IDs de documentos deben ser un array"),{isValid:v.length===0,errors:v}}},It=os("documentFolder",{state:Bs,getters:js,actions:{...Us,...zs}}),Ns={class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},Os={class:"bg-white rounded-xl shadow-xl max-w-md w-full"},qs={class:"flex justify-between items-center p-6 border-b"},Rs={class:"text-lg font-semibold text-gray-900"},Vs={class:"mb-4"},Qs=e("label",{for:"folderName",class:"block text-sm font-medium text-gray-700 mb-2"}," Nombre de la carpeta ",-1),Gs={class:"mb-6"},Hs=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"}," Color de la carpeta ",-1),Zs={class:"grid grid-cols-8 gap-2"},Ws=["onClick","title"],Js={class:"flex gap-3"},Ks=["disabled"],Ys={__name:"CreateEditFolderModal",props:{isVisible:{type:Boolean,required:!0},editingFolder:{type:Object,default:null}},emits:["close","success"],setup(l,{emit:v}){const i=l,p=v,A=It(),$=w(!1),u=w({name:"",color_id:0}),k=j(()=>dt()),y=()=>{u.value={name:"",color_id:0}};be(()=>i.editingFolder,V=>{V?u.value={name:V.name,color_id:V.color_id}:y()},{immediate:!0}),be(()=>i.isVisible,V=>{V||y()});const T=()=>{p("close")},te=async()=>{if(u.value.name.trim()){$.value=!0;try{i.editingFolder?await A.updateFolder(i.editingFolder.id,u.value):await A.createFolder(u.value),$.value=!1,p("success")}catch{$.value=!1}}};return(V,K)=>l.isVisible?(n(),oe(Xe,{key:0},{default:x(()=>[e("div",Ns,[e("div",Os,[e("div",qs,[e("h3",Rs,f(l.editingFolder?"Editar Carpeta":"Nueva Carpeta"),1),e("button",{onClick:T,class:"text-gray-400 hover:text-gray-500"},[o(t(Le),{class:"w-6 h-6"})])]),e("form",{onSubmit:he(te,["prevent"]),class:"p-6"},[e("div",Vs,[Qs,Te(e("input",{id:"folderName","onUpdate:modelValue":K[0]||(K[0]=N=>u.value.name=N),type:"text",required:"",maxlength:"100",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Ej: Contratos Laborales"},null,512),[[Oe,u.value.name]])]),e("div",Gs,[Hs,e("div",Zs,[(n(!0),a(ae,null,ue(k.value,N=>(n(),a("button",{key:N.id,type:"button",onClick:g=>u.value.color_id=N.id,class:_(["w-8 h-8 rounded-full border-2 transition-all",u.value.color_id===N.id?"border-gray-800 scale-110":"border-gray-300 hover:border-gray-400"]),style:He({backgroundColor:N.hex}),title:N.name},null,14,Ws))),128))])]),e("div",Js,[e("button",{type:"button",onClick:T,class:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"}," Cancelar "),e("button",{type:"submit",disabled:!u.value.name.trim()||$.value,class:"flex-1 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},f($.value?"Guardando...":l.editingFolder?"Actualizar":"Crear"),9,Ks)])],32)])])]),_:1})):F("",!0)}},Xs={class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},eo={class:"bg-white rounded-xl shadow-xl max-w-6xl w-full max-h-[90vh] overflow-hidden flex flex-col"},to={class:"border-b px-6 py-4 flex-shrink-0"},so={class:"flex justify-between items-center"},oo={class:"flex items-center gap-3"},no={class:"text-xl font-semibold text-gray-900"},ro={class:"text-sm text-gray-600"},lo={class:"flex items-center gap-2"},ao={class:"flex-1 overflow-y-auto p-6"},io={key:0,class:"bg-white rounded-lg shadow-sm border border-gray-200"},co={class:"min-w-full divide-y divide-gray-200"},uo=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Documento "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Tipo "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etiquetas "),e("th",{scope:"col",class:"w-16 px-6 py-3"})])],-1),mo={class:"bg-white divide-y divide-gray-200"},go=["onClick"],po={class:"px-6 py-4 whitespace-nowrap"},ho={class:"flex items-center"},fo={class:"flex-shrink-0 h-10 w-10"},vo={class:"h-10 w-10 rounded-lg bg-blue-100 flex items-center justify-center"},bo={class:"ml-4"},yo={class:"text-sm font-medium text-gray-900"},xo={class:"px-6 py-4 whitespace-nowrap"},_o={class:"text-sm text-gray-600"},wo={class:"px-6 py-4 whitespace-nowrap"},$o={class:"px-6 py-4 whitespace-nowrap"},ko={class:"flex flex-wrap gap-1"},Co={key:0,class:"text-sm text-gray-400"},Do={class:"py-1"},So=["onClick"],Fo=["onClick"],Eo={key:1,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center"},Ao=e("h4",{class:"text-lg font-medium text-gray-900 mb-2"},"Esta carpeta está vacía",-1),To=e("p",{class:"text-gray-600 mb-4"},"Agrega documentos para organizar tu trabajo",-1),Mo={__name:"FolderDetailsModalTable",props:{folder:{type:Object,default:null}},emits:["close","add-documents","remove-document","view-document","use-document","document-action"],setup(l,{emit:v}){const i=l,p=v;Je(),qe();const A=w({}),$=w({}),u=w(!1),k=w(-1),y=[{name:"blue",hex:"#3B82F6"},{name:"purple",hex:"#8B5CF6"},{name:"pink",hex:"#EC4899"},{name:"green",hex:"#10B981"},{name:"yellow",hex:"#F59E0B"},{name:"red",hex:"#EF4444"},{name:"indigo",hex:"#6366F1"},{name:"teal",hex:"#14B8A6"}],T=j(()=>{if(!i.folder)return y[0];if(i.folder.color)return y.find(L=>L.name===i.folder.color)||y[0];const h=i.folder.id%y.length;return y[h]}),te=h=>h.state==="Published"||h.state==="Draft"?"Formato":h.state==="PendingSignatures"||h.state==="FullySigned"?"Para Firmar":h.state==="Progress"||h.state==="Completed"?"Mis Documentos":"Documento",V=h=>({Published:"Publicado",Draft:"Borrador",Progress:"En Progreso",Completed:"Completado",PendingSignatures:"Pendiente Firma",FullySigned:"Firmado"})[h.state]||h.state,K=h=>({Published:"bg-green-100 text-green-700 border border-green-200",Draft:"bg-gray-100 text-gray-700 border border-gray-200",Progress:"bg-blue-100 text-blue-700 border border-blue-200",Completed:"bg-green-100 text-green-700 border border-green-200",PendingSignatures:"bg-yellow-100 text-yellow-700 border border-yellow-200",FullySigned:"bg-green-100 text-green-700 border border-green-200"})[h.state]||"bg-gray-100 text-gray-700 border border-gray-200",N=h=>{const L=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],O=h.id%L.length;return L[O]},g=()=>{p("close")},M=()=>{p("add-documents",i.folder)},D=h=>{p("remove-document",{folderId:i.folder.id,documentId:h.id})},G=h=>{const L=te(h);p(L==="Formato"?"use-document":"view-document",h)},S=()=>!u.value||!i.folder?"auto":i.folder.documents.length===1?"280px":i.folder.documents.length===2&&k.value===1?"340px":"280px",C=(h,L)=>{h&&(A.value[L]=h)},ie=(h,L)=>{h&&($.value[L]=h)},z=(h,L)=>{u.value=!L,k.value=L?-1:h,L||setTimeout(()=>{const O=$.value[h];if(O){const E=O.$el||O;if(E&&E.getBoundingClientRect){const U=E.getBoundingClientRect(),ne=window.innerHeight;if(h===0){if(U.bottom>ne-20){const I=U.bottom-ne+40;window.scrollBy({top:I,behavior:"smooth"})}}else if(U.bottom>ne-10){const I=U.bottom-ne+30;window.scrollBy({top:I,behavior:"smooth"})}else if(U.top<80){const I=U.top-100;window.scrollBy({top:I,behavior:"smooth"})}}}},100)};return(h,L)=>l.folder?(n(),oe(Xe,{key:0},{default:x(()=>[e("div",Xs,[e("div",eo,[e("div",to,[e("div",so,[e("div",oo,[e("div",{class:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",style:He({backgroundColor:T.value.hex+"20"})},[o(t(kt),{class:"h-6 w-6",style:He({color:T.value.hex})},null,8,["style"])],4),e("div",null,[e("h3",no,f(l.folder.name),1),e("p",ro,f(l.folder.documents.length)+" documento"+f(l.folder.documents.length!==1?"s":""),1)])]),e("div",lo,[e("button",{onClick:M,class:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-blue-600 hover:bg-blue-50 rounded-lg transition-colors"},[o(t(Ye),{class:"w-5 h-5"}),Y(" Agregar documentos ")]),e("button",{onClick:g,class:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors"},[o(t(Le),{class:"w-6 h-6"})])])])]),e("div",ao,[l.folder.documents.length>0?(n(),a("div",io,[e("div",{class:"overflow-x-auto",style:He({minHeight:S()})},[e("table",co,[uo,e("tbody",mo,[(n(!0),a(ae,null,ue(l.folder.documents,(O,E)=>(n(),a("tr",{key:O.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:U=>G(O)},[e("td",po,[e("div",ho,[e("div",fo,[e("div",vo,[o(t(Re),{class:"h-5 w-5 text-blue-600"})])]),e("div",bo,[e("div",yo,f(O.title),1)])])]),e("td",xo,[e("span",_o,f(te(O)),1)]),e("td",wo,[e("span",{class:_(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",K(O)])},f(V(O)),3)]),e("td",$o,[e("div",ko,[(n(!0),a(ae,null,ue(O.tags,U=>(n(),a("span",{key:U.id,class:_(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",N(U)])},f(U.name),3))),128)),!O.tags||O.tags.length===0?(n(),a("span",Co,"-")):F("",!0)])]),e("td",{class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",onClick:L[0]||(L[0]=he(()=>{},["stop"]))},[o(t(Se),{as:"div",class:"relative inline-block text-left"},{default:x(({open:U})=>[o(t(Fe),{ref_for:!0,ref:ne=>C(ne,E),onClick:ne=>z(E,U),class:"inline-flex items-center justify-center w-8 h-8 rounded-md hover:bg-gray-100"},{default:x(()=>[o(t(st),{class:"h-5 w-5 text-gray-500"})]),_:2},1032,["onClick"]),o(t(Ee),{ref_for:!0,ref:ne=>ie(ne,E),class:_([l.folder.documents.length>2&&E>0&&E>=l.folder.documents.length-3?"absolute right-0 z-[9999] bottom-full mb-2 w-48 origin-bottom-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none":"absolute right-0 z-[9999] mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"])},{default:x(()=>[e("div",Do,[o(t(ce),null,{default:x(({active:ne})=>[e("a",{onClick:I=>G(O),class:_([ne?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Ver documento ",10,So)]),_:2},1024),o(t(ce),null,{default:x(({active:ne})=>[e("a",{onClick:I=>D(O),class:_([ne?"bg-gray-100":"","block px-4 py-2 text-sm text-red-600 cursor-pointer"])}," Quitar de carpeta ",10,Fo)]),_:2},1024)])]),_:2},1032,["class"])]),_:2},1024)])],8,go))),128))])])],4)])):(n(),a("div",Eo,[o(t(ct),{class:"w-12 h-12 text-gray-300 mx-auto mb-4"}),Ao,To,e("button",{onClick:M,class:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"},[o(t(Ye),{class:"w-5 h-5"}),Y(" Agregar documentos ")])]))])])])]),_:1})):F("",!0)}},xt=l=>(mt("data-v-d403a707"),l=l(),gt(),l),Lo={class:"tag-filter-container"},Po={class:"relative"},Io={class:"flex items-center"},Bo={key:0,class:"ml-2 inline-flex items-center justify-center h-5 w-5 bg-primary text-white text-xs rounded-full font-medium"},jo={key:0,class:"absolute left-0 mt-2 w-full sm:w-80 bg-white rounded-xl shadow-xl ring-1 ring-black ring-opacity-5 border border-gray-100 z-50 overflow-hidden"},Uo={class:"bg-gray-50 p-4 border-b border-gray-200"},zo={class:"flex items-center justify-between mb-3"},No=xt(()=>e("h3",{class:"text-sm font-semibold text-gray-900"},"Filtrar por etiquetas",-1)),Oo={key:0,class:"text-xs text-gray-500"},qo={class:"relative"},Ro={key:0,class:"px-4 py-2 bg-blue-50 border-b border-blue-100"},Vo={class:"flex items-center justify-between"},Qo={class:"text-xs font-medium text-blue-700"},Go={class:"max-h-52 overflow-y-auto"},Ho={key:0,class:"px-4 py-8 text-center"},Zo=xt(()=>e("p",{class:"text-gray-500 text-sm"},"No hay etiquetas disponibles",-1)),Wo={key:1,class:"px-4 py-8 text-center"},Jo={class:"text-gray-500 text-sm"},Ko={key:2,class:"px-4 py-8 text-center"},Yo=xt(()=>e("div",{class:"flex items-center justify-center"},[e("div",{class:"animate-spin rounded-full h-5 w-5 border-2 border-primary border-t-transparent"}),e("span",{class:"ml-3 text-sm text-gray-600"},"Cargando etiquetas...")],-1)),Xo=[Yo],en={key:3,class:"py-2"},tn=["onClick"],sn={class:"flex items-center h-5"},on={class:"relative"},nn=["id","checked","onChange"],rn={key:0,class:"w-2.5 h-2.5 text-white",fill:"currentColor",viewBox:"0 0 20 20"},ln=xt(()=>e("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"},null,-1)),an=[ln],dn={class:"ml-3 flex items-center flex-1 min-w-0"},cn={class:"text-sm font-medium text-gray-900 truncate"},un={key:0,class:"mt-4"},mn={class:"flex items-start gap-2"},gn=xt(()=>e("span",{class:"text-xs font-medium text-gray-500 mt-1.5 flex-shrink-0"},"Activos:",-1)),pn={class:"flex flex-wrap gap-2"},hn=["onClick"],fn={class:"mr-1"},vn={class:"ml-1 p-0.5 rounded-full hover:bg-white/50 transition-colors duration-150"},bn={__name:"TagFilter",props:{modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue"],setup(l,{emit:v}){const i=l,p=v,A=qe(),$=w(!1),u=w([]),k=w(!1),y=w(""),T=j(()=>A.sortedTags),te=j(()=>{if(!y.value.trim())return T.value;const G=y.value.toLowerCase().trim();return T.value.filter(S=>S.name.toLowerCase().includes(G))}),V=G=>{const S=it(G.color_id);return{hex:S&&S.hex?S.hex:"#9CA3AF",dark:S&&S.dark?S.dark:"#374151"}},K=()=>{$.value=!$.value,$.value&&(y.value="")},N=G=>u.value.some(S=>S.id===G.id),g=G=>{const S=u.value.findIndex(C=>C.id===G.id);S>=0?u.value.splice(S,1):u.value.push(G),p("update:modelValue",u.value)},M=()=>{u.value=[],p("update:modelValue",[])},D=G=>{G.target.closest(".tag-filter-container")||($.value=!1,y.value="")};return Ne(async()=>{try{k.value=!0,await A.initTags()}catch(G){console.error("Error loading tags:",G)}finally{k.value=!1}document.addEventListener("click",D)}),be(()=>i.modelValue,G=>{u.value=G||[]},{immediate:!0}),ut(()=>{document.removeEventListener("click",D)}),(G,S)=>(n(),a("div",Lo,[e("div",Po,[e("button",{onClick:K,class:_(["group inline-flex items-center justify-between w-full sm:w-auto sm:min-w-[200px] px-4 py-3 border border-gray-200 rounded-xl shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 hover:border-gray-300 focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-primary transition-all duration-200",{"ring-2 ring-primary border-primary bg-blue-50":$.value,"border-primary bg-primary/5":u.value.length>0&&!$.value}])},[e("div",Io,[o(t(zt),{class:_(["h-5 w-5 mr-2.5 text-gray-500 group-hover:text-gray-600",{"text-primary":u.value.length>0||$.value}])},null,8,["class"]),e("span",{class:_(["text-gray-700",{"text-primary font-semibold":u.value.length>0||$.value}])}," Filtrar por etiquetas ",2),u.value.length>0?(n(),a("span",Bo,f(u.value.length),1)):F("",!0)]),o(t(ze),{class:_(["ml-3 h-4 w-4 text-gray-400 transition-all duration-200 group-hover:text-gray-600",{"rotate-180 text-primary":$.value,"text-primary":u.value.length>0&&!$.value}])},null,8,["class"])],2),o(ns,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:x(()=>[$.value?(n(),a("div",jo,[e("div",Uo,[e("div",zo,[No,T.value.length>0?(n(),a("span",Oo,f(T.value.length)+" disponibles ",1)):F("",!0)]),e("div",qo,[o(t(Ze),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),Te(e("input",{"onUpdate:modelValue":S[0]||(S[0]=C=>y.value=C),type:"text",placeholder:"Buscar etiquetas...",class:"w-full pl-9 pr-4 py-2.5 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-200"},null,512),[[Oe,y.value]])])]),u.value.length>0?(n(),a("div",Ro,[e("div",Vo,[e("span",Qo,f(u.value.length)+" etiqueta"+f(u.value.length!==1?"s":"")+" seleccionada"+f(u.value.length!==1?"s":""),1),e("button",{onClick:M,class:"text-xs text-red-600 hover:text-red-700 font-medium px-2 py-1 rounded-md hover:bg-red-50 transition-all duration-200"}," Limpiar todo ")])])):F("",!0),e("div",Go,[!k.value&&te.value.length===0&&y.value.trim()===""?(n(),a("div",Ho,[o(t(zt),{class:"h-8 w-8 text-gray-300 mx-auto mb-2"}),Zo])):F("",!0),!k.value&&te.value.length===0&&y.value.trim()!==""?(n(),a("div",Wo,[o(t(Ze),{class:"h-8 w-8 text-gray-300 mx-auto mb-2"}),e("p",Jo,'Sin resultados para "'+f(y.value)+'"',1),e("button",{onClick:S[1]||(S[1]=C=>y.value=""),class:"text-xs text-primary hover:text-primary-dark mt-2 font-medium"}," Ver todas las etiquetas ")])):F("",!0),k.value?(n(),a("div",Ko,Xo)):F("",!0),!k.value&&te.value.length>0?(n(),a("div",en,[(n(!0),a(ae,null,ue(te.value,C=>(n(),a("div",{key:C.id,class:"group flex items-center px-4 py-2.5 hover:bg-gray-50 cursor-pointer transition-colors duration-150",onClick:ie=>g(C)},[e("div",sn,[e("div",on,[e("input",{id:`tag-${C.id}`,type:"checkbox",checked:N(C),onChange:ie=>g(C),class:"sr-only"},null,40,nn),e("div",{class:_(["w-4 h-4 border-2 rounded transition-all duration-200 flex items-center justify-center",N(C)?"bg-primary border-primary":"border-gray-300 group-hover:border-gray-400"])},[N(C)?(n(),a("svg",rn,an)):F("",!0)],2)])]),e("div",dn,[e("div",{class:"w-3 h-3 rounded-full mr-2.5 border flex-shrink-0 shadow-sm",style:He({backgroundColor:V(C).hex})},null,4),e("span",cn,f(C.name),1)])],8,tn))),128))])):F("",!0)])])):F("",!0)]),_:1})]),u.value.length>0?(n(),a("div",un,[e("div",mn,[gn,e("div",pn,[(n(!0),a(ae,null,ue(u.value,C=>(n(),a("div",{key:C.id,class:"group inline-flex items-center pl-2.5 pr-1.5 py-1.5 rounded-lg text-xs font-medium border shadow-sm cursor-pointer transition-all duration-200 hover:shadow-md",style:He({backgroundColor:V(C).hex+"20",borderColor:V(C).hex+"40",color:V(C).dark}),onClick:ie=>g(C)},[e("div",{class:"w-2 h-2 rounded-full mr-2 flex-shrink-0",style:He({backgroundColor:V(C).hex})},null,4),e("span",fn,f(C.name),1),e("div",vn,[o(t(Le),{class:"h-3 w-3 opacity-60 group-hover:opacity-100"})])],12,hn))),128))])])])):F("",!0)]))}},yn=yt(bn,[["__scopeId","data-v-d403a707"]]),xn={class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},_n={class:"bg-white rounded-xl shadow-xl max-w-5xl w-full max-h-[90vh] overflow-hidden"},wn={class:"border-b"},$n={class:"hidden sm:flex justify-between items-center p-6"},kn=e("h3",{class:"text-lg font-semibold text-gray-900"},"Agregar Documentos",-1),Cn={class:"text-sm text-gray-600"},Dn={class:"sm:hidden p-4"},Sn={class:"flex justify-between items-start mb-2"},Fn={class:"flex-1 min-w-0 mr-3"},En=e("h3",{class:"text-lg font-semibold text-gray-900"},"Agregar Documentos",-1),An={class:"text-sm text-gray-600 truncate"},Tn={class:"border-b"},Mn={class:"hidden sm:flex space-x-8 px-6","aria-label":"Tabs"},Ln=["onClick"],Pn={class:"ml-2 bg-gray-100 text-gray-600 py-0.5 px-2 rounded-full text-xs"},In={class:"sm:hidden relative px-4 py-3"},Bn={class:"flex items-center"},jn={class:"ml-2 bg-gray-100 text-gray-600 py-0.5 px-2 rounded-full text-xs"},Un=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1),zn=[Un],Nn={class:"absolute top-full left-4 right-4 z-50 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg overflow-hidden"},On=["onClick"],qn={class:"border-b bg-gray-50 p-4 sm:p-6"},Rn={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},Vn={class:"flex-1"},Qn={key:0,class:"flex items-center gap-3"},Gn={class:"text-sm text-gray-600"},Hn={class:"p-4 sm:p-6 overflow-y-auto max-h-[calc(90vh-350px)]"},Zn={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4"},Wn={key:4,class:"absolute top-2 left-2 w-6 h-6 bg-primary text-white rounded-full flex items-center justify-center shadow-sm"},Jn={key:0,class:"text-center py-8 sm:py-12"},Kn={class:"text-lg font-medium text-gray-900 mb-2"},Yn={class:"text-gray-600 text-sm sm:text-base"},Xn={class:"border-t bg-gray-50"},er={class:"hidden sm:flex justify-between items-center p-6"},tr={class:"text-sm text-gray-600"},sr={class:"flex gap-3"},or=["disabled"],nr={class:"sm:hidden p-4 space-y-3"},rr={class:"text-center text-sm text-gray-600"},lr={class:"flex gap-3"},ar=["disabled"],ir={__name:"AddDocumentsModal",props:{isVisible:{type:Boolean,required:!0},folder:{type:Object,default:null}},emits:["close","add-documents"],setup(l,{emit:v}){const i=l,p=v,A=qe(),$=Je(),u=w([]),k=w([]),y=w("my-documents"),T=w(!1),te=w(!1),V=[{name:"my-documents",label:"Mis Documentos"},{name:"use-documents",label:"Formatos Disponibles"},{name:"pending-signatures",label:"Firmas Pendientes"},{name:"signed-documents",label:"Documentos Firmados"}],K=j(()=>$.currentUser);be(()=>i.isVisible,h=>{h&&(u.value=[],k.value=[],y.value="my-documents")}),be(y,()=>{u.value=[]}),be(k,()=>{u.value=[]},{deep:!0});const N=j(()=>{const h=M(y.value);return h.length===0?!1:h.every(L=>u.value.includes(L.id))}),g=h=>{var E;if(!i.folder)return[];const L=i.folder.documents.map(U=>U.id);let O=[];switch(h){case"my-documents":O=A.progressAndCompletedDocumentsByClient((E=K.value)==null?void 0:E.id);break;case"use-documents":O=A.publishedDocumentsUnassigned;break;case"pending-signatures":O=A.documents.filter(U=>{var ne,I;return U.state==="PendingSignatures"&&(U.assigned_to===((ne=K.value)==null?void 0:ne.id)||((I=U.signatures)==null?void 0:I.some(m=>{var P;return m.signer_email===((P=K.value)==null?void 0:P.email)})))});break;case"signed-documents":O=A.documents.filter(U=>{var ne,I;return U.state==="FullySigned"&&(U.assigned_to===((ne=K.value)==null?void 0:ne.id)||((I=U.signatures)==null?void 0:I.some(m=>{var P;return m.signer_email===((P=K.value)==null?void 0:P.email)})))});break;default:O=[]}return O.filter(U=>!L.includes(U.id))},M=h=>{const L=g(h);if(!k.value||k.value.length===0)return L;const O=k.value.map(E=>E.id);return L.filter(E=>!E.tags||E.tags.length===0?!1:E.tags.some(U=>O.includes(U.id)))},D=h=>{const L=u.value.indexOf(h);L>-1?u.value.splice(L,1):u.value.push(h)},G=()=>{const L=M(y.value).map(O=>O.id);if(N.value)u.value=u.value.filter(O=>!L.includes(O));else{const O=L.filter(E=>!u.value.includes(E));u.value.push(...O)}},S=()=>{p("close")},C=async()=>{if(u.value.length!==0){T.value=!0;try{await p("add-documents",u.value)}finally{T.value=!1}}},ie=h=>{y.value=h,te.value=!1},z=h=>{h.target.closest(".relative")||(te.value=!1)};return Ne(()=>{document.addEventListener("click",z)}),ut(()=>{document.removeEventListener("click",z)}),(h,L)=>l.isVisible&&l.folder?(n(),oe(Xe,{key:0},{default:x(()=>{var O;return[e("div",xn,[e("div",_n,[e("div",wn,[e("div",$n,[e("div",null,[kn,e("p",Cn,'Selecciona documentos para agregar a "'+f(l.folder.name)+'"',1)]),e("button",{onClick:S,class:"text-gray-400 hover:text-gray-500 hover:bg-gray-100 p-2 rounded-lg transition-colors"},[o(t(Le),{class:"w-5 h-5"})])]),e("div",Dn,[e("div",Sn,[e("div",Fn,[En,e("p",An,'Para "'+f(l.folder.name)+'"',1)]),e("button",{onClick:S,class:"text-gray-400 hover:text-gray-500 hover:bg-gray-100 p-2 rounded-lg transition-colors flex-shrink-0"},[o(t(Le),{class:"w-5 h-5"})])])])]),e("div",Tn,[e("nav",Mn,[(n(),a(ae,null,ue(V,E=>e("button",{key:E.name,onClick:U=>y.value=E.name,class:_([y.value===E.name?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])},[Y(f(E.label)+" ",1),e("span",Pn,f(M(E.name).length),1)],10,Ln)),64))]),e("div",In,[e("button",{onClick:L[0]||(L[0]=E=>te.value=!te.value),class:"w-full flex items-center justify-between py-3 px-4 bg-white border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary"},[e("div",Bn,[e("span",null,f(((O=V.find(E=>E.name===y.value))==null?void 0:O.label)||"Seleccionar categoría"),1),e("span",jn,f(M(y.value).length),1)]),(n(),a("svg",{class:_(["ml-2 h-5 w-5 transition-transform duration-200",te.value?"transform rotate-180":""]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},zn,2))]),Te(e("div",Nn,[(n(),a(ae,null,ue(V,E=>e("button",{key:E.name,onClick:U=>ie(E.name),class:_(["w-full text-left px-4 py-3 text-sm transition-colors duration-150 flex items-center justify-between",y.value===E.name?"bg-primary text-white":"text-gray-700 hover:bg-gray-50"])},[e("span",null,f(E.label),1),e("span",{class:_(["py-0.5 px-2 rounded-full text-xs",y.value===E.name?"bg-white/20 text-white":"bg-gray-100 text-gray-600"])},f(M(E.name).length),3)],10,On)),64))],512),[[Dt,te.value]])])]),e("div",qn,[e("div",Rn,[e("div",Vn,[o(yn,{modelValue:k.value,"onUpdate:modelValue":L[1]||(L[1]=E=>k.value=E),class:"max-w-md"},null,8,["modelValue"])]),M(y.value).length>0?(n(),a("div",Qn,[e("span",Gn,f(M(y.value).length)+" documento(s) disponible(s) ",1),e("button",{onClick:G,class:_(["px-4 py-2 rounded-lg border font-medium text-sm transition-colors",N.value?"bg-red-50 border-red-200 text-red-700 hover:bg-red-100":"bg-primary text-white border-primary hover:bg-primary-dark"])},f(N.value?"Deseleccionar todos":"Seleccionar todos"),3)])):F("",!0)])]),e("div",Hn,[e("div",Zn,[(n(!0),a(ae,null,ue(M(y.value),E=>(n(),a("div",{key:E.id,class:"relative"},[y.value==="my-documents"?(n(),oe(t(gs),{key:0,document:E,"highlighted-doc-id":null,"show-tags":!0,"show-client-name":!1,"menu-options":[],"disable-internal-actions":!0,"additional-classes":u.value.includes(E.id)?"ring-2 ring-primary bg-primary-50":"",onClick:U=>D(E.id)},null,8,["document","additional-classes","onClick"])):F("",!0),y.value==="use-documents"?(n(),oe(t(Is),{key:1,document:E,"show-tags":!0,"menu-options":[],"show-menu-options":!1,"disable-internal-actions":!0,"additional-classes":u.value.includes(E.id)?"ring-2 ring-primary bg-primary-50":"",onClick:U=>D(E.id)},null,8,["document","additional-classes","onClick"])):F("",!0),y.value==="pending-signatures"?(n(),oe(t(Ut),{key:2,document:E,"highlighted-doc-id":null,"show-tags":!0,"menu-options":[],"disable-internal-actions":!0,"additional-classes":u.value.includes(E.id)?"ring-2 ring-primary bg-primary-50":"",onClick:U=>D(E.id)},null,8,["document","additional-classes","onClick"])):F("",!0),y.value==="signed-documents"?(n(),oe(t(Ut),{key:3,document:E,"highlighted-doc-id":null,"show-tags":!0,"menu-options":[],"disable-internal-actions":!0,"additional-classes":u.value.includes(E.id)?"ring-2 ring-primary bg-primary-50":"",onClick:U=>D(E.id)},null,8,["document","additional-classes","onClick"])):F("",!0),u.value.includes(E.id)?(n(),a("div",Wn,[o(t(ps),{class:"w-4 h-4"})])):F("",!0)]))),128))]),M(y.value).length===0?(n(),a("div",Jn,[o(t(ct),{class:"w-12 h-12 sm:w-16 sm:h-16 text-gray-300 mx-auto mb-4"}),e("h4",Kn,f(k.value.length>0?"No hay documentos que coincidan con el filtro":"No hay documentos disponibles"),1),e("p",Yn,f(k.value.length>0?"Intenta ajustar los filtros de etiquetas o selecciona otra categoría":"No tienes documentos de esta categoría que no estén ya en la carpeta"),1)])):F("",!0)]),e("div",Xn,[e("div",er,[e("div",tr,f(u.value.length)+" documento(s) seleccionado(s) ",1),e("div",sr,[e("button",{onClick:S,class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"}," Cancelar "),e("button",{onClick:C,disabled:u.value.length===0||T.value,class:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},f(T.value?"Agregando...":`Agregar ${u.value.length} documento(s)`),9,or)])]),e("div",nr,[e("div",rr,f(u.value.length)+" documento(s) seleccionado(s) ",1),e("div",lr,[e("button",{onClick:S,class:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-center font-medium"}," Cancelar "),e("button",{onClick:C,disabled:u.value.length===0||T.value,class:"flex-1 px-4 py-3 bg-primary text-white rounded-lg hover:bg-primary-dark disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-center font-medium"},f(T.value?"Agregando...":"Agregar"),9,ar)])])])])])]}),_:1})):F("",!0)}},at=l=>(mt("data-v-d9a5a89f"),l=l(),gt(),l),dr={class:"folders-table"},cr={key:0,class:"bg-white rounded-lg shadow-sm border border-gray-200",style:{"overflow-x":"visible","overflow-y":"hidden"}},ur={class:"min-w-full divide-y divide-gray-200"},mr=at(()=>e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Carpeta "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Documentos "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Creada "),e("th",{scope:"col",class:"w-16 px-6 py-3"})])],-1)),gr={class:"bg-white divide-y divide-gray-200"},pr=["onClick"],hr={class:"px-6 py-4 whitespace-nowrap"},fr={class:"flex items-center"},vr={class:"flex-shrink-0 h-10 w-10"},br={class:"ml-4"},yr={class:"text-sm font-medium text-gray-900"},xr={class:"px-6 py-4 whitespace-nowrap"},_r={class:"flex items-center gap-2"},wr={class:"text-sm text-gray-900"},$r={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},kr={class:"py-1"},Cr=["onClick"],Dr=["onClick"],Sr=["onClick"],Fr=["onClick"],Er={key:1,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center"},Ar=at(()=>e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No tienes carpetas aún",-1)),Tr=at(()=>e("p",{class:"text-gray-600 mb-6"},"Crea tu primera carpeta para organizar tus documentos",-1)),Mr={key:2,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center"},Lr=at(()=>e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No se encontraron carpetas",-1)),Pr=at(()=>e("p",{class:"text-gray-600"},"No hay carpetas que coincidan con tu búsqueda",-1)),Ir={key:3,class:"flex justify-center items-center py-12"},Br=at(()=>e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"},null,-1)),jr=[Br],Ur={__name:"FoldersTable",props:{sortedFolders:{type:Array,required:!0},searchQuery:{type:String,default:""},isLoading:{type:Boolean,default:!1}},emits:["folder-click","edit-folder","delete-folder","add-documents","create-folder"],setup(l,{emit:v}){const i=l,p=v,A=w({}),$=w({}),u=w(!1),k=w(-1),y=j(()=>{if(!i.searchQuery.trim())return i.sortedFolders;const z=i.searchQuery.toLowerCase();return i.sortedFolders.filter(h=>h.name.toLowerCase().includes(z))}),T=[{name:"blue",hex:"#3B82F6"},{name:"purple",hex:"#8B5CF6"},{name:"pink",hex:"#EC4899"},{name:"green",hex:"#10B981"},{name:"yellow",hex:"#F59E0B"},{name:"red",hex:"#EF4444"},{name:"indigo",hex:"#6366F1"},{name:"teal",hex:"#14B8A6"}],te=z=>{if(z.color)return T.find(L=>L.name===z.color)||T[0];const h=z.id%T.length;return T[h]},V=z=>{if(!z)return"-";const h=new Date(z),O=Math.abs(new Date-h),E=Math.ceil(O/(1e3*60*60*24));return E===0?"Hoy":E===1?"Ayer":E<7?`Hace ${E} días`:E<30?`Hace ${Math.floor(E/7)} semanas`:E<365?`Hace ${Math.floor(E/30)} meses`:h.toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"})},K=z=>{p("folder-click",z)},N=z=>{p("edit-folder",z)},g=z=>{p("delete-folder",z)},M=z=>{p("add-documents",z)},D=()=>{p("create-folder")},G=()=>u.value?y.value.length===1?"280px":y.value.length===2&&k.value===1?"340px":"280px":"auto",S=(z,h)=>{z&&(A.value[h]=z)},C=(z,h)=>{z&&($.value[h]=z)},ie=(z,h)=>{u.value=!h,k.value=h?-1:z,h||setTimeout(()=>{const L=$.value[z];if(L){const O=L.$el||L;if(O&&O.getBoundingClientRect){const E=O.getBoundingClientRect(),U=window.innerHeight;if(z===0){if(E.bottom>U-20){const ne=E.bottom-U+40;window.scrollBy({top:ne,behavior:"smooth"})}}else if(E.bottom>U-10){const ne=E.bottom-U+30;window.scrollBy({top:ne,behavior:"smooth"})}else if(E.top<80){const ne=E.top-100;window.scrollBy({top:ne,behavior:"smooth"})}}}},100)};return(z,h)=>(n(),a("div",dr,[!l.isLoading&&y.value.length>0?(n(),a("div",cr,[e("div",{class:"overflow-x-auto",style:He({minHeight:G(),overflowY:"visible"})},[e("table",ur,[mr,e("tbody",gr,[(n(!0),a(ae,null,ue(y.value,(L,O)=>{var E,U;return n(),a("tr",{key:L.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:ne=>K(L)},[e("td",hr,[e("div",fr,[e("div",vr,[e("div",{class:"h-10 w-10 rounded-lg flex items-center justify-center",style:He({backgroundColor:te(L).hex+"20"})},[o(t(kt),{class:"h-6 w-6",style:He({color:te(L).hex})},null,8,["style"])],4)]),e("div",br,[e("div",yr,f(L.name),1)])])]),e("td",xr,[e("div",_r,[o(t(Re),{class:"h-5 w-5 text-gray-400"}),e("span",wr,f(((E=L.documents)==null?void 0:E.length)||0)+" documento"+f((((U=L.documents)==null?void 0:U.length)||0)!==1?"s":""),1)])]),e("td",$r,f(V(L.created_at)),1),e("td",{class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",onClick:h[0]||(h[0]=he(()=>{},["stop"]))},[o(t(Se),{as:"div",class:"relative inline-block text-left"},{default:x(({open:ne})=>[o(t(Fe),{ref_for:!0,ref:I=>S(I,O),onClick:I=>ie(O,ne),class:"inline-flex items-center justify-center w-8 h-8 rounded-md hover:bg-gray-100"},{default:x(()=>[o(t(st),{class:"h-5 w-5 text-gray-500"})]),_:2},1032,["onClick"]),o(t(Ee),{ref_for:!0,ref:I=>C(I,O),class:_([y.value.length>2&&O>0&&O>=y.value.length-3?"absolute right-0 z-[9999] bottom-full mb-2 w-48 origin-bottom-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none":"absolute right-0 z-[9999] mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"])},{default:x(()=>[e("div",kr,[o(t(ce),null,{default:x(({active:I})=>[e("a",{onClick:m=>K(L),class:_([I?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Ver carpeta ",10,Cr)]),_:2},1024),o(t(ce),null,{default:x(({active:I})=>[e("a",{onClick:m=>M(L),class:_([I?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Agregar documentos ",10,Dr)]),_:2},1024),o(t(ce),null,{default:x(({active:I})=>[e("a",{onClick:m=>N(L),class:_([I?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Editar ",10,Sr)]),_:2},1024),o(t(ce),null,{default:x(({active:I})=>[e("a",{onClick:m=>g(L),class:_([I?"bg-gray-100":"","block px-4 py-2 text-sm text-red-600 cursor-pointer"])}," Eliminar ",10,Fr)]),_:2},1024)])]),_:2},1032,["class"])]),_:2},1024)])],8,pr)}),128))])])],4)])):!l.isLoading&&l.sortedFolders.length===0?(n(),a("div",Er,[o(t(kt),{class:"w-16 h-16 text-gray-300 mx-auto mb-4"}),Ar,Tr,e("button",{onClick:D,class:"inline-flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors"},[o(t(Ye),{class:"w-5 h-5"}),Y(" Crear Primera Carpeta ")])])):!l.isLoading&&l.sortedFolders.length>0&&y.value.length===0?(n(),a("div",Mr,[o(t(kt),{class:"w-16 h-16 text-gray-300 mx-auto mb-4"}),Lr,Pr])):F("",!0),l.isLoading?(n(),a("div",Ir,jr)):F("",!0)]))}},zr=yt(Ur,[["__scopeId","data-v-d9a5a89f"]]),Jt=l=>(mt("data-v-ab5666d5"),l=l(),gt(),l),Nr={class:"folder-management"},Or={class:"mb-6"},qr={class:"hidden sm:flex justify-between items-center"},Rr=Jt(()=>e("div",null,[e("h2",{class:"text-xl font-semibold text-gray-900"},"Mis Carpetas"),e("p",{class:"text-sm text-gray-600 mt-1"},"Organiza tus documentos, firmas y formatos en carpetas personalizadas")],-1)),Vr={class:"sm:hidden"},Qr=Jt(()=>e("div",{class:"text-center mb-4"},[e("h2",{class:"text-xl font-semibold text-gray-900"},"Mis Carpetas"),e("p",{class:"text-sm text-gray-600 mt-1 px-2"},"Organiza tus documentos, firmas y formatos en carpetas personalizadas")],-1)),Gr={__name:"FolderManagement",props:{searchQuery:{type:String,default:""},selectedTags:{type:Array,default:()=>[]}},emits:["refresh","navigate-to-main"],setup(l,{emit:v}){const i=l,p=v,A=It(),$=qe(),u=Je(),k=w(!1),y=w(null),T=w(null),te=w(!1),V=w(null),K=j(()=>A.isLoading),N=j(()=>A.sortedFolders);j(()=>u.currentUser),Ne(async()=>{await A.init(),await $.init()}),be(()=>i.searchQuery,()=>{}),be(()=>A.folders,m=>{var P,R;if(T.value&&m&&m.length>0){const se=m.find(X=>X.id===T.value.id);if(se){const X=((P=T.value.documents)==null?void 0:P.length)||0,ge=((R=se.documents)==null?void 0:R.length)||0;JSON.stringify(T.value)!==JSON.stringify(se)&&(T.value={...se},console.log(`🔄 FolderManagement: Synced selectedFolder "${se.name}" with store. Documents: ${X} → ${ge}`))}}},{deep:!0});const g=()=>{y.value=null,k.value=!0},M=m=>{y.value=m,k.value=!0},D=()=>{k.value=!1,y.value=null},G=()=>{D()},S=m=>{T.value=m},C=()=>{T.value=null},ie=async m=>{if(confirm(`¿Estás seguro de que quieres eliminar la carpeta "${m.name}"?`))try{await A.deleteFolder(m.id),$e(`Carpeta "${m.name}" eliminada correctamente`,"success")}catch(P){$e("Error al eliminar la carpeta","error"),console.error("Error deleting folder:",P)}},z=m=>{V.value=m,te.value=!0},h=async(m=!1)=>{if(te.value=!1,V.value=null,m&&T.value)try{await L()}catch(P){console.warn("Error refreshing folder after adding documents:",P)}},L=async()=>{if(T.value)try{await A.fetchFolderById(T.value.id,!0);const m=A.getFolderById(T.value.id);m&&(T.value={...m},console.log("✅ Selected folder refreshed successfully"))}catch(m){throw console.error("❌ Error refreshing selected folder:",m),m}},O=async m=>{var P,R,se;if(!(!V.value||m.length===0))try{const X=V.value.documents.map(pe=>pe.id).filter(pe=>pe!=null&&!isNaN(parseInt(pe))).map(pe=>parseInt(pe)),ge=m.filter(pe=>pe!=null&&!isNaN(parseInt(pe))).map(pe=>parseInt(pe)),de=[...new Set([...X,...ge])];if(console.log("Current document IDs:",X),console.log("Selected document IDs:",ge),console.log("Updated document IDs:",de),de.some(pe=>!Number.isInteger(pe)||pe<=0))throw new Error("IDs de documentos inválidos detectados");await A.updateFolder(V.value.id,{document_ids:de}),await h(!0),$e(`${ge.length} documento(s) agregado(s) a la carpeta`,"success"),p("navigate-to-main")}catch(X){console.error("Error adding documents to folder:",X),console.error("Error details:",((P=X.response)==null?void 0:P.data)||X.message),(R=X.response)!=null&&R.status?$e(`Error al agregar documentos: ${((se=X.response.data)==null?void 0:se.detail)||X.message}`,"error"):$e("Error al agregar documentos a la carpeta","error")}},E=async m=>{var P,R,se;if(T.value)try{const X=parseInt(m);if(!Number.isInteger(X)||X<=0)throw new Error("ID de documento inválido");const ge=T.value.documents.map(de=>de.id).filter(de=>de!=null&&!isNaN(parseInt(de))).map(de=>parseInt(de)).filter(de=>de!==X);console.log("Removing document ID:",X),console.log("Updated document IDs after removal:",ge),await A.updateFolder(T.value.id,{document_ids:ge}),$e("Documento removido de la carpeta","success"),T.value=null,p("navigate-to-main");try{await A.fetchFolderById(T.value.id,!0);const de=A.getFolderById(T.value.id);de&&(T.value=de),console.log("Folder data refreshed successfully after removal")}catch(de){console.warn("Error refreshing folder data:",de);try{T.value={...T.value,documents:T.value.documents.filter(pe=>pe.id!==X)},console.log("Applied optimistic removal for document ID:",X)}catch(pe){console.warn("Optimistic update failed:",pe)}}}catch(X){console.error("Error removing document from folder:",X),console.error("Error details:",((P=X.response)==null?void 0:P.data)||X.message),(R=X.response)!=null&&R.status?$e(`Error al remover documento: ${((se=X.response.data)==null?void 0:se.detail)||X.message}`,"error"):$e("Error al remover el documento de la carpeta","error")}},U=m=>{console.log("View document:",m)},ne=m=>{console.log("Use document:",m)},I=(m,P)=>{console.log("Document action:",m,P)};return(m,P)=>(n(),a("div",Nr,[e("div",Or,[e("div",qr,[Rr,e("button",{onClick:g,class:"inline-flex items-center gap-2 px-4 py-2.5 bg-primary text-white rounded-xl hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-all duration-200 shadow-sm hover:shadow-md"},[o(t(Ye),{class:"w-5 h-5"}),Y(" Nueva Carpeta ")])]),e("div",Vr,[Qr,e("button",{onClick:g,class:"w-full flex items-center justify-center gap-3 px-4 py-4 bg-primary text-white rounded-xl hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-all duration-200 shadow-sm hover:shadow-md font-medium text-base"},[o(t(Ye),{class:"w-6 h-6"}),Y(" Nueva Carpeta ")])])]),o(t(zr),{"sorted-folders":N.value,"search-query":l.searchQuery,"is-loading":K.value,onFolderClick:S,onEditFolder:M,onDeleteFolder:ie,onAddDocuments:z,onCreateFolder:g},null,8,["sorted-folders","search-query","is-loading"]),o(t(Ys),{"is-visible":k.value,"editing-folder":y.value,onClose:D,onSuccess:G},null,8,["is-visible","editing-folder"]),o(t(Mo),{folder:T.value,onClose:C,onAddDocuments:z,onRemoveDocument:E,onViewDocument:U,onUseDocument:ne,onDocumentAction:I},null,8,["folder"]),o(t(ir),{"is-visible":te.value,folder:V.value,onClose:h,onAddDocuments:O},null,8,["is-visible","folder"])]))}},Hr=yt(Gr,[["__scopeId","data-v-ab5666d5"]]);function Bt(){const l=Je(),v=j(()=>{var $;return(($=l.currentUser)==null?void 0:$.role)==="basic"}),i=$=>{$e("Esta funcionalidad está restringida para usuarios básicos. Por favor, contacta a tu abogado para obtener acceso completo.","warning")};return{isBasicUser:v,showRestrictionNotification:i,handleFeatureAccess:($,u)=>v.value?(i(),!1):(u&&u(),!0),getRestrictedButtonClasses:$=>$?"opacity-60 cursor-not-allowed":""}}function Zr(l){return!l.variables||l.variables.length===0?!0:l.variables.every(v=>v.name_es&&v.name_es.trim().length>0)}function Mt(l,v){var A;if(!l.requires_signature||l.state!=="PendingSignatures"||!l.signatures||l.signatures.length===0)return!1;const i=(A=v==null?void 0:v.currentUser)==null?void 0:A.email,p=l.signatures.find($=>$.signer_email===i);return!(!p||p.signed)}const Wr={lawyer:{getMenuOptions:(l,v,i)=>{const p=[{label:"Editar",action:"edit"},{label:"Permisos",action:"permissions"},{label:"Administrar Asociaciones",action:"relationships"},{label:"Eliminar",action:"delete"},{label:"Previsualización",action:"preview"},{label:"Crear una Copia",action:"copy"},{label:"Gestionar Membrete",action:"letterhead"}];return l.state==="Draft"?p.push({label:"Publicar",action:"publish",disabled:!Zr(l)}):l.state==="Published"&&(p.push({label:"Mover a Borrador",action:"draft"}),p.push({label:"Formalizar y Agregar Firmas",action:"formalize"})),(l.state==="Completed"||l.state==="Published")&&p.push({label:"Descargar PDF",action:"downloadPDF"},{label:"Descargar Word",action:"downloadWord"},{label:"Enviar por Email",action:"email"}),l.requires_signature&&(p.push({label:"Ver Firmas",action:"viewSignatures"}),Mt(l,i)&&p.push({label:"Firmar documento",action:"sign"})),p}},signatures:{getMenuOptions:(l,v,i)=>{const p=[{label:"Previsualizar",action:"preview"},{label:"Gestionar Membrete",action:"letterhead"}];return l.requires_signature&&(l.state==="PendingSignatures"||l.state==="FullySigned")&&p.push({label:"Estado de las firmas",action:"viewSignatures"}),Mt(l,i)&&p.push({label:"Firmar documento",action:"sign"}),l.state==="FullySigned"&&p.push({label:"Descargar Documento firmado",action:"downloadSignedDocument"}),l.state==="PendingSignatures"&&p.push({label:"Descargar PDF",action:"downloadPDF"}),p}},client:{getMenuOptions:(l,v,i)=>{var u,k,y;const p=[],A=((u=i==null?void 0:i.currentUser)==null?void 0:u.role)==="basic",$=((k=i==null?void 0:i.currentUser)==null?void 0:k.role)==="corporate_client"||((y=i==null?void 0:i.currentUser)==null?void 0:y.role)==="client";return l.state==="Completed"?(p.push({label:"Editar",action:"edit-submenu",isGroup:!0,children:[{label:"Editar Formulario",action:"editForm"},{label:"Editar Documento",action:"editDocument"}]}),$&&p.push({label:"Formalizar y Agregar Firmas",action:"formalize"})):p.push({label:"Completar",action:"editForm"}),l.state==="Completed"&&p.push({label:"Previsualizar",action:"preview"}),p.push({label:"Eliminar",action:"delete"}),A?p.push({label:"Gestionar Membrete",action:"letterhead",disabled:!0}):p.push({label:"Gestionar Membrete",action:"letterhead"}),p.push({label:"Administrar Asociaciones",action:"relationships"}),l.requires_signature&&(p.push({label:"Ver Firmas",action:"viewSignatures"}),Mt(l,i)&&p.push({label:"Firmar documento",action:"sign"})),l.state==="Completed"&&p.push({label:"Descargar PDF",action:"downloadPDF"},{label:"Descargar Word",action:"downloadWord"},{label:"Enviar",action:"email"}),p}}};function Jr(l,v,i="list",p=null){const A=Wr[l];return A?A.getMenuOptions(v,i,p):[]}const Kr={class:"relative bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col"},Yr={class:"px-6 py-4 border-b border-gray-200"},Xr=e("h2",{class:"text-xl font-semibold text-gray-800"},"Acciones del Documento",-1),el={class:"text-sm text-gray-500 mt-1"},tl={class:"p-6 overflow-y-auto flex-grow"},sl={class:"space-y-4"},ol={key:0,class:"text-sm font-semibold text-gray-700 uppercase tracking-wide px-2"},nl={class:"grid grid-cols-1 sm:grid-cols-2 gap-2"},rl=["onClick","disabled"],ll={class:"text-sm font-medium"},al={key:1,class:"border-t border-gray-200 my-4"},il={key:0,class:"text-center py-12"},dl=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No hay acciones disponibles",-1),cl=e("p",{class:"mt-1 text-sm text-gray-500"}," No hay opciones disponibles para este documento. ",-1),_t={__name:"DocumentActionsModal",props:{isVisible:{type:Boolean,default:!1},document:{type:Object,default:null},cardType:{type:String,required:!0,validator:l=>["lawyer","client","signatures"].includes(l)},context:{type:String,default:"table"},userStore:{type:Object,default:null}},emits:["close","action"],setup(l,{emit:v}){const i=l,p=v,A=j(()=>i.document?Jr(i.cardType,i.document,i.context,i.userStore):[]),$=j(()=>{const N=A.value;if(!N||N.length===0)return[];const g=[],M={edit:"Edición",view:"Visualización",share:"Compartir",manage:"Gestión",signatures:"Firmas",delete:"Eliminación"},D={edit:[],view:[],share:[],manage:[],signatures:[],delete:[]};return N.forEach(G=>{if(G.children&&Array.isArray(G.children))G.children.forEach(S=>{const C=S.action.toLowerCase();u(S,C,D)});else{const S=G.action.toLowerCase();u(G,S,D)}}),D.edit.length>0&&g.push({title:M.edit,options:D.edit}),D.view.length>0&&g.push({title:M.view,options:D.view}),D.share.length>0&&g.push({title:M.share,options:D.share}),D.signatures.length>0&&g.push({title:M.signatures,options:D.signatures}),D.manage.length>0&&g.push({title:M.manage,options:D.manage}),D.delete.length>0&&g.push({title:M.delete,options:D.delete}),g}),u=(N,g,M)=>{g.includes("edit")||g.includes("editar")||g==="copy"||g==="draft"||g==="publish"||g==="formalize"||g==="completar"?M.edit.push(N):g.includes("view")||g.includes("preview")||g.includes("ver")||g.includes("previsualización")?M.view.push(N):g.includes("download")||g.includes("email")||g.includes("enviar")||g.includes("descargar")?M.share.push(N):g.includes("signature")||g.includes("firma")||g.includes("sign")?M.signatures.push(N):g.includes("permission")||g.includes("relationship")||g.includes("letterhead")||g.includes("permiso")||g.includes("asociación")||g.includes("membrete")?M.manage.push(N):g.includes("delete")||g.includes("eliminar")?M.delete.push(N):M.manage.push(N)},k=N=>{const g=N.toLowerCase();return g==="editform"||g.includes("completar")?qt:g==="editdocument"||g.includes("editar documento")?Nt:g.includes("edit")||g==="editar"?Nt:g.includes("delete")||g==="eliminar"?Ht:g.includes("preview")||g.includes("ver")||g.includes("previsualización")?Gt:g==="copy"||g.includes("copia")?us:g.includes("download")||g.includes("descargar")?nt:g.includes("email")||g.includes("enviar")?ls:g.includes("permission")||g.includes("permiso")?hs:g.includes("relationship")||g.includes("asociación")?fs:g.includes("letterhead")||g.includes("membrete")?Zt:g.includes("signature")||g.includes("firma")?Wt:g==="publish"||g.includes("publicar")?_s:g==="draft"||g.includes("borrador")?Re:g==="formalize"||g.includes("formalizar")?qt:ct},y=N=>{const g=N.toLowerCase();return g.includes("delete")||g==="eliminar"?"text-red-600":g.includes("download")||g.includes("descargar")?"text-blue-600":g.includes("email")||g.includes("enviar")?"text-green-600":g.includes("signature")||g.includes("firma")?"text-purple-600":"text-gray-600"},T=N=>{const g=N.toLowerCase();return g.includes("delete")||g==="eliminar"?"border-red-200 bg-red-50 text-red-700 hover:bg-red-100 hover:border-red-300":g.includes("download")||g.includes("descargar")?"border-blue-200 bg-blue-50 text-blue-700 hover:bg-blue-100 hover:border-blue-300":g.includes("email")||g.includes("enviar")?"border-green-200 bg-green-50 text-green-700 hover:bg-green-100 hover:border-green-300":g.includes("signature")||g.includes("firma")?"border-purple-200 bg-purple-50 text-purple-700 hover:bg-purple-100 hover:border-purple-300":"border-gray-200 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-300"},{handleFeatureAccess:te}=Bt(),V=N=>{const g=A.value.find(D=>D.action===N?D:D.children?D.children.find(G=>G.action===N):null),M=g!=null&&g.children?g.children.find(D=>D.action===N):g;if(M!=null&&M.disabled){te("Esta funcionalidad",null);return}p("action",N,i.document)},K=()=>{p("close")};return(N,g)=>Te((n(),oe(Xe,null,{default:x(()=>{var M;return[e("div",Kr,[e("div",Yr,[Xr,e("p",el,f(((M=l.document)==null?void 0:M.title)||"Cargando..."),1),e("button",{onClick:K,class:"absolute top-4 right-4 text-gray-400 hover:text-gray-500 transition-colors"},[o(t(Le),{class:"h-6 w-6"})])]),e("div",tl,[e("div",sl,[(n(!0),a(ae,null,ue($.value,(D,G)=>(n(),a("div",{key:G,class:"space-y-2"},[D.title?(n(),a("h3",ol,f(D.title),1)):F("",!0),e("div",nl,[(n(!0),a(ae,null,ue(D.options,S=>(n(),a("button",{key:S.action,onClick:C=>V(S.action),disabled:S.disabled,class:_(["flex items-center justify-start px-4 py-3 rounded-lg border transition-all duration-200",S.disabled?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed opacity-60":T(S.action),"hover:shadow-md hover:scale-[1.02]"])},[(n(),oe(rs(k(S.action)),{class:_(["h-5 w-5 mr-3 flex-shrink-0",S.disabled?"text-gray-400":y(S.action)])},null,8,["class"])),e("span",ll,f(S.label),1),S.disabled?(n(),oe(t(cs),{key:0,class:"h-4 w-4 ml-auto text-gray-400"})):F("",!0)],10,rl))),128))]),G<$.value.length-1?(n(),a("div",al)):F("",!0)]))),128)),$.value.length===0?(n(),a("div",il,[o(t(ct),{class:"mx-auto h-12 w-12 text-gray-400"}),dl,cl])):F("",!0)])])])]}),_:1},512)),[[Dt,l.isVisible]])}},ul={class:"document-list-client-table"},ml={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6"},gl={class:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between"},pl={class:"flex flex-col sm:flex-row gap-3 flex-1 w-full lg:w-auto"},hl={class:"relative flex-1 min-w-[200px]"},fl={class:"max-w-[120px] truncate"},vl={class:"p-2"},bl={class:"relative mb-2"},yl={class:"max-h-60 overflow-y-auto"},xl=["onClick"],_l={class:"truncate"},wl={key:0,class:"px-3 py-2 text-sm text-gray-500 text-center"},$l={class:"flex items-center gap-3 w-full lg:w-auto"},kl={class:"text-sm text-gray-500 whitespace-nowrap"},Cl={class:"py-1"},Dl={class:"bg-white rounded-lg shadow-sm border border-gray-200"},Sl={class:"overflow-x-auto"},Fl={class:"min-w-full divide-y divide-gray-200"},El=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Documento "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Firma "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etiqueta ")])],-1),Al={class:"bg-white divide-y divide-gray-200"},Tl=["onClick"],Ml={class:"px-6 py-4 whitespace-nowrap"},Ll={class:"flex items-center"},Pl={class:"flex-shrink-0 h-10 w-10"},Il={class:"h-10 w-10 rounded-lg bg-blue-100 flex items-center justify-center"},Bl={class:"ml-4"},jl={class:"text-sm font-medium text-gray-900"},Ul={class:"px-6 py-4 whitespace-nowrap"},zl={class:"px-6 py-4 whitespace-nowrap"},Nl={class:"px-6 py-4 whitespace-nowrap"},Ol={class:"flex flex-wrap gap-1"},ql={key:0,class:"text-sm text-gray-400"},Rl={key:0,class:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"},Vl={class:"flex flex-1 justify-between sm:hidden"},Ql=["disabled"],Gl=["disabled"],Hl={class:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between"},Zl={class:"text-sm text-gray-700"},Wl={class:"font-medium"},Jl={class:"font-medium"},Kl={class:"font-medium"},Yl={class:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination"},Xl=["disabled"],ea=e("span",{class:"sr-only"},"Anterior",-1),ta=["onClick"],sa={key:1,class:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700"},oa=["disabled"],na=e("span",{class:"sr-only"},"Siguiente",-1),ra={key:1,class:"text-center py-12"},la=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No hay documentos",-1),aa=e("p",{class:"mt-1 text-sm text-gray-500"},"Los documentos asignados por tu abogado aparecerán aquí.",-1),ia={__name:"DocumentListClientTable",props:{searchQuery:String,selectedTags:{type:Array,default:()=>[]}},emits:["refresh","open-letterhead","open-relationships"],setup(l,{emit:v}){const i=qe(),p=Je(),A=et(),$=v,{handleFeatureAccess:u}=Bt(),{activeModals:k,openModal:y,closeModal:T}=ft(i,p),{handlePreviewDocument:te,deleteDocument:V,downloadPDFDocument:K,downloadWordDocument:N,formalizeDocument:g,signDocument:M}=vt(i,p,$);be(k,r=>{},{deep:!0}),Ne(()=>{});const D=w(""),G=w(""),S=w(null),C=w("recent");Ne(()=>{i.init(),p.init()});const ie=j(()=>p.getCurrentUser),z=j(()=>ie.value?i.progressAndCompletedDocumentsByClient(ie.value.id):[]),h=j(()=>{let r=[...z.value];const s=D.value.toLowerCase();return s&&(r=r.filter(c=>{var J,me;return((J=c.title)==null?void 0:J.toLowerCase().includes(s))||((me=c.tags)==null?void 0:me.some(Me=>{var we;return(we=Me.name)==null?void 0:we.toLowerCase().includes(s)}))})),S.value&&(r=r.filter(c=>c.tags&&c.tags.some(J=>J.id===S.value))),C.value==="name"?r.sort((c,J)=>{const me=(c.title||"").toLowerCase(),Me=(J.title||"").toLowerCase();return me.localeCompare(Me)}):C.value==="recent"&&r.sort((c,J)=>J.id-c.id),r}),L=w(1),O=w(10),E=j(()=>{const r=(L.value-1)*O.value,s=r+O.value;return h.value.slice(r,s)}),U=j(()=>Math.ceil(h.value.length/O.value)),ne=j(()=>{const r=(L.value-1)*O.value+1,s=Math.min(L.value*O.value,h.value.length);return{start:r,end:s,total:h.value.length}});be([D,S,C],()=>{L.value=1});const I=j(()=>{const r=U.value,s=L.value,c=[];if(r<=7)for(let J=1;J<=r;J++)c.push(J);else if(s<=4){for(let J=1;J<=5;J++)c.push(J);c.push("..."),c.push(r)}else if(s>=r-3){c.push(1),c.push("...");for(let J=r-4;J<=r;J++)c.push(J)}else c.push(1),c.push("..."),c.push(s-1),c.push(s),c.push(s+1),c.push("..."),c.push(r);return c}),m=()=>{L.value>1&&L.value--},P=()=>{L.value<U.value&&L.value++},R=r=>{r>=1&&r<=U.value&&(L.value=r)},se=j(()=>{const r=new Map;return z.value.forEach(s=>{s.tags&&s.tags.length>0&&s.tags.forEach(c=>{r.has(c.id)||r.set(c.id,c)})}),Array.from(r.values()).sort((s,c)=>s.name.localeCompare(c.name))}),X=j(()=>{if(!G.value)return se.value;const r=G.value.toLowerCase();return se.value.filter(s=>s.name.toLowerCase().includes(r))}),ge=j(()=>{if(!S.value)return null;const r=se.value.find(s=>s.id===S.value);return r?r.name:null}),de=j(()=>{switch(C.value){case"name":return"Nombre (A-Z)";case"recent":default:return"Más recientes"}}),pe=r=>r.state==="Completed"?"Completado":r.state==="Progress"?"En Progreso":r.state||"Sin estado",Ce=r=>r.state==="Completed"?"bg-green-100 text-green-700 border border-green-200":r.state==="Progress"?"bg-blue-100 text-blue-700 border border-blue-200":"bg-gray-100 text-gray-700 border border-gray-200",De=r=>{if(!r.signatures||r.signatures.length===0)return"Sin Firma";if(r.fully_signed)return"Firmado";const s=r.signatures.find(J=>{var me;return J.user_id===((me=ie.value)==null?void 0:me.id)});return s?s.signed?"Firmado":"Pendiente Firmar":r.signatures.some(J=>!J.signed)?"Pendiente Firmar":"Sin Firma"},Ve=r=>{const s=De(r);return s==="Sin Firma"?"bg-yellow-100 text-yellow-700 border border-yellow-200":s==="Firmado"?"bg-green-100 text-green-700 border border-green-200":s==="Pendiente Firmar"?"bg-blue-100 text-blue-700 border border-blue-200":s==="Devuelto Sin Firma"?"bg-red-100 text-red-700 border border-red-200":"bg-gray-100 text-gray-700 border border-gray-200"},Ie=r=>{const s=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],c=r.id%s.length;return s[c]},Qe=r=>{const s=["bg-blue-500","bg-purple-500","bg-pink-500","bg-yellow-500","bg-green-500","bg-red-500","bg-indigo-500","bg-orange-500"],c=r.id%s.length;return s[c]},Ue=()=>{S.value=null},W=w(!1),re=w(null),fe=r=>{re.value=r,W.value=!0},Pe=async(r,s)=>{W.value=!1,await d(r,s)},d=async(r,s)=>{var c;try{switch(r){case"editForm":y("edit",s,{userRole:((c=p.currentUser)==null?void 0:c.role)||"client"});break;case"editDocument":A.push(`/dynamic_document_dashboard/client/editor/edit/${s.id}`);break;case"preview":await te(s);break;case"delete":await V(s);break;case"letterhead":u("Membrete Individual",()=>{y("letterhead",s)});break;case"relationships":y("relationships",s);break;case"downloadPDF":await K(s);break;case"downloadWord":await N(s);break;case"email":y("email",s);break;case"formalize":await g(s);break;case"viewSignatures":y("signatures",s);break;case"sign":await M(s,y);break;default:console.warn("Unknown action:",r)}}catch(J){console.error(`Error executing action ${r}:`,J)}};return(r,s)=>(n(),a(ae,null,[e("div",ul,[e("div",ml,[e("div",gl,[e("div",pl,[e("div",hl,[o(t(Ze),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),Te(e("input",{"onUpdate:modelValue":s[0]||(s[0]=c=>D.value=c),type:"text",placeholder:"Buscar...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent"},null,512),[[Oe,D.value]])]),o(t(Se),{as:"div",class:"relative"},{default:x(()=>[o(t(Fe),{class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:x(()=>[o(t(tt),{class:"h-4 w-4"}),e("span",fl,f(ge.value||"Etiqueta"),1),o(t(ze),{class:"h-4 w-4"})]),_:1}),o(t(Ee),{class:"absolute left-0 z-10 mt-2 w-64 origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:x(()=>[e("div",vl,[e("div",bl,[o(t(Ze),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),Te(e("input",{"onUpdate:modelValue":s[1]||(s[1]=c=>G.value=c),type:"text",placeholder:"Buscar etiquetas...",class:"w-full pl-9 pr-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent",onClick:s[2]||(s[2]=he(()=>{},["stop"]))},null,512),[[Oe,G.value]])]),e("div",yl,[o(t(ce),null,{default:x(({active:c})=>[e("a",{onClick:s[3]||(s[3]=J=>S.value=null),class:_([c?"bg-gray-100":"","block px-3 py-2 text-sm text-gray-700 cursor-pointer rounded-md"])}," Todos ",2)]),_:1}),(n(!0),a(ae,null,ue(X.value,c=>(n(),oe(t(ce),{key:c.id},{default:x(({active:J})=>[e("a",{onClick:me=>S.value=c.id,class:_([J?"bg-gray-100":"","flex items-center gap-2 px-3 py-2 text-sm cursor-pointer rounded-md"])},[e("span",{class:_(["w-3 h-3 rounded-full flex-shrink-0",Qe(c)])},null,2),e("span",_l,f(c.name),1)],10,xl)]),_:2},1024))),128)),X.value.length===0?(n(),a("div",wl," No se encontraron etiquetas ")):F("",!0)])])]),_:1})]),_:1}),S.value?(n(),a("button",{key:0,onClick:Ue,class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",title:"Limpiar filtros"},[o(t(Le),{class:"h-4 w-4"}),Y(" Limpiar ")])):F("",!0)]),e("div",$l,[e("span",kl,f(h.value.length)+" "+f(h.value.length===1?"resultado":"resultados"),1),o(t(Se),{as:"div",class:"relative"},{default:x(()=>[o(t(Fe),{class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:x(()=>[Y(" Ordenar: "+f(de.value)+" ",1),o(t(ze),{class:"h-4 w-4"})]),_:1}),o(t(Ee),{class:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:x(()=>[e("div",Cl,[o(t(ce),null,{default:x(({active:c})=>[e("a",{onClick:s[4]||(s[4]=J=>C.value="recent"),class:_([c?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Más recientes ",2)]),_:1}),o(t(ce),null,{default:x(({active:c})=>[e("a",{onClick:s[5]||(s[5]=J=>C.value="name"),class:_([c?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Nombre (A-Z) ",2)]),_:1})])]),_:1})]),_:1})])])]),e("div",Dl,[e("div",Sl,[e("table",Fl,[El,e("tbody",Al,[(n(!0),a(ae,null,ue(E.value,(c,J)=>(n(),a("tr",{key:c.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:me=>fe(c)},[e("td",Ml,[e("div",Ll,[e("div",Pl,[e("div",Il,[o(t(Re),{class:"h-5 w-5 text-blue-600"})])]),e("div",Bl,[e("div",jl,f(c.title),1)])])]),e("td",Ul,[e("span",{class:_(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",Ce(c)])},f(pe(c)),3)]),e("td",zl,[e("span",{class:_(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",Ve(c)])},f(De(c)),3)]),e("td",Nl,[e("div",Ol,[(n(!0),a(ae,null,ue(c.tags,me=>(n(),a("span",{key:me.id,class:_(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",Ie(me)])},f(me.name),3))),128)),!c.tags||c.tags.length===0?(n(),a("span",ql,"-")):F("",!0)])])],8,Tl))),128))])])]),U.value>1?(n(),a("div",Rl,[e("div",Vl,[e("button",{onClick:m,disabled:L.value===1,class:_(["relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",L.value===1?"opacity-50 cursor-not-allowed":""])}," Anterior ",10,Ql),e("button",{onClick:P,disabled:L.value===U.value,class:_(["relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",L.value===U.value?"opacity-50 cursor-not-allowed":""])}," Siguiente ",10,Gl)]),e("div",Hl,[e("div",null,[e("p",Zl,[Y(" Mostrando "),e("span",Wl,f(ne.value.start),1),Y(" a "),e("span",Jl,f(ne.value.end),1),Y(" de "),e("span",Kl,f(ne.value.total),1),Y(" resultados ")])]),e("div",null,[e("nav",Yl,[e("button",{onClick:m,disabled:L.value===1,class:_(["relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",L.value===1?"opacity-50 cursor-not-allowed":""])},[ea,o(t(pt),{class:"h-5 w-5","aria-hidden":"true"})],10,Xl),(n(!0),a(ae,null,ue(I.value,c=>(n(),a(ae,{key:c},[c!=="..."?(n(),a("button",{key:0,onClick:J=>R(c),class:_(["relative inline-flex items-center px-4 py-2 text-sm font-semibold focus:z-20 focus:outline-offset-0",L.value===c?"z-10 bg-secondary text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-secondary":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50"])},f(c),11,ta)):(n(),a("span",sa," ... "))],64))),128)),e("button",{onClick:P,disabled:L.value===U.value,class:_(["relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",L.value===U.value?"opacity-50 cursor-not-allowed":""])},[na,o(t(rt),{class:"h-5 w-5","aria-hidden":"true"})],10,oa)])])])])):F("",!0),h.value.length===0?(n(),a("div",ra,[o(t(lt),{class:"mx-auto h-12 w-12 text-gray-400"}),la,aa])):F("",!0)])]),(n(),oe(ht,{to:"body"},[t(k).edit.isOpen?(n(),oe(St,{key:0,document:t(k).edit.document,"user-role":t(k).edit.userRole,onClose:s[6]||(s[6]=c=>t(T)("edit")),onRefresh:s[7]||(s[7]=c=>$("refresh"))},null,8,["document","user-role"])):F("",!0),t(k).email.isOpen?(n(),oe(Ft,{key:1,document:t(k).email.document,onClose:s[8]||(s[8]=c=>t(T)("email"))},null,8,["document"])):F("",!0),t(k).letterhead.isOpen?(n(),oe(bt,{key:2,"is-visible":!0,document:t(k).letterhead.document,onClose:s[9]||(s[9]=c=>t(T)("letterhead")),onRefresh:s[10]||(s[10]=c=>$("refresh"))},null,8,["document"])):F("",!0),t(k).relationships.isOpen?(n(),oe(Et,{key:3,"is-open":!0,document:t(k).relationships.document,onClose:s[11]||(s[11]=c=>t(T)("relationships")),onRefresh:s[12]||(s[12]=c=>$("refresh"))},null,8,["document"])):F("",!0),W.value?(n(),oe(_t,{key:4,"is-visible":W.value,document:re.value,"card-type":"client",context:"table","user-store":t(p),onClose:s[13]||(s[13]=c=>W.value=!1),onAction:Pe},null,8,["is-visible","document","user-store"])):F("",!0)]))],64))}},da={class:"mb-4"},ca={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6"},ua={class:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between"},ma={class:"flex flex-col sm:flex-row gap-3 flex-1 w-full lg:w-auto"},ga={class:"relative flex-1 min-w-[200px]"},pa={class:"max-w-[120px] truncate"},ha={class:"p-2"},fa={class:"relative mb-2"},va={class:"max-h-60 overflow-y-auto"},ba=["onClick"],ya={class:"truncate"},xa={key:0,class:"px-3 py-2 text-sm text-gray-500 text-center"},_a={class:"flex items-center gap-3 w-full lg:w-auto"},wa={class:"text-sm text-gray-500 whitespace-nowrap"},$a={class:"py-1"},ka={key:0,class:"bg-white rounded-lg shadow-sm border border-gray-200"},Ca={class:"min-w-full divide-y divide-gray-200"},Da=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Plantilla "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etiquetas "),e("th",{scope:"col",class:"w-16 px-6 py-3"})])],-1),Sa={class:"bg-white divide-y divide-gray-200"},Fa=["onClick"],Ea={class:"px-6 py-4 whitespace-nowrap"},Aa={class:"flex items-center"},Ta={class:"flex-shrink-0 h-10 w-10"},Ma={class:"h-10 w-10 rounded-lg bg-purple-100 flex items-center justify-center"},La={class:"ml-4"},Pa={class:"text-sm font-medium text-gray-900"},Ia=e("td",{class:"px-6 py-4 whitespace-nowrap"},[e("span",{class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-purple-100 text-purple-700 border border-purple-200"}," Disponible ")],-1),Ba={class:"px-6 py-4 whitespace-nowrap"},ja={class:"flex flex-wrap gap-1"},Ua={key:0,class:"text-sm text-gray-400"},za={class:"py-1"},Na=["onClick"],Oa={key:1,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center"},qa=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No hay plantillas disponibles",-1),Ra={class:"mt-1 text-sm text-gray-500"},Va=e("div",{class:"mt-4"},[e("div",{class:"text-xs text-gray-400 bg-gray-100 px-3 py-2 rounded-lg inline-block"},[Y(" 💡 "),e("strong",null,"Tip:"),Y(" Las plantillas son creadas por los abogados ")])],-1),Qa={__name:"UseDocumentTable",props:{searchQuery:String,selectedTags:{type:Array,default:()=>[]}},emits:["go-back"],setup(l,{emit:v}){const i=qe();Je();const p=et(),A=v,$=w(""),u=w(""),k=w(null),y=w("recent"),T=w({}),te=w({}),V=w(!1),K=w(-1),N=j(()=>i.publishedDocumentsUnassigned||[]),g=j(()=>{let m=[...N.value];const P=$.value.toLowerCase();return P&&(m=m.filter(R=>{var se,X;return((se=R.title)==null?void 0:se.toLowerCase().includes(P))||((X=R.tags)==null?void 0:X.some(ge=>{var de;return(de=ge.name)==null?void 0:de.toLowerCase().includes(P)}))})),k.value&&(m=m.filter(R=>R.tags&&R.tags.some(se=>se.id===k.value))),y.value==="name"?m.sort((R,se)=>{const X=(R.title||"").toLowerCase(),ge=(se.title||"").toLowerCase();return X.localeCompare(ge)}):y.value==="recent"&&m.sort((R,se)=>se.id-R.id),m}),M=j(()=>{const m=new Map;return N.value.forEach(P=>{P.tags&&P.tags.length>0&&P.tags.forEach(R=>{m.has(R.id)||m.set(R.id,R)})}),Array.from(m.values()).sort((P,R)=>P.name.localeCompare(R.name))}),D=j(()=>{if(!u.value)return M.value;const m=u.value.toLowerCase();return M.value.filter(P=>P.name.toLowerCase().includes(m))}),G=j(()=>{if(!k.value)return null;const m=M.value.find(P=>P.id===k.value);return m?m.name:null}),S=j(()=>{switch(y.value){case"name":return"Nombre (A-Z)";case"recent":default:return"Más recientes"}}),C=j(()=>{const m=$.value&&$.value.trim().length>0,P=k.value!==null;return m&&P?"No se encontraron plantillas que coincidan con tu búsqueda y filtros":m?"No se encontraron plantillas que coincidan con tu búsqueda":P?"No se encontraron plantillas con la etiqueta seleccionada":"Aún no hay plantillas disponibles para usar"}),ie=m=>{const P=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],R=m.id%P.length;return P[R]},z=m=>{const P=["bg-blue-500","bg-purple-500","bg-pink-500","bg-yellow-500","bg-green-500","bg-red-500","bg-indigo-500","bg-orange-500"],R=m.id%P.length;return P[R]},h=()=>{k.value=null},L=m=>{const se=`/dynamic_document_dashboard/document/use/${m.state==="Published"&&!m.assigned_to?"creator":"editor"}/${m.id}/${encodeURIComponent(m.title.trim())}`;p.push(se)},O=()=>{A("go-back")};Ne(async()=>{(!i.documents||i.documents.length===0)&&await i.init(!0)});const E=()=>V.value?g.value.length===1?"280px":g.value.length===2&&K.value===1?"340px":"280px":"auto",U=(m,P)=>{m&&(T.value[P]=m)},ne=(m,P)=>{m&&(te.value[P]=m)},I=(m,P)=>{V.value=!P,K.value=P?-1:m,P||setTimeout(()=>{const R=te.value[m];if(R){const se=R.$el||R;if(se&&se.getBoundingClientRect){const X=se.getBoundingClientRect(),ge=window.innerHeight;if(m===0){if(X.bottom>ge-20){const de=X.bottom-ge+40;window.scrollBy({top:de,behavior:"smooth"})}}else if(X.bottom>ge-10){const de=X.bottom-ge+30;window.scrollBy({top:de,behavior:"smooth"})}else if(X.top<80){const de=X.top-100;window.scrollBy({top:de,behavior:"smooth"})}}}},100)};return(m,P)=>(n(),a("div",null,[e("div",da,[e("button",{onClick:O,class:"inline-flex items-center gap-2 px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 rounded-lg transition-colors border border-gray-300"},[o(t(vs),{class:"h-4 w-4"}),Y(" Volver a Mis Documentos ")])]),e("div",ca,[e("div",ua,[e("div",ma,[e("div",ga,[o(t(Ze),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),Te(e("input",{"onUpdate:modelValue":P[0]||(P[0]=R=>$.value=R),type:"text",placeholder:"Buscar plantillas...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent"},null,512),[[Oe,$.value]])]),o(t(Se),{as:"div",class:"relative"},{default:x(()=>[o(t(Fe),{class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:x(()=>[o(t(tt),{class:"h-4 w-4"}),e("span",pa,f(G.value||"Etiqueta"),1),o(t(ze),{class:"h-4 w-4"})]),_:1}),o(t(Ee),{class:"absolute left-0 z-10 mt-2 w-64 origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:x(()=>[e("div",ha,[e("div",fa,[o(t(Ze),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),Te(e("input",{"onUpdate:modelValue":P[1]||(P[1]=R=>u.value=R),type:"text",placeholder:"Buscar etiquetas...",class:"w-full pl-9 pr-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent",onClick:P[2]||(P[2]=he(()=>{},["stop"]))},null,512),[[Oe,u.value]])]),e("div",va,[o(t(ce),null,{default:x(({active:R})=>[e("a",{onClick:P[3]||(P[3]=se=>k.value=null),class:_([R?"bg-gray-100":"","block px-3 py-2 text-sm text-gray-700 cursor-pointer rounded-md"])}," Todos ",2)]),_:1}),(n(!0),a(ae,null,ue(D.value,R=>(n(),oe(t(ce),{key:R.id},{default:x(({active:se})=>[e("a",{onClick:X=>k.value=R.id,class:_([se?"bg-gray-100":"","flex items-center gap-2 px-3 py-2 text-sm cursor-pointer rounded-md"])},[e("span",{class:_(["w-3 h-3 rounded-full flex-shrink-0",z(R)])},null,2),e("span",ya,f(R.name),1)],10,ba)]),_:2},1024))),128)),D.value.length===0?(n(),a("div",xa," No se encontraron etiquetas ")):F("",!0)])])]),_:1})]),_:1}),k.value?(n(),a("button",{key:0,onClick:h,class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",title:"Limpiar filtros"},[o(t(Le),{class:"h-4 w-4"}),Y(" Limpiar ")])):F("",!0)]),e("div",_a,[e("span",wa," Mostrando "+f(g.value.length)+" plantillas ",1),o(t(Se),{as:"div",class:"relative"},{default:x(()=>[o(t(Fe),{class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:x(()=>[Y(" Ordenar: "+f(S.value)+" ",1),o(t(ze),{class:"h-4 w-4"})]),_:1}),o(t(Ee),{class:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:x(()=>[e("div",$a,[o(t(ce),null,{default:x(({active:R})=>[e("a",{onClick:P[4]||(P[4]=se=>y.value="recent"),class:_([R?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Más recientes ",2)]),_:1}),o(t(ce),null,{default:x(({active:R})=>[e("a",{onClick:P[5]||(P[5]=se=>y.value="name"),class:_([R?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Nombre (A-Z) ",2)]),_:1})])]),_:1})]),_:1})])])]),g.value.length>0?(n(),a("div",ka,[e("div",{class:"overflow-x-auto",style:He({minHeight:E()})},[e("table",Ca,[Da,e("tbody",Sa,[(n(!0),a(ae,null,ue(g.value,R=>(n(),a("tr",{key:R.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:se=>L(R)},[e("td",Ea,[e("div",Aa,[e("div",Ta,[e("div",Ma,[o(t(Re),{class:"h-5 w-5 text-purple-600"})])]),e("div",La,[e("div",Pa,f(R.title),1)])])]),Ia,e("td",Ba,[e("div",ja,[(n(!0),a(ae,null,ue(R.tags,se=>(n(),a("span",{key:se.id,class:_(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",ie(se)])},f(se.name),3))),128)),!R.tags||R.tags.length===0?(n(),a("span",Ua,"-")):F("",!0)])]),e("td",{class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",onClick:P[6]||(P[6]=he(()=>{},["stop"]))},[o(t(Se),{as:"div",class:"relative inline-block text-left"},{default:x(({open:se})=>[o(t(Fe),{ref_for:!0,ref:X=>U(X,m.index),onClick:X=>I(m.index,se),class:"inline-flex items-center justify-center w-8 h-8 rounded-md hover:bg-gray-100"},{default:x(()=>[o(t(st),{class:"h-5 w-5 text-gray-500"})]),_:2},1032,["onClick"]),o(t(Ee),{ref_for:!0,ref:X=>ne(X,m.index),class:_([g.value.length>2&&m.index>0&&m.index>=g.value.length-3?"absolute right-0 z-[9999] bottom-full mb-2 w-48 origin-bottom-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none":"absolute right-0 z-[9999] mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"])},{default:x(()=>[e("div",za,[o(t(ce),null,{default:x(({active:X})=>[e("a",{onClick:ge=>L(R),class:_([X?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Usar plantilla ",10,Na)]),_:2},1024)])]),_:2},1032,["class"])]),_:2},1024)])],8,Fa))),128))])])],4)])):(n(),a("div",Oa,[o(t(lt),{class:"mx-auto h-12 w-12 text-gray-400"}),qa,e("p",Ra,f(C.value),1),Va]))]))}},Ke=l=>(mt("data-v-f7aff6da"),l=l(),gt(),l),Ga={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-3 sm:p-4 mb-6"},Ha={class:"mb-4"},Za={class:"relative w-full"},Wa={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-4"},Ja={class:"flex items-center gap-2 min-w-0"},Ka={class:"truncate"},Ya={class:"py-1"},Xa=["onClick"],ei={class:"flex items-center gap-2 min-w-0"},ti={class:"truncate"},si={class:"p-2"},oi={class:"relative mb-2"},ni={class:"max-h-60 overflow-y-auto"},ri=["onClick"],li={class:"truncate"},ai={key:0,class:"px-3 py-2 text-sm text-gray-500 text-center"},ii={class:"flex items-center justify-stretch"},di=Ke(()=>e("span",null,"Limpiar",-1)),ci={class:"flex flex-col gap-3 pt-4 border-t border-gray-200"},ui={class:"flex flex-col sm:flex-row gap-3 items-start sm:items-center justify-between"},mi={class:"text-sm text-gray-500"},gi={class:"font-medium"},pi=Ke(()=>e("span",{class:"hidden sm:inline"},"Ordenar:",-1)),hi={class:"py-1"},fi={class:"flex items-center gap-2"},vi=Ke(()=>e("span",{class:"hidden sm:inline"},"Exportar",-1)),bi={class:"py-1"},yi={class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",style:{"overflow-x":"visible","overflow-y":"hidden"}},xi={class:"overflow-x-auto",style:{"overflow-y":"visible"}},_i={class:"min-w-full divide-y divide-gray-200"},wi={class:"bg-gray-50"},$i={scope:"col",class:"w-12 px-6 py-3"},ki=["checked"],Ci=Ke(()=>e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Nombre Minuta ",-1)),Di=Ke(()=>e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado ",-1)),Si=Ke(()=>e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etiqueta ",-1)),Fi={class:"bg-white divide-y divide-gray-200"},Ei=["onClick"],Ai=["checked","onChange"],Ti={class:"px-6 py-4 whitespace-nowrap"},Mi={class:"flex items-center"},Li={class:"flex-shrink-0 h-10 w-10"},Pi={class:"h-10 w-10 rounded-lg bg-blue-100 flex items-center justify-center"},Ii={class:"ml-4"},Bi={class:"text-sm font-medium text-gray-900"},ji={class:"px-6 py-4 whitespace-nowrap"},Ui={class:"px-6 py-4 whitespace-nowrap"},zi={class:"flex flex-wrap gap-1"},Ni={key:0,class:"text-sm text-gray-400"},Oi={key:0,class:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"},qi={class:"flex flex-1 justify-between sm:hidden"},Ri=["disabled"],Vi=["disabled"],Qi={class:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between"},Gi={class:"text-sm text-gray-700"},Hi={class:"font-medium"},Zi={class:"font-medium"},Wi={class:"font-medium"},Ji={class:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination"},Ki=["disabled"],Yi=Ke(()=>e("span",{class:"sr-only"},"Anterior",-1)),Xi=["onClick"],ed={key:1,class:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700"},td=["disabled"],sd=Ke(()=>e("span",{class:"sr-only"},"Siguiente",-1)),od={key:0,class:"text-center py-12"},nd=Ke(()=>e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No hay documentos",-1)),rd=Ke(()=>e("p",{class:"mt-1 text-sm text-gray-500"},"No se encontraron documentos con los filtros seleccionados.",-1)),ld={__name:"DocumentListLawyer",props:{searchQuery:String,selectedTags:{type:Array,default:()=>[]},promptDocuments:{type:Array,default:null}},emits:["refresh"],setup(l,{emit:v}){const i=qe(),p=Je(),A=et(),$=v,{activeModals:u,openModal:k,closeModal:y,getUserRole:T}=ft(i,p),{handlePreviewDocument:te,deleteDocument:V,downloadPDFDocument:K,downloadWordDocument:N,copyDocument:g,publishDocument:M,moveToDraft:D,formalizeDocument:G,signDocument:S,downloadSignedDocument:C}=vt(i,p,$),ie=w([]),z=w([]),h=l,L=w(""),O=w(""),E=w(null),U=w(null),ne=w("recent"),I=w([]),m=w(1),P=w(10),R=B=>{switch(B.state){case"Published":return"Publicado";case"Draft":return"Borrador";case"Progress":return"En progreso";case"Completed":return"Completado";case"PendingSignatures":return"Pendiente de firmas";case"FullySigned":return"Completamente firmado";default:return"Desconocido"}},se=B=>{switch(B.state){case"Published":case"FullySigned":return"bg-green-100 text-green-700 border border-green-200";case"Draft":case"Progress":return"bg-blue-100 text-blue-700 border border-blue-200";case"PendingSignatures":return"bg-yellow-100 text-yellow-700 border border-yellow-200";case"Completed":return"bg-purple-100 text-purple-700 border border-purple-200";default:return"bg-gray-100 text-gray-700 border border-gray-200"}},X=B=>{const b=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],H=B.id%b.length;return b[H]},ge=B=>{switch(B){case"Published":return"Publicado";case"Draft":return"Borrador";case"Progress":return"En progreso";case"Completed":return"Completado";case"PendingSignatures":return"Pendiente de firmas";case"FullySigned":return"Completamente firmado";default:return B}},de=j(()=>{const B=new Set;return Ie.value.forEach(b=>{b.state&&B.add(b.state)}),Array.from(B).sort()}),pe=j(()=>{const B=new Map;return Ie.value.forEach(b=>{b.tags&&b.tags.length>0&&b.tags.forEach(H=>{B.has(H.id)||B.set(H.id,H)})}),Array.from(B.values()).sort((b,H)=>b.name.localeCompare(H.name))}),Ce=j(()=>{if(!O.value)return pe.value;const B=O.value.toLowerCase();return pe.value.filter(b=>b.name.toLowerCase().includes(B))}),De=j(()=>{if(!U.value)return null;const B=pe.value.find(b=>b.id===U.value);return B?B.name:null}),Ve=B=>{const b=["bg-blue-500","bg-purple-500","bg-pink-500","bg-yellow-500","bg-green-500","bg-red-500","bg-indigo-500","bg-orange-500"],H=B.id%b.length;return b[H]},Ie=j(()=>{if(h.promptDocuments)return[];const b=(i.getDocumentsByLawyerId(p.currentUser.id)||[]).filter(_e=>_e.state!=="FullySigned"),H=h.selectedTags?h.selectedTags.map(_e=>_e.id):[];return i.filteredDocumentsBySearchAndTags(h.searchQuery,p,H).filter(_e=>b.some(xe=>xe.id===_e.id))}),Qe=j(()=>{if(h.promptDocuments&&h.promptDocuments.length>0){let B=h.promptDocuments.filter(b=>b.title&&b.title.toLowerCase().includes((h.searchQuery||"").toLowerCase()));if(h.selectedTags&&h.selectedTags.length>0){const b=h.selectedTags.map(H=>H.id);B=B.filter(H=>!H.tags||H.tags.length===0?!1:H.tags.some(q=>b.includes(q.id)))}return B}return[]}),Ue=j(()=>h.promptDocuments?Qe.value:Ie.value),W=j(()=>{let B=[...Ue.value];const b=L.value.toLowerCase();return b&&(B=B.filter(H=>{var q,_e,xe;return((q=H.title)==null?void 0:q.toLowerCase().includes(b))||((_e=H.state)==null?void 0:_e.toLowerCase().includes(b))||((xe=H.tags)==null?void 0:xe.some(At=>{var We;return(We=At.name)==null?void 0:We.toLowerCase().includes(b)}))})),E.value&&(B=B.filter(H=>H.state===E.value)),U.value&&(B=B.filter(H=>H.tags&&H.tags.some(q=>q.id===U.value))),ne.value==="name"?B.sort((H,q)=>{const _e=(H.title||"").toLowerCase(),xe=(q.title||"").toLowerCase();return _e.localeCompare(xe)}):ne.value==="recent"&&B.sort((H,q)=>q.id-H.id),B}),re=j(()=>{const B=(m.value-1)*P.value,b=B+P.value;return W.value.slice(B,b)}),fe=j(()=>Math.ceil(W.value.length/P.value)),Pe=j(()=>{const B=(m.value-1)*P.value+1,b=Math.min(m.value*P.value,W.value.length);return{start:B,end:b,total:W.value.length}});be([L,E,U],()=>{m.value=1});const d=j(()=>{switch(ne.value){case"name":return"Nombre (A-Z)";case"recent":default:return"Más recientes"}});j(()=>{if(h.promptDocuments)return null;const B=i.lastUpdatedDocumentId,b=localStorage.getItem("lastUpdatedDocumentId"),H=[...Ie.value];return B&&H.some(xe=>String(xe.id)===String(B))?B:b&&H.some(xe=>String(xe.id)===String(b))?b:null});const r=async()=>{try{const B=p.currentUser.id,b=await Ct(`dynamic-documents/user/${B}/pending-documents-full/`),H=await Ct(`dynamic-documents/user/${B}/signed-documents/`);b.status===200&&(ie.value=b.data),H.status===200&&(z.value=H.data)}catch(B){console.error("Error fetching lawyer documents:",B),B.response&&(console.error("Error response data:",B.response.data),console.error("Error status:",B.response.status))}};be(Ue,B=>{if(!h.promptDocuments&&i.lastUpdatedDocumentId&&!B.some(H=>String(H.id)===String(i.lastUpdatedDocumentId))&&B.length>0){const q=[...B].sort((_e,xe)=>xe.id-_e.id)[0].id;i.lastUpdatedDocumentId=q,localStorage.setItem("lastUpdatedDocumentId",q)}});const s=B=>{B&&setTimeout(()=>{try{const b=document.querySelectorAll(`[data-document-id="${B}"]`);if(b.length>0){const H=b[0];H.classList.remove("animate-pulse-highlight-green","animate-pulse-highlight-blue"),H.offsetWidth,(H.querySelector("[data-document-id]")||H).classList.contains("border-green-400")?H.classList.add("animate-pulse-highlight-green"):H.classList.add("animate-pulse-highlight-blue"),H.scrollIntoView({behavior:"smooth",block:"center"})}}catch(b){console.error("Error forcing highlight:",b)}},100)};window.forceDocumentHighlight=s,Ne(async()=>{if(h.promptDocuments)return;await i.init();const B=localStorage.getItem("lastUpdatedDocumentId");B&&(i.lastUpdatedDocumentId=B,setTimeout(()=>{Ue.value.some(H=>String(H.id)===String(B))&&s(B)},500)),r()});const c=j(()=>W.value.length>0&&I.value.length===W.value.length),J=()=>{c.value?I.value=[]:I.value=W.value.map(B=>B.id)},me=B=>{const b=I.value.indexOf(B);b>-1?I.value.splice(b,1):I.value.push(B)},Me=()=>{I.value=W.value.map(B=>B.id)},we=()=>{I.value=[]},Ge=()=>{E.value=null,U.value=null},ee=()=>{m.value>1&&m.value--},Q=()=>{m.value<fe.value&&m.value++},le=B=>{B>=1&&B<=fe.value&&(m.value=B)},Z=j(()=>{const B=fe.value,b=m.value,H=[];if(B<=7)for(let q=1;q<=B;q++)H.push(q);else if(b<=4){for(let q=1;q<=5;q++)H.push(q);H.push("..."),H.push(B)}else if(b>=B-3){H.push(1),H.push("...");for(let q=B-4;q<=B;q++)H.push(q)}else H.push(1),H.push("..."),H.push(b-1),H.push(b),H.push(b+1),H.push("..."),H.push(B);return H}),ve=()=>{const B=I.value.length>0?W.value.filter(We=>I.value.includes(We.id)):W.value,b=["Nombre Minuta","Estado","Etiquetas"],H=B.map(We=>[We.title||"",R(We),We.tags?We.tags.map(Tt=>Tt.name).join(", "):""]),q=[b.join(","),...H.map(We=>We.map(Tt=>`"${Tt}"`).join(","))].join(`
`),_e=new Blob([q],{type:"text/csv;charset=utf-8;"}),xe=document.createElement("a"),At=URL.createObjectURL(_e);xe.setAttribute("href",At),xe.setAttribute("download",`documentos_${new Date().toISOString().split("T")[0]}.csv`),xe.style.visibility="hidden",document.body.appendChild(xe),xe.click(),document.body.removeChild(xe)},ye=async(B,b)=>{try{switch(B){case"edit":A.push(`/dynamic_document_dashboard/lawyer/editor/edit/${b.id}`);break;case"permissions":k("permissions",b);break;case"relationships":k("relationships",b);break;case"preview":await te(b);break;case"delete":await V(b);break;case"downloadPDF":await K(b);break;case"downloadWord":await N(b);break;case"email":k("email",b);break;case"copy":await g(b);break;case"publish":await M(b);break;case"draft":await D(b);break;case"formalize":await G(b);break;case"viewSignatures":k("signatures",b);break;case"sign":await S(b,k);break;case"letterhead":k("letterhead",b);break;default:console.warn("Unknown action:",B)}}catch(H){console.error(`Error executing action ${B}:`,H)}},Ae=w(!1),ke=w(null),Be=B=>{ke.value=B,Ae.value=!0},Kt=async(B,b)=>{Ae.value=!1,await ye(B,b)};return(B,b)=>{var H;return n(),a("div",null,[e("div",Ga,[e("div",Ha,[e("div",Za,[o(t(Ze),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),Te(e("input",{"onUpdate:modelValue":b[0]||(b[0]=q=>L.value=q),type:"text",placeholder:"Buscar...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent text-sm"},null,512),[[Oe,L.value]])])]),e("div",Wa,[o(t(Se),{as:"div",class:"relative"},{default:x(()=>[o(t(Fe),{class:"w-full inline-flex items-center justify-between gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:x(()=>[e("div",Ja,[o(t(tt),{class:"h-4 w-4 flex-shrink-0"}),e("span",Ka,f(E.value||"Estado"),1)]),o(t(ze),{class:"h-4 w-4 flex-shrink-0"})]),_:1}),o(t(Ee),{class:"absolute left-0 z-10 mt-2 w-full min-w-[14rem] origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:x(()=>[e("div",Ya,[o(t(ce),null,{default:x(({active:q})=>[e("a",{onClick:b[1]||(b[1]=_e=>E.value=null),class:_([q?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Todos ",2)]),_:1}),(n(!0),a(ae,null,ue(de.value,q=>(n(),oe(t(ce),{key:q},{default:x(({active:_e})=>[e("a",{onClick:xe=>E.value=q,class:_([_e?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])},f(ge(q)),11,Xa)]),_:2},1024))),128))])]),_:1})]),_:1}),o(t(Se),{as:"div",class:"relative"},{default:x(()=>[o(t(Fe),{class:"w-full inline-flex items-center justify-between gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:x(()=>[e("div",ei,[o(t(tt),{class:"h-4 w-4 flex-shrink-0"}),e("span",ti,f(De.value||"Etiqueta"),1)]),o(t(ze),{class:"h-4 w-4 flex-shrink-0"})]),_:1}),o(t(Ee),{class:"absolute left-0 z-10 mt-2 w-full min-w-[16rem] origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:x(()=>[e("div",si,[e("div",oi,[o(t(Ze),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),Te(e("input",{"onUpdate:modelValue":b[2]||(b[2]=q=>O.value=q),type:"text",placeholder:"Buscar etiquetas...",class:"w-full pl-9 pr-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent",onClick:b[3]||(b[3]=he(()=>{},["stop"]))},null,512),[[Oe,O.value]])]),e("div",ni,[o(t(ce),null,{default:x(({active:q})=>[e("a",{onClick:b[4]||(b[4]=_e=>U.value=null),class:_([q?"bg-gray-100":"","block px-3 py-2 text-sm text-gray-700 cursor-pointer rounded-md"])}," Todos ",2)]),_:1}),(n(!0),a(ae,null,ue(Ce.value,q=>(n(),oe(t(ce),{key:q.id},{default:x(({active:_e})=>[e("a",{onClick:xe=>U.value=q.id,class:_([_e?"bg-gray-100":"","flex items-center gap-2 px-3 py-2 text-sm cursor-pointer rounded-md"])},[e("span",{class:_(["w-3 h-3 rounded-full flex-shrink-0",Ve(q)])},null,2),e("span",li,f(q.name),1)],10,ri)]),_:2},1024))),128)),Ce.value.length===0?(n(),a("div",ai," No se encontraron etiquetas ")):F("",!0)])])]),_:1})]),_:1}),e("div",ii,[E.value||U.value?(n(),a("button",{key:0,onClick:Ge,class:"w-full inline-flex items-center justify-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",title:"Limpiar filtros"},[o(t(Le),{class:"h-4 w-4 flex-shrink-0"}),di])):F("",!0)])]),e("div",ci,[e("div",ui,[e("div",mi,[e("span",gi,f(W.value.length),1),Y(" resultados ")]),o(t(Se),{as:"div",class:"relative"},{default:x(()=>[o(t(Fe),{class:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:x(()=>[pi,Y(" "+f(d.value)+" ",1),o(t(ze),{class:"h-4 w-4"})]),_:1}),o(t(Ee),{class:"absolute left-0 sm:left-auto sm:right-0 z-10 mt-2 w-48 origin-top-left sm:origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:x(()=>[e("div",hi,[o(t(ce),null,{default:x(({active:q})=>[e("a",{onClick:b[5]||(b[5]=_e=>ne.value="recent"),class:_([q?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Más recientes ",2)]),_:1}),o(t(ce),null,{default:x(({active:q})=>[e("a",{onClick:b[6]||(b[6]=_e=>ne.value="name"),class:_([q?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Nombre (A-Z) ",2)]),_:1})])]),_:1})]),_:1})]),e("div",fi,[e("button",{onClick:ve,class:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},[o(t(nt),{class:"h-4 w-4"}),vi]),o(t(Se),{as:"div",class:"relative"},{default:x(()=>[o(t(Fe),{class:"inline-flex items-center justify-center w-10 h-10 rounded-md hover:bg-gray-100"},{default:x(()=>[o(t(st),{class:"h-5 w-5 text-gray-500"})]),_:1}),o(t(Ee),{class:"absolute left-0 sm:left-auto sm:right-0 z-10 mt-2 w-48 origin-top-left sm:origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:x(()=>[e("div",bi,[o(t(ce),null,{default:x(({active:q})=>[e("a",{onClick:Me,class:_([q?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Seleccionar todo ",2)]),_:1}),o(t(ce),null,{default:x(({active:q})=>[e("a",{onClick:we,class:_([q?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Deseleccionar todo ",2)]),_:1})])]),_:1})]),_:1})])])]),e("div",yi,[e("div",xi,[e("table",_i,[e("thead",wi,[e("tr",null,[e("th",$i,[e("input",{type:"checkbox",checked:c.value,onChange:J,class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,ki)]),Ci,Di,Si])]),e("tbody",Fi,[(n(!0),a(ae,null,ue(re.value,(q,_e)=>(n(),a("tr",{key:q.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:xe=>Be(q)},[e("td",{class:"px-6 py-4 whitespace-nowrap",onClick:b[7]||(b[7]=he(()=>{},["stop"]))},[e("input",{type:"checkbox",checked:I.value.includes(q.id),onChange:xe=>me(q.id),class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,Ai)]),e("td",Ti,[e("div",Mi,[e("div",Li,[e("div",Pi,[o(t(Re),{class:"h-5 w-5 text-blue-600"})])]),e("div",Ii,[e("div",Bi,f(q.title),1)])])]),e("td",ji,[e("span",{class:_(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",se(q)])},f(R(q)),3)]),e("td",Ui,[e("div",zi,[(n(!0),a(ae,null,ue(q.tags,xe=>(n(),a("span",{key:xe.id,class:_(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",X(xe)])},f(xe.name),3))),128)),!q.tags||q.tags.length===0?(n(),a("span",Ni,"-")):F("",!0)])])],8,Ei))),128))])])]),fe.value>1?(n(),a("div",Oi,[e("div",qi,[e("button",{onClick:ee,disabled:m.value===1,class:_(["relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",m.value===1?"opacity-50 cursor-not-allowed":""])}," Anterior ",10,Ri),e("button",{onClick:Q,disabled:m.value===fe.value,class:_(["relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",m.value===fe.value?"opacity-50 cursor-not-allowed":""])}," Siguiente ",10,Vi)]),e("div",Qi,[e("div",null,[e("p",Gi,[Y(" Mostrando "),e("span",Hi,f(Pe.value.start),1),Y(" a "),e("span",Zi,f(Pe.value.end),1),Y(" de "),e("span",Wi,f(Pe.value.total),1),Y(" resultados ")])]),e("div",null,[e("nav",Ji,[e("button",{onClick:ee,disabled:m.value===1,class:_(["relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",m.value===1?"opacity-50 cursor-not-allowed":""])},[Yi,o(t(pt),{class:"h-5 w-5","aria-hidden":"true"})],10,Ki),(n(!0),a(ae,null,ue(Z.value,q=>(n(),a(ae,{key:q},[q!=="..."?(n(),a("button",{key:0,onClick:_e=>le(q),class:_(["relative inline-flex items-center px-4 py-2 text-sm font-semibold focus:z-20 focus:outline-offset-0",m.value===q?"z-10 bg-secondary text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-secondary":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50"])},f(q),11,Xi)):(n(),a("span",ed," ... "))],64))),128)),e("button",{onClick:Q,disabled:m.value===fe.value,class:_(["relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",m.value===fe.value?"opacity-50 cursor-not-allowed":""])},[sd,o(t(rt),{class:"h-5 w-5","aria-hidden":"true"})],10,td)])])])])):F("",!0)]),W.value.length===0?(n(),a("div",od,[o(t(lt),{class:"mx-auto h-12 w-12 text-gray-400"}),nd,rd])):F("",!0),o(Pt,{isVisible:t(ot),documentData:t(Lt),onClose:b[8]||(b[8]=q=>ot.value=!1)},null,8,["isVisible","documentData"]),(n(),oe(ht,{to:"body"},[t(u).edit.isOpen?(n(),oe(t(St),{key:0,document:t(u).edit.document,"user-role":t(T)(),onClose:b[9]||(b[9]=q=>t(y)("edit")),onRefresh:b[10]||(b[10]=q=>$("refresh"))},null,8,["document","user-role"])):F("",!0),t(u).email.isOpen?(n(),oe(t(Ft),{key:1,document:t(u).email.document,onClose:b[11]||(b[11]=q=>t(y)("email"))},null,8,["document"])):F("",!0),t(u).signatures.isOpen?(n(),oe(t(Qt),{key:2,"document-id":(H=t(u).signatures.document)==null?void 0:H.id,onClose:b[12]||(b[12]=q=>t(y)("signatures")),onRefresh:b[13]||(b[13]=q=>$("refresh"))},null,8,["document-id"])):F("",!0),t(u).permissions.isOpen?(n(),oe(t(ms),{key:3,"is-open":t(u).permissions.isOpen,document:t(u).permissions.document,onClose:b[14]||(b[14]=q=>t(y)("permissions")),onSaved:b[15]||(b[15]=q=>$("refresh"))},null,8,["is-open","document"])):F("",!0),t(u).letterhead.isOpen?(n(),oe(bt,{key:4,"is-visible":t(u).letterhead.isOpen,document:t(u).letterhead.document,onClose:b[16]||(b[16]=q=>t(y)("letterhead")),onUploaded:b[17]||(b[17]=q=>$("refresh")),onDeleted:b[18]||(b[18]=q=>$("refresh"))},null,8,["is-visible","document"])):F("",!0),t(u).relationships.isOpen?(n(),oe(Et,{key:5,"is-open":t(u).relationships.isOpen,document:t(u).relationships.document,onClose:b[19]||(b[19]=q=>t(y)("relationships")),onRefresh:b[20]||(b[20]=q=>$("refresh"))},null,8,["is-open","document"])):F("",!0),Ae.value?(n(),oe(_t,{key:6,"is-visible":Ae.value,document:ke.value,"card-type":"lawyer",context:"table","user-store":t(p),onClose:b[21]||(b[21]=q=>Ae.value=!1),onAction:Kt},null,8,["is-visible","document","user-store"])):F("",!0)]))])}}},ad=yt(ld,[["__scopeId","data-v-f7aff6da"]]),id={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-3 sm:p-4 mb-6"},dd={class:"mb-4"},cd={class:"relative w-full"},ud={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-4"},md={class:"flex items-center gap-2 min-w-0"},gd={class:"truncate"},pd={class:"py-1"},hd=["onClick"],fd={class:"flex items-center justify-stretch"},vd=e("span",null,"Limpiar",-1),bd={class:"flex flex-col gap-3 pt-4 border-t border-gray-200"},yd={class:"flex flex-col sm:flex-row gap-3 items-start sm:items-center justify-between"},xd={class:"text-sm text-gray-500"},_d={class:"font-medium"},wd=e("span",{class:"hidden sm:inline"},"Ordenar:",-1),$d={class:"py-1"},kd={class:"flex items-center gap-2"},Cd=e("span",{class:"hidden sm:inline"},"Exportar",-1),Dd={class:"py-1"},Sd={class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",style:{"overflow-x":"visible","overflow-y":"hidden"}},Fd={class:"overflow-x-auto",style:{"overflow-y":"visible"}},Ed={class:"min-w-full divide-y divide-gray-200"},Ad={class:"bg-gray-50"},Td={scope:"col",class:"w-12 px-6 py-3"},Md=["checked"],Ld=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Nombre Documento ",-1),Pd=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Cliente ",-1),Id=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado ",-1),Bd=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etiqueta ",-1),jd={class:"bg-white divide-y divide-gray-200"},Ud=["onClick"],zd=["checked","onChange"],Nd={class:"px-6 py-4 whitespace-nowrap"},Od={class:"flex items-center"},qd={class:"flex-shrink-0 h-10 w-10"},Rd={class:"h-10 w-10 rounded-lg bg-green-100 flex items-center justify-center"},Vd={class:"ml-4"},Qd={class:"text-sm font-medium text-gray-900"},Gd={class:"px-6 py-4 whitespace-nowrap"},Hd={class:"text-sm text-gray-900"},Zd=e("td",{class:"px-6 py-4 whitespace-nowrap"},[e("span",{class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-700 border border-green-200"}," Completado ")],-1),Wd={class:"px-6 py-4 whitespace-nowrap"},Jd={class:"flex flex-wrap gap-1"},Kd={key:0,class:"text-sm text-gray-400"},Yd={key:0,class:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"},Xd={class:"flex flex-1 justify-between sm:hidden"},ec=["disabled"],tc=["disabled"],sc={class:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between"},oc={class:"text-sm text-gray-700"},nc={class:"font-medium"},rc={class:"font-medium"},lc={class:"font-medium"},ac={class:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination"},ic=["disabled"],dc=e("span",{class:"sr-only"},"Anterior",-1),cc=["onClick"],uc={key:1,class:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700"},mc=["disabled"],gc=e("span",{class:"sr-only"},"Siguiente",-1),pc={key:0,class:"text-center py-12"},hc=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No hay documentos completados",-1),fc=e("p",{class:"mt-1 text-sm text-gray-500"},"Los documentos completados por clientes aparecerán aquí.",-1),vc={__name:"DocumentFinishedByClientListTable",props:{searchQuery:String,selectedTags:{type:Array,default:()=>[]}},emits:["refresh"],setup(l,{emit:v}){const i=qe(),p=Je(),A=et(),$=l,u=v,{activeModals:k,openModal:y,closeModal:T,getUserRole:te}=ft(i,p),{handlePreviewDocument:V,deleteDocument:K,downloadPDFDocument:N,downloadWordDocument:g}=vt(i,p,u),M=w(""),D=w(null),G=w("recent"),S=w([]),C=w(1),ie=w(10);Ne(()=>{i.init(),p.init()});const z=j(()=>{const d=i.completedDocumentsByClient,r=$.selectedTags?$.selectedTags.map(c=>c.id):[];return i.filteredDocumentsBySearchAndTags($.searchQuery,p,r).filter(c=>d.some(J=>J.id===c.id))}),h=j(()=>{let d=[...z.value];const r=M.value.toLowerCase();return r&&(d=d.filter(s=>{var c,J;return((c=s.title)==null?void 0:c.toLowerCase().includes(r))||((J=s.tags)==null?void 0:J.some(me=>{var Me;return(Me=me.name)==null?void 0:Me.toLowerCase().includes(r)}))})),D.value&&(d=d.filter(s=>s.tags&&s.tags.some(c=>c.id===D.value))),G.value==="name"?d.sort((s,c)=>{const J=(s.title||"").toLowerCase(),me=(c.title||"").toLowerCase();return J.localeCompare(me)}):G.value==="recent"&&d.sort((s,c)=>c.id-s.id),d}),L=j(()=>{const d=(C.value-1)*ie.value,r=d+ie.value;return h.value.slice(d,r)}),O=j(()=>Math.ceil(h.value.length/ie.value)),E=j(()=>{const d=(C.value-1)*ie.value+1,r=Math.min(C.value*ie.value,h.value.length);return{start:d,end:r,total:h.value.length}});be([M,D],()=>{C.value=1});const U=j(()=>{const d=new Map;return z.value.forEach(r=>{r.tags&&r.tags.length>0&&r.tags.forEach(s=>{d.has(s.id)||d.set(s.id,s)})}),Array.from(d.values()).sort((r,s)=>r.name.localeCompare(s.name))}),ne=j(()=>{if(!D.value)return null;const d=U.value.find(r=>r.id===D.value);return d?d.name:null}),I=j(()=>{switch(G.value){case"name":return"Nombre (A-Z)";case"recent":default:return"Más recientes"}}),m=d=>d.client_name?d.client_name:d.client?`${d.client.first_name||""} ${d.client.last_name||""}`.trim():"Cliente",P=d=>{const r=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],s=d.id%r.length;return r[s]},R=j(()=>h.value.length>0&&S.value.length===h.value.length),se=()=>{R.value?S.value=[]:S.value=h.value.map(d=>d.id)},X=d=>{const r=S.value.indexOf(d);r>-1?S.value.splice(r,1):S.value.push(d)},ge=()=>{S.value=h.value.map(d=>d.id)},de=()=>{S.value=[]},pe=()=>{D.value=null},Ce=()=>{C.value>1&&C.value--},De=()=>{C.value<O.value&&C.value++},Ve=d=>{d>=1&&d<=O.value&&(C.value=d)},Ie=j(()=>{const d=O.value,r=C.value,s=[];if(d<=7)for(let c=1;c<=d;c++)s.push(c);else if(r<=4){for(let c=1;c<=5;c++)s.push(c);s.push("..."),s.push(d)}else if(r>=d-3){s.push(1),s.push("...");for(let c=d-4;c<=d;c++)s.push(c)}else s.push(1),s.push("..."),s.push(r-1),s.push(r),s.push(r+1),s.push("..."),s.push(d);return s}),Qe=()=>{const d=S.value.length>0?h.value.filter(we=>S.value.includes(we.id)):h.value,r=["Nombre Documento","Cliente","Estado","Etiquetas"],s=d.map(we=>[we.title||"",m(we),"Completado",we.tags?we.tags.map(Ge=>Ge.name).join(", "):""]),c=[r.join(","),...s.map(we=>we.map(Ge=>`"${Ge}"`).join(","))].join(`
`),J=new Blob([c],{type:"text/csv;charset=utf-8;"}),me=document.createElement("a"),Me=URL.createObjectURL(J);me.setAttribute("href",Me),me.setAttribute("download",`documentos_completados_${new Date().toISOString().split("T")[0]}.csv`),me.style.visibility="hidden",document.body.appendChild(me),me.click(),document.body.removeChild(me)},Ue=async(d,r)=>{try{switch(d){case"editForm":y("edit",r,{userRole:te()});break;case"editDocument":A.push(`/dynamic_document_dashboard/client/editor/edit/${r.id}`);break;case"preview":await V(r);break;case"delete":await K(r);break;case"letterhead":y("letterhead",r);break;case"relationships":y("relationships",r);break;case"downloadPDF":await N(r);break;case"downloadWord":await g(r);break;case"email":y("email",r);break;default:console.warn("Unknown action:",d)}}catch(s){console.error(`Error executing action ${d}:`,s)}},W=w(!1),re=w(null),fe=d=>{re.value=d,W.value=!0},Pe=async(d,r)=>{W.value=!1,await Ue(d,r)};return(d,r)=>(n(),a("div",null,[e("div",id,[e("div",dd,[e("div",cd,[o(t(Ze),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),Te(e("input",{"onUpdate:modelValue":r[0]||(r[0]=s=>M.value=s),type:"text",placeholder:"Buscar...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent text-sm"},null,512),[[Oe,M.value]])])]),e("div",ud,[o(t(Se),{as:"div",class:"relative"},{default:x(()=>[o(t(Fe),{class:"w-full inline-flex items-center justify-between gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:x(()=>[e("div",md,[o(t(tt),{class:"h-4 w-4 flex-shrink-0"}),e("span",gd,f(ne.value||"Etiqueta"),1)]),o(t(ze),{class:"h-4 w-4 flex-shrink-0"})]),_:1}),o(t(Ee),{class:"absolute left-0 z-10 mt-2 w-full min-w-[16rem] origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none max-h-60 overflow-y-auto"},{default:x(()=>[e("div",pd,[o(t(ce),null,{default:x(({active:s})=>[e("a",{onClick:r[1]||(r[1]=c=>D.value=null),class:_([s?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Todos ",2)]),_:1}),(n(!0),a(ae,null,ue(U.value,s=>(n(),oe(t(ce),{key:s.id},{default:x(({active:c})=>[e("a",{onClick:J=>D.value=s.id,class:_([c?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])},f(s.name),11,hd)]),_:2},1024))),128))])]),_:1})]),_:1}),e("div",fd,[D.value?(n(),a("button",{key:0,onClick:pe,class:"w-full inline-flex items-center justify-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",title:"Limpiar filtros"},[o(t(Le),{class:"h-4 w-4 flex-shrink-0"}),vd])):F("",!0)])]),e("div",bd,[e("div",yd,[e("div",xd,[e("span",_d,f(h.value.length),1),Y(" resultados ")]),o(t(Se),{as:"div",class:"relative"},{default:x(()=>[o(t(Fe),{class:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:x(()=>[wd,Y(" "+f(I.value)+" ",1),o(t(ze),{class:"h-4 w-4"})]),_:1}),o(t(Ee),{class:"absolute left-0 sm:left-auto sm:right-0 z-10 mt-2 w-48 origin-top-left sm:origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:x(()=>[e("div",$d,[o(t(ce),null,{default:x(({active:s})=>[e("a",{onClick:r[2]||(r[2]=c=>G.value="recent"),class:_([s?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Más recientes ",2)]),_:1}),o(t(ce),null,{default:x(({active:s})=>[e("a",{onClick:r[3]||(r[3]=c=>G.value="name"),class:_([s?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Nombre (A-Z) ",2)]),_:1})])]),_:1})]),_:1})]),e("div",kd,[e("button",{onClick:Qe,class:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},[o(t(nt),{class:"h-4 w-4"}),Cd]),o(t(Se),{as:"div",class:"relative"},{default:x(()=>[o(t(Fe),{class:"inline-flex items-center justify-center w-10 h-10 rounded-md hover:bg-gray-100"},{default:x(()=>[o(t(st),{class:"h-5 w-5 text-gray-500"})]),_:1}),o(t(Ee),{class:"absolute left-0 sm:left-auto sm:right-0 z-10 mt-2 w-48 origin-top-left sm:origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:x(()=>[e("div",Dd,[o(t(ce),null,{default:x(({active:s})=>[e("a",{onClick:ge,class:_([s?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Seleccionar todo ",2)]),_:1}),o(t(ce),null,{default:x(({active:s})=>[e("a",{onClick:de,class:_([s?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Deseleccionar todo ",2)]),_:1})])]),_:1})]),_:1})])])]),e("div",Sd,[e("div",Fd,[e("table",Ed,[e("thead",Ad,[e("tr",null,[e("th",Td,[e("input",{type:"checkbox",checked:R.value,onChange:se,class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,Md)]),Ld,Pd,Id,Bd])]),e("tbody",jd,[(n(!0),a(ae,null,ue(L.value,(s,c)=>(n(),a("tr",{key:s.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:J=>fe(s)},[e("td",{class:"px-6 py-4 whitespace-nowrap",onClick:r[4]||(r[4]=he(()=>{},["stop"]))},[e("input",{type:"checkbox",checked:S.value.includes(s.id),onChange:J=>X(s.id),class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,zd)]),e("td",Nd,[e("div",Od,[e("div",qd,[e("div",Rd,[o(t(Re),{class:"h-5 w-5 text-green-600"})])]),e("div",Vd,[e("div",Qd,f(s.title),1)])])]),e("td",Gd,[e("div",Hd,f(m(s)),1)]),Zd,e("td",Wd,[e("div",Jd,[(n(!0),a(ae,null,ue(s.tags,J=>(n(),a("span",{key:J.id,class:_(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",P(J)])},f(J.name),3))),128)),!s.tags||s.tags.length===0?(n(),a("span",Kd,"-")):F("",!0)])])],8,Ud))),128))])])]),O.value>1?(n(),a("div",Yd,[e("div",Xd,[e("button",{onClick:Ce,disabled:C.value===1,class:_(["relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",C.value===1?"opacity-50 cursor-not-allowed":""])}," Anterior ",10,ec),e("button",{onClick:De,disabled:C.value===O.value,class:_(["relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",C.value===O.value?"opacity-50 cursor-not-allowed":""])}," Siguiente ",10,tc)]),e("div",sc,[e("div",null,[e("p",oc,[Y(" Mostrando "),e("span",nc,f(E.value.start),1),Y(" a "),e("span",rc,f(E.value.end),1),Y(" de "),e("span",lc,f(E.value.total),1),Y(" resultados ")])]),e("div",null,[e("nav",ac,[e("button",{onClick:Ce,disabled:C.value===1,class:_(["relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",C.value===1?"opacity-50 cursor-not-allowed":""])},[dc,o(t(pt),{class:"h-5 w-5","aria-hidden":"true"})],10,ic),(n(!0),a(ae,null,ue(Ie.value,s=>(n(),a(ae,{key:s},[s!=="..."?(n(),a("button",{key:0,onClick:c=>Ve(s),class:_(["relative inline-flex items-center px-4 py-2 text-sm font-semibold focus:z-20 focus:outline-offset-0",C.value===s?"z-10 bg-secondary text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-secondary":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50"])},f(s),11,cc)):(n(),a("span",uc," ... "))],64))),128)),e("button",{onClick:De,disabled:C.value===O.value,class:_(["relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",C.value===O.value?"opacity-50 cursor-not-allowed":""])},[gc,o(t(rt),{class:"h-5 w-5","aria-hidden":"true"})],10,mc)])])])])):F("",!0)]),h.value.length===0?(n(),a("div",pc,[o(t(lt),{class:"mx-auto h-12 w-12 text-gray-400"}),hc,fc])):F("",!0),(n(),oe(ht,{to:"body"},[t(k).edit.isOpen?(n(),oe(t(St),{key:0,document:t(k).edit.document,"user-role":t(te)(),onClose:r[5]||(r[5]=s=>t(T)("edit")),onRefresh:r[6]||(r[6]=s=>u("refresh"))},null,8,["document","user-role"])):F("",!0),t(k).email.isOpen?(n(),oe(t(Ft),{key:1,document:t(k).email.document,onClose:r[7]||(r[7]=s=>t(T)("email"))},null,8,["document"])):F("",!0),t(k).letterhead.isOpen?(n(),oe(bt,{key:2,"is-visible":t(k).letterhead.isOpen,document:t(k).letterhead.document,onClose:r[8]||(r[8]=s=>t(T)("letterhead")),onUploaded:r[9]||(r[9]=s=>u("refresh")),onDeleted:r[10]||(r[10]=s=>u("refresh"))},null,8,["is-visible","document"])):F("",!0),t(k).relationships.isOpen?(n(),oe(Et,{key:3,"is-open":t(k).relationships.isOpen,document:t(k).relationships.document,onClose:r[11]||(r[11]=s=>t(T)("relationships")),onRefresh:r[12]||(r[12]=s=>u("refresh"))},null,8,["is-open","document"])):F("",!0),W.value?(n(),oe(_t,{key:4,"is-visible":W.value,document:re.value,"card-type":"client",context:"table","user-store":t(p),onClose:r[13]||(r[13]=s=>W.value=!1),onAction:Pe},null,8,["is-visible","document","user-store"])):F("",!0)]))]))}},bc={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-3 sm:p-4 mb-6"},yc={class:"mb-4"},xc={class:"relative w-full"},_c={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-4"},wc={class:"flex items-center gap-2 min-w-0"},$c={class:"truncate"},kc={class:"py-1"},Cc=["onClick"],Dc={class:"flex items-center justify-stretch"},Sc=e("span",null,"Limpiar",-1),Fc={class:"flex flex-col gap-3 pt-4 border-t border-gray-200"},Ec={class:"flex flex-col sm:flex-row gap-3 items-start sm:items-center justify-between"},Ac={class:"text-sm text-gray-500"},Tc={class:"font-medium"},Mc=e("span",{class:"hidden sm:inline"},"Ordenar:",-1),Lc={class:"py-1"},Pc={class:"flex items-center gap-2"},Ic=e("span",{class:"hidden sm:inline"},"Exportar",-1),Bc={class:"py-1"},jc={class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",style:{"overflow-x":"visible","overflow-y":"hidden"}},Uc={class:"overflow-x-auto",style:{"overflow-y":"visible"}},zc={class:"min-w-full divide-y divide-gray-200"},Nc={class:"bg-gray-50"},Oc={scope:"col",class:"w-12 px-6 py-3"},qc=["checked"],Rc=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Nombre Documento ",-1),Vc=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Cliente ",-1),Qc=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado ",-1),Gc=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etiqueta ",-1),Hc={class:"bg-white divide-y divide-gray-200"},Zc=["onClick"],Wc=["checked","onChange"],Jc={class:"px-6 py-4 whitespace-nowrap"},Kc={class:"flex items-center"},Yc={class:"flex-shrink-0 h-10 w-10"},Xc={class:"h-10 w-10 rounded-lg bg-blue-100 flex items-center justify-center"},eu={class:"ml-4"},tu={class:"text-sm font-medium text-gray-900"},su={class:"px-6 py-4 whitespace-nowrap"},ou={class:"text-sm text-gray-900"},nu=e("td",{class:"px-6 py-4 whitespace-nowrap"},[e("span",{class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-700 border border-blue-200"}," En Progreso ")],-1),ru={class:"px-6 py-4 whitespace-nowrap"},lu={class:"flex flex-wrap gap-1"},au={key:0,class:"text-sm text-gray-400"},iu={key:0,class:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"},du={class:"flex flex-1 justify-between sm:hidden"},cu=["disabled"],uu=["disabled"],mu={class:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between"},gu={class:"text-sm text-gray-700"},pu={class:"font-medium"},hu={class:"font-medium"},fu={class:"font-medium"},vu={class:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination"},bu=["disabled"],yu=e("span",{class:"sr-only"},"Anterior",-1),xu=["onClick"],_u={key:1,class:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700"},wu=["disabled"],$u=e("span",{class:"sr-only"},"Siguiente",-1),ku={key:0,class:"text-center py-12"},Cu=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No hay documentos en progreso",-1),Du=e("p",{class:"mt-1 text-sm text-gray-500"},"Los documentos en progreso por clientes aparecerán aquí.",-1),Su={__name:"DocumentInProgressByClientListTable",props:{searchQuery:String,selectedTags:{type:Array,default:()=>[]}},emits:["refresh"],setup(l,{emit:v}){const i=qe(),p=Je(),A=et(),$=l,u=v,{activeModals:k,openModal:y,closeModal:T,getUserRole:te}=ft(i,p),{handlePreviewDocument:V,deleteDocument:K,downloadPDFDocument:N,downloadWordDocument:g}=vt(i,p,u),M=w(""),D=w(null),G=w("recent"),S=w([]),C=w(1),ie=w(10);Ne(()=>{i.init(),p.init()});const z=j(()=>{const d=i.progressDocumentsByClient,r=$.selectedTags?$.selectedTags.map(c=>c.id):[];return i.filteredDocumentsBySearchAndTags($.searchQuery,p,r).filter(c=>d.some(J=>J.id===c.id))}),h=j(()=>{let d=[...z.value];const r=M.value.toLowerCase();return r&&(d=d.filter(s=>{var c,J;return((c=s.title)==null?void 0:c.toLowerCase().includes(r))||((J=s.tags)==null?void 0:J.some(me=>{var Me;return(Me=me.name)==null?void 0:Me.toLowerCase().includes(r)}))})),D.value&&(d=d.filter(s=>s.tags&&s.tags.some(c=>c.id===D.value))),G.value==="name"?d.sort((s,c)=>{const J=(s.title||"").toLowerCase(),me=(c.title||"").toLowerCase();return J.localeCompare(me)}):G.value==="recent"&&d.sort((s,c)=>c.id-s.id),d}),L=j(()=>{const d=(C.value-1)*ie.value,r=d+ie.value;return h.value.slice(d,r)}),O=j(()=>Math.ceil(h.value.length/ie.value)),E=j(()=>{const d=(C.value-1)*ie.value+1,r=Math.min(C.value*ie.value,h.value.length);return{start:d,end:r,total:h.value.length}});be([M,D],()=>{C.value=1});const U=j(()=>{const d=new Map;return z.value.forEach(r=>{r.tags&&r.tags.length>0&&r.tags.forEach(s=>{d.has(s.id)||d.set(s.id,s)})}),Array.from(d.values()).sort((r,s)=>r.name.localeCompare(s.name))}),ne=j(()=>{if(!D.value)return null;const d=U.value.find(r=>r.id===D.value);return d?d.name:null}),I=j(()=>{switch(G.value){case"name":return"Nombre (A-Z)";case"recent":default:return"Más recientes"}}),m=d=>d.client_name?d.client_name:d.client?`${d.client.first_name||""} ${d.client.last_name||""}`.trim():"Cliente",P=d=>{const r=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],s=d.id%r.length;return r[s]},R=j(()=>h.value.length>0&&S.value.length===h.value.length),se=()=>{R.value?S.value=[]:S.value=h.value.map(d=>d.id)},X=d=>{const r=S.value.indexOf(d);r>-1?S.value.splice(r,1):S.value.push(d)},ge=()=>{S.value=h.value.map(d=>d.id)},de=()=>{S.value=[]},pe=()=>{D.value=null},Ce=()=>{C.value>1&&C.value--},De=()=>{C.value<O.value&&C.value++},Ve=d=>{d>=1&&d<=O.value&&(C.value=d)},Ie=j(()=>{const d=O.value,r=C.value,s=[];if(d<=7)for(let c=1;c<=d;c++)s.push(c);else if(r<=4){for(let c=1;c<=5;c++)s.push(c);s.push("..."),s.push(d)}else if(r>=d-3){s.push(1),s.push("...");for(let c=d-4;c<=d;c++)s.push(c)}else s.push(1),s.push("..."),s.push(r-1),s.push(r),s.push(r+1),s.push("..."),s.push(d);return s}),Qe=()=>{const d=S.value.length>0?h.value.filter(we=>S.value.includes(we.id)):h.value,r=["Nombre Documento","Cliente","Estado","Etiquetas"],s=d.map(we=>[we.title||"",m(we),"En Progreso",we.tags?we.tags.map(Ge=>Ge.name).join(", "):""]),c=[r.join(","),...s.map(we=>we.map(Ge=>`"${Ge}"`).join(","))].join(`
`),J=new Blob([c],{type:"text/csv;charset=utf-8;"}),me=document.createElement("a"),Me=URL.createObjectURL(J);me.setAttribute("href",Me),me.setAttribute("download",`documentos_en_progreso_${new Date().toISOString().split("T")[0]}.csv`),me.style.visibility="hidden",document.body.appendChild(me),me.click(),document.body.removeChild(me)},Ue=async(d,r)=>{try{switch(d){case"editForm":y("edit",r,{userRole:te()});break;case"editDocument":A.push(`/dynamic_document_dashboard/client/editor/edit/${r.id}`);break;case"preview":await V(r);break;case"delete":await K(r);break;case"letterhead":y("letterhead",r);break;case"relationships":y("relationships",r);break;case"downloadPDF":await N(r);break;case"downloadWord":await g(r);break;case"email":y("email",r);break;default:console.warn("Unknown action:",d)}}catch(s){console.error(`Error executing action ${d}:`,s)}},W=w(!1),re=w(null),fe=d=>{re.value=d,W.value=!0},Pe=async(d,r)=>{W.value=!1,await Ue(d,r)};return(d,r)=>(n(),a("div",null,[e("div",bc,[e("div",yc,[e("div",xc,[o(t(Ze),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),Te(e("input",{"onUpdate:modelValue":r[0]||(r[0]=s=>M.value=s),type:"text",placeholder:"Buscar...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent text-sm"},null,512),[[Oe,M.value]])])]),e("div",_c,[o(t(Se),{as:"div",class:"relative"},{default:x(()=>[o(t(Fe),{class:"w-full inline-flex items-center justify-between gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:x(()=>[e("div",wc,[o(t(tt),{class:"h-4 w-4 flex-shrink-0"}),e("span",$c,f(ne.value||"Etiqueta"),1)]),o(t(ze),{class:"h-4 w-4 flex-shrink-0"})]),_:1}),o(t(Ee),{class:"absolute left-0 z-10 mt-2 w-full min-w-[16rem] origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none max-h-60 overflow-y-auto"},{default:x(()=>[e("div",kc,[o(t(ce),null,{default:x(({active:s})=>[e("a",{onClick:r[1]||(r[1]=c=>D.value=null),class:_([s?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Todos ",2)]),_:1}),(n(!0),a(ae,null,ue(U.value,s=>(n(),oe(t(ce),{key:s.id},{default:x(({active:c})=>[e("a",{onClick:J=>D.value=s.id,class:_([c?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])},f(s.name),11,Cc)]),_:2},1024))),128))])]),_:1})]),_:1}),e("div",Dc,[D.value?(n(),a("button",{key:0,onClick:pe,class:"w-full inline-flex items-center justify-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",title:"Limpiar filtros"},[o(t(Le),{class:"h-4 w-4 flex-shrink-0"}),Sc])):F("",!0)])]),e("div",Fc,[e("div",Ec,[e("div",Ac,[e("span",Tc,f(h.value.length),1),Y(" resultados ")]),o(t(Se),{as:"div",class:"relative"},{default:x(()=>[o(t(Fe),{class:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:x(()=>[Mc,Y(" "+f(I.value)+" ",1),o(t(ze),{class:"h-4 w-4"})]),_:1}),o(t(Ee),{class:"absolute left-0 sm:left-auto sm:right-0 z-10 mt-2 w-48 origin-top-left sm:origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:x(()=>[e("div",Lc,[o(t(ce),null,{default:x(({active:s})=>[e("a",{onClick:r[2]||(r[2]=c=>G.value="recent"),class:_([s?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Más recientes ",2)]),_:1}),o(t(ce),null,{default:x(({active:s})=>[e("a",{onClick:r[3]||(r[3]=c=>G.value="name"),class:_([s?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Nombre (A-Z) ",2)]),_:1})])]),_:1})]),_:1})]),e("div",Pc,[e("button",{onClick:Qe,class:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},[o(t(nt),{class:"h-4 w-4"}),Ic]),o(t(Se),{as:"div",class:"relative"},{default:x(()=>[o(t(Fe),{class:"inline-flex items-center justify-center w-10 h-10 rounded-md hover:bg-gray-100"},{default:x(()=>[o(t(st),{class:"h-5 w-5 text-gray-500"})]),_:1}),o(t(Ee),{class:"absolute left-0 sm:left-auto sm:right-0 z-10 mt-2 w-48 origin-top-left sm:origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:x(()=>[e("div",Bc,[o(t(ce),null,{default:x(({active:s})=>[e("a",{onClick:ge,class:_([s?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Seleccionar todo ",2)]),_:1}),o(t(ce),null,{default:x(({active:s})=>[e("a",{onClick:de,class:_([s?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Deseleccionar todo ",2)]),_:1})])]),_:1})]),_:1})])])]),e("div",jc,[e("div",Uc,[e("table",zc,[e("thead",Nc,[e("tr",null,[e("th",Oc,[e("input",{type:"checkbox",checked:R.value,onChange:se,class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,qc)]),Rc,Vc,Qc,Gc])]),e("tbody",Hc,[(n(!0),a(ae,null,ue(L.value,(s,c)=>(n(),a("tr",{key:s.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:J=>fe(s)},[e("td",{class:"px-6 py-4 whitespace-nowrap",onClick:r[4]||(r[4]=he(()=>{},["stop"]))},[e("input",{type:"checkbox",checked:S.value.includes(s.id),onChange:J=>X(s.id),class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,Wc)]),e("td",Jc,[e("div",Kc,[e("div",Yc,[e("div",Xc,[o(t(Re),{class:"h-5 w-5 text-blue-600"})])]),e("div",eu,[e("div",tu,f(s.title),1)])])]),e("td",su,[e("div",ou,f(m(s)),1)]),nu,e("td",ru,[e("div",lu,[(n(!0),a(ae,null,ue(s.tags,J=>(n(),a("span",{key:J.id,class:_(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",P(J)])},f(J.name),3))),128)),!s.tags||s.tags.length===0?(n(),a("span",au,"-")):F("",!0)])])],8,Zc))),128))])])]),O.value>1?(n(),a("div",iu,[e("div",du,[e("button",{onClick:Ce,disabled:C.value===1,class:_(["relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",C.value===1?"opacity-50 cursor-not-allowed":""])}," Anterior ",10,cu),e("button",{onClick:De,disabled:C.value===O.value,class:_(["relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",C.value===O.value?"opacity-50 cursor-not-allowed":""])}," Siguiente ",10,uu)]),e("div",mu,[e("div",null,[e("p",gu,[Y(" Mostrando "),e("span",pu,f(E.value.start),1),Y(" a "),e("span",hu,f(E.value.end),1),Y(" de "),e("span",fu,f(E.value.total),1),Y(" resultados ")])]),e("div",null,[e("nav",vu,[e("button",{onClick:Ce,disabled:C.value===1,class:_(["relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",C.value===1?"opacity-50 cursor-not-allowed":""])},[yu,o(t(pt),{class:"h-5 w-5","aria-hidden":"true"})],10,bu),(n(!0),a(ae,null,ue(Ie.value,s=>(n(),a(ae,{key:s},[s!=="..."?(n(),a("button",{key:0,onClick:c=>Ve(s),class:_(["relative inline-flex items-center px-4 py-2 text-sm font-semibold focus:z-20 focus:outline-offset-0",C.value===s?"z-10 bg-secondary text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-secondary":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50"])},f(s),11,xu)):(n(),a("span",_u," ... "))],64))),128)),e("button",{onClick:De,disabled:C.value===O.value,class:_(["relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",C.value===O.value?"opacity-50 cursor-not-allowed":""])},[$u,o(t(rt),{class:"h-5 w-5","aria-hidden":"true"})],10,wu)])])])])):F("",!0)]),h.value.length===0?(n(),a("div",ku,[o(t(lt),{class:"mx-auto h-12 w-12 text-gray-400"}),Cu,Du])):F("",!0),(n(),oe(ht,{to:"body"},[t(k).edit.isOpen?(n(),oe(t(St),{key:0,document:t(k).edit.document,"user-role":t(te)(),onClose:r[5]||(r[5]=s=>t(T)("edit")),onRefresh:r[6]||(r[6]=s=>u("refresh"))},null,8,["document","user-role"])):F("",!0),t(k).email.isOpen?(n(),oe(t(Ft),{key:1,document:t(k).email.document,onClose:r[7]||(r[7]=s=>t(T)("email"))},null,8,["document"])):F("",!0),t(k).letterhead.isOpen?(n(),oe(bt,{key:2,"is-visible":t(k).letterhead.isOpen,document:t(k).letterhead.document,onClose:r[8]||(r[8]=s=>t(T)("letterhead")),onUploaded:r[9]||(r[9]=s=>u("refresh")),onDeleted:r[10]||(r[10]=s=>u("refresh"))},null,8,["is-visible","document"])):F("",!0),t(k).relationships.isOpen?(n(),oe(Et,{key:3,"is-open":t(k).relationships.isOpen,document:t(k).relationships.document,onClose:r[11]||(r[11]=s=>t(T)("relationships")),onRefresh:r[12]||(r[12]=s=>u("refresh"))},null,8,["is-open","document"])):F("",!0),W.value?(n(),oe(_t,{key:4,"is-visible":W.value,document:re.value,"card-type":"client",context:"table","user-store":t(p),onClose:r[13]||(r[13]=s=>W.value=!1),onAction:Pe},null,8,["is-visible","document","user-store"])):F("",!0)]))]))}},Fu={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-3 sm:p-4 mb-6"},Eu={class:"mb-4"},Au={class:"relative w-full"},Tu={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-4"},Mu={class:"flex items-center gap-2 min-w-0"},Lu={class:"truncate"},Pu={class:"p-2"},Iu={class:"relative mb-2"},Bu={class:"max-h-60 overflow-y-auto"},ju=["onClick"],Uu={class:"truncate"},zu={key:0,class:"px-3 py-2 text-sm text-gray-500 text-center"},Nu={class:"flex items-center justify-stretch"},Ou=e("span",null,"Limpiar",-1),qu={class:"flex flex-col gap-3 pt-4 border-t border-gray-200"},Ru={class:"flex flex-col sm:flex-row gap-3 items-start sm:items-center justify-between"},Vu={class:"text-sm text-gray-500"},Qu={class:"font-medium"},Gu=e("span",{class:"hidden sm:inline"},"Ordenar:",-1),Hu={class:"py-1"},Zu={class:"flex items-center gap-2"},Wu=e("span",{class:"hidden sm:inline"},"Exportar",-1),Ju={class:"py-1"},Ku={class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",style:{"overflow-x":"visible","overflow-y":"hidden"}},Yu={class:"overflow-x-auto",style:{"overflow-y":"visible"}},Xu={class:"min-w-full divide-y divide-gray-200"},em={class:"bg-gray-50"},tm={scope:"col",class:"w-12 px-6 py-3"},sm=["checked"],om=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Nombre Documento ",-1),nm=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado Firma ",-1),rm=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etiqueta ",-1),lm={class:"bg-white divide-y divide-gray-200"},am=["onClick"],im=["checked","onChange"],dm={class:"px-6 py-4 whitespace-nowrap"},cm={class:"flex items-center"},um={class:"flex-shrink-0 h-10 w-10"},mm={class:"h-10 w-10 rounded-lg bg-purple-100 flex items-center justify-center"},gm={class:"ml-4"},pm={class:"text-sm font-medium text-gray-900"},hm={class:"px-6 py-4 whitespace-nowrap"},fm={class:"px-6 py-4 whitespace-nowrap"},vm={class:"flex flex-wrap gap-1"},bm={key:0,class:"text-sm text-gray-400"},ym={key:0,class:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"},xm={class:"flex flex-1 justify-between sm:hidden"},_m=["disabled"],wm=["disabled"],$m={class:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between"},km={class:"text-sm text-gray-700"},Cm={class:"font-medium"},Dm={class:"font-medium"},Sm={class:"font-medium"},Fm={class:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination"},Em=["disabled"],Am=e("span",{class:"sr-only"},"Anterior",-1),Tm=["onClick"],Mm={key:1,class:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700"},Lm=["disabled"],Pm=e("span",{class:"sr-only"},"Siguiente",-1),Im={key:0,class:"text-center py-12"},Bm={class:"mt-2 text-sm font-medium text-gray-900"},jm={class:"mt-1 text-sm text-gray-500"},Um={key:1,class:"text-center py-12"},zm=e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-secondary"},null,-1),Nm=e("p",{class:"mt-2 text-sm text-gray-500"},"Cargando documentos...",-1),Om=[zm,Nm],$t={__name:"SignaturesListTable",props:{state:{type:String,required:!0,validator:l=>["PendingSignatures","FullySigned"].includes(l)},searchQuery:{type:String,default:""},selectedTags:{type:Array,default:()=>[]}},emits:["refresh","document-fully-signed","open-electronic-signature"],setup(l,{expose:v,emit:i}){const p=l,A=i,$=Je(),u=qe();et();const{activeModals:k,openModal:y,closeModal:T,getUserRole:te}=ft(u,$),{handlePreviewDocument:V,downloadPDFDocument:K,signDocument:N,downloadSignedDocument:g}=vt(u,$,A);w([]);const M=w(!1),D=w(""),G=w(""),S=w(null),C=w("recent"),ie=w([]),z=w(1),h=w(10),L=j(()=>p.state==="PendingSignatures"?"No tienes documentos pendientes por firmar":"No tienes documentos firmados"),O=j(()=>p.state==="PendingSignatures"?"Cuando tengas documentos que requieran tu firma electrónica aparecerán aquí.":"Una vez que firmes documentos electrónicamente, aparecerán aquí."),E=j(()=>{const ee=$.currentUser.role,Q=$.currentUser.id,le=$.currentUser.email;let Z=[];return ee==="lawyer"?p.state==="PendingSignatures"?Z=u.pendingSignatureDocuments.filter(ve=>{var ke;const ye=ve.created_by===Q,Ae=(ke=ve.signatures)==null?void 0:ke.some(Be=>Be.signer_email===le);return ye||Ae}):Z=u.fullySignedDocuments.filter(ve=>{var ke;const ye=ve.created_by===Q,Ae=(ke=ve.signatures)==null?void 0:ke.some(Be=>Be.signer_email===le&&Be.signed);return ye||Ae}):p.state==="PendingSignatures"?Z=u.documents.filter(ve=>{var ke;if(ve.state!=="PendingSignatures")return!1;const ye=(ke=ve.signatures)==null?void 0:ke.some(Be=>Be.signer_email===le),Ae=ve.created_by===Q;return ye||Ae}):Z=u.documents.filter(ve=>{var ke;if(ve.state!=="FullySigned")return!1;const ye=(ke=ve.signatures)==null?void 0:ke.some(Be=>Be.signer_email===le&&Be.signed),Ae=ve.created_by===Q;return ye||Ae}),Z}),U=j(()=>{let ee=[...E.value];const Q=D.value.toLowerCase();return Q&&(ee=ee.filter(le=>{var Z,ve;return((Z=le.title)==null?void 0:Z.toLowerCase().includes(Q))||((ve=le.tags)==null?void 0:ve.some(ye=>{var Ae;return(Ae=ye.name)==null?void 0:Ae.toLowerCase().includes(Q)}))})),S.value&&(ee=ee.filter(le=>le.tags&&le.tags.some(Z=>Z.id===S.value))),C.value==="name"?ee.sort((le,Z)=>{const ve=(le.title||"").toLowerCase(),ye=(Z.title||"").toLowerCase();return ve.localeCompare(ye)}):C.value==="recent"&&ee.sort((le,Z)=>Z.id-le.id),ee}),ne=j(()=>{const ee=(z.value-1)*h.value,Q=ee+h.value;return U.value.slice(ee,Q)}),I=j(()=>Math.ceil(U.value.length/h.value)),m=j(()=>{const ee=(z.value-1)*h.value+1,Q=Math.min(z.value*h.value,U.value.length);return{start:ee,end:Q,total:U.value.length}});be([D,S],()=>{z.value=1});const P=j(()=>{const ee=new Map;return E.value.forEach(Q=>{Q.tags&&Q.tags.length>0&&Q.tags.forEach(le=>{ee.has(le.id)||ee.set(le.id,le)})}),Array.from(ee.values()).sort((Q,le)=>Q.name.localeCompare(le.name))}),R=j(()=>{if(!G.value)return P.value;const ee=G.value.toLowerCase();return P.value.filter(Q=>Q.name.toLowerCase().includes(ee))}),se=j(()=>{if(!S.value)return null;const ee=P.value.find(Q=>Q.id===S.value);return ee?ee.name:null}),X=ee=>{const Q=["bg-blue-500","bg-purple-500","bg-pink-500","bg-yellow-500","bg-green-500","bg-red-500","bg-indigo-500","bg-orange-500"],le=ee.id%Q.length;return Q[le]},ge=j(()=>{switch(C.value){case"name":return"Nombre (A-Z)";case"recent":default:return"Más recientes"}}),de=ee=>{const Q=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],le=ee.id%Q.length;return Q[le]},pe=ee=>p.state==="FullySigned"?"bg-green-100 text-green-700 border border-green-200":"bg-yellow-100 text-yellow-700 border border-yellow-200",Ce=ee=>p.state==="FullySigned"?"Firmado":"Pendiente",De=j(()=>U.value.length>0&&ie.value.length===U.value.length),Ve=()=>{De.value?ie.value=[]:ie.value=U.value.map(ee=>ee.id)},Ie=ee=>{const Q=ie.value.indexOf(ee);Q>-1?ie.value.splice(Q,1):ie.value.push(ee)},Qe=()=>{ie.value=U.value.map(ee=>ee.id)},Ue=()=>{ie.value=[]},W=()=>{S.value=null},re=()=>{z.value>1&&z.value--},fe=()=>{z.value<I.value&&z.value++},Pe=ee=>{ee>=1&&ee<=I.value&&(z.value=ee)},d=j(()=>{const ee=I.value,Q=z.value,le=[];if(ee<=7)for(let Z=1;Z<=ee;Z++)le.push(Z);else if(Q<=4){for(let Z=1;Z<=5;Z++)le.push(Z);le.push("..."),le.push(ee)}else if(Q>=ee-3){le.push(1),le.push("...");for(let Z=ee-4;Z<=ee;Z++)le.push(Z)}else le.push(1),le.push("..."),le.push(Q-1),le.push(Q),le.push(Q+1),le.push("..."),le.push(ee);return le}),r=()=>{const ee=ie.value.length>0?U.value.filter(ke=>ie.value.includes(ke.id)):U.value,Q=["Nombre Documento","Estado Firma","Etiquetas"],le=ee.map(ke=>[ke.title||"",Ce(),ke.tags?ke.tags.map(Be=>Be.name).join(", "):""]),Z=[Q.join(","),...le.map(ke=>ke.map(Be=>`"${Be}"`).join(","))].join(`
`),ve=new Blob([Z],{type:"text/csv;charset=utf-8;"}),ye=document.createElement("a"),Ae=URL.createObjectURL(ve);ye.setAttribute("href",Ae),ye.setAttribute("download",`documentos_firmas_${new Date().toISOString().split("T")[0]}.csv`),ye.style.visibility="hidden",document.body.appendChild(ye),ye.click(),document.body.removeChild(ye)},s=w(!1),c=w(null),J=ee=>{c.value=ee,s.value=!0},me=async(ee,Q)=>{s.value=!1,await Me(ee,Q)},Me=async(ee,Q)=>{try{switch(ee){case"preview":await V(Q);break;case"letterhead":y("letterhead",Q);break;case"viewSignatures":y("signatures",Q);break;case"sign":await N(Q,y);break;case"downloadSignedDocument":await g(Q);break;case"downloadPDF":await K(Q);break;default:console.warn("Unknown action:",ee)}}catch(le){console.error(`Error executing action ${ee}:`,le)}},we=async()=>{M.value=!0;try{await u.init(!0)}catch(ee){console.error("Error refreshing documents:",ee),$e("Error al actualizar documentos","error")}finally{M.value=!1}},Ge=async()=>{await we(),A("refresh")};return Ne(async()=>{await we()}),v({refresh:Ge}),be(()=>$.currentUser,()=>{Ge()}),(ee,Q)=>{var le;return n(),a("div",null,[e("div",Fu,[e("div",Eu,[e("div",Au,[o(t(Ze),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),Te(e("input",{"onUpdate:modelValue":Q[0]||(Q[0]=Z=>D.value=Z),type:"text",placeholder:"Buscar...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent text-sm"},null,512),[[Oe,D.value]])])]),e("div",Tu,[o(t(Se),{as:"div",class:"relative"},{default:x(()=>[o(t(Fe),{class:"w-full inline-flex items-center justify-between gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:x(()=>[e("div",Mu,[o(t(tt),{class:"h-4 w-4 flex-shrink-0"}),e("span",Lu,f(se.value||"Etiqueta"),1)]),o(t(ze),{class:"h-4 w-4 flex-shrink-0"})]),_:1}),o(t(Ee),{class:"absolute left-0 z-10 mt-2 w-full min-w-[16rem] origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:x(()=>[e("div",Pu,[e("div",Iu,[o(t(Ze),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),Te(e("input",{"onUpdate:modelValue":Q[1]||(Q[1]=Z=>G.value=Z),type:"text",placeholder:"Buscar etiquetas...",class:"w-full pl-9 pr-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent",onClick:Q[2]||(Q[2]=he(()=>{},["stop"]))},null,512),[[Oe,G.value]])]),e("div",Bu,[o(t(ce),null,{default:x(({active:Z})=>[e("a",{onClick:Q[3]||(Q[3]=ve=>S.value=null),class:_([Z?"bg-gray-100":"","block px-3 py-2 text-sm text-gray-700 cursor-pointer rounded-md"])}," Todos ",2)]),_:1}),(n(!0),a(ae,null,ue(R.value,Z=>(n(),oe(t(ce),{key:Z.id},{default:x(({active:ve})=>[e("a",{onClick:ye=>S.value=Z.id,class:_([ve?"bg-gray-100":"","flex items-center gap-2 px-3 py-2 text-sm cursor-pointer rounded-md"])},[e("span",{class:_(["w-3 h-3 rounded-full flex-shrink-0",X(Z)])},null,2),e("span",Uu,f(Z.name),1)],10,ju)]),_:2},1024))),128)),R.value.length===0?(n(),a("div",zu," No se encontraron etiquetas ")):F("",!0)])])]),_:1})]),_:1}),e("div",Nu,[S.value?(n(),a("button",{key:0,onClick:W,class:"w-full inline-flex items-center justify-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",title:"Limpiar filtros"},[o(t(Le),{class:"h-4 w-4 flex-shrink-0"}),Ou])):F("",!0)])]),e("div",qu,[e("div",Ru,[e("div",Vu,[e("span",Qu,f(U.value.length),1),Y(" resultados ")]),o(t(Se),{as:"div",class:"relative"},{default:x(()=>[o(t(Fe),{class:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:x(()=>[Gu,Y(" "+f(ge.value)+" ",1),o(t(ze),{class:"h-4 w-4"})]),_:1}),o(t(Ee),{class:"absolute left-0 sm:left-auto sm:right-0 z-10 mt-2 w-48 origin-top-left sm:origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:x(()=>[e("div",Hu,[o(t(ce),null,{default:x(({active:Z})=>[e("a",{onClick:Q[4]||(Q[4]=ve=>C.value="recent"),class:_([Z?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Más recientes ",2)]),_:1}),o(t(ce),null,{default:x(({active:Z})=>[e("a",{onClick:Q[5]||(Q[5]=ve=>C.value="name"),class:_([Z?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Nombre (A-Z) ",2)]),_:1})])]),_:1})]),_:1})]),e("div",Zu,[e("button",{onClick:r,class:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},[o(t(nt),{class:"h-4 w-4"}),Wu]),o(t(Se),{as:"div",class:"relative"},{default:x(()=>[o(t(Fe),{class:"inline-flex items-center justify-center w-10 h-10 rounded-md hover:bg-gray-100"},{default:x(()=>[o(t(st),{class:"h-5 w-5 text-gray-500"})]),_:1}),o(t(Ee),{class:"absolute left-0 sm:left-auto sm:right-0 z-10 mt-2 w-48 origin-top-left sm:origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:x(()=>[e("div",Ju,[o(t(ce),null,{default:x(({active:Z})=>[e("a",{onClick:Qe,class:_([Z?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Seleccionar todo ",2)]),_:1}),o(t(ce),null,{default:x(({active:Z})=>[e("a",{onClick:Ue,class:_([Z?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Deseleccionar todo ",2)]),_:1})])]),_:1})]),_:1})])])]),e("div",Ku,[e("div",Yu,[e("table",Xu,[e("thead",em,[e("tr",null,[e("th",tm,[e("input",{type:"checkbox",checked:De.value,onChange:Ve,class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,sm)]),om,nm,rm])]),e("tbody",lm,[(n(!0),a(ae,null,ue(ne.value,(Z,ve)=>(n(),a("tr",{key:Z.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:ye=>J(Z)},[e("td",{class:"px-6 py-4 whitespace-nowrap",onClick:Q[6]||(Q[6]=he(()=>{},["stop"]))},[e("input",{type:"checkbox",checked:ie.value.includes(Z.id),onChange:ye=>Ie(Z.id),class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,im)]),e("td",dm,[e("div",cm,[e("div",um,[e("div",mm,[o(t(Re),{class:"h-5 w-5 text-purple-600"})])]),e("div",gm,[e("div",pm,f(Z.title),1)])])]),e("td",hm,[e("span",{class:_(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",pe()])},f(Ce()),3)]),e("td",fm,[e("div",vm,[(n(!0),a(ae,null,ue(Z.tags,ye=>(n(),a("span",{key:ye.id,class:_(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",de(ye)])},f(ye.name),3))),128)),!Z.tags||Z.tags.length===0?(n(),a("span",bm,"-")):F("",!0)])])],8,am))),128))])])]),I.value>1?(n(),a("div",ym,[e("div",xm,[e("button",{onClick:re,disabled:z.value===1,class:_(["relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",z.value===1?"opacity-50 cursor-not-allowed":""])}," Anterior ",10,_m),e("button",{onClick:fe,disabled:z.value===I.value,class:_(["relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",z.value===I.value?"opacity-50 cursor-not-allowed":""])}," Siguiente ",10,wm)]),e("div",$m,[e("div",null,[e("p",km,[Y(" Mostrando "),e("span",Cm,f(m.value.start),1),Y(" a "),e("span",Dm,f(m.value.end),1),Y(" de "),e("span",Sm,f(m.value.total),1),Y(" resultados ")])]),e("div",null,[e("nav",Fm,[e("button",{onClick:re,disabled:z.value===1,class:_(["relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",z.value===1?"opacity-50 cursor-not-allowed":""])},[Am,o(t(pt),{class:"h-5 w-5","aria-hidden":"true"})],10,Em),(n(!0),a(ae,null,ue(d.value,Z=>(n(),a(ae,{key:Z},[Z!=="..."?(n(),a("button",{key:0,onClick:ve=>Pe(Z),class:_(["relative inline-flex items-center px-4 py-2 text-sm font-semibold focus:z-20 focus:outline-offset-0",z.value===Z?"z-10 bg-secondary text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-secondary":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50"])},f(Z),11,Tm)):(n(),a("span",Mm," ... "))],64))),128)),e("button",{onClick:fe,disabled:z.value===I.value,class:_(["relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",z.value===I.value?"opacity-50 cursor-not-allowed":""])},[Pm,o(t(rt),{class:"h-5 w-5","aria-hidden":"true"})],10,Lm)])])])])):F("",!0)]),U.value.length===0&&!M.value?(n(),a("div",Im,[o(t(lt),{class:"mx-auto h-12 w-12 text-gray-400"}),e("h3",Bm,f(L.value),1),e("p",jm,f(O.value),1)])):F("",!0),M.value?(n(),a("div",Um,Om)):F("",!0),o(Pt,{isVisible:t(ot),documentData:t(Lt),onClose:Q[7]||(Q[7]=Z=>ot.value=!1)},null,8,["isVisible","documentData"]),(n(),oe(ht,{to:"body"},[t(k).signatures.isOpen?(n(),oe(t(Qt),{key:0,"document-id":(le=t(k).signatures.document)==null?void 0:le.id,onClose:Q[8]||(Q[8]=Z=>t(T)("signatures")),onRefresh:Q[9]||(Q[9]=Z=>A("refresh"))},null,8,["document-id"])):F("",!0),t(k).letterhead.isOpen?(n(),oe(bt,{key:1,"is-visible":t(k).letterhead.isOpen,document:t(k).letterhead.document,onClose:Q[10]||(Q[10]=Z=>t(T)("letterhead")),onUploaded:Q[11]||(Q[11]=Z=>A("refresh")),onDeleted:Q[12]||(Q[12]=Z=>A("refresh"))},null,8,["is-visible","document"])):F("",!0),s.value?(n(),oe(_t,{key:2,"is-visible":s.value,document:c.value,"card-type":"signatures",context:"table","user-store":t($),onClose:Q[13]||(Q[13]=Z=>s.value=!1),onAction:me},null,8,["is-visible","document","user-store"])):F("",!0)]))])}}},qm={class:"bg-white rounded-lg p-6 shadow-xl max-w-lg w-full"},Rm={class:"flex justify-end"},Vm=e("label",{for:"document-name",class:"block text-base font-medium leading-6 text-primary"},[Y(" Nombre "),e("span",{class:"text-red-500"},"*")],-1),Qm={class:"mt-2"},Gm={class:"flex gap-2 mt-2.5"},Hm=["disabled"],Zm=e("span",null,"Actualizar nombre",-1),Wm=[Zm],Jm=["disabled"],Km={__name:"CreateDocumentByLawyer",emits:["close"],setup(l,{emit:v}){const i=et(),p=qe(),A=v,$=w(""),u=w("");Rt(()=>{var N;(N=p.selectedDocument)!=null&&N.title?($.value=p.selectedDocument.title,u.value=p.selectedDocument.title):($.value="",u.value="")});const k=N=>{N.key==="Escape"&&A("close")};Ne(()=>{document.addEventListener("keydown",k)}),ut(()=>{document.removeEventListener("keydown",k)});const y=j(()=>$.value.trim().length>0),T=j(()=>{var N;return!!((N=p.selectedDocument)!=null&&N.id)}),te=j(()=>T.value&&$.value.trim()!==u.value.trim()&&$.value.trim().length>0);async function V(){if(T.value&&te.value)try{const N={title:$.value.trim()};await p.updateDocument(p.selectedDocument.id,N),u.value=$.value.trim(),p.selectedDocument.title=$.value.trim(),p.lastUpdatedDocumentId=p.selectedDocument.id,localStorage.setItem("lastUpdatedDocumentId",p.selectedDocument.id);const g=p.selectedDocument.id;A("close",{updatedDocId:g});const M=window.location.pathname;M==="/dynamic_document_dashboard"||M==="/dynamic_document_dashboard/"?setTimeout(()=>{window.forceDocumentHighlight&&window.forceDocumentHighlight(g)},100):setTimeout(()=>{window.location.href="/dynamic_document_dashboard"},1e3)}catch(N){console.error("Error updating document name:",N)}}const K=async()=>{if(!y.value)return;const N=encodeURIComponent($.value.trim());T.value?(p.selectedDocument.title=$.value,p.selectedDocument.id&&(p.lastUpdatedDocumentId=p.selectedDocument.id,localStorage.setItem("lastUpdatedDocumentId",p.selectedDocument.id.toString())),i.push(`/dynamic_document_dashboard/lawyer/editor/edit/${p.selectedDocument.id}`)):(p.selectedDocument={title:$.value.trim()},i.push(`/dynamic_document_dashboard/lawyer/editor/create/${N}`))};return(N,g)=>(n(),a("div",qm,[e("div",Rm,[e("button",{onClick:g[0]||(g[0]=M=>A("close"))},[o(t(Le),{class:"size-6"})])]),e("form",{onSubmit:he(K,["prevent"])},[e("div",null,[Vm,e("div",Qm,[Te(e("input",{"onUpdate:modelValue":g[1]||(g[1]=M=>$.value=M),type:"text",name:"document-name",id:"document-name",class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-secondary sm:text-sm sm:leading-6",required:""},null,512),[[Oe,$.value]])])]),e("div",Gm,[T.value?(n(),a("button",{key:0,type:"button",onClick:V,disabled:!te.value,class:_(["p-2.5 text-sm font-medium rounded-md flex gap-2",te.value?"bg-primary text-white cursor-pointer":"bg-gray-200 text-gray-400 cursor-not-allowed opacity-70"])},Wm,10,Hm)):F("",!0),e("button",{type:"submit",class:_(["p-2.5 text-sm font-medium rounded-md flex gap-2",y.value?"bg-secondary text-white":"bg-gray-200 text-secondary border-2 border-dashed border-secondary cursor-not-allowed bg-opacity-50"]),disabled:!y.value},[e("span",null,f(T.value?"Editar Documento":"Continuar"),1)],10,Jm)])],32)]))}},je=l=>(mt("data-v-07bc4810"),l=l(),gt(),l),Ym={class:"relative bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col"},Xm={class:"px-6 py-4 border-b border-gray-200"},eg=je(()=>e("h2",{class:"text-xl font-semibold text-gray-800"},"Gestión de Membrete Global",-1)),tg=je(()=>e("p",{class:"text-sm text-gray-500 mt-1"}," Este membrete se aplicará por defecto a todos tus documentos ",-1)),sg={class:"p-6 overflow-y-auto flex-grow"},og={key:0,class:"text-center py-10"},ng=je(()=>e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1)),rg={class:"mt-4 text-gray-500"},lg={key:1,class:"space-y-6"},ag={key:0,class:"space-y-4"},ig=je(()=>e("h3",{class:"text-lg font-medium text-gray-900"},"Membrete Global Actual",-1)),dg={class:"border border-gray-200 rounded-lg p-4 bg-gray-50"},cg=["src"],ug={class:"mt-4 flex justify-center space-x-3"},mg=["disabled"],gg={key:1,class:"text-center py-8"},pg=je(()=>e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"Sin Membrete Global",-1)),hg=je(()=>e("p",{class:"mt-1 text-sm text-gray-500"}," No tienes una imagen de membrete global configurada. ",-1)),fg=je(()=>e("p",{class:"mt-1 text-xs text-gray-400"}," El membrete global se aplicará a todos los documentos que no tengan un membrete específico. ",-1)),vg={class:"space-y-4"},bg={class:"text-lg font-medium text-gray-900"},yg={class:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-gray-400 transition-colors"},xg={key:0},_g={class:"mt-4"},wg=je(()=>e("p",{class:"mt-2 text-sm text-gray-500"}," Solo archivos PNG, máximo 10MB ",-1)),$g=je(()=>e("p",{class:"text-xs text-gray-400 mt-1"}," Dimensiones ideales: 612 × 612 píxeles (8.5:11 Carta) ",-1)),kg={key:1,class:"space-y-4"},Cg={class:"flex items-center justify-center space-x-2 text-sm text-gray-600"},Dg={class:"text-gray-400"},Sg={key:0,class:"mt-4"},Fg=["src"],Eg={class:"flex justify-center space-x-3"},Ag=["disabled"],Tg={key:1,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},Mg={key:2,class:"bg-blue-50 border border-blue-200 rounded-lg p-6 space-y-6"},Lg={class:"flex items-center space-x-2"},Pg=je(()=>e("h3",{class:"text-lg font-semibold text-blue-900"},"Especificaciones del Membrete Global",-1)),Ig=je(()=>e("div",{class:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},[e("h4",{class:"font-medium text-yellow-800 mb-2"},"🔄 Prioridad de Membrete"),e("div",{class:"text-sm text-yellow-700 space-y-1"},[e("div",null,[e("strong",null,"1º Prioridad:"),Y(" Membrete específico del documento")]),e("div",null,[e("strong",null,"2º Prioridad:"),Y(" Membrete global del usuario (este)")]),e("div",null,[e("strong",null,"3º Prioridad:"),Y(" Sin membrete")])])],-1)),Bg=je(()=>e("div",{class:"space-y-3"},[e("h4",{class:"font-medium text-gray-900"},"📐 Dimensiones Exactas"),e("div",{class:"bg-white rounded-lg p-4 border border-blue-200"},[e("div",{class:"grid grid-cols-2 gap-4 text-sm"},[e("div",null,[e("span",{class:"font-medium text-gray-700"},"Ancho:"),e("span",{class:"ml-2 text-blue-600 font-mono"},"612 píxeles")]),e("div",null,[e("span",{class:"font-medium text-gray-700"},"Alto:"),e("span",{class:"ml-2 text-blue-600 font-mono"},"612 píxeles")]),e("div",null,[e("span",{class:"font-medium text-gray-700"},"Proporción:"),e("span",{class:"ml-2 text-blue-600"},"8.5:11 (Carta)")]),e("div",null,[e("span",{class:"font-medium text-gray-700"},"Tolerancia:"),e("span",{class:"ml-2 text-orange-600"},"±10%")])])])],-1)),jg=je(()=>e("div",{class:"space-y-3"},[e("h4",{class:"font-medium text-gray-900"},"🎨 Distribución Recomendada"),e("div",{class:"bg-white rounded-lg p-4 border border-blue-200"},[e("div",{class:"space-y-4"},[e("div",{class:"mx-auto w-40 h-44 border-2 border-gray-300 rounded bg-gradient-to-b from-blue-100 via-yellow-50 to-green-100 relative text-xs"},[e("div",{class:"absolute top-0 left-0 right-0 h-12 bg-blue-200 bg-opacity-70 border-b border-blue-300 flex items-center justify-center text-blue-800 font-medium"}," HEADER ZONE "),e("div",{class:"absolute top-10 left-1 text-blue-700 text-[10px]"},"120-150px"),e("div",{class:"absolute top-12 left-0 right-0 bottom-12 bg-yellow-100 bg-opacity-50 border-y border-yellow-300 flex items-center justify-center text-yellow-800 font-medium"},[e("div",{class:"text-center"},[e("div",null,"BODY ZONE"),e("div",{class:"text-[10px] mt-1"},"⚠️ ZONA CRÍTICA")])]),e("div",{class:"absolute top-20 left-1 text-yellow-700 text-[10px]"},"300-400px"),e("div",{class:"absolute bottom-0 left-0 right-0 h-12 bg-green-200 bg-opacity-70 border-t border-green-300 flex items-center justify-center text-green-800 font-medium"}," FOOTER ZONE "),e("div",{class:"absolute bottom-10 left-1 text-green-700 text-[10px]"},"80-120px")]),e("div",{class:"space-y-3 text-sm"},[e("div",{class:"flex items-start space-x-3"},[e("div",{class:"w-4 h-4 bg-blue-200 border border-blue-300 rounded mt-0.5 flex-shrink-0"}),e("div",null,[e("span",{class:"font-medium text-blue-800"},"Header (Superior):"),e("span",{class:"text-gray-600 ml-1"},"Logos, nombre de empresa. Puede tener mayor intensidad visual.")])]),e("div",{class:"flex items-start space-x-3"},[e("div",{class:"w-4 h-4 bg-yellow-100 border border-yellow-300 rounded mt-0.5 flex-shrink-0"}),e("div",null,[e("span",{class:"font-medium text-yellow-800"},"Body (Centro):"),e("span",{class:"text-gray-600 ml-1"},"Mantén semi-transparente. El texto del documento se superpone aquí.")])]),e("div",{class:"flex items-start space-x-3"},[e("div",{class:"w-4 h-4 bg-green-200 border border-green-300 rounded mt-0.5 flex-shrink-0"}),e("div",null,[e("span",{class:"font-medium text-green-800"},"Footer (Inferior):"),e("span",{class:"text-gray-600 ml-1"},"Direcciones, teléfonos, emails, información de contacto.")])])])])])],-1)),Ug=je(()=>e("div",{class:"space-y-3"},[e("h4",{class:"font-medium text-gray-900"},"🔧 Consideraciones Técnicas"),e("div",{class:"bg-white rounded-lg p-4 border border-blue-200"},[e("div",{class:"space-y-2 text-sm text-gray-700"},[e("div",{class:"flex items-start space-x-2"},[e("span",{class:"text-blue-600 font-medium"},"•"),e("span",null,[e("strong",null,"Posicionamiento:"),Y(" La imagen se centra automáticamente en el documento")])]),e("div",{class:"flex items-start space-x-2"},[e("span",{class:"text-blue-600 font-medium"},"•"),e("span",null,[e("strong",null,"Transparencia:"),Y(" Usa PNG con canal alpha para efectos de transparencia")])]),e("div",{class:"flex items-start space-x-2"},[e("span",{class:"text-blue-600 font-medium"},"•"),e("span",null,[e("strong",null,"Márgenes:"),Y(" Deja 30-50px de margen en los lados para seguridad")])]),e("div",{class:"flex items-start space-x-2"},[e("span",{class:"text-blue-600 font-medium"},"•"),e("span",null,[e("strong",null,"Resolución:"),Y(" 72-150 DPI es suficiente para documentos digitales")])]),e("div",{class:"flex items-start space-x-2"},[e("span",{class:"text-orange-600 font-medium"},"⚠️"),e("span",null,[e("strong",null,"Zona crítica:"),Y(" Evita elementos gráficos densos en el centro (300-400px de altura)")])])])])],-1)),zg=je(()=>e("div",{class:"bg-gradient-to-r from-green-50 to-blue-50 border border-green-200 rounded-lg p-4"},[e("h4",{class:"font-medium text-green-800 mb-2"},"💡 Tips de Diseño Rápido"),e("div",{class:"text-sm text-green-700 space-y-1"},[e("div",null,"• Si solo tienes header, ubícalo en los primeros 120-150px"),e("div",null,"• El resto de la imagen debe ser transparente o blanco"),e("div",null,"• Para footer, usa los últimos 80-120px"),e("div",null,"• El texto se superpone en toda la imagen, mantén el centro claro")])],-1)),Ng={key:3,class:"space-y-2"},Og={class:"flex"},qg={class:"text-sm text-yellow-700"},Rg={__name:"GlobalLetterheadModal",props:{isVisible:{type:Boolean,default:!1}},emits:["close","uploaded","deleted"],setup(l,{emit:v}){const i=l,p=v;be(()=>i.isVisible,I=>{});const A=qe(),$=w(!1),u=w(""),k=w(!1),y=w(!1),T=w(null),te=w(null),V=w(null),K=w([]),N=w(null),g=w(!1),M=w(!1),D=()=>{C(),p("close")},G=I=>{const m=I.target.files[0];if(!m)return;if(!m.type.includes("png")){alert("Solo se permiten archivos PNG");return}if(m.size>10*1024*1024){alert("El archivo no puede ser mayor a 10MB");return}T.value=m,K.value=[];const P=new FileReader;P.onload=R=>{te.value=R.target.result;const se=new Image;se.onload=()=>{S(se.width,se.height)},se.src=R.target.result},P.readAsDataURL(m)},S=(I,m)=>{const X=I/m,ge=612/612,de=Math.abs(X-ge)/ge;if(I===612&&m===612){K.value.push("✅ Dimensiones perfectas: 612 × 612 píxeles");return}de<=.1?(K.value.push(`ℹ️ Buenas proporciones detectadas: ${I} × ${m} píxeles (${X.toFixed(3)})`),(I!==612||m!==612)&&K.value.push("💡 Para mejores resultados, usa exactamente 612 × 612 píxeles")):(K.value.push(`⚠️ Proporciones no ideales: ${I} × ${m} píxeles (${X.toFixed(3)})`),K.value.push(`🎯 Proporciones recomendadas: ${ge.toFixed(3)} (8.5:11)`),K.value.push("📐 Considera redimensionar tu imagen a 612 × 612 píxeles")),(I<300||m<300)&&K.value.push("⚠️ Imagen muy pequeña - puede verse pixelada en documentos"),(I>1200||m>1600)&&K.value.push("ℹ️ Imagen muy grande - se redimensionará automáticamente")},C=()=>{T.value=null,te.value=null,K.value=[],g.value=!1,N.value&&(N.value.value="")},ie=async()=>{var I;if(T.value){k.value=!0,K.value=[];try{const m=await A.uploadGlobalLetterheadImage(T.value);(I=m.data)!=null&&I.warnings&&m.data.warnings.length>0&&(K.value=m.data.warnings),M.value=!1,await z(),C(),p("uploaded",m.data)}catch(m){console.error("Error uploading global letterhead:",m),alert("Error al subir la imagen. Por favor intenta nuevamente.")}finally{k.value=!1}}},z=async()=>{if(!(V.value===null&&M.value)){M.value=!0;try{const I=await A.getGlobalLetterheadImage();I.data&&(V.value=URL.createObjectURL(I.data))}catch{V.value=null}}},h=()=>{confirm("¿Estás seguro de que deseas eliminar la imagen de membrete global?")&&L()},L=async()=>{y.value=!0;try{await A.deleteGlobalLetterheadImage(),V.value&&URL.revokeObjectURL(V.value),V.value=null,M.value=!0,p("deleted")}catch(I){console.error("Error deleting global letterhead:",I),alert("Error al eliminar la imagen. Por favor intenta nuevamente.")}finally{y.value=!1}},O=()=>{if(V.value){const I=document.createElement("a");I.href=V.value,I.download="membrete-global.png",document.body.appendChild(I),I.click(),document.body.removeChild(I)}},E=()=>{V.value=null},U=I=>{if(I===0)return"0 Bytes";const m=1024,P=["Bytes","KB","MB","GB"],R=Math.floor(Math.log(I)/Math.log(m));return parseFloat((I/Math.pow(m,R)).toFixed(2))+" "+P[R]};be(()=>i.isVisible,I=>{I&&z()});const ne=()=>{V.value&&URL.revokeObjectURL(V.value),te.value&&URL.revokeObjectURL(te.value)};return Ne(()=>{i.isVisible&&z()}),ut(ne),(I,m)=>Te((n(),oe(Xe,null,{default:x(()=>[e("div",Ym,[e("div",Xm,[eg,tg,e("button",{onClick:D,class:"absolute top-4 right-4 text-gray-400 hover:text-gray-500"},[o(t(Le),{class:"h-6 w-6"})])]),e("div",sg,[$.value?(n(),a("div",og,[ng,e("p",rg,f(u.value),1)])):(n(),a("div",lg,[V.value?(n(),a("div",ag,[ig,e("div",dg,[e("img",{src:V.value,alt:"Membrete global actual",class:"max-w-full h-auto max-h-64 mx-auto shadow-sm",onError:E},null,40,cg),e("div",ug,[e("button",{onClick:O,class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},[o(t(nt),{class:"h-4 w-4 mr-2"}),Y(" Descargar ")]),e("button",{onClick:h,disabled:y.value,class:"inline-flex items-center px-3 py-2 border border-transparent shadow-sm text-sm leading-4 font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50"},[o(t(Ht),{class:"h-4 w-4 mr-2"}),Y(" "+f(y.value?"Eliminando...":"Eliminar"),1)],8,mg)])])])):(n(),a("div",gg,[o(t(ct),{class:"mx-auto h-12 w-12 text-gray-400"}),pg,hg,fg])),e("div",vg,[e("h3",bg,f(V.value?"Reemplazar Membrete Global":"Subir Membrete Global"),1),e("div",yg,[e("input",{ref_key:"fileInput",ref:N,type:"file",accept:".png",onChange:G,class:"hidden"},null,544),T.value?(n(),a("div",kg,[e("div",Cg,[o(t(Wt),{class:"h-5 w-5 text-green-500"}),e("span",null,f(T.value.name),1),e("span",Dg,"("+f(U(T.value.size))+")",1)]),te.value?(n(),a("div",Sg,[e("img",{src:te.value,alt:"Vista previa",class:"max-w-full h-auto max-h-32 mx-auto border border-gray-200 rounded"},null,8,Fg)])):F("",!0),e("div",Eg,[e("button",{onClick:C,class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"}," Cancelar "),e("button",{onClick:ie,disabled:k.value,class:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50"},[k.value?(n(),a("div",Tg)):(n(),oe(t(bs),{key:0,class:"h-4 w-4 mr-2"})),Y(" "+f(k.value?"Subiendo...":"Subir Imagen"),1)],8,Ag)])])):(n(),a("div",xg,[o(t(Zt),{class:"mx-auto h-12 w-12 text-gray-400"}),e("div",_g,[e("button",{onClick:m[0]||(m[0]=P=>I.$refs.fileInput.click()),class:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}," Seleccionar Imagen PNG "),e("button",{onClick:m[1]||(m[1]=P=>g.value=!g.value),class:"ml-3 inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"},[o(t(Ot),{class:"h-4 w-4 mr-2"}),Y(" "+f(g.value?"Ocultar":"Ver")+" Especificaciones ",1)])]),wg,$g]))])]),g.value?(n(),a("div",Mg,[e("div",Lg,[o(t(Ot),{class:"h-6 w-6 text-blue-600"}),Pg]),Ig,Bg,jg,Ug,zg])):F("",!0),K.value.length>0?(n(),a("div",Ng,[(n(!0),a(ae,null,ue(K.value,(P,R)=>(n(),a("div",{key:R,class:"bg-yellow-50 border border-yellow-200 rounded-md p-3"},[e("div",Og,[o(t(ys),{class:"h-5 w-5 text-yellow-400 mr-2 flex-shrink-0 mt-0.5"}),e("p",qg,f(P),1)])]))),128))])):F("",!0)]))])])]),_:1},512)),[[Dt,l.isVisible]])}},Vg=yt(Rg,[["__scopeId","data-v-07bc4810"]]),Qg={class:"min-h-screen bg-gray-50"},Gg={class:"sticky top-0 z-40 flex h-16 shrink-0 items-center gap-x-4 border-b border-gray-200 bg-white px-4 shadow-sm sm:gap-x-6 sm:px-6 lg:px-8"},Hg={class:"p-4 sm:p-6 lg:p-8"},Zg={key:0},Wg={class:"mb-6 border-b border-gray-200"},Jg={class:"hidden md:block"},Kg={class:"flex flex-wrap gap-x-4 gap-y-2 md:gap-x-8 mb-4","aria-label":"Tabs"},Yg=["onClick"],Xg={class:"flex gap-3"},e0=["disabled"],t0=e("span",null,"Firma Electrónica",-1),s0=e("span",null,"Membrete Global",-1),o0=e("span",null,"Nueva Minuta",-1),n0={class:"md:hidden space-y-3 relative"},r0=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1),l0=[r0],a0={key:0,class:"absolute z-20 mt-2 bg-white border border-gray-300 rounded-lg shadow-lg overflow-hidden w-full"},i0=["onClick"],d0={class:"grid grid-cols-3 gap-2"},c0=["disabled"],u0=e("span",{class:"font-medium text-xs leading-tight"},"Firma",-1),m0=e("span",{class:"font-medium text-xs leading-tight"},"Membrete",-1),g0=e("span",{class:"font-medium text-xs leading-tight"},"Nueva",-1),p0={key:0},h0={key:1},f0={key:2},v0={key:3},b0={key:4},y0={key:5,class:"mt-6 text-center text-gray-400 font-regular"},x0=e("p",null,"No hay documentos disponibles para mostrar.",-1),_0=[x0],w0={key:1},$0={class:"mb-6 border-b border-gray-200"},k0={class:"hidden md:flex items-center justify-between"},C0={class:"-mb-px flex flex-wrap gap-x-4 gap-y-2 md:gap-x-8","aria-label":"Tabs"},D0=["onClick"],S0={class:"flex items-center gap-2 mb-4"},F0={class:"relative group"},E0=["disabled"],A0={key:0,class:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50"},T0=e("div",{class:"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"},null,-1),M0={class:"relative group"},L0=["disabled"],P0={key:0,class:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50"},I0=e("div",{class:"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"},null,-1),B0={class:"md:hidden relative"},j0=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1),U0=[j0],z0={key:0,class:"absolute top-full left-0 right-0 z-50 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg overflow-hidden"},N0=["onClick"],O0={class:"md:hidden mt-4 mb-4 flex flex-col gap-2"},q0={class:"relative group"},R0=["disabled"],V0={key:0,class:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50"},Q0=e("div",{class:"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"},null,-1),G0={class:"relative group"},H0=["disabled"],Z0={key:0,class:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50"},W0=e("div",{class:"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"},null,-1),J0={key:0},K0={key:1},Y0={class:"p-4 sm:p-6"},X0={class:"bg-white rounded-xl shadow-xl max-w-3xl w-full mx-auto"},ep={class:"flex justify-between items-center p-4 border-b"},tp=e("h2",{class:"text-lg font-medium text-primary"},"Firma Electrónica",-1),sp={class:"p-4 sm:p-6"},op={class:"p-4 sm:p-6"},np={class:"bg-white rounded-xl shadow-xl max-w-3xl w-full mx-auto"},rp={class:"flex justify-between items-center p-4 border-b"},lp=e("h2",{class:"text-lg font-medium text-primary"},"Firma Electrónica",-1),ap={class:"p-4 sm:p-6"},Bp={__name:"Dashboard",setup(l){const v=Je(),i=qe(),p=It(),A=et(),$=as(),{isBasicUser:u,handleFeatureAccess:k}=Bt(),y=w(""),T=w("default"),te=w(!1),V=w("folders"),K=w("legal-documents"),N=w(!1),g=w(!1),M=w(!1),D=w(!1),G=w(!1),S=w(null),C=w([]),ie=w("recent");be(K,(W,re)=>{},{immediate:!0}),j(()=>[]),j(()=>ie.value==="recent"?"Más recientes":"Nombre (A-Z)");const z=j(()=>v.currentUser),h=j(()=>z.value?z.value.role:(A.push("/login"),null)),L=j(()=>{let W=[];h.value==="lawyer"?W=i.draftAndPublishedDocumentsUnassigned:(h.value==="client"||h.value==="basic"||h.value==="corporate_client")&&(W=i.progressAndCompletedDocumentsByClient(z.value.id));const re=C.value&&Array.isArray(C.value)?C.value.map(fe=>fe.id):[];return i.filteredDocumentsBySearchAndTags(y.value,v,re).filter(fe=>W.some(Pe=>Pe.id===fe.id))}),O=async W=>{T.value=W,i.selectedDocument=null;try{await i.init(!0)}catch(re){console.error("Error loading documents for useDocument section:",re)}},E=()=>{te.value=!1,T.value="default",i.selectedDocument=null},U=async()=>{await i.init(!0)},ne=()=>{if(!z.value){console.error("Cannot open signature modal: currentUser is not loaded");return}g.value=!0},I=()=>{if(!z.value){console.error("Cannot open signature modal: currentUser is not loaded");return}k("Firma Electrónica",()=>{N.value=!0})},m=async W=>{K.value="signed-documents"},P=async W=>{V.value="signed-documents"},R=()=>{if(!z.value){console.error("Cannot open letterhead modal: currentUser is not loaded");return}k("Membrete Global",()=>{M.value=!0})},se=W=>{$e("Membrete global subido correctamente","success")},X=()=>{$e("Membrete global eliminado correctamente","success")},ge=async()=>{if(T.value==="useDocument"){T.value="default",V.value="my-documents";return}V.value="folders";try{await new Promise(W=>setTimeout(W,100)),await p.fetchFolders(!0)}catch{}};be(()=>i.lastUpdatedDocumentId,(W,re)=>{if(W&&W!==re&&T.value==="default"){const fe=Date.now();(!be.lastExecutionTime||fe-be.lastExecutionTime>100)&&(be.lastExecutionTime=fe,T.value="default")}},{immediate:!1}),be(D,W=>{}),be(G,W=>{}),be(S,W=>{}),be(()=>$.path,(W,re)=>{W==="/dynamic_document_dashboard"&&re&&re.includes("/document/use/")&&i.init()}),be(()=>$.query,W=>{W.lawyerTab&&(K.value=W.lawyerTab),W.tab&&(V.value=W.tab)},{immediate:!0});const de=[{name:"folders",label:"Carpetas"},{name:"my-documents",label:"Mis Documentos"},{name:"pending-signatures",label:"Dcs. Por Firmar"},{name:"signed-documents",label:"Dcs. Firmados"}],pe=[{name:"legal-documents",label:"Minutas"},{name:"pending-signatures",label:"Dcs. Por Firmar"},{name:"signed-documents",label:"Dcs. Firmados"},{name:"finished-documents",label:"Dcs. Clientes"},{name:"in-progress-documents",label:"Dcs. Clientes en Progreso"}],Ce=w(!1),De=w(!1),Ve=()=>{Ce.value=!1,De.value=!1},Ie=W=>{K.value=W,Ce.value=!1,Ve()},Qe=W=>{V.value=W,De.value=!1,Ve()};Ne(async()=>{await v.init(),await i.init(),await p.init(),i.selectedDocument=null,T.value="default";const W=localStorage.getItem("lastUpdatedDocumentId");W&&i.documents.some(fe=>fe.id.toString()===W)&&(i.lastUpdatedDocumentId=parseInt(W))});const Ue=async W=>{v.currentUser&&(v.currentUser.has_signature=!0),$e("Firma electrónica guardada correctamente","success"),setTimeout(()=>{g.value=!1,N.value=!1},500)};return(W,re)=>{var fe,Pe;return n(),a(ae,null,[e("div",Qg,[e("div",Gg,[Vt(W.$slots,"default")]),e("div",Hg,[h.value==="lawyer"?(n(),a("div",Zg,[e("div",Wg,[e("div",Jg,[e("nav",Kg,[(n(),a(ae,null,ue(pe,d=>e("button",{key:d.name,onClick:he(r=>Ie(d.name),["stop"]),class:_([K.value===d.name?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm cursor-pointer"])},f(d.label),11,Yg)),64))]),e("div",Xg,[e("button",{onClick:he(ne,["stop"]),disabled:!z.value,class:_(["inline-flex items-center gap-2 px-4 py-2 rounded-lg border border-purple-200 text-sm font-medium transition-all duration-200",z.value?"bg-white text-gray-700 hover:bg-purple-50 hover:border-purple-300":"bg-gray-50 text-gray-400 cursor-not-allowed opacity-60"])},[o(t(wt),{class:"size-5 text-purple-500"}),t0],10,e0),e("button",{onClick:re[0]||(re[0]=he(d=>M.value=!0,["stop"])),class:"inline-flex items-center gap-2 px-4 py-2 rounded-lg border border-green-200 bg-white text-sm font-medium text-gray-700 hover:bg-green-50 hover:border-green-300 transition-all duration-200"},[o(t(Re),{class:"size-5 text-green-500"}),s0]),e("button",{onClick:re[1]||(re[1]=he(d=>te.value=!0,["stop"])),class:"inline-flex items-center gap-2 px-4 py-2 rounded-lg border border-secondary bg-secondary text-sm font-medium text-white hover:bg-blue-700 transition-all duration-200"},[o(t(Ye),{class:"size-5"}),o0])])]),e("div",n0,[e("button",{onClick:re[2]||(re[2]=he(d=>Ce.value=!Ce.value,["stop"])),class:"dropdown-button w-full flex items-center justify-between py-4 px-3 bg-white border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary"},[e("span",null,f(((fe=pe.find(d=>d.name===K.value))==null?void 0:fe.label)||"Seleccionar sección"),1),(n(),a("svg",{class:_(["ml-2 h-5 w-5 transition-transform duration-200",Ce.value?"transform rotate-180":""]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},l0,2))]),Ce.value?(n(),a("div",a0,[(n(),a(ae,null,ue(pe,d=>e("button",{key:d.name,onClick:he(r=>Ie(d.name),["stop"]),class:_(["w-full text-left px-4 py-3 text-sm transition-colors duration-150",K.value===d.name?"bg-primary text-white":"text-gray-700 hover:bg-gray-50"])},f(d.label),11,i0)),64))])):F("",!0),e("div",d0,[e("button",{onClick:he(ne,["stop"]),disabled:!z.value,class:_(["flex flex-col items-center justify-center py-3 px-2 rounded-lg border border-purple-200 text-center transition-all duration-200",z.value?"bg-white hover:bg-purple-50":"bg-gray-50 cursor-not-allowed opacity-60"])},[o(t(wt),{class:"size-6 text-purple-500 mb-1"}),u0],10,c0),e("button",{onClick:re[3]||(re[3]=he(d=>M.value=!0,["stop"])),class:"flex flex-col items-center justify-center py-3 px-2 rounded-lg border border-green-200 bg-white text-center transition-all duration-200 hover:bg-green-50"},[o(t(Re),{class:"size-6 text-green-500 mb-1"}),m0]),e("button",{onClick:re[4]||(re[4]=he(d=>te.value=!0,["stop"])),class:"flex flex-col items-center justify-center py-3 px-2 rounded-lg border border-secondary bg-secondary text-white text-center transition-all duration-200 hover:bg-blue-700"},[o(t(Ye),{class:"size-6 mb-1"}),g0])])])]),K.value==="legal-documents"?(n(),a("div",p0,[o(ad,{searchQuery:y.value,selectedTags:C.value},null,8,["searchQuery","selectedTags"])])):F("",!0),K.value==="pending-signatures"?(n(),a("div",h0,[o($t,{state:"PendingSignatures",searchQuery:y.value,selectedTags:C.value,onOpenElectronicSignature:ne,onDocumentFullySigned:m},null,8,["searchQuery","selectedTags"])])):F("",!0),K.value==="signed-documents"?(n(),a("div",f0,[o($t,{state:"FullySigned",searchQuery:y.value,selectedTags:C.value,onOpenElectronicSignature:ne},null,8,["searchQuery","selectedTags"])])):F("",!0),K.value==="finished-documents"?(n(),a("div",v0,[o(vc,{searchQuery:y.value,selectedTags:C.value},null,8,["searchQuery","selectedTags"])])):F("",!0),K.value==="in-progress-documents"?(n(),a("div",b0,[o(Su,{searchQuery:y.value,selectedTags:C.value},null,8,["searchQuery","selectedTags"])])):F("",!0),L.value.length===0?(n(),a("div",y0,_0)):F("",!0)])):F("",!0),h.value==="client"||h.value==="basic"||h.value==="corporate_client"?(n(),a("div",w0,[e("div",$0,[e("div",k0,[e("nav",C0,[(n(),a(ae,null,ue(de,d=>e("button",{key:d.name,onClick:he(r=>Qe(d.name),["stop"]),class:_([V.value===d.name?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])},f(d.label),11,D0)),64))]),e("div",S0,[e("div",F0,[e("button",{onClick:he(I,["stop"]),disabled:t(u),class:_(["inline-flex items-center gap-2 px-3 py-2 text-sm font-medium rounded-lg transition-colors border",t(u)?"text-purple-400 bg-gray-50 border-gray-200 cursor-not-allowed opacity-60":"text-purple-600 hover:bg-purple-50 border-purple-200"])},[o(t(wt),{class:"h-4 w-4"}),Y(" Firma Electrónica ")],10,E0),t(u)?(n(),a("div",A0,[Y(" Actualiza tu suscripción para usar esta funcionalidad "),T0])):F("",!0)]),e("div",M0,[e("button",{onClick:he(R,["stop"]),disabled:t(u),class:_(["inline-flex items-center gap-2 px-3 py-2 text-sm font-medium rounded-lg transition-colors border",t(u)?"text-green-400 bg-gray-50 border-gray-200 cursor-not-allowed opacity-60":"text-green-600 hover:bg-green-50 border-green-200"])},[o(t(Re),{class:"h-4 w-4"}),Y(" Membrete Global ")],10,L0),t(u)?(n(),a("div",P0,[Y(" Actualiza tu suscripción para usar esta funcionalidad "),I0])):F("",!0)]),e("button",{onClick:re[5]||(re[5]=he(d=>O("useDocument"),["stop"])),class:"inline-flex items-center gap-2 px-3 py-2 text-sm font-medium text-white bg-secondary hover:bg-blue-700 rounded-lg transition-colors",type:"button"},[o(t(Ye),{class:"h-4 w-4"}),Y(" Nuevo Documento ")])])]),e("div",B0,[e("button",{onClick:re[6]||(re[6]=he(d=>De.value=!De.value,["stop"])),class:"w-full flex items-center justify-between py-4 px-3 bg-white border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary"},[e("span",null,f(((Pe=de.find(d=>d.name===V.value))==null?void 0:Pe.label)||"Seleccionar sección"),1),(n(),a("svg",{class:_(["ml-2 h-5 w-5 transition-transform duration-200",De.value?"transform rotate-180":""]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},U0,2))]),De.value?(n(),a("div",z0,[(n(),a(ae,null,ue(de,d=>e("button",{key:d.name,onClick:he(r=>Qe(d.name),["stop"]),class:_(["w-full text-left px-4 py-3 text-sm transition-colors duration-150",V.value===d.name?"bg-primary text-white":"text-gray-700 hover:bg-gray-50"])},f(d.label),11,N0)),64))])):F("",!0)]),e("div",O0,[e("div",q0,[e("button",{onClick:he(I,["stop"]),disabled:t(u),class:_(["w-full flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium rounded-lg transition-colors",t(u)?"text-purple-400 bg-gray-50 cursor-not-allowed opacity-60":"text-purple-600 bg-purple-50 hover:bg-purple-100"])},[o(t(wt),{class:"h-5 w-5"}),Y(" Firma Electrónica ")],10,R0),t(u)?(n(),a("div",V0,[Y(" Actualiza tu suscripción para usar esta funcionalidad "),Q0])):F("",!0)]),e("div",G0,[e("button",{onClick:he(R,["stop"]),disabled:t(u),class:_(["w-full flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium rounded-lg transition-colors",t(u)?"text-green-400 bg-gray-50 cursor-not-allowed opacity-60":"text-green-600 bg-green-50 hover:bg-green-100"])},[o(t(Re),{class:"h-5 w-5"}),Y(" Membrete Global ")],10,H0),t(u)?(n(),a("div",Z0,[Y(" Actualiza tu suscripción para usar esta funcionalidad "),W0])):F("",!0)]),e("button",{onClick:re[7]||(re[7]=he(d=>O("useDocument"),["stop"])),class:"w-full flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium text-white bg-secondary hover:bg-blue-700 rounded-lg transition-colors",type:"button"},[o(t(Ye),{class:"h-5 w-5"}),Y(" Nuevo Documento ")])])]),T.value==="useDocument"?(n(),a("div",J0,[o(Qa,{searchQuery:y.value,selectedTags:C.value,onGoBack:ge},null,8,["searchQuery","selectedTags"])])):(n(),a("div",K0,[V.value==="folders"?(n(),oe(Hr,{key:0,searchQuery:y.value,selectedTags:C.value,onRefresh:U,onNavigateToMain:ge},null,8,["searchQuery","selectedTags"])):V.value==="my-documents"?(n(),oe(ia,{key:1,searchQuery:y.value,selectedTags:C.value,onRefresh:U},null,8,["searchQuery","selectedTags"])):V.value==="pending-signatures"?(n(),oe($t,{key:2,state:"PendingSignatures",searchQuery:y.value,selectedTags:C.value,onRefresh:U,onOpenElectronicSignature:I,onDocumentFullySigned:P},null,8,["searchQuery","selectedTags"])):V.value==="signed-documents"?(n(),oe($t,{key:3,state:"FullySigned",searchQuery:y.value,selectedTags:C.value,onRefresh:U,onOpenElectronicSignature:I},null,8,["searchQuery","selectedTags"])):F("",!0)]))])):F("",!0)])]),te.value?(n(),oe(Xe,{key:0},{default:x(()=>[o(Km,{onClose:E})]),_:1})):F("",!0),g.value&&z.value?(n(),oe(Xe,{key:1},{default:x(()=>[e("div",Y0,[e("div",X0,[e("div",ep,[tp,e("button",{onClick:re[8]||(re[8]=d=>g.value=!1),class:"text-gray-400 hover:text-gray-500 p-1 rounded-full hover:bg-gray-100"},[o(t(Le),{class:"h-6 w-6"})])]),e("div",sp,[o(jt,{"user-id":z.value.id,"initial-show-options":!z.value.has_signature,onSignatureSaved:Ue,onCancel:re[9]||(re[9]=d=>g.value=!1)},null,8,["user-id","initial-show-options"])])])])]),_:1})):F("",!0),N.value&&z.value?(n(),oe(Xe,{key:2},{default:x(()=>[e("div",op,[e("div",np,[e("div",rp,[lp,e("button",{onClick:re[10]||(re[10]=d=>N.value=!1),class:"text-gray-400 hover:text-gray-500 p-1 rounded-full hover:bg-gray-100"},[o(t(Le),{class:"h-6 w-6"})])]),e("div",ap,[o(jt,{"user-id":z.value.id,"initial-show-options":!z.value.has_signature,onSignatureSaved:Ue,onCancel:re[11]||(re[11]=d=>N.value=!1)},null,8,["user-id","initial-show-options"])])])])]),_:1})):F("",!0),o(Pt,{isVisible:t(ot),documentData:t(Lt),onClose:re[12]||(re[12]=d=>ot.value=!1)},null,8,["isVisible","documentData"]),o(Vg,{isVisible:M.value,onClose:re[13]||(re[13]=d=>M.value=!1),onUploaded:se,onDeleted:X},null,8,["isVisible"])],64)}}};export{Bp as default};
