import{e as o,f as l,g as e,u as Xe,r as L,aI as Rt,o as qe,aq as ut,c as j,h as s,j as t,G as Le,w as Me,v as ze,n as b,l as D,t as h,m as ve,p as te,s as we,b3 as Yt,i as m,ac as Je,a9 as Vt,b4 as Xt,Q as kt,k as ee,a2 as Ye,F as le,D as $t,E as es,b5 as ts,a0 as ss,C as os,T as ke,N as me,I as We,a1 as Re,ag as Fe,ad as Ae,ae as Te,af as re,b6 as rs,O as mt,P as gt,ah as pt,b7 as ht,a5 as ns,aW as ls,b8 as _t,b9 as It}from"./index.js";import{u as Oe,o as as,s as st,p as Tt}from"./index2.js";import{g as it,a as dt}from"./DocumentPermissionsManager.js";import{B as is,a as ft,b as vt,c as Ct,d as Dt,L as bt,e as St,r as ds,f as cs,_ as Mt,D as Qt,g as us}from"./index3.js";import{_ as yt}from"./_plugin-vue_export-helper.js";import{r as wt,_ as ms}from"./DocumentCard.js";import{r as Ke}from"./PlusIcon.js";import{r as ot,a as et}from"./EllipsisVerticalIcon.js";import{r as ct}from"./DocumentIcon.js";import{r as Gt}from"./EyeIcon.js";import{_ as jt}from"./SignatureDocumentCard.js";import{r as Bt,a as gs,b as ps}from"./TagIcon.js";import{r as Ne,a as tt,b as rt}from"./FunnelIcon.js";import{r as Qe}from"./MagnifyingGlassIcon.js";import{r as hs}from"./ArrowLeftIcon.js";import{r as Ut}from"./PencilIcon.js";import{r as Zt}from"./TrashIcon.js";import{r as nt}from"./ArrowDownTrayIcon.js";import{a as fs,r as Wt}from"./LinkIcon.js";import{r as Ht}from"./PhotoIcon.js";import{r as Nt}from"./InformationCircleIcon.js";import{r as vs}from"./CloudArrowUpIcon.js";import{r as bs}from"./ExclamationTriangleIcon.js";import"./useRecentViews.js";import"./loading_message.js";function qt(r,f){return o(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"})])}function ys(r,f){return o(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z"})])}function xs(r,f){return o(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7.217 10.907a2.25 2.25 0 1 0 0 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186 9.566-5.314m-9.566 7.5 9.566 5.314m0 0a2.25 2.25 0 1 0 3.935 2.186 2.25 2.25 0 0 0-3.935-2.186Zm0-12.814a2.25 2.25 0 1 0 3.933-2.185 2.25 2.25 0 0 0-3.933 2.185Z"})])}const _s={class:"bg-white rounded-lg p-6 shadow-xl max-w-lg w-full"},ws={class:"flex justify-end"},$s=e("label",{for:"document-name",class:"block text-base font-medium leading-6 text-primary"},[te(" Nombre "),e("span",{class:"text-red-500"},"*")],-1),ks={class:"mt-2"},Cs={class:"flex gap-2 mt-2.5"},Ds=["disabled"],Ss=e("span",null,"Actualizar nombre",-1),Es=[Ss],Fs=["disabled"],As={__name:"UseDocumentByClient",props:{documentId:{type:[Number,null],required:!1,default:null}},emits:["close"],setup(r,{emit:f}){const i=r,c=Xe(),S=Oe(),x=f,u=L(""),$=L(""),F=()=>{x("close")};Rt(()=>{var y,g;S.selectedDocument?(u.value=((y=S.selectedDocument)==null?void 0:y.title)||"",$.value=((g=S.selectedDocument)==null?void 0:g.title)||""):(u.value="",$.value="")});const U=y=>{y.key==="Escape"&&F()};qe(()=>{document.addEventListener("keydown",U)}),ut(()=>{document.removeEventListener("keydown",U)});const K=j(()=>u.value.trim().length>0),O=j(()=>{var y;return!!((y=S.selectedDocument)!=null&&y.id)}),J=j(()=>O.value&&u.value.trim()!==$.value.trim()&&u.value.trim().length>0);async function E(){if(O.value&&J.value)try{const y={title:u.value.trim()};await S.updateDocument(S.selectedDocument.id,y),$.value=u.value.trim(),S.selectedDocument.title=u.value.trim();const g=S.selectedDocument.id;we("Document name successfully updated.","success"),x("close",{updatedDocId:g});const w=window.location.pathname;w==="/dynamic_document_dashboard"||w==="/dynamic_document_dashboard/"||setTimeout(()=>{window.location.href="/dynamic_document_dashboard"},1e3)}catch(y){console.error("Error updating document name:",y),we("Error updating document name.","error")}}function n(){const y=encodeURIComponent(u.value.trim());i.documentId&&!S.selectedDocument?c.push(`/dynamic_document_dashboard/document/use/creator/${i.documentId}/${y}`):S.selectedDocument?(S.selectedDocument.title=u.value.trim(),c.push(`/dynamic_document_dashboard/document/use/editor/${S.selectedDocument.id}/${y}`)):we("Error: No se pudo continuar. Documento no seleccionado.","error")}return(y,g)=>(o(),l("div",_s,[e("div",ws,[e("button",{onClick:F},[s(t(Le),{class:"size-6"})])]),e("form",{onSubmit:ve(n,["prevent"])},[e("div",null,[$s,e("div",ks,[Me(e("input",{"onUpdate:modelValue":g[0]||(g[0]=T=>u.value=T),type:"text",id:"document-name",class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm ring-1 ring-inset ring-gray-300",required:""},null,512),[[ze,u.value]])])]),e("div",Cs,[O.value?(o(),l("button",{key:0,type:"button",onClick:E,disabled:!J.value,class:b(["p-2.5 text-sm font-medium rounded-md flex gap-2",J.value?"bg-primary text-white cursor-pointer":"bg-gray-200 text-gray-400 cursor-not-allowed opacity-70"])},Es,10,Ds)):D("",!0),e("button",{type:"submit",class:b(["p-2.5 text-sm font-medium rounded-md flex gap-2",K.value?"bg-secondary text-white":"bg-gray-200 text-secondary border-2 border-dashed border-secondary cursor-not-allowed bg-opacity-50"]),disabled:!K.value},[e("span",null,h(O.value?"Editar Documento":"Continuar"),1)],10,Fs)])],32)]))}},Ts={class:"mt-3 pt-2 border-t border-gray-100"},Ms={class:"flex items-center gap-2 text-xs text-gray-500"},Ls=e("span",null,"Hacer clic para usar este documento",-1),Ps={__name:"UseDocumentCard",props:{document:{type:Object,required:!0},showTags:{type:Boolean,default:!0},cardType:{type:String,default:"default"},cardContext:{type:String,default:"list"},documentStore:{type:Object,default:null},userStore:{type:Object,default:null},menuOptions:{type:Array,default:null},disableInternalActions:{type:Boolean,default:!1},showMenuOptions:{type:Boolean,default:null}},emits:["click","remove-from-folder","document-created"],setup(r,{emit:f}){const i=r,c=f,S=L(!1),x=L(null),u=it(9),$=j(()=>"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium !bg-purple-100 !text-purple-700 !border !border-purple-200"),F=j(()=>u.dark),U=j(()=>"group !border-purple-400 !bg-purple-50/50 !shadow-purple-100"),K=j(()=>i.menuOptions!==null?i.menuOptions:[{label:"Usar",action:"use",icon:ys,iconClasses:"w-4 h-4 text-purple-600"},{label:"Previsualizaci√≥n",action:"preview",icon:Gt,iconClasses:"w-4 h-4 text-gray-600"}]),O=j(()=>!1),J=(g,T)=>{i.disableInternalActions?c("click",g,T):n(g.id)},E=(g,T)=>{switch(g){case"use":n(T.id);break;case"preview":as(T);break;default:console.warn("Unknown menu action:",g)}};function n(g){g?(x.value=g,S.value=!0):console.error("Document ID is required:",g)}function y(g){if(S.value=!1,x.value=null,g&&g.updatedDocId){c("document-created",g);const T=window.location.pathname;T==="/dynamic_document_dashboard"||T==="/dynamic_document_dashboard/"?setTimeout(()=>{window.forceDocumentHighlight&&window.forceDocumentHighlight(g.updatedDocId)},100):setTimeout(()=>{window.location.href="/dynamic_document_dashboard"},500)}}return(g,T)=>(o(),l(le,null,[s(is,{document:r.document,"card-type":r.cardType,"card-context":r.cardContext,"status-icon":t(Xt),"status-text":"Disponible","status-badge-classes":$.value,"menu-options":K.value,"highlighted-doc-id":null,"show-tags":r.showTags,"document-store":r.documentStore,"user-store":r.userStore,"additional-classes":U.value,"disable-internal-actions":r.disableInternalActions,"show-menu-options":r.showMenuOptions,onClick:J,onMenuAction:E,onRemoveFromFolder:T[0]||(T[0]=w=>g.$emit("remove-from-folder",w))},Yt({"additional-actions":m(()=>[Vt(g.$slots,"additional-actions")]),_:2},[O.value?{name:"right-action",fn:m(()=>[s(t(ot),{class:"w-5 h-5 text-gray-400 group-hover:text-gray-600 transition-colors"})]),key:"0"}:void 0,r.disableInternalActions?void 0:{name:"footer",fn:m(()=>[e("div",Ts,[e("div",Ms,[e("div",{class:"w-2 h-2 rounded-full",style:Je({backgroundColor:F.value})},null,4),Ls])])]),key:"1"}]),1032,["document","card-type","card-context","status-icon","status-badge-classes","menu-options","show-tags","document-store","user-store","additional-classes","disable-internal-actions","show-menu-options"]),Me(s(Ye,null,{default:m(()=>[x.value!==null?(o(),ee(As,{key:0,"document-id":x.value,onClose:y},null,8,["document-id"])):D("",!0)]),_:1},512),[[kt,S.value]])],64))}},Is=()=>({folders:[],currentFolder:null,isLoading:!1,error:null,lastUpdatedFolderId:null}),js={sortedFolders:r=>[...r.folders].sort((f,i)=>new Date(i.created_at)-new Date(f.created_at)),getFolderById:r=>f=>r.folders.find(i=>i.id===f),getFoldersByColor:r=>f=>r.folders.filter(i=>i.color_id===f),getFolderWithColor:r=>f=>{const i=r.folders.find(c=>c.id===f);return i?{...i,color:it(i.color_id)}:null},getFoldersContainingDocument:r=>f=>r.folders.filter(i=>i.document_ids&&i.document_ids.includes(f)),totalDocumentsInFolders:r=>r.folders.reduce((f,i)=>f+(i.document_ids?i.document_ids.length:0),0),hasFolders:r=>r.folders.length>0,availableColors:()=>dt()},Bs={async init(r=!1){if(!(this.folders.length>0&&!r)){this.isLoading=!0,this.error=null;try{await this.fetchFolders()}catch(f){console.error("Error initializing document folder store:",f),this.error="Error al inicializar las carpetas"}finally{this.isLoading=!1}}},async fetchFolders(){try{const r=await $t("dynamic-documents/folders/");if(r.status===200)return this.folders=r.data,r.data;throw new Error(`Error fetching folders: ${r.status}`)}catch(r){throw console.error("Error fetching folders:",r),this.error="Error al obtener las carpetas",r}},async fetchFolder(r){this.isLoading=!0,this.error=null;try{const f=await $t(`dynamic-documents/folders/${r}/`);if(f.status===200){const i=f.data,c=this.folders.findIndex(S=>S.id===i.id);return c!==-1?this.folders[c]=i:this.folders.push(i),this.currentFolder=i,i}else throw new Error(`Error fetching folder: ${f.status}`)}catch(f){throw console.error("Error fetching folder:",f),this.error="Error al obtener la carpeta",f}finally{this.isLoading=!1}},async createFolder(r){this.isLoading=!0,this.error=null;try{if(!r.name||r.name.trim()==="")throw new Error("El nombre de la carpeta es requerido");const f=r.color_id??0;if(f<0||f>=dt().length)throw new Error("Color de carpeta no v√°lido");const i={name:r.name.trim(),color_id:f,...r.document_ids&&{document_ids:r.document_ids}},c=await es("dynamic-documents/folders/create/",i);if(c.status===200||c.status===201){const S=c.data;return this.folders.push(S),this.lastUpdatedFolderId=S.id,await we("Carpeta creada exitosamente","success"),S}else throw new Error(`Error creating folder: ${c.status}`)}catch(f){throw console.error("Error creating folder:",f),this.error=f.message||"Error al crear la carpeta",await we(this.error,"error"),f}finally{this.isLoading=!1}},async updateFolder(r,f){this.isLoading=!0,this.error=null;try{if(f.name&&f.name.trim()==="")throw new Error("El nombre de la carpeta no puede estar vac√≠o");if(f.color_id!==void 0){const S=f.color_id;if(S<0||S>=dt().length)throw new Error("Color de carpeta no v√°lido")}const i={};f.name&&(i.name=f.name.trim()),f.color_id!==void 0&&(i.color_id=f.color_id),f.document_ids!==void 0&&(i.document_ids=f.document_ids);const c=await ts(`dynamic-documents/folders/${r}/update/`,i);if(c.status===200){const S=c.data,x=this.folders.findIndex(u=>u.id===r);return x!==-1&&(this.folders[x]=S),this.currentFolder&&this.currentFolder.id===r&&(this.currentFolder=S),this.lastUpdatedFolderId=r,await we("Carpeta actualizada exitosamente","success"),S}else throw new Error(`Error updating folder: ${c.status}`)}catch(i){throw console.error("Error updating folder:",i),this.error=i.message||"Error al actualizar la carpeta",await we(this.error,"error"),i}finally{this.isLoading=!1}},async deleteFolder(r){this.isLoading=!0,this.error=null;try{const f=await ss(`dynamic-documents/folders/${r}/delete/`);if(f.status===204||f.status===200)return this.folders=this.folders.filter(i=>i.id!==r),this.currentFolder&&this.currentFolder.id===r&&(this.currentFolder=null),await we("Carpeta eliminada exitosamente","success"),!0;throw new Error(`Error deleting folder: ${f.status}`)}catch(f){throw console.error("Error deleting folder:",f),this.error=f.message||"Error al eliminar la carpeta",await we(this.error,"error"),f}finally{this.isLoading=!1}},setCurrentFolder(r){this.currentFolder=r},clearCurrentFolder(){this.currentFolder=null},reset(){this.folders=[],this.currentFolder=null,this.isLoading=!1,this.error=null,this.lastUpdatedFolderId=null}},Us={async addDocumentsToFolder(r,f){const i=this.getFolderById(r);if(!i)throw new Error("Carpeta no encontrada");const c=i.document_ids||[],S=[...new Set([...c,...f])];return await this.updateFolder(r,{document_ids:S})},async removeDocumentsFromFolder(r,f){const i=this.getFolderById(r);if(!i)throw new Error("Carpeta no encontrada");const S=(i.document_ids||[]).filter(x=>!f.includes(x));return await this.updateFolder(r,{document_ids:S})},async moveDocumentsBetweenFolders(r,f,i){try{f&&await this.removeDocumentsFromFolder(f,r),i&&await this.addDocumentsToFolder(i,r),await we("Documentos movidos exitosamente","success")}catch(c){throw console.error("Error moving documents between folders:",c),await we("Error al mover documentos","error"),c}},getFolderColor(r){const f=this.getFolderById(r);return f?it(f.color_id):it(0)},validateFolderData(r){const f=[];if((!r.name||r.name.trim()==="")&&f.push("El nombre de la carpeta es requerido"),r.name&&r.name.length>100&&f.push("El nombre de la carpeta no puede exceder 100 caracteres"),r.color_id!==void 0){const i=r.color_id;(i<0||i>=dt().length)&&f.push("Color de carpeta no v√°lido")}return r.document_ids&&!Array.isArray(r.document_ids)&&f.push("Los IDs de documentos deben ser un array"),{isValid:f.length===0,errors:f}}},Lt=os("documentFolder",{state:Is,getters:js,actions:{...Bs,...Us}}),Ns={class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},qs={class:"bg-white rounded-xl shadow-xl max-w-md w-full"},zs={class:"flex justify-between items-center p-6 border-b"},Os={class:"text-lg font-semibold text-gray-900"},Rs={class:"mb-4"},Vs=e("label",{for:"folderName",class:"block text-sm font-medium text-gray-700 mb-2"}," Nombre de la carpeta ",-1),Qs={class:"mb-6"},Gs=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"}," Color de la carpeta ",-1),Zs={class:"grid grid-cols-8 gap-2"},Ws=["onClick","title"],Hs={class:"flex gap-3"},Ks=["disabled"],Js={__name:"CreateEditFolderModal",props:{isVisible:{type:Boolean,required:!0},editingFolder:{type:Object,default:null}},emits:["close","success"],setup(r,{emit:f}){const i=r,c=f,S=Lt(),x=L(!1),u=L({name:"",color_id:0}),$=j(()=>dt()),F=()=>{u.value={name:"",color_id:0}};ke(()=>i.editingFolder,O=>{O?u.value={name:O.name,color_id:O.color_id}:F()},{immediate:!0}),ke(()=>i.isVisible,O=>{O||F()});const U=()=>{c("close")},K=async()=>{if(u.value.name.trim()){x.value=!0;try{i.editingFolder?(await S.updateFolder(i.editingFolder.id,u.value),we("Carpeta actualizada correctamente","success")):(await S.createFolder(u.value),we("Carpeta creada correctamente","success")),c("success")}catch(O){const J=i.editingFolder?"actualizar":"crear";we(`Error al ${J} la carpeta`,"error"),console.error(`Error ${J} folder:`,O)}finally{x.value=!1}}};return(O,J)=>r.isVisible?(o(),ee(Ye,{key:0},{default:m(()=>[e("div",Ns,[e("div",qs,[e("div",zs,[e("h3",Os,h(r.editingFolder?"Editar Carpeta":"Nueva Carpeta"),1),e("button",{onClick:U,class:"text-gray-400 hover:text-gray-500"},[s(t(Le),{class:"w-6 h-6"})])]),e("form",{onSubmit:ve(K,["prevent"]),class:"p-6"},[e("div",Rs,[Vs,Me(e("input",{id:"folderName","onUpdate:modelValue":J[0]||(J[0]=E=>u.value.name=E),type:"text",required:"",maxlength:"100",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Ej: Contratos Laborales"},null,512),[[ze,u.value.name]])]),e("div",Qs,[Gs,e("div",Zs,[(o(!0),l(le,null,me($.value,E=>(o(),l("button",{key:E.id,type:"button",onClick:n=>u.value.color_id=E.id,class:b(["w-8 h-8 rounded-full border-2 transition-all",u.value.color_id===E.id?"border-gray-800 scale-110":"border-gray-300 hover:border-gray-400"]),style:Je({backgroundColor:E.hex}),title:E.name},null,14,Ws))),128))])]),e("div",Hs,[e("button",{type:"button",onClick:U,class:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"}," Cancelar "),e("button",{type:"submit",disabled:!u.value.name.trim()||x.value,class:"flex-1 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},h(x.value?"Guardando...":r.editingFolder?"Actualizar":"Crear"),9,Ks)])],32)])])]),_:1})):D("",!0)}},Ys={class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},Xs={class:"bg-white rounded-xl shadow-xl max-w-6xl w-full max-h-[90vh] overflow-hidden flex flex-col"},eo={class:"border-b px-6 py-4 flex-shrink-0"},to={class:"flex justify-between items-center"},so={class:"flex items-center gap-3"},oo={class:"text-xl font-semibold text-gray-900"},ro={class:"text-sm text-gray-600"},no={class:"flex items-center gap-2"},lo={class:"flex-1 overflow-y-auto p-6"},ao={key:0,class:"bg-white rounded-lg shadow-sm border border-gray-200"},io={class:"overflow-x-auto"},co={class:"min-w-full divide-y divide-gray-200"},uo=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Documento "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Tipo "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etiquetas "),e("th",{scope:"col",class:"w-16 px-6 py-3"})])],-1),mo={class:"bg-white divide-y divide-gray-200"},go=["onClick"],po={class:"px-6 py-4 whitespace-nowrap"},ho={class:"flex items-center"},fo={class:"flex-shrink-0 h-10 w-10"},vo={class:"h-10 w-10 rounded-lg bg-blue-100 flex items-center justify-center"},bo={class:"ml-4"},yo={class:"text-sm font-medium text-gray-900"},xo={class:"px-6 py-4 whitespace-nowrap"},_o={class:"text-sm text-gray-600"},wo={class:"px-6 py-4 whitespace-nowrap"},$o={class:"px-6 py-4 whitespace-nowrap"},ko={class:"flex flex-wrap gap-1"},Co={key:0,class:"text-sm text-gray-400"},Do={class:"py-1"},So=["onClick"],Eo=["onClick"],Fo={key:1,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center"},Ao=e("h4",{class:"text-lg font-medium text-gray-900 mb-2"},"Esta carpeta est√° vac√≠a",-1),To=e("p",{class:"text-gray-600 mb-4"},"Agrega documentos para organizar tu trabajo",-1),Mo={__name:"FolderDetailsModalTable",props:{folder:{type:Object,default:null}},emits:["close","add-documents","remove-document","view-document","use-document","document-action"],setup(r,{emit:f}){const i=r,c=f;We(),Oe();const S=[{name:"blue",hex:"#3B82F6"},{name:"purple",hex:"#8B5CF6"},{name:"pink",hex:"#EC4899"},{name:"green",hex:"#10B981"},{name:"yellow",hex:"#F59E0B"},{name:"red",hex:"#EF4444"},{name:"indigo",hex:"#6366F1"},{name:"teal",hex:"#14B8A6"}],x=j(()=>{if(!i.folder)return S[0];if(i.folder.color)return S.find(y=>y.name===i.folder.color)||S[0];const n=i.folder.id%S.length;return S[n]}),u=n=>n.state==="Published"||n.state==="Draft"?"Formato":n.state==="PendingSignatures"||n.state==="FullySigned"?"Para Firmar":n.state==="Progress"||n.state==="Completed"?"Mis Documentos":"Documento",$=n=>({Published:"Publicado",Draft:"Borrador",Progress:"En Progreso",Completed:"Completado",PendingSignatures:"Pendiente Firma",FullySigned:"Firmado"})[n.state]||n.state,F=n=>({Published:"bg-green-100 text-green-700 border border-green-200",Draft:"bg-gray-100 text-gray-700 border border-gray-200",Progress:"bg-blue-100 text-blue-700 border border-blue-200",Completed:"bg-green-100 text-green-700 border border-green-200",PendingSignatures:"bg-yellow-100 text-yellow-700 border border-yellow-200",FullySigned:"bg-green-100 text-green-700 border border-green-200"})[n.state]||"bg-gray-100 text-gray-700 border border-gray-200",U=n=>{const y=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],g=n.id%y.length;return y[g]},K=()=>{c("close")},O=()=>{c("add-documents",i.folder)},J=n=>{c("remove-document",{folderId:i.folder.id,documentId:n.id})},E=n=>{const y=u(n);c(y==="Formato"?"use-document":"view-document",n)};return(n,y)=>r.folder?(o(),ee(Ye,{key:0},{default:m(()=>[e("div",Ys,[e("div",Xs,[e("div",eo,[e("div",to,[e("div",so,[e("div",{class:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",style:Je({backgroundColor:x.value.hex+"20"})},[s(t(wt),{class:"h-6 w-6",style:Je({color:x.value.hex})},null,8,["style"])],4),e("div",null,[e("h3",oo,h(r.folder.name),1),e("p",ro,h(r.folder.documents.length)+" documento"+h(r.folder.documents.length!==1?"s":""),1)])]),e("div",no,[e("button",{onClick:O,class:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-blue-600 hover:bg-blue-50 rounded-lg transition-colors"},[s(t(Ke),{class:"w-5 h-5"}),te(" Agregar documentos ")]),e("button",{onClick:K,class:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors"},[s(t(Le),{class:"w-6 h-6"})])])])]),e("div",lo,[r.folder.documents.length>0?(o(),l("div",ao,[e("div",io,[e("table",co,[uo,e("tbody",mo,[(o(!0),l(le,null,me(r.folder.documents,g=>(o(),l("tr",{key:g.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:T=>E(g)},[e("td",po,[e("div",ho,[e("div",fo,[e("div",vo,[s(t(Re),{class:"h-5 w-5 text-blue-600"})])]),e("div",bo,[e("div",yo,h(g.title),1)])])]),e("td",xo,[e("span",_o,h(u(g)),1)]),e("td",wo,[e("span",{class:b(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",F(g)])},h($(g)),3)]),e("td",$o,[e("div",ko,[(o(!0),l(le,null,me(g.tags,T=>(o(),l("span",{key:T.id,class:b(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",U(T)])},h(T.name),3))),128)),!g.tags||g.tags.length===0?(o(),l("span",Co,"-")):D("",!0)])]),e("td",{class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",onClick:y[0]||(y[0]=ve(()=>{},["stop"]))},[s(t(Fe),{as:"div",class:"relative inline-block text-left"},{default:m(()=>[s(t(Ae),{class:"inline-flex items-center justify-center w-8 h-8 rounded-md hover:bg-gray-100"},{default:m(()=>[s(t(et),{class:"h-5 w-5 text-gray-500"})]),_:1}),s(t(Te),{class:"absolute right-0 z-[9999] mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",Do,[s(t(re),null,{default:m(({active:T})=>[e("a",{onClick:w=>E(g),class:b([T?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Ver documento ",10,So)]),_:2},1024),s(t(re),null,{default:m(({active:T})=>[e("a",{onClick:w=>J(g),class:b([T?"bg-gray-100":"","block px-4 py-2 text-sm text-red-600 cursor-pointer"])}," Quitar de carpeta ",10,Eo)]),_:2},1024)])]),_:2},1024)]),_:2},1024)])],8,go))),128))])])])])):(o(),l("div",Fo,[s(t(ct),{class:"w-12 h-12 text-gray-300 mx-auto mb-4"}),Ao,To,e("button",{onClick:O,class:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"},[s(t(Ke),{class:"w-5 h-5"}),te(" Agregar documentos ")])]))])])])]),_:1})):D("",!0)}},xt=r=>(mt("data-v-d403a707"),r=r(),gt(),r),Lo={class:"tag-filter-container"},Po={class:"relative"},Io={class:"flex items-center"},jo={key:0,class:"ml-2 inline-flex items-center justify-center h-5 w-5 bg-primary text-white text-xs rounded-full font-medium"},Bo={key:0,class:"absolute left-0 mt-2 w-full sm:w-80 bg-white rounded-xl shadow-xl ring-1 ring-black ring-opacity-5 border border-gray-100 z-50 overflow-hidden"},Uo={class:"bg-gray-50 p-4 border-b border-gray-200"},No={class:"flex items-center justify-between mb-3"},qo=xt(()=>e("h3",{class:"text-sm font-semibold text-gray-900"},"Filtrar por etiquetas",-1)),zo={key:0,class:"text-xs text-gray-500"},Oo={class:"relative"},Ro={key:0,class:"px-4 py-2 bg-blue-50 border-b border-blue-100"},Vo={class:"flex items-center justify-between"},Qo={class:"text-xs font-medium text-blue-700"},Go={class:"max-h-52 overflow-y-auto"},Zo={key:0,class:"px-4 py-8 text-center"},Wo=xt(()=>e("p",{class:"text-gray-500 text-sm"},"No hay etiquetas disponibles",-1)),Ho={key:1,class:"px-4 py-8 text-center"},Ko={class:"text-gray-500 text-sm"},Jo={key:2,class:"px-4 py-8 text-center"},Yo=xt(()=>e("div",{class:"flex items-center justify-center"},[e("div",{class:"animate-spin rounded-full h-5 w-5 border-2 border-primary border-t-transparent"}),e("span",{class:"ml-3 text-sm text-gray-600"},"Cargando etiquetas...")],-1)),Xo=[Yo],er={key:3,class:"py-2"},tr=["onClick"],sr={class:"flex items-center h-5"},or={class:"relative"},rr=["id","checked","onChange"],nr={key:0,class:"w-2.5 h-2.5 text-white",fill:"currentColor",viewBox:"0 0 20 20"},lr=xt(()=>e("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"},null,-1)),ar=[lr],ir={class:"ml-3 flex items-center flex-1 min-w-0"},dr={class:"text-sm font-medium text-gray-900 truncate"},cr={key:0,class:"mt-4"},ur={class:"flex items-start gap-2"},mr=xt(()=>e("span",{class:"text-xs font-medium text-gray-500 mt-1.5 flex-shrink-0"},"Activos:",-1)),gr={class:"flex flex-wrap gap-2"},pr=["onClick"],hr={class:"mr-1"},fr={class:"ml-1 p-0.5 rounded-full hover:bg-white/50 transition-colors duration-150"},vr={__name:"TagFilter",props:{modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue"],setup(r,{emit:f}){const i=r,c=f,S=Oe(),x=L(!1),u=L([]),$=L(!1),F=L(""),U=j(()=>S.sortedTags),K=j(()=>{if(!F.value.trim())return U.value;const T=F.value.toLowerCase().trim();return U.value.filter(w=>w.name.toLowerCase().includes(T))}),O=T=>{const w=it(T.color_id);return{hex:w&&w.hex?w.hex:"#9CA3AF",dark:w&&w.dark?w.dark:"#374151"}},J=()=>{x.value=!x.value,x.value&&(F.value="")},E=T=>u.value.some(w=>w.id===T.id),n=T=>{const w=u.value.findIndex(B=>B.id===T.id);w>=0?u.value.splice(w,1):u.value.push(T),c("update:modelValue",u.value)},y=()=>{u.value=[],c("update:modelValue",[])},g=T=>{T.target.closest(".tag-filter-container")||(x.value=!1,F.value="")};return qe(async()=>{try{$.value=!0,await S.initTags()}catch(T){console.error("Error loading tags:",T)}finally{$.value=!1}document.addEventListener("click",g)}),ke(()=>i.modelValue,T=>{u.value=T||[]},{immediate:!0}),ut(()=>{document.removeEventListener("click",g)}),(T,w)=>(o(),l("div",Lo,[e("div",Po,[e("button",{onClick:J,class:b(["group inline-flex items-center justify-between w-full sm:w-auto sm:min-w-[200px] px-4 py-3 border border-gray-200 rounded-xl shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 hover:border-gray-300 focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-primary transition-all duration-200",{"ring-2 ring-primary border-primary bg-blue-50":x.value,"border-primary bg-primary/5":u.value.length>0&&!x.value}])},[e("div",Io,[s(t(Bt),{class:b(["h-5 w-5 mr-2.5 text-gray-500 group-hover:text-gray-600",{"text-primary":u.value.length>0||x.value}])},null,8,["class"]),e("span",{class:b(["text-gray-700",{"text-primary font-semibold":u.value.length>0||x.value}])}," Filtrar por etiquetas ",2),u.value.length>0?(o(),l("span",jo,h(u.value.length),1)):D("",!0)]),s(t(Ne),{class:b(["ml-3 h-4 w-4 text-gray-400 transition-all duration-200 group-hover:text-gray-600",{"rotate-180 text-primary":x.value,"text-primary":u.value.length>0&&!x.value}])},null,8,["class"])],2),s(rs,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:m(()=>[x.value?(o(),l("div",Bo,[e("div",Uo,[e("div",No,[qo,U.value.length>0?(o(),l("span",zo,h(U.value.length)+" disponibles ",1)):D("",!0)]),e("div",Oo,[s(t(Qe),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),Me(e("input",{"onUpdate:modelValue":w[0]||(w[0]=B=>F.value=B),type:"text",placeholder:"Buscar etiquetas...",class:"w-full pl-9 pr-4 py-2.5 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-200"},null,512),[[ze,F.value]])])]),u.value.length>0?(o(),l("div",Ro,[e("div",Vo,[e("span",Qo,h(u.value.length)+" etiqueta"+h(u.value.length!==1?"s":"")+" seleccionada"+h(u.value.length!==1?"s":""),1),e("button",{onClick:y,class:"text-xs text-red-600 hover:text-red-700 font-medium px-2 py-1 rounded-md hover:bg-red-50 transition-all duration-200"}," Limpiar todo ")])])):D("",!0),e("div",Go,[!$.value&&K.value.length===0&&F.value.trim()===""?(o(),l("div",Zo,[s(t(Bt),{class:"h-8 w-8 text-gray-300 mx-auto mb-2"}),Wo])):D("",!0),!$.value&&K.value.length===0&&F.value.trim()!==""?(o(),l("div",Ho,[s(t(Qe),{class:"h-8 w-8 text-gray-300 mx-auto mb-2"}),e("p",Ko,'Sin resultados para "'+h(F.value)+'"',1),e("button",{onClick:w[1]||(w[1]=B=>F.value=""),class:"text-xs text-primary hover:text-primary-dark mt-2 font-medium"}," Ver todas las etiquetas ")])):D("",!0),$.value?(o(),l("div",Jo,Xo)):D("",!0),!$.value&&K.value.length>0?(o(),l("div",er,[(o(!0),l(le,null,me(K.value,B=>(o(),l("div",{key:B.id,class:"group flex items-center px-4 py-2.5 hover:bg-gray-50 cursor-pointer transition-colors duration-150",onClick:Y=>n(B)},[e("div",sr,[e("div",or,[e("input",{id:`tag-${B.id}`,type:"checkbox",checked:E(B),onChange:Y=>n(B),class:"sr-only"},null,40,rr),e("div",{class:b(["w-4 h-4 border-2 rounded transition-all duration-200 flex items-center justify-center",E(B)?"bg-primary border-primary":"border-gray-300 group-hover:border-gray-400"])},[E(B)?(o(),l("svg",nr,ar)):D("",!0)],2)])]),e("div",ir,[e("div",{class:"w-3 h-3 rounded-full mr-2.5 border flex-shrink-0 shadow-sm",style:Je({backgroundColor:O(B).hex})},null,4),e("span",dr,h(B.name),1)])],8,tr))),128))])):D("",!0)])])):D("",!0)]),_:1})]),u.value.length>0?(o(),l("div",cr,[e("div",ur,[mr,e("div",gr,[(o(!0),l(le,null,me(u.value,B=>(o(),l("div",{key:B.id,class:"group inline-flex items-center pl-2.5 pr-1.5 py-1.5 rounded-lg text-xs font-medium border shadow-sm cursor-pointer transition-all duration-200 hover:shadow-md",style:Je({backgroundColor:O(B).hex+"20",borderColor:O(B).hex+"40",color:O(B).dark}),onClick:Y=>n(B)},[e("div",{class:"w-2 h-2 rounded-full mr-2 flex-shrink-0",style:Je({backgroundColor:O(B).hex})},null,4),e("span",hr,h(B.name),1),e("div",fr,[s(t(Le),{class:"h-3 w-3 opacity-60 group-hover:opacity-100"})])],12,pr))),128))])])])):D("",!0)]))}},br=yt(vr,[["__scopeId","data-v-d403a707"]]),yr={class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},xr={class:"bg-white rounded-xl shadow-xl max-w-5xl w-full max-h-[90vh] overflow-hidden"},_r={class:"border-b"},wr={class:"hidden sm:flex justify-between items-center p-6"},$r=e("h3",{class:"text-lg font-semibold text-gray-900"},"Agregar Documentos",-1),kr={class:"text-sm text-gray-600"},Cr={class:"sm:hidden p-4"},Dr={class:"flex justify-between items-start mb-2"},Sr={class:"flex-1 min-w-0 mr-3"},Er=e("h3",{class:"text-lg font-semibold text-gray-900"},"Agregar Documentos",-1),Fr={class:"text-sm text-gray-600 truncate"},Ar={class:"border-b"},Tr={class:"hidden sm:flex space-x-8 px-6","aria-label":"Tabs"},Mr=["onClick"],Lr={class:"ml-2 bg-gray-100 text-gray-600 py-0.5 px-2 rounded-full text-xs"},Pr={class:"sm:hidden relative px-4 py-3"},Ir={class:"flex items-center"},jr={class:"ml-2 bg-gray-100 text-gray-600 py-0.5 px-2 rounded-full text-xs"},Br=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1),Ur=[Br],Nr={class:"absolute top-full left-4 right-4 z-50 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg overflow-hidden"},qr=["onClick"],zr={class:"border-b bg-gray-50 p-4 sm:p-6"},Or={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},Rr={class:"flex-1"},Vr={key:0,class:"flex items-center gap-3"},Qr={class:"text-sm text-gray-600"},Gr={class:"p-4 sm:p-6 overflow-y-auto max-h-[calc(90vh-350px)]"},Zr={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4"},Wr={key:4,class:"absolute top-2 left-2 w-6 h-6 bg-primary text-white rounded-full flex items-center justify-center shadow-sm"},Hr={key:0,class:"text-center py-8 sm:py-12"},Kr={class:"text-lg font-medium text-gray-900 mb-2"},Jr={class:"text-gray-600 text-sm sm:text-base"},Yr={class:"border-t bg-gray-50"},Xr={class:"hidden sm:flex justify-between items-center p-6"},en={class:"text-sm text-gray-600"},tn={class:"flex gap-3"},sn=["disabled"],on={class:"sm:hidden p-4 space-y-3"},rn={class:"text-center text-sm text-gray-600"},nn={class:"flex gap-3"},ln=["disabled"],an={__name:"AddDocumentsModal",props:{isVisible:{type:Boolean,required:!0},folder:{type:Object,default:null}},emits:["close","add-documents"],setup(r,{emit:f}){const i=r,c=f,S=Oe(),x=We(),u=L([]),$=L([]),F=L("my-documents"),U=L(!1),K=L(!1),O=[{name:"my-documents",label:"Mis Documentos"},{name:"use-documents",label:"Formatos Disponibles"},{name:"pending-signatures",label:"Firmas Pendientes"},{name:"signed-documents",label:"Documentos Firmados"}],J=j(()=>x.currentUser);ke(()=>i.isVisible,_=>{_&&(u.value=[],$.value=[],F.value="my-documents")}),ke(F,()=>{u.value=[]}),ke($,()=>{u.value=[]},{deep:!0});const E=j(()=>{const _=y(F.value);return _.length===0?!1:_.every(q=>u.value.includes(q.id))}),n=_=>{var R;if(!i.folder)return[];const q=i.folder.documents.map(X=>X.id);let V=[];switch(_){case"my-documents":V=S.progressAndCompletedDocumentsByClient((R=J.value)==null?void 0:R.id);break;case"use-documents":V=S.publishedDocumentsUnassigned;break;case"pending-signatures":V=S.documents.filter(X=>{var ye,Z;return X.state==="PendingSignatures"&&(X.assigned_to===((ye=J.value)==null?void 0:ye.id)||((Z=X.signatures)==null?void 0:Z.some(A=>{var oe;return A.signer_email===((oe=J.value)==null?void 0:oe.email)})))});break;case"signed-documents":V=S.documents.filter(X=>{var ye,Z;return X.state==="FullySigned"&&(X.assigned_to===((ye=J.value)==null?void 0:ye.id)||((Z=X.signatures)==null?void 0:Z.some(A=>{var oe;return A.signer_email===((oe=J.value)==null?void 0:oe.email)})))});break;default:V=[]}return V.filter(X=>!q.includes(X.id))},y=_=>{const q=n(_);if(!$.value||$.value.length===0)return q;const V=$.value.map(R=>R.id);return q.filter(R=>!R.tags||R.tags.length===0?!1:R.tags.some(X=>V.includes(X.id)))},g=_=>{const q=u.value.indexOf(_);q>-1?u.value.splice(q,1):u.value.push(_)},T=()=>{const q=y(F.value).map(V=>V.id);if(E.value)u.value=u.value.filter(V=>!q.includes(V));else{const V=q.filter(R=>!u.value.includes(R));u.value.push(...V)}},w=()=>{c("close")},B=async()=>{if(u.value.length!==0){U.value=!0;try{await c("add-documents",u.value)}finally{U.value=!1}}},Y=_=>{F.value=_,K.value=!1},P=_=>{_.target.closest(".relative")||(K.value=!1)};return qe(()=>{document.addEventListener("click",P)}),ut(()=>{document.removeEventListener("click",P)}),(_,q)=>r.isVisible&&r.folder?(o(),ee(Ye,{key:0},{default:m(()=>{var V;return[e("div",yr,[e("div",xr,[e("div",_r,[e("div",wr,[e("div",null,[$r,e("p",kr,'Selecciona documentos para agregar a "'+h(r.folder.name)+'"',1)]),e("button",{onClick:w,class:"text-gray-400 hover:text-gray-500 hover:bg-gray-100 p-2 rounded-lg transition-colors"},[s(t(Le),{class:"w-5 h-5"})])]),e("div",Cr,[e("div",Dr,[e("div",Sr,[Er,e("p",Fr,'Para "'+h(r.folder.name)+'"',1)]),e("button",{onClick:w,class:"text-gray-400 hover:text-gray-500 hover:bg-gray-100 p-2 rounded-lg transition-colors flex-shrink-0"},[s(t(Le),{class:"w-5 h-5"})])])])]),e("div",Ar,[e("nav",Tr,[(o(),l(le,null,me(O,R=>e("button",{key:R.name,onClick:X=>F.value=R.name,class:b([F.value===R.name?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])},[te(h(R.label)+" ",1),e("span",Lr,h(y(R.name).length),1)],10,Mr)),64))]),e("div",Pr,[e("button",{onClick:q[0]||(q[0]=R=>K.value=!K.value),class:"w-full flex items-center justify-between py-3 px-4 bg-white border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary"},[e("div",Ir,[e("span",null,h(((V=O.find(R=>R.name===F.value))==null?void 0:V.label)||"Seleccionar categor√≠a"),1),e("span",jr,h(y(F.value).length),1)]),(o(),l("svg",{class:b(["ml-2 h-5 w-5 transition-transform duration-200",K.value?"transform rotate-180":""]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ur,2))]),Me(e("div",Nr,[(o(),l(le,null,me(O,R=>e("button",{key:R.name,onClick:X=>Y(R.name),class:b(["w-full text-left px-4 py-3 text-sm transition-colors duration-150 flex items-center justify-between",F.value===R.name?"bg-primary text-white":"text-gray-700 hover:bg-gray-50"])},[e("span",null,h(R.label),1),e("span",{class:b(["py-0.5 px-2 rounded-full text-xs",F.value===R.name?"bg-white/20 text-white":"bg-gray-100 text-gray-600"])},h(y(R.name).length),3)],10,qr)),64))],512),[[kt,K.value]])])]),e("div",zr,[e("div",Or,[e("div",Rr,[s(br,{modelValue:$.value,"onUpdate:modelValue":q[1]||(q[1]=R=>$.value=R),class:"max-w-md"},null,8,["modelValue"])]),y(F.value).length>0?(o(),l("div",Vr,[e("span",Qr,h(y(F.value).length)+" documento(s) disponible(s) ",1),e("button",{onClick:T,class:b(["px-4 py-2 rounded-lg border font-medium text-sm transition-colors",E.value?"bg-red-50 border-red-200 text-red-700 hover:bg-red-100":"bg-primary text-white border-primary hover:bg-primary-dark"])},h(E.value?"Deseleccionar todos":"Seleccionar todos"),3)])):D("",!0)])]),e("div",Gr,[e("div",Zr,[(o(!0),l(le,null,me(y(F.value),R=>(o(),l("div",{key:R.id,class:"relative"},[F.value==="my-documents"?(o(),ee(t(ms),{key:0,document:R,"highlighted-doc-id":null,"show-tags":!0,"show-client-name":!1,"menu-options":[],"disable-internal-actions":!0,"additional-classes":u.value.includes(R.id)?"ring-2 ring-primary bg-primary-50":"",onClick:X=>g(R.id)},null,8,["document","additional-classes","onClick"])):D("",!0),F.value==="use-documents"?(o(),ee(t(Ps),{key:1,document:R,"show-tags":!0,"menu-options":[],"show-menu-options":!1,"disable-internal-actions":!0,"additional-classes":u.value.includes(R.id)?"ring-2 ring-primary bg-primary-50":"",onClick:X=>g(R.id)},null,8,["document","additional-classes","onClick"])):D("",!0),F.value==="pending-signatures"?(o(),ee(t(jt),{key:2,document:R,"highlighted-doc-id":null,"show-tags":!0,"menu-options":[],"disable-internal-actions":!0,"additional-classes":u.value.includes(R.id)?"ring-2 ring-primary bg-primary-50":"",onClick:X=>g(R.id)},null,8,["document","additional-classes","onClick"])):D("",!0),F.value==="signed-documents"?(o(),ee(t(jt),{key:3,document:R,"highlighted-doc-id":null,"show-tags":!0,"menu-options":[],"disable-internal-actions":!0,"additional-classes":u.value.includes(R.id)?"ring-2 ring-primary bg-primary-50":"",onClick:X=>g(R.id)},null,8,["document","additional-classes","onClick"])):D("",!0),u.value.includes(R.id)?(o(),l("div",Wr,[s(t(gs),{class:"w-4 h-4"})])):D("",!0)]))),128))]),y(F.value).length===0?(o(),l("div",Hr,[s(t(ct),{class:"w-12 h-12 sm:w-16 sm:h-16 text-gray-300 mx-auto mb-4"}),e("h4",Kr,h($.value.length>0?"No hay documentos que coincidan con el filtro":"No hay documentos disponibles"),1),e("p",Jr,h($.value.length>0?"Intenta ajustar los filtros de etiquetas o selecciona otra categor√≠a":"No tienes documentos de esta categor√≠a que no est√©n ya en la carpeta"),1)])):D("",!0)]),e("div",Yr,[e("div",Xr,[e("div",en,h(u.value.length)+" documento(s) seleccionado(s) ",1),e("div",tn,[e("button",{onClick:w,class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"}," Cancelar "),e("button",{onClick:B,disabled:u.value.length===0||U.value,class:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},h(U.value?"Agregando...":`Agregar ${u.value.length} documento(s)`),9,sn)])]),e("div",on,[e("div",rn,h(u.value.length)+" documento(s) seleccionado(s) ",1),e("div",nn,[e("button",{onClick:w,class:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-center font-medium"}," Cancelar "),e("button",{onClick:B,disabled:u.value.length===0||U.value,class:"flex-1 px-4 py-3 bg-primary text-white rounded-lg hover:bg-primary-dark disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-center font-medium"},h(U.value?"Agregando...":"Agregar"),9,ln)])])])])])]}),_:1})):D("",!0)}},lt=r=>(mt("data-v-d7093a90"),r=r(),gt(),r),dn={class:"folders-table"},cn={key:0,class:"bg-white rounded-lg shadow-sm border border-gray-200",style:{"overflow-x":"visible","overflow-y":"hidden"}},un={class:"overflow-x-auto",style:{"overflow-y":"visible"}},mn={class:"min-w-full divide-y divide-gray-200"},gn=lt(()=>e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Carpeta "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Documentos "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Creada "),e("th",{scope:"col",class:"w-16 px-6 py-3"})])],-1)),pn={class:"bg-white divide-y divide-gray-200"},hn=["onClick"],fn={class:"px-6 py-4 whitespace-nowrap"},vn={class:"flex items-center"},bn={class:"flex-shrink-0 h-10 w-10"},yn={class:"ml-4"},xn={class:"text-sm font-medium text-gray-900"},_n={class:"px-6 py-4 whitespace-nowrap"},wn={class:"flex items-center gap-2"},$n={class:"text-sm text-gray-900"},kn={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Cn={class:"py-1"},Dn=["onClick"],Sn=["onClick"],En=["onClick"],Fn=["onClick"],An={key:1,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center"},Tn=lt(()=>e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No tienes carpetas a√∫n",-1)),Mn=lt(()=>e("p",{class:"text-gray-600 mb-6"},"Crea tu primera carpeta para organizar tus documentos",-1)),Ln={key:2,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center"},Pn=lt(()=>e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No se encontraron carpetas",-1)),In=lt(()=>e("p",{class:"text-gray-600"},"No hay carpetas que coincidan con tu b√∫squeda",-1)),jn={key:3,class:"flex justify-center items-center py-12"},Bn=lt(()=>e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"},null,-1)),Un=[Bn],Nn={__name:"FoldersTable",props:{sortedFolders:{type:Array,required:!0},searchQuery:{type:String,default:""},isLoading:{type:Boolean,default:!1}},emits:["folder-click","edit-folder","delete-folder","add-documents","create-folder"],setup(r,{emit:f}){const i=r,c=f,S=j(()=>{if(!i.searchQuery.trim())return i.sortedFolders;const E=i.searchQuery.toLowerCase();return i.sortedFolders.filter(n=>n.name.toLowerCase().includes(E))}),x=[{name:"blue",hex:"#3B82F6"},{name:"purple",hex:"#8B5CF6"},{name:"pink",hex:"#EC4899"},{name:"green",hex:"#10B981"},{name:"yellow",hex:"#F59E0B"},{name:"red",hex:"#EF4444"},{name:"indigo",hex:"#6366F1"},{name:"teal",hex:"#14B8A6"}],u=E=>{if(E.color)return x.find(y=>y.name===E.color)||x[0];const n=E.id%x.length;return x[n]},$=E=>{if(!E)return"-";const n=new Date(E),g=Math.abs(new Date-n),T=Math.ceil(g/(1e3*60*60*24));return T===0?"Hoy":T===1?"Ayer":T<7?`Hace ${T} d√≠as`:T<30?`Hace ${Math.floor(T/7)} semanas`:T<365?`Hace ${Math.floor(T/30)} meses`:n.toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"})},F=E=>{c("folder-click",E)},U=E=>{c("edit-folder",E)},K=E=>{c("delete-folder",E)},O=E=>{c("add-documents",E)},J=()=>{c("create-folder")};return(E,n)=>(o(),l("div",dn,[!r.isLoading&&S.value.length>0?(o(),l("div",cn,[e("div",un,[e("table",mn,[gn,e("tbody",pn,[(o(!0),l(le,null,me(S.value,y=>{var g,T;return o(),l("tr",{key:y.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:w=>F(y)},[e("td",fn,[e("div",vn,[e("div",bn,[e("div",{class:"h-10 w-10 rounded-lg flex items-center justify-center",style:Je({backgroundColor:u(y).hex+"20"})},[s(t(wt),{class:"h-6 w-6",style:Je({color:u(y).hex})},null,8,["style"])],4)]),e("div",yn,[e("div",xn,h(y.name),1)])])]),e("td",_n,[e("div",wn,[s(t(Re),{class:"h-5 w-5 text-gray-400"}),e("span",$n,h(((g=y.documents)==null?void 0:g.length)||0)+" documento"+h((((T=y.documents)==null?void 0:T.length)||0)!==1?"s":""),1)])]),e("td",kn,h($(y.created_at)),1),e("td",{class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",onClick:n[0]||(n[0]=ve(()=>{},["stop"]))},[s(t(Fe),{as:"div",class:"relative inline-block text-left"},{default:m(()=>[s(t(Ae),{class:"inline-flex items-center justify-center w-8 h-8 rounded-md hover:bg-gray-100"},{default:m(()=>[s(t(et),{class:"h-5 w-5 text-gray-500"})]),_:1}),s(t(Te),{class:"absolute right-0 z-[9999] mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",Cn,[s(t(re),null,{default:m(({active:w})=>[e("a",{onClick:B=>F(y),class:b([w?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Ver carpeta ",10,Dn)]),_:2},1024),s(t(re),null,{default:m(({active:w})=>[e("a",{onClick:B=>O(y),class:b([w?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Agregar documentos ",10,Sn)]),_:2},1024),s(t(re),null,{default:m(({active:w})=>[e("a",{onClick:B=>U(y),class:b([w?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Editar ",10,En)]),_:2},1024),s(t(re),null,{default:m(({active:w})=>[e("a",{onClick:B=>K(y),class:b([w?"bg-gray-100":"","block px-4 py-2 text-sm text-red-600 cursor-pointer"])}," Eliminar ",10,Fn)]),_:2},1024)])]),_:2},1024)]),_:2},1024)])],8,hn)}),128))])])])])):!r.isLoading&&r.sortedFolders.length===0?(o(),l("div",An,[s(t(wt),{class:"w-16 h-16 text-gray-300 mx-auto mb-4"}),Tn,Mn,e("button",{onClick:J,class:"inline-flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors"},[s(t(Ke),{class:"w-5 h-5"}),te(" Crear Primera Carpeta ")])])):!r.isLoading&&r.sortedFolders.length>0&&S.value.length===0?(o(),l("div",Ln,[s(t(wt),{class:"w-16 h-16 text-gray-300 mx-auto mb-4"}),Pn,In])):D("",!0),r.isLoading?(o(),l("div",jn,Un)):D("",!0)]))}},qn=yt(Nn,[["__scopeId","data-v-d7093a90"]]),Kt=r=>(mt("data-v-ab5666d5"),r=r(),gt(),r),zn={class:"folder-management"},On={class:"mb-6"},Rn={class:"hidden sm:flex justify-between items-center"},Vn=Kt(()=>e("div",null,[e("h2",{class:"text-xl font-semibold text-gray-900"},"Mis Carpetas"),e("p",{class:"text-sm text-gray-600 mt-1"},"Organiza tus documentos, firmas y formatos en carpetas personalizadas")],-1)),Qn={class:"sm:hidden"},Gn=Kt(()=>e("div",{class:"text-center mb-4"},[e("h2",{class:"text-xl font-semibold text-gray-900"},"Mis Carpetas"),e("p",{class:"text-sm text-gray-600 mt-1 px-2"},"Organiza tus documentos, firmas y formatos en carpetas personalizadas")],-1)),Zn={__name:"FolderManagement",props:{searchQuery:{type:String,default:""},selectedTags:{type:Array,default:()=>[]}},emits:["refresh","navigate-to-main"],setup(r,{emit:f}){const i=r,c=f,S=Lt(),x=Oe(),u=We(),$=L(!1),F=L(null),U=L(null),K=L(!1),O=L(null),J=j(()=>S.isLoading),E=j(()=>S.sortedFolders);j(()=>u.currentUser),qe(async()=>{await S.init(),await x.init()}),ke(()=>i.searchQuery,()=>{}),ke(()=>S.folders,A=>{var oe,pe;if(U.value&&A&&A.length>0){const be=A.find(ce=>ce.id===U.value.id);if(be){const ce=((oe=U.value.documents)==null?void 0:oe.length)||0,xe=((pe=be.documents)==null?void 0:pe.length)||0;JSON.stringify(U.value)!==JSON.stringify(be)&&(U.value={...be},console.log(`üîÑ FolderManagement: Synced selectedFolder "${be.name}" with store. Documents: ${ce} ‚Üí ${xe}`))}}},{deep:!0});const n=()=>{F.value=null,$.value=!0},y=A=>{F.value=A,$.value=!0},g=()=>{$.value=!1,F.value=null},T=()=>{g()},w=A=>{U.value=A},B=()=>{U.value=null},Y=async A=>{if(confirm(`¬øEst√°s seguro de que quieres eliminar la carpeta "${A.name}"?`))try{await S.deleteFolder(A.id),we(`Carpeta "${A.name}" eliminada correctamente`,"success")}catch(oe){we("Error al eliminar la carpeta","error"),console.error("Error deleting folder:",oe)}},P=A=>{O.value=A,K.value=!0},_=async(A=!1)=>{if(K.value=!1,O.value=null,A&&U.value)try{await q()}catch(oe){console.warn("Error refreshing folder after adding documents:",oe)}},q=async()=>{if(U.value)try{await S.fetchFolderById(U.value.id,!0);const A=S.getFolderById(U.value.id);A&&(U.value={...A},console.log("‚úÖ Selected folder refreshed successfully"))}catch(A){throw console.error("‚ùå Error refreshing selected folder:",A),A}},V=async A=>{var oe,pe,be;if(!(!O.value||A.length===0))try{const ce=O.value.documents.map(he=>he.id).filter(he=>he!=null&&!isNaN(parseInt(he))).map(he=>parseInt(he)),xe=A.filter(he=>he!=null&&!isNaN(parseInt(he))).map(he=>parseInt(he)),ge=[...new Set([...ce,...xe])];if(console.log("Current document IDs:",ce),console.log("Selected document IDs:",xe),console.log("Updated document IDs:",ge),ge.some(he=>!Number.isInteger(he)||he<=0))throw new Error("IDs de documentos inv√°lidos detectados");await S.updateFolder(O.value.id,{document_ids:ge}),await _(!0),we(`${xe.length} documento(s) agregado(s) a la carpeta`,"success"),c("navigate-to-main")}catch(ce){console.error("Error adding documents to folder:",ce),console.error("Error details:",((oe=ce.response)==null?void 0:oe.data)||ce.message),(pe=ce.response)!=null&&pe.status?we(`Error al agregar documentos: ${((be=ce.response.data)==null?void 0:be.detail)||ce.message}`,"error"):we("Error al agregar documentos a la carpeta","error")}},R=async A=>{var oe,pe,be;if(U.value)try{const ce=parseInt(A);if(!Number.isInteger(ce)||ce<=0)throw new Error("ID de documento inv√°lido");const xe=U.value.documents.map(ge=>ge.id).filter(ge=>ge!=null&&!isNaN(parseInt(ge))).map(ge=>parseInt(ge)).filter(ge=>ge!==ce);console.log("Removing document ID:",ce),console.log("Updated document IDs after removal:",xe),await S.updateFolder(U.value.id,{document_ids:xe}),we("Documento removido de la carpeta","success"),U.value=null,c("navigate-to-main");try{await S.fetchFolderById(U.value.id,!0);const ge=S.getFolderById(U.value.id);ge&&(U.value=ge),console.log("Folder data refreshed successfully after removal")}catch(ge){console.warn("Error refreshing folder data:",ge);try{U.value={...U.value,documents:U.value.documents.filter(he=>he.id!==ce)},console.log("Applied optimistic removal for document ID:",ce)}catch(he){console.warn("Optimistic update failed:",he)}}}catch(ce){console.error("Error removing document from folder:",ce),console.error("Error details:",((oe=ce.response)==null?void 0:oe.data)||ce.message),(pe=ce.response)!=null&&pe.status?we(`Error al remover documento: ${((be=ce.response.data)==null?void 0:be.detail)||ce.message}`,"error"):we("Error al remover el documento de la carpeta","error")}},X=A=>{console.log("View document:",A)},ye=A=>{console.log("Use document:",A)},Z=(A,oe)=>{console.log("Document action:",A,oe)};return(A,oe)=>(o(),l("div",zn,[e("div",On,[e("div",Rn,[Vn,e("button",{onClick:n,class:"inline-flex items-center gap-2 px-4 py-2.5 bg-primary text-white rounded-xl hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-all duration-200 shadow-sm hover:shadow-md"},[s(t(Ke),{class:"w-5 h-5"}),te(" Nueva Carpeta ")])]),e("div",Qn,[Gn,e("button",{onClick:n,class:"w-full flex items-center justify-center gap-3 px-4 py-4 bg-primary text-white rounded-xl hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-all duration-200 shadow-sm hover:shadow-md font-medium text-base"},[s(t(Ke),{class:"w-6 h-6"}),te(" Nueva Carpeta ")])])]),s(t(qn),{"sorted-folders":E.value,"search-query":r.searchQuery,"is-loading":J.value,onFolderClick:w,onEditFolder:y,onDeleteFolder:Y,onAddDocuments:P,onCreateFolder:n},null,8,["sorted-folders","search-query","is-loading"]),s(t(Js),{"is-visible":$.value,"editing-folder":F.value,onClose:g,onSuccess:T},null,8,["is-visible","editing-folder"]),s(t(Mo),{folder:U.value,onClose:B,onAddDocuments:P,onRemoveDocument:R,onViewDocument:X,onUseDocument:ye,onDocumentAction:Z},null,8,["folder"]),s(t(an),{"is-visible":K.value,folder:O.value,onClose:_,onAddDocuments:V},null,8,["is-visible","folder"])]))}},Wn=yt(Zn,[["__scopeId","data-v-ab5666d5"]]);function Pt(){const r=We(),f=j(()=>{var x;return((x=r.currentUser)==null?void 0:x.role)==="basic"}),i=x=>{we("Esta funcionalidad est√° restringida para usuarios b√°sicos. Por favor, contacta a tu abogado para obtener acceso completo.","warning")};return{isBasicUser:f,showRestrictionNotification:i,handleFeatureAccess:(x,u)=>f.value?(i(),!1):(u&&u(),!0),getRestrictedButtonClasses:x=>x?"opacity-60 cursor-not-allowed":""}}const Hn={class:"document-list-client-table"},Kn={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6"},Jn={class:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between"},Yn={class:"flex flex-col sm:flex-row gap-3 flex-1 w-full lg:w-auto"},Xn={class:"relative flex-1 min-w-[200px]"},el={class:"max-w-[120px] truncate"},tl={class:"p-2"},sl={class:"relative mb-2"},ol={class:"max-h-60 overflow-y-auto"},rl=["onClick"],nl={class:"truncate"},ll={key:0,class:"px-3 py-2 text-sm text-gray-500 text-center"},al={class:"flex items-center gap-3 w-full lg:w-auto"},il={class:"text-sm text-gray-500 whitespace-nowrap"},dl={class:"py-1"},cl={class:"bg-white rounded-lg shadow-sm border border-gray-200",style:{"overflow-x":"visible","overflow-y":"hidden"}},ul={class:"overflow-x-auto",style:{"overflow-y":"visible"}},ml={class:"min-w-full divide-y divide-gray-200"},gl=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Documento "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Firma "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etiqueta "),e("th",{scope:"col",class:"w-16 px-6 py-3"})])],-1),pl={class:"bg-white divide-y divide-gray-200"},hl=["onClick"],fl={class:"px-6 py-4 whitespace-nowrap"},vl={class:"flex items-center"},bl={class:"flex-shrink-0 h-10 w-10"},yl={class:"h-10 w-10 rounded-lg bg-blue-100 flex items-center justify-center"},xl={class:"ml-4"},_l={class:"text-sm font-medium text-gray-900"},wl={class:"px-6 py-4 whitespace-nowrap"},$l={class:"px-6 py-4 whitespace-nowrap"},kl={class:"px-6 py-4 whitespace-nowrap"},Cl={class:"flex flex-wrap gap-1"},Dl={key:0,class:"text-sm text-gray-400"},Sl={class:"py-1"},El=["onClick"],Fl=["onClick"],Al=["onClick"],Tl=["onClick"],Ml=["onClick"],Ll=["onClick"],Pl=["onClick"],Il=["onClick"],jl=["onClick"],Bl=["onClick"],Ul={key:0,class:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"},Nl={class:"flex flex-1 justify-between sm:hidden"},ql=["disabled"],zl=["disabled"],Ol={class:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between"},Rl={class:"text-sm text-gray-700"},Vl={class:"font-medium"},Ql={class:"font-medium"},Gl={class:"font-medium"},Zl={class:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination"},Wl=["disabled"],Hl=e("span",{class:"sr-only"},"Anterior",-1),Kl=["onClick"],Jl={key:1,class:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700"},Yl=["disabled"],Xl=e("span",{class:"sr-only"},"Siguiente",-1),ea={key:1,class:"text-center py-12"},ta=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No hay documentos",-1),sa=e("p",{class:"mt-1 text-sm text-gray-500"},"Los documentos asignados por tu abogado aparecer√°n aqu√≠.",-1),oa={__name:"DocumentListClientTable",props:{searchQuery:String,selectedTags:{type:Array,default:()=>[]}},emits:["refresh","open-letterhead","open-relationships"],setup(r,{emit:f}){const i=Oe(),c=We(),S=Xe(),x=f,{handleFeatureAccess:u}=Pt(),{activeModals:$,openModal:F,closeModal:U}=ft(i,c),{handlePreviewDocument:K,deleteDocument:O,downloadPDFDocument:J,downloadWordDocument:E}=vt(i,c,x);ke($,k=>{},{deep:!0}),qe(()=>{});const n=L(""),y=L(""),g=L(null),T=L("recent");qe(()=>{i.init(),c.init()});const w=j(()=>c.getCurrentUser),B=j(()=>w.value?i.progressAndCompletedDocumentsByClient(w.value.id):[]),Y=j(()=>{let k=[...B.value];const M=n.value.toLowerCase();return M&&(k=k.filter(C=>{var se,de;return((se=C.title)==null?void 0:se.toLowerCase().includes(M))||((de=C.tags)==null?void 0:de.some(Q=>{var z;return(z=Q.name)==null?void 0:z.toLowerCase().includes(M)}))})),g.value&&(k=k.filter(C=>C.tags&&C.tags.some(se=>se.id===g.value))),T.value==="name"?k.sort((C,se)=>{const de=(C.title||"").toLowerCase(),Q=(se.title||"").toLowerCase();return de.localeCompare(Q)}):T.value==="recent"&&k.sort((C,se)=>se.id-C.id),k}),P=L(1),_=L(10),q=j(()=>{const k=(P.value-1)*_.value,M=k+_.value;return Y.value.slice(k,M)}),V=j(()=>Math.ceil(Y.value.length/_.value)),R=j(()=>{const k=(P.value-1)*_.value+1,M=Math.min(P.value*_.value,Y.value.length);return{start:k,end:M,total:Y.value.length}});ke([n,g,T],()=>{P.value=1});const X=j(()=>{const k=V.value,M=P.value,C=[];if(k<=7)for(let se=1;se<=k;se++)C.push(se);else if(M<=4){for(let se=1;se<=5;se++)C.push(se);C.push("..."),C.push(k)}else if(M>=k-3){C.push(1),C.push("...");for(let se=k-4;se<=k;se++)C.push(se)}else C.push(1),C.push("..."),C.push(M-1),C.push(M),C.push(M+1),C.push("..."),C.push(k);return C}),ye=()=>{P.value>1&&P.value--},Z=()=>{P.value<V.value&&P.value++},A=k=>{k>=1&&k<=V.value&&(P.value=k)},oe=j(()=>{const k=new Map;return B.value.forEach(M=>{M.tags&&M.tags.length>0&&M.tags.forEach(C=>{k.has(C.id)||k.set(C.id,C)})}),Array.from(k.values()).sort((M,C)=>M.name.localeCompare(C.name))}),pe=j(()=>{if(!y.value)return oe.value;const k=y.value.toLowerCase();return oe.value.filter(M=>M.name.toLowerCase().includes(k))}),be=j(()=>{if(!g.value)return null;const k=oe.value.find(M=>M.id===g.value);return k?k.name:null}),ce=j(()=>{switch(T.value){case"name":return"Nombre (A-Z)";case"recent":default:return"M√°s recientes"}}),xe=k=>k.state==="Completed"?"Completado":k.state==="Progress"?"En Progreso":k.state||"Sin estado",ge=k=>k.state==="Completed"?"bg-green-100 text-green-700 border border-green-200":k.state==="Progress"?"bg-blue-100 text-blue-700 border border-blue-200":"bg-gray-100 text-gray-700 border border-gray-200",he=k=>{if(!k.signatures||k.signatures.length===0)return"Sin Firma";if(k.fully_signed)return"Firmado";const M=k.signatures.find(se=>{var de;return se.user_id===((de=w.value)==null?void 0:de.id)});return M?M.signed?"Firmado":"Pendiente Firmar":k.signatures.some(se=>!se.signed)?"Pendiente Firmar":"Sin Firma"},Pe=k=>{const M=he(k);return M==="Sin Firma"?"bg-yellow-100 text-yellow-700 border border-yellow-200":M==="Firmado"?"bg-green-100 text-green-700 border border-green-200":M==="Pendiente Firmar"?"bg-blue-100 text-blue-700 border border-blue-200":M==="Devuelto Sin Firma"?"bg-red-100 text-red-700 border border-red-200":"bg-gray-100 text-gray-700 border border-gray-200"},je=k=>{const M=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],C=k.id%M.length;return M[C]},Ve=k=>{const M=["bg-blue-500","bg-purple-500","bg-pink-500","bg-yellow-500","bg-green-500","bg-red-500","bg-indigo-500","bg-orange-500"],C=k.id%M.length;return M[C]},ue=()=>{g.value=null},ie=k=>{const M=`/dynamic_document_dashboard/document/use/editor/${k.id}/${encodeURIComponent(k.title.trim())}`;S.push(M)},De=k=>{var M;F("edit",k,{userRole:((M=c.currentUser)==null?void 0:M.role)||"client"})},fe=k=>{S.push(`/dynamic_document_dashboard/client/editor/edit/${k.id}`)},ne=async k=>{await K(k)},Se=async k=>{await O(k)},Ge=k=>{u("Membrete Individual",()=>{F("letterhead",k)})},p=k=>{F("relationships",k)},d=async k=>{await J(k)},a=async k=>{await E(k)},G=k=>{F("email",k)};return(k,M)=>(o(),l(le,null,[e("div",Hn,[e("div",Kn,[e("div",Jn,[e("div",Yn,[e("div",Xn,[s(t(Qe),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),Me(e("input",{"onUpdate:modelValue":M[0]||(M[0]=C=>n.value=C),type:"text",placeholder:"Buscar...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent"},null,512),[[ze,n.value]])]),s(t(Fe),{as:"div",class:"relative"},{default:m(()=>[s(t(Ae),{class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:m(()=>[s(t(tt),{class:"h-4 w-4"}),e("span",el,h(be.value||"Etiqueta"),1),s(t(Ne),{class:"h-4 w-4"})]),_:1}),s(t(Te),{class:"absolute left-0 z-10 mt-2 w-64 origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",tl,[e("div",sl,[s(t(Qe),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),Me(e("input",{"onUpdate:modelValue":M[1]||(M[1]=C=>y.value=C),type:"text",placeholder:"Buscar etiquetas...",class:"w-full pl-9 pr-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent",onClick:M[2]||(M[2]=ve(()=>{},["stop"]))},null,512),[[ze,y.value]])]),e("div",ol,[s(t(re),null,{default:m(({active:C})=>[e("a",{onClick:M[3]||(M[3]=se=>g.value=null),class:b([C?"bg-gray-100":"","block px-3 py-2 text-sm text-gray-700 cursor-pointer rounded-md"])}," Todos ",2)]),_:1}),(o(!0),l(le,null,me(pe.value,C=>(o(),ee(t(re),{key:C.id},{default:m(({active:se})=>[e("a",{onClick:de=>g.value=C.id,class:b([se?"bg-gray-100":"","flex items-center gap-2 px-3 py-2 text-sm cursor-pointer rounded-md"])},[e("span",{class:b(["w-3 h-3 rounded-full flex-shrink-0",Ve(C)])},null,2),e("span",nl,h(C.name),1)],10,rl)]),_:2},1024))),128)),pe.value.length===0?(o(),l("div",ll," No se encontraron etiquetas ")):D("",!0)])])]),_:1})]),_:1}),g.value?(o(),l("button",{key:0,onClick:ue,class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",title:"Limpiar filtros"},[s(t(Le),{class:"h-4 w-4"}),te(" Limpiar ")])):D("",!0)]),e("div",al,[e("span",il,h(Y.value.length)+" "+h(Y.value.length===1?"resultado":"resultados"),1),s(t(Fe),{as:"div",class:"relative"},{default:m(()=>[s(t(Ae),{class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:m(()=>[te(" Ordenar: "+h(ce.value)+" ",1),s(t(Ne),{class:"h-4 w-4"})]),_:1}),s(t(Te),{class:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",dl,[s(t(re),null,{default:m(({active:C})=>[e("a",{onClick:M[4]||(M[4]=se=>T.value="recent"),class:b([C?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," M√°s recientes ",2)]),_:1}),s(t(re),null,{default:m(({active:C})=>[e("a",{onClick:M[5]||(M[5]=se=>T.value="name"),class:b([C?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Nombre (A-Z) ",2)]),_:1})])]),_:1})]),_:1})])])]),e("div",cl,[e("div",ul,[e("table",ml,[gl,e("tbody",pl,[(o(!0),l(le,null,me(q.value,(C,se)=>(o(),l("tr",{key:C.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:de=>ie(C)},[e("td",fl,[e("div",vl,[e("div",bl,[e("div",yl,[s(t(Re),{class:"h-5 w-5 text-blue-600"})])]),e("div",xl,[e("div",_l,h(C.title),1)])])]),e("td",wl,[e("span",{class:b(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",ge(C)])},h(xe(C)),3)]),e("td",$l,[e("span",{class:b(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",Pe(C)])},h(he(C)),3)]),e("td",kl,[e("div",Cl,[(o(!0),l(le,null,me(C.tags,de=>(o(),l("span",{key:de.id,class:b(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",je(de)])},h(de.name),3))),128)),!C.tags||C.tags.length===0?(o(),l("span",Dl,"-")):D("",!0)])]),e("td",{class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",onClick:M[6]||(M[6]=ve(()=>{},["stop"]))},[s(t(Fe),{as:"div",class:"relative inline-block text-left"},{default:m(()=>[s(t(Ae),{class:"inline-flex items-center justify-center w-8 h-8 rounded-md hover:bg-gray-100"},{default:m(()=>[s(t(et),{class:"h-5 w-5 text-gray-500"})]),_:1}),s(t(Te),{class:b([q.value.length<=3?"absolute right-full mr-2 top-0 z-[9999] w-56 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none":se>=q.value.length-3?"absolute right-0 z-[9999] bottom-full mb-2 w-56 origin-bottom-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none":"absolute right-0 z-[9999] mt-2 w-56 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"])},{default:m(()=>[e("div",Sl,[C.state==="Completed"?(o(),ee(t(re),{key:0},{default:m(({active:de})=>[e("a",{onClick:Q=>De(C),class:b([de?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Editar Formulario ",10,El)]),_:2},1024)):D("",!0),C.state==="Completed"?(o(),ee(t(re),{key:1},{default:m(({active:de})=>[e("a",{onClick:Q=>fe(C),class:b([de?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Editar Documento ",10,Fl)]),_:2},1024)):D("",!0),C.state!=="Completed"?(o(),ee(t(re),{key:2},{default:m(({active:de})=>[e("a",{onClick:Q=>De(C),class:b([de?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Completar ",10,Al)]),_:2},1024)):D("",!0),C.state==="Completed"?(o(),ee(t(re),{key:3},{default:m(({active:de})=>[e("a",{onClick:Q=>ne(C),class:b([de?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Previsualizar ",10,Tl)]),_:2},1024)):D("",!0),s(t(re),null,{default:m(({active:de})=>[e("a",{onClick:Q=>Se(C),class:b([de?"bg-gray-100":"","block px-4 py-2 text-sm text-red-600 cursor-pointer"])}," Eliminar ",10,Ml)]),_:2},1024),s(t(re),null,{default:m(({active:de})=>{var Q;return[e("a",{onClick:z=>Ge(C),class:b([de?"bg-gray-100":"",((Q=w.value)==null?void 0:Q.role)==="basic"?"opacity-60 cursor-not-allowed text-gray-400":"text-gray-700 cursor-pointer","block px-4 py-2 text-sm"])}," Gestionar Membrete ",10,Ll)]}),_:2},1024),s(t(re),null,{default:m(({active:de})=>[e("a",{onClick:Q=>p(C),class:b([de?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Administrar Asociaciones ",10,Pl)]),_:2},1024),C.state==="Completed"?(o(),ee(t(re),{key:4},{default:m(({active:de})=>[e("a",{onClick:Q=>d(C),class:b([de?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Descargar PDF ",10,Il)]),_:2},1024)):D("",!0),C.state==="Completed"?(o(),ee(t(re),{key:5},{default:m(({active:de})=>[e("a",{onClick:Q=>a(C),class:b([de?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Descargar Word ",10,jl)]),_:2},1024)):D("",!0),C.state==="Completed"?(o(),ee(t(re),{key:6},{default:m(({active:de})=>[e("a",{onClick:Q=>G(C),class:b([de?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Enviar ",10,Bl)]),_:2},1024)):D("",!0)])]),_:2},1032,["class"])]),_:2},1024)])],8,hl))),128))])])]),V.value>1?(o(),l("div",Ul,[e("div",Nl,[e("button",{onClick:ye,disabled:P.value===1,class:b(["relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",P.value===1?"opacity-50 cursor-not-allowed":""])}," Anterior ",10,ql),e("button",{onClick:Z,disabled:P.value===V.value,class:b(["relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",P.value===V.value?"opacity-50 cursor-not-allowed":""])}," Siguiente ",10,zl)]),e("div",Ol,[e("div",null,[e("p",Rl,[te(" Mostrando "),e("span",Vl,h(R.value.start),1),te(" a "),e("span",Ql,h(R.value.end),1),te(" de "),e("span",Gl,h(R.value.total),1),te(" resultados ")])]),e("div",null,[e("nav",Zl,[e("button",{onClick:ye,disabled:P.value===1,class:b(["relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",P.value===1?"opacity-50 cursor-not-allowed":""])},[Hl,s(t(pt),{class:"h-5 w-5","aria-hidden":"true"})],10,Wl),(o(!0),l(le,null,me(X.value,C=>(o(),l(le,{key:C},[C!=="..."?(o(),l("button",{key:0,onClick:se=>A(C),class:b(["relative inline-flex items-center px-4 py-2 text-sm font-semibold focus:z-20 focus:outline-offset-0",P.value===C?"z-10 bg-secondary text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-secondary":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50"])},h(C),11,Kl)):(o(),l("span",Jl," ... "))],64))),128)),e("button",{onClick:Z,disabled:P.value===V.value,class:b(["relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",P.value===V.value?"opacity-50 cursor-not-allowed":""])},[Xl,s(t(ot),{class:"h-5 w-5","aria-hidden":"true"})],10,Yl)])])])])):D("",!0),Y.value.length===0?(o(),l("div",ea,[s(t(rt),{class:"mx-auto h-12 w-12 text-gray-400"}),ta,sa])):D("",!0)])]),(o(),ee(ht,{to:"body"},[t($).edit.isOpen?(o(),ee(Ct,{key:0,document:t($).edit.document,"user-role":t($).edit.userRole,onClose:M[7]||(M[7]=C=>t(U)("edit")),onRefresh:M[8]||(M[8]=C=>x("refresh"))},null,8,["document","user-role"])):D("",!0),t($).email.isOpen?(o(),ee(Dt,{key:1,document:t($).email.document,onClose:M[9]||(M[9]=C=>t(U)("email"))},null,8,["document"])):D("",!0),t($).letterhead.isOpen?(o(),ee(bt,{key:2,"is-visible":!0,document:t($).letterhead.document,onClose:M[10]||(M[10]=C=>t(U)("letterhead")),onRefresh:M[11]||(M[11]=C=>x("refresh"))},null,8,["document"])):D("",!0),t($).relationships.isOpen?(o(),ee(St,{key:3,"is-open":!0,document:t($).relationships.document,onClose:M[12]||(M[12]=C=>t(U)("relationships")),onRefresh:M[13]||(M[13]=C=>x("refresh"))},null,8,["document"])):D("",!0)]))],64))}},ra={class:"mb-4"},na={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6"},la={class:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between"},aa={class:"flex flex-col sm:flex-row gap-3 flex-1 w-full lg:w-auto"},ia={class:"relative flex-1 min-w-[200px]"},da={class:"max-w-[120px] truncate"},ca={class:"p-2"},ua={class:"relative mb-2"},ma={class:"max-h-60 overflow-y-auto"},ga=["onClick"],pa={class:"truncate"},ha={key:0,class:"px-3 py-2 text-sm text-gray-500 text-center"},fa={class:"flex items-center gap-3 w-full lg:w-auto"},va={class:"text-sm text-gray-500 whitespace-nowrap"},ba={class:"py-1"},ya={key:0,class:"bg-white rounded-lg shadow-sm border border-gray-200"},xa={class:"overflow-x-auto"},_a={class:"min-w-full divide-y divide-gray-200"},wa=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Plantilla "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etiquetas "),e("th",{scope:"col",class:"w-16 px-6 py-3"})])],-1),$a={class:"bg-white divide-y divide-gray-200"},ka=["onClick"],Ca={class:"px-6 py-4 whitespace-nowrap"},Da={class:"flex items-center"},Sa={class:"flex-shrink-0 h-10 w-10"},Ea={class:"h-10 w-10 rounded-lg bg-purple-100 flex items-center justify-center"},Fa={class:"ml-4"},Aa={class:"text-sm font-medium text-gray-900"},Ta=e("td",{class:"px-6 py-4 whitespace-nowrap"},[e("span",{class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-purple-100 text-purple-700 border border-purple-200"}," Disponible ")],-1),Ma={class:"px-6 py-4 whitespace-nowrap"},La={class:"flex flex-wrap gap-1"},Pa={key:0,class:"text-sm text-gray-400"},Ia={class:"py-1"},ja=["onClick"],Ba={key:1,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center"},Ua=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No hay plantillas disponibles",-1),Na={class:"mt-1 text-sm text-gray-500"},qa=e("div",{class:"mt-4"},[e("div",{class:"text-xs text-gray-400 bg-gray-100 px-3 py-2 rounded-lg inline-block"},[te(" üí° "),e("strong",null,"Tip:"),te(" Las plantillas son creadas por los abogados ")])],-1),za={__name:"UseDocumentTable",props:{searchQuery:String,selectedTags:{type:Array,default:()=>[]}},emits:["go-back"],setup(r,{emit:f}){const i=Oe();We();const c=Xe(),S=f,x=L(""),u=L(""),$=L(null),F=L("recent"),U=j(()=>i.publishedDocumentsUnassigned||[]),K=j(()=>{let P=[...U.value];const _=x.value.toLowerCase();return _&&(P=P.filter(q=>{var V,R;return((V=q.title)==null?void 0:V.toLowerCase().includes(_))||((R=q.tags)==null?void 0:R.some(X=>{var ye;return(ye=X.name)==null?void 0:ye.toLowerCase().includes(_)}))})),$.value&&(P=P.filter(q=>q.tags&&q.tags.some(V=>V.id===$.value))),F.value==="name"?P.sort((q,V)=>{const R=(q.title||"").toLowerCase(),X=(V.title||"").toLowerCase();return R.localeCompare(X)}):F.value==="recent"&&P.sort((q,V)=>V.id-q.id),P}),O=j(()=>{const P=new Map;return U.value.forEach(_=>{_.tags&&_.tags.length>0&&_.tags.forEach(q=>{P.has(q.id)||P.set(q.id,q)})}),Array.from(P.values()).sort((_,q)=>_.name.localeCompare(q.name))}),J=j(()=>{if(!u.value)return O.value;const P=u.value.toLowerCase();return O.value.filter(_=>_.name.toLowerCase().includes(P))}),E=j(()=>{if(!$.value)return null;const P=O.value.find(_=>_.id===$.value);return P?P.name:null}),n=j(()=>{switch(F.value){case"name":return"Nombre (A-Z)";case"recent":default:return"M√°s recientes"}}),y=j(()=>{const P=x.value&&x.value.trim().length>0,_=$.value!==null;return P&&_?"No se encontraron plantillas que coincidan con tu b√∫squeda y filtros":P?"No se encontraron plantillas que coincidan con tu b√∫squeda":_?"No se encontraron plantillas con la etiqueta seleccionada":"A√∫n no hay plantillas disponibles para usar"}),g=P=>{const _=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],q=P.id%_.length;return _[q]},T=P=>{const _=["bg-blue-500","bg-purple-500","bg-pink-500","bg-yellow-500","bg-green-500","bg-red-500","bg-indigo-500","bg-orange-500"],q=P.id%_.length;return _[q]},w=()=>{$.value=null},B=P=>{const V=`/dynamic_document_dashboard/document/use/${P.state==="Published"&&!P.assigned_to?"creator":"editor"}/${P.id}/${encodeURIComponent(P.title.trim())}`;c.push(V)},Y=()=>{S("go-back")};return qe(async()=>{(!i.documents||i.documents.length===0)&&await i.init(!0)}),(P,_)=>(o(),l("div",null,[e("div",ra,[e("button",{onClick:Y,class:"inline-flex items-center gap-2 px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 rounded-lg transition-colors border border-gray-300"},[s(t(hs),{class:"h-4 w-4"}),te(" Volver a Mis Documentos ")])]),e("div",na,[e("div",la,[e("div",aa,[e("div",ia,[s(t(Qe),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),Me(e("input",{"onUpdate:modelValue":_[0]||(_[0]=q=>x.value=q),type:"text",placeholder:"Buscar plantillas...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent"},null,512),[[ze,x.value]])]),s(t(Fe),{as:"div",class:"relative"},{default:m(()=>[s(t(Ae),{class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:m(()=>[s(t(tt),{class:"h-4 w-4"}),e("span",da,h(E.value||"Etiqueta"),1),s(t(Ne),{class:"h-4 w-4"})]),_:1}),s(t(Te),{class:"absolute left-0 z-10 mt-2 w-64 origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",ca,[e("div",ua,[s(t(Qe),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),Me(e("input",{"onUpdate:modelValue":_[1]||(_[1]=q=>u.value=q),type:"text",placeholder:"Buscar etiquetas...",class:"w-full pl-9 pr-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent",onClick:_[2]||(_[2]=ve(()=>{},["stop"]))},null,512),[[ze,u.value]])]),e("div",ma,[s(t(re),null,{default:m(({active:q})=>[e("a",{onClick:_[3]||(_[3]=V=>$.value=null),class:b([q?"bg-gray-100":"","block px-3 py-2 text-sm text-gray-700 cursor-pointer rounded-md"])}," Todos ",2)]),_:1}),(o(!0),l(le,null,me(J.value,q=>(o(),ee(t(re),{key:q.id},{default:m(({active:V})=>[e("a",{onClick:R=>$.value=q.id,class:b([V?"bg-gray-100":"","flex items-center gap-2 px-3 py-2 text-sm cursor-pointer rounded-md"])},[e("span",{class:b(["w-3 h-3 rounded-full flex-shrink-0",T(q)])},null,2),e("span",pa,h(q.name),1)],10,ga)]),_:2},1024))),128)),J.value.length===0?(o(),l("div",ha," No se encontraron etiquetas ")):D("",!0)])])]),_:1})]),_:1}),$.value?(o(),l("button",{key:0,onClick:w,class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",title:"Limpiar filtros"},[s(t(Le),{class:"h-4 w-4"}),te(" Limpiar ")])):D("",!0)]),e("div",fa,[e("span",va," Mostrando "+h(K.value.length)+" plantillas ",1),s(t(Fe),{as:"div",class:"relative"},{default:m(()=>[s(t(Ae),{class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:m(()=>[te(" Ordenar: "+h(n.value)+" ",1),s(t(Ne),{class:"h-4 w-4"})]),_:1}),s(t(Te),{class:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",ba,[s(t(re),null,{default:m(({active:q})=>[e("a",{onClick:_[4]||(_[4]=V=>F.value="recent"),class:b([q?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," M√°s recientes ",2)]),_:1}),s(t(re),null,{default:m(({active:q})=>[e("a",{onClick:_[5]||(_[5]=V=>F.value="name"),class:b([q?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Nombre (A-Z) ",2)]),_:1})])]),_:1})]),_:1})])])]),K.value.length>0?(o(),l("div",ya,[e("div",xa,[e("table",_a,[wa,e("tbody",$a,[(o(!0),l(le,null,me(K.value,q=>(o(),l("tr",{key:q.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:V=>B(q)},[e("td",Ca,[e("div",Da,[e("div",Sa,[e("div",Ea,[s(t(Re),{class:"h-5 w-5 text-purple-600"})])]),e("div",Fa,[e("div",Aa,h(q.title),1)])])]),Ta,e("td",Ma,[e("div",La,[(o(!0),l(le,null,me(q.tags,V=>(o(),l("span",{key:V.id,class:b(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",g(V)])},h(V.name),3))),128)),!q.tags||q.tags.length===0?(o(),l("span",Pa,"-")):D("",!0)])]),e("td",{class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",onClick:_[6]||(_[6]=ve(()=>{},["stop"]))},[s(t(Fe),{as:"div",class:"relative inline-block text-left"},{default:m(()=>[s(t(Ae),{class:"inline-flex items-center justify-center w-8 h-8 rounded-md hover:bg-gray-100"},{default:m(()=>[s(t(et),{class:"h-5 w-5 text-gray-500"})]),_:1}),s(t(Te),{class:"absolute right-0 z-[9999] mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",Ia,[s(t(re),null,{default:m(({active:V})=>[e("a",{onClick:R=>B(q),class:b([V?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Usar plantilla ",10,ja)]),_:2},1024)])]),_:2},1024)]),_:2},1024)])],8,ka))),128))])])])])):(o(),l("div",Ba,[s(t(rt),{class:"mx-auto h-12 w-12 text-gray-400"}),Ua,e("p",Na,h(y.value),1),qa]))]))}};function Oa(r){return!r.variables||r.variables.length===0?!0:r.variables.every(f=>f.name_es&&f.name_es.trim().length>0)}function zt(r,f){var S;if(!r.requires_signature||r.state!=="PendingSignatures"||!r.signatures||r.signatures.length===0)return!1;const i=(S=f==null?void 0:f.currentUser)==null?void 0:S.email,c=r.signatures.find(x=>x.signer_email===i);return!(!c||c.signed)}const Ra={lawyer:{getMenuOptions:(r,f,i)=>{const c=[{label:"Editar",action:"edit"},{label:"Permisos",action:"permissions"},{label:"Administrar Asociaciones",action:"relationships"},{label:"Eliminar",action:"delete"},{label:"Previsualizaci√≥n",action:"preview"},{label:"Crear una Copia",action:"copy"},{label:"Gestionar Membrete",action:"letterhead"}];return r.state==="Draft"?c.push({label:"Publicar",action:"publish",disabled:!Oa(r)}):r.state==="Published"&&(c.push({label:"Mover a Borrador",action:"draft"}),c.push({label:"Formalizar y Agregar Firmas",action:"formalize"})),(r.state==="Completed"||r.state==="Published")&&c.push({label:"Descargar PDF",action:"downloadPDF"},{label:"Descargar Word",action:"downloadWord"},{label:"Enviar por Email",action:"email"}),r.requires_signature&&(c.push({label:"Ver Firmas",action:"viewSignatures"}),zt(r,i)&&c.push({label:"Firmar documento",action:"sign"})),c}},signatures:{getMenuOptions:(r,f,i)=>{const c=[{label:"Previsualizar",action:"preview"},{label:"Gestionar Membrete",action:"letterhead"}];return r.requires_signature&&(r.state==="PendingSignatures"||r.state==="FullySigned")&&c.push({label:"Estado de las firmas",action:"viewSignatures"}),zt(r,i)&&c.push({label:"Firmar documento",action:"sign"}),r.state==="FullySigned"&&c.push({label:"Descargar Documento firmado",action:"downloadSignedDocument"}),r.state==="PendingSignatures"&&c.push({label:"Descargar PDF",action:"downloadPDF"}),c}},client:{getMenuOptions:(r,f,i)=>{var x;const c=[],S=((x=i==null?void 0:i.currentUser)==null?void 0:x.role)==="basic";return r.state==="Completed"?c.push({label:"Editar",action:"edit-submenu",isGroup:!0,children:[{label:"Editar Formulario",action:"editForm"},{label:"Editar Documento",action:"editDocument"}]}):c.push({label:"Completar",action:"editForm"}),r.state==="Completed"&&c.push({label:"Previsualizar",action:"preview"}),c.push({label:"Eliminar",action:"delete"}),S?c.push({label:"Gestionar Membrete",action:"letterhead",disabled:!0}):c.push({label:"Gestionar Membrete",action:"letterhead"}),c.push({label:"Administrar Asociaciones",action:"relationships"}),r.state==="Completed"&&c.push({label:"Descargar PDF",action:"downloadPDF"},{label:"Descargar Word",action:"downloadWord"},{label:"Enviar",action:"email"}),c}}};function Va(r,f,i="list",c=null){const S=Ra[r];return S?S.getMenuOptions(f,i,c):[]}const Qa={class:"relative bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col"},Ga={class:"px-6 py-4 border-b border-gray-200"},Za=e("h2",{class:"text-xl font-semibold text-gray-800"},"Acciones del Documento",-1),Wa={class:"text-sm text-gray-500 mt-1"},Ha={class:"p-6 overflow-y-auto flex-grow"},Ka={class:"space-y-4"},Ja={key:0,class:"text-sm font-semibold text-gray-700 uppercase tracking-wide px-2"},Ya={class:"grid grid-cols-1 sm:grid-cols-2 gap-2"},Xa=["onClick","disabled"],ei={class:"text-sm font-medium"},ti={key:1,class:"border-t border-gray-200 my-4"},si={key:0,class:"text-center py-12"},oi=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No hay acciones disponibles",-1),ri=e("p",{class:"mt-1 text-sm text-gray-500"}," No hay opciones disponibles para este documento. ",-1),Et={__name:"DocumentActionsModal",props:{isVisible:{type:Boolean,default:!1},document:{type:Object,default:null},cardType:{type:String,required:!0,validator:r=>["lawyer","client","signatures"].includes(r)},context:{type:String,default:"table"},userStore:{type:Object,default:null}},emits:["close","action"],setup(r,{emit:f}){const i=r,c=f,S=j(()=>i.document?Va(i.cardType,i.document,i.context,i.userStore):[]),x=j(()=>{const E=S.value;if(!E||E.length===0)return[];const n=[],y={edit:"Edici√≥n",view:"Visualizaci√≥n",share:"Compartir",manage:"Gesti√≥n",signatures:"Firmas",delete:"Eliminaci√≥n"},g={edit:[],view:[],share:[],manage:[],signatures:[],delete:[]};return E.forEach(T=>{if(T.children&&Array.isArray(T.children))T.children.forEach(w=>{const B=w.action.toLowerCase();u(w,B,g)});else{const w=T.action.toLowerCase();u(T,w,g)}}),g.edit.length>0&&n.push({title:y.edit,options:g.edit}),g.view.length>0&&n.push({title:y.view,options:g.view}),g.share.length>0&&n.push({title:y.share,options:g.share}),g.signatures.length>0&&n.push({title:y.signatures,options:g.signatures}),g.manage.length>0&&n.push({title:y.manage,options:g.manage}),g.delete.length>0&&n.push({title:y.delete,options:g.delete}),n}),u=(E,n,y)=>{n.includes("edit")||n.includes("editar")||n==="copy"||n==="draft"||n==="publish"||n==="formalize"||n==="completar"?y.edit.push(E):n.includes("view")||n.includes("preview")||n.includes("ver")||n.includes("previsualizaci√≥n")?y.view.push(E):n.includes("download")||n.includes("email")||n.includes("enviar")||n.includes("descargar")?y.share.push(E):n.includes("signature")||n.includes("firma")||n.includes("sign")?y.signatures.push(E):n.includes("permission")||n.includes("relationship")||n.includes("letterhead")||n.includes("permiso")||n.includes("asociaci√≥n")||n.includes("membrete")?y.manage.push(E):n.includes("delete")||n.includes("eliminar")?y.delete.push(E):y.manage.push(E)},$=E=>{const n=E.toLowerCase();return n==="editform"||n.includes("completar")?qt:n==="editdocument"||n.includes("editar documento")?Ut:n.includes("edit")||n==="editar"?Ut:n.includes("delete")||n==="eliminar"?Zt:n.includes("preview")||n.includes("ver")||n.includes("previsualizaci√≥n")?Gt:n==="copy"||n.includes("copia")?cs:n.includes("download")||n.includes("descargar")?nt:n.includes("email")||n.includes("enviar")?ls:n.includes("permission")||n.includes("permiso")?ps:n.includes("relationship")||n.includes("asociaci√≥n")?fs:n.includes("letterhead")||n.includes("membrete")?Ht:n.includes("signature")||n.includes("firma")?Wt:n==="publish"||n.includes("publicar")?xs:n==="draft"||n.includes("borrador")?Re:n==="formalize"||n.includes("formalizar")?qt:ct},F=E=>{const n=E.toLowerCase();return n.includes("delete")||n==="eliminar"?"text-red-600":n.includes("download")||n.includes("descargar")?"text-blue-600":n.includes("email")||n.includes("enviar")?"text-green-600":n.includes("signature")||n.includes("firma")?"text-purple-600":"text-gray-600"},U=E=>{const n=E.toLowerCase();return n.includes("delete")||n==="eliminar"?"border-red-200 bg-red-50 text-red-700 hover:bg-red-100 hover:border-red-300":n.includes("download")||n.includes("descargar")?"border-blue-200 bg-blue-50 text-blue-700 hover:bg-blue-100 hover:border-blue-300":n.includes("email")||n.includes("enviar")?"border-green-200 bg-green-50 text-green-700 hover:bg-green-100 hover:border-green-300":n.includes("signature")||n.includes("firma")?"border-purple-200 bg-purple-50 text-purple-700 hover:bg-purple-100 hover:border-purple-300":"border-gray-200 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-300"},{handleFeatureAccess:K}=Pt(),O=E=>{const n=S.value.find(g=>g.action===E?g:g.children?g.children.find(T=>T.action===E):null),y=n!=null&&n.children?n.children.find(g=>g.action===E):n;if(y!=null&&y.disabled){K("Esta funcionalidad",null);return}c("action",E,i.document)},J=()=>{c("close")};return(E,n)=>Me((o(),ee(Ye,null,{default:m(()=>{var y;return[e("div",Qa,[e("div",Ga,[Za,e("p",Wa,h(((y=r.document)==null?void 0:y.title)||"Cargando..."),1),e("button",{onClick:J,class:"absolute top-4 right-4 text-gray-400 hover:text-gray-500 transition-colors"},[s(t(Le),{class:"h-6 w-6"})])]),e("div",Ha,[e("div",Ka,[(o(!0),l(le,null,me(x.value,(g,T)=>(o(),l("div",{key:T,class:"space-y-2"},[g.title?(o(),l("h3",Ja,h(g.title),1)):D("",!0),e("div",Ya,[(o(!0),l(le,null,me(g.options,w=>(o(),l("button",{key:w.action,onClick:B=>O(w.action),disabled:w.disabled,class:b(["flex items-center justify-start px-4 py-3 rounded-lg border transition-all duration-200",w.disabled?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed opacity-60":U(w.action),"hover:shadow-md hover:scale-[1.02]"])},[(o(),ee(ns($(w.action)),{class:b(["h-5 w-5 mr-3 flex-shrink-0",w.disabled?"text-gray-400":F(w.action)])},null,8,["class"])),e("span",ei,h(w.label),1),w.disabled?(o(),ee(t(ds),{key:0,class:"h-4 w-4 ml-auto text-gray-400"})):D("",!0)],10,Xa))),128))]),T<x.value.length-1?(o(),l("div",ti)):D("",!0)]))),128)),x.value.length===0?(o(),l("div",si,[s(t(ct),{class:"mx-auto h-12 w-12 text-gray-400"}),oi,ri])):D("",!0)])])])]}),_:1},512)),[[kt,r.isVisible]])}},He=r=>(mt("data-v-f7aff6da"),r=r(),gt(),r),ni={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-3 sm:p-4 mb-6"},li={class:"mb-4"},ai={class:"relative w-full"},ii={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-4"},di={class:"flex items-center gap-2 min-w-0"},ci={class:"truncate"},ui={class:"py-1"},mi=["onClick"],gi={class:"flex items-center gap-2 min-w-0"},pi={class:"truncate"},hi={class:"p-2"},fi={class:"relative mb-2"},vi={class:"max-h-60 overflow-y-auto"},bi=["onClick"],yi={class:"truncate"},xi={key:0,class:"px-3 py-2 text-sm text-gray-500 text-center"},_i={class:"flex items-center justify-stretch"},wi=He(()=>e("span",null,"Limpiar",-1)),$i={class:"flex flex-col gap-3 pt-4 border-t border-gray-200"},ki={class:"flex flex-col sm:flex-row gap-3 items-start sm:items-center justify-between"},Ci={class:"text-sm text-gray-500"},Di={class:"font-medium"},Si=He(()=>e("span",{class:"hidden sm:inline"},"Ordenar:",-1)),Ei={class:"py-1"},Fi={class:"flex items-center gap-2"},Ai=He(()=>e("span",{class:"hidden sm:inline"},"Exportar",-1)),Ti={class:"py-1"},Mi={class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",style:{"overflow-x":"visible","overflow-y":"hidden"}},Li={class:"overflow-x-auto",style:{"overflow-y":"visible"}},Pi={class:"min-w-full divide-y divide-gray-200"},Ii={class:"bg-gray-50"},ji={scope:"col",class:"w-12 px-6 py-3"},Bi=["checked"],Ui=He(()=>e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Nombre Minuta ",-1)),Ni=He(()=>e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado ",-1)),qi=He(()=>e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etiqueta ",-1)),zi={class:"bg-white divide-y divide-gray-200"},Oi=["onClick"],Ri=["checked","onChange"],Vi={class:"px-6 py-4 whitespace-nowrap"},Qi={class:"flex items-center"},Gi={class:"flex-shrink-0 h-10 w-10"},Zi={class:"h-10 w-10 rounded-lg bg-blue-100 flex items-center justify-center"},Wi={class:"ml-4"},Hi={class:"text-sm font-medium text-gray-900"},Ki={class:"px-6 py-4 whitespace-nowrap"},Ji={class:"px-6 py-4 whitespace-nowrap"},Yi={class:"flex flex-wrap gap-1"},Xi={key:0,class:"text-sm text-gray-400"},ed={key:0,class:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"},td={class:"flex flex-1 justify-between sm:hidden"},sd=["disabled"],od=["disabled"],rd={class:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between"},nd={class:"text-sm text-gray-700"},ld={class:"font-medium"},ad={class:"font-medium"},id={class:"font-medium"},dd={class:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination"},cd=["disabled"],ud=He(()=>e("span",{class:"sr-only"},"Anterior",-1)),md=["onClick"],gd={key:1,class:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700"},pd=["disabled"],hd=He(()=>e("span",{class:"sr-only"},"Siguiente",-1)),fd={key:0,class:"text-center py-12"},vd=He(()=>e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No hay documentos",-1)),bd=He(()=>e("p",{class:"mt-1 text-sm text-gray-500"},"No se encontraron documentos con los filtros seleccionados.",-1)),yd={__name:"DocumentListLawyer",props:{searchQuery:String,selectedTags:{type:Array,default:()=>[]},promptDocuments:{type:Array,default:null}},emits:["refresh"],setup(r,{emit:f}){const i=Oe(),c=We(),S=Xe(),x=f,{activeModals:u,openModal:$,closeModal:F,getUserRole:U}=ft(i,c),{handlePreviewDocument:K,deleteDocument:O,downloadPDFDocument:J,downloadWordDocument:E,copyDocument:n,publishDocument:y,moveToDraft:g,formalizeDocument:T,signDocument:w,downloadSignedDocument:B}=vt(i,c,x),Y=L([]),P=L([]),_=r,q=L(""),V=L(""),R=L(null),X=L(null),ye=L("recent"),Z=L([]),A=L(1),oe=L(10),pe=I=>{switch(I.state){case"Published":return"Publicado";case"Draft":return"Borrador";case"Progress":return"En progreso";case"Completed":return"Completado";case"PendingSignatures":return"Pendiente de firmas";case"FullySigned":return"Completamente firmado";default:return"Desconocido"}},be=I=>{switch(I.state){case"Published":case"FullySigned":return"bg-green-100 text-green-700 border border-green-200";case"Draft":case"Progress":return"bg-blue-100 text-blue-700 border border-blue-200";case"PendingSignatures":return"bg-yellow-100 text-yellow-700 border border-yellow-200";case"Completed":return"bg-purple-100 text-purple-700 border border-purple-200";default:return"bg-gray-100 text-gray-700 border border-gray-200"}},ce=I=>{const v=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],W=I.id%v.length;return v[W]},xe=I=>{switch(I){case"Published":return"Publicado";case"Draft":return"Borrador";case"Progress":return"En progreso";case"Completed":return"Completado";case"PendingSignatures":return"Pendiente de firmas";case"FullySigned":return"Completamente firmado";default:return I}},ge=j(()=>{const I=new Set;return ue.value.forEach(v=>{v.state&&I.add(v.state)}),Array.from(I).sort()}),he=j(()=>{const I=new Map;return ue.value.forEach(v=>{v.tags&&v.tags.length>0&&v.tags.forEach(W=>{I.has(W.id)||I.set(W.id,W)})}),Array.from(I.values()).sort((v,W)=>v.name.localeCompare(W.name))}),Pe=j(()=>{if(!V.value)return he.value;const I=V.value.toLowerCase();return he.value.filter(v=>v.name.toLowerCase().includes(I))}),je=j(()=>{if(!X.value)return null;const I=he.value.find(v=>v.id===X.value);return I?I.name:null}),Ve=I=>{const v=["bg-blue-500","bg-purple-500","bg-pink-500","bg-yellow-500","bg-green-500","bg-red-500","bg-indigo-500","bg-orange-500"],W=I.id%v.length;return v[W]},ue=j(()=>{if(_.promptDocuments)return[];const v=(i.getDocumentsByLawyerId(c.currentUser.id)||[]).filter($e=>$e.state!=="FullySigned"),W=_.selectedTags?_.selectedTags.map($e=>$e.id):[];return i.filteredDocumentsBySearchAndTags(_.searchQuery,c,W).filter($e=>v.some(_e=>_e.id===$e.id))}),ie=j(()=>{if(_.promptDocuments&&_.promptDocuments.length>0){let I=_.promptDocuments.filter(v=>v.title&&v.title.toLowerCase().includes((_.searchQuery||"").toLowerCase()));if(_.selectedTags&&_.selectedTags.length>0){const v=_.selectedTags.map(W=>W.id);I=I.filter(W=>!W.tags||W.tags.length===0?!1:W.tags.some(N=>v.includes(N.id)))}return I}return[]}),De=j(()=>_.promptDocuments?ie.value:ue.value),fe=j(()=>{let I=[...De.value];const v=q.value.toLowerCase();return v&&(I=I.filter(W=>{var N,$e,_e;return((N=W.title)==null?void 0:N.toLowerCase().includes(v))||(($e=W.state)==null?void 0:$e.toLowerCase().includes(v))||((_e=W.tags)==null?void 0:_e.some(Ft=>{var Ze;return(Ze=Ft.name)==null?void 0:Ze.toLowerCase().includes(v)}))})),R.value&&(I=I.filter(W=>W.state===R.value)),X.value&&(I=I.filter(W=>W.tags&&W.tags.some(N=>N.id===X.value))),ye.value==="name"?I.sort((W,N)=>{const $e=(W.title||"").toLowerCase(),_e=(N.title||"").toLowerCase();return $e.localeCompare(_e)}):ye.value==="recent"&&I.sort((W,N)=>N.id-W.id),I}),ne=j(()=>{const I=(A.value-1)*oe.value,v=I+oe.value;return fe.value.slice(I,v)}),Se=j(()=>Math.ceil(fe.value.length/oe.value)),Ge=j(()=>{const I=(A.value-1)*oe.value+1,v=Math.min(A.value*oe.value,fe.value.length);return{start:I,end:v,total:fe.value.length}});ke([q,R,X],()=>{A.value=1});const p=j(()=>{switch(ye.value){case"name":return"Nombre (A-Z)";case"recent":default:return"M√°s recientes"}});j(()=>{if(_.promptDocuments)return null;const I=i.lastUpdatedDocumentId,v=localStorage.getItem("lastUpdatedDocumentId"),W=[...ue.value];return I&&W.some(_e=>String(_e.id)===String(I))?I:v&&W.some(_e=>String(_e.id)===String(v))?v:null});const d=async()=>{try{const I=c.currentUser.id,v=await $t(`dynamic-documents/user/${I}/pending-documents-full/`),W=await $t(`dynamic-documents/user/${I}/signed-documents/`);v.status===200&&(Y.value=v.data),W.status===200&&(P.value=W.data)}catch(I){console.error("Error fetching lawyer documents:",I),I.response&&(console.error("Error response data:",I.response.data),console.error("Error status:",I.response.status))}};ke(De,I=>{if(!_.promptDocuments&&i.lastUpdatedDocumentId&&!I.some(W=>String(W.id)===String(i.lastUpdatedDocumentId))&&I.length>0){const N=[...I].sort(($e,_e)=>_e.id-$e.id)[0].id;i.lastUpdatedDocumentId=N,localStorage.setItem("lastUpdatedDocumentId",N)}});const a=I=>{I&&setTimeout(()=>{try{const v=document.querySelectorAll(`[data-document-id="${I}"]`);if(v.length>0){const W=v[0];W.classList.remove("animate-pulse-highlight-green","animate-pulse-highlight-blue"),W.offsetWidth,(W.querySelector("[data-document-id]")||W).classList.contains("border-green-400")?W.classList.add("animate-pulse-highlight-green"):W.classList.add("animate-pulse-highlight-blue"),W.scrollIntoView({behavior:"smooth",block:"center"})}}catch(v){console.error("Error forcing highlight:",v)}},100)};window.forceDocumentHighlight=a,qe(async()=>{if(_.promptDocuments)return;await i.init();const I=localStorage.getItem("lastUpdatedDocumentId");I&&(i.lastUpdatedDocumentId=I,setTimeout(()=>{De.value.some(W=>String(W.id)===String(I))&&a(I)},500)),d()});const G=j(()=>fe.value.length>0&&Z.value.length===fe.value.length),k=()=>{G.value?Z.value=[]:Z.value=fe.value.map(I=>I.id)},M=I=>{const v=Z.value.indexOf(I);v>-1?Z.value.splice(v,1):Z.value.push(I)},C=()=>{Z.value=fe.value.map(I=>I.id)},se=()=>{Z.value=[]},de=()=>{R.value=null,X.value=null},Q=()=>{A.value>1&&A.value--},z=()=>{A.value<Se.value&&A.value++},ae=I=>{I>=1&&I<=Se.value&&(A.value=I)},H=j(()=>{const I=Se.value,v=A.value,W=[];if(I<=7)for(let N=1;N<=I;N++)W.push(N);else if(v<=4){for(let N=1;N<=5;N++)W.push(N);W.push("..."),W.push(I)}else if(v>=I-3){W.push(1),W.push("...");for(let N=I-4;N<=I;N++)W.push(N)}else W.push(1),W.push("..."),W.push(v-1),W.push(v),W.push(v+1),W.push("..."),W.push(I);return W}),Ce=()=>{const I=Z.value.length>0?fe.value.filter(Ze=>Z.value.includes(Ze.id)):fe.value,v=["Nombre Minuta","Estado","Etiquetas"],W=I.map(Ze=>[Ze.title||"",pe(Ze),Ze.tags?Ze.tags.map(At=>At.name).join(", "):""]),N=[v.join(","),...W.map(Ze=>Ze.map(At=>`"${At}"`).join(","))].join(`
`),$e=new Blob([N],{type:"text/csv;charset=utf-8;"}),_e=document.createElement("a"),Ft=URL.createObjectURL($e);_e.setAttribute("href",Ft),_e.setAttribute("download",`documentos_${new Date().toISOString().split("T")[0]}.csv`),_e.style.visibility="hidden",document.body.appendChild(_e),_e.click(),document.body.removeChild(_e)},Ee=async(I,v)=>{try{switch(I){case"edit":S.push(`/dynamic_document_dashboard/lawyer/editor/edit/${v.id}`);break;case"permissions":$("permissions",v);break;case"relationships":$("relationships",v);break;case"preview":await K(v);break;case"delete":await O(v);break;case"downloadPDF":await J(v);break;case"downloadWord":await E(v);break;case"email":$("email",v);break;case"copy":await n(v);break;case"publish":await y(v);break;case"draft":await g(v);break;case"formalize":await T(v);break;case"viewSignatures":$("signatures",v);break;case"sign":await w(v,$);break;case"letterhead":$("letterhead",v);break;default:console.warn("Unknown action:",I)}}catch(W){console.error(`Error executing action ${I}:`,W)}},Ie=L(!1),Be=L(null),at=I=>{Be.value=I,Ie.value=!0},Jt=async(I,v)=>{Ie.value=!1,await Ee(I,v)};return(I,v)=>{var W;return o(),l("div",null,[e("div",ni,[e("div",li,[e("div",ai,[s(t(Qe),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),Me(e("input",{"onUpdate:modelValue":v[0]||(v[0]=N=>q.value=N),type:"text",placeholder:"Buscar...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent text-sm"},null,512),[[ze,q.value]])])]),e("div",ii,[s(t(Fe),{as:"div",class:"relative"},{default:m(()=>[s(t(Ae),{class:"w-full inline-flex items-center justify-between gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:m(()=>[e("div",di,[s(t(tt),{class:"h-4 w-4 flex-shrink-0"}),e("span",ci,h(R.value||"Estado"),1)]),s(t(Ne),{class:"h-4 w-4 flex-shrink-0"})]),_:1}),s(t(Te),{class:"absolute left-0 z-10 mt-2 w-full min-w-[14rem] origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",ui,[s(t(re),null,{default:m(({active:N})=>[e("a",{onClick:v[1]||(v[1]=$e=>R.value=null),class:b([N?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Todos ",2)]),_:1}),(o(!0),l(le,null,me(ge.value,N=>(o(),ee(t(re),{key:N},{default:m(({active:$e})=>[e("a",{onClick:_e=>R.value=N,class:b([$e?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])},h(xe(N)),11,mi)]),_:2},1024))),128))])]),_:1})]),_:1}),s(t(Fe),{as:"div",class:"relative"},{default:m(()=>[s(t(Ae),{class:"w-full inline-flex items-center justify-between gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:m(()=>[e("div",gi,[s(t(tt),{class:"h-4 w-4 flex-shrink-0"}),e("span",pi,h(je.value||"Etiqueta"),1)]),s(t(Ne),{class:"h-4 w-4 flex-shrink-0"})]),_:1}),s(t(Te),{class:"absolute left-0 z-10 mt-2 w-full min-w-[16rem] origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",hi,[e("div",fi,[s(t(Qe),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),Me(e("input",{"onUpdate:modelValue":v[2]||(v[2]=N=>V.value=N),type:"text",placeholder:"Buscar etiquetas...",class:"w-full pl-9 pr-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent",onClick:v[3]||(v[3]=ve(()=>{},["stop"]))},null,512),[[ze,V.value]])]),e("div",vi,[s(t(re),null,{default:m(({active:N})=>[e("a",{onClick:v[4]||(v[4]=$e=>X.value=null),class:b([N?"bg-gray-100":"","block px-3 py-2 text-sm text-gray-700 cursor-pointer rounded-md"])}," Todos ",2)]),_:1}),(o(!0),l(le,null,me(Pe.value,N=>(o(),ee(t(re),{key:N.id},{default:m(({active:$e})=>[e("a",{onClick:_e=>X.value=N.id,class:b([$e?"bg-gray-100":"","flex items-center gap-2 px-3 py-2 text-sm cursor-pointer rounded-md"])},[e("span",{class:b(["w-3 h-3 rounded-full flex-shrink-0",Ve(N)])},null,2),e("span",yi,h(N.name),1)],10,bi)]),_:2},1024))),128)),Pe.value.length===0?(o(),l("div",xi," No se encontraron etiquetas ")):D("",!0)])])]),_:1})]),_:1}),e("div",_i,[R.value||X.value?(o(),l("button",{key:0,onClick:de,class:"w-full inline-flex items-center justify-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",title:"Limpiar filtros"},[s(t(Le),{class:"h-4 w-4 flex-shrink-0"}),wi])):D("",!0)])]),e("div",$i,[e("div",ki,[e("div",Ci,[e("span",Di,h(fe.value.length),1),te(" resultados ")]),s(t(Fe),{as:"div",class:"relative"},{default:m(()=>[s(t(Ae),{class:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:m(()=>[Si,te(" "+h(p.value)+" ",1),s(t(Ne),{class:"h-4 w-4"})]),_:1}),s(t(Te),{class:"absolute left-0 sm:left-auto sm:right-0 z-10 mt-2 w-48 origin-top-left sm:origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",Ei,[s(t(re),null,{default:m(({active:N})=>[e("a",{onClick:v[5]||(v[5]=$e=>ye.value="recent"),class:b([N?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," M√°s recientes ",2)]),_:1}),s(t(re),null,{default:m(({active:N})=>[e("a",{onClick:v[6]||(v[6]=$e=>ye.value="name"),class:b([N?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Nombre (A-Z) ",2)]),_:1})])]),_:1})]),_:1})]),e("div",Fi,[e("button",{onClick:Ce,class:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},[s(t(nt),{class:"h-4 w-4"}),Ai]),s(t(Fe),{as:"div",class:"relative"},{default:m(()=>[s(t(Ae),{class:"inline-flex items-center justify-center w-10 h-10 rounded-md hover:bg-gray-100"},{default:m(()=>[s(t(et),{class:"h-5 w-5 text-gray-500"})]),_:1}),s(t(Te),{class:"absolute left-0 sm:left-auto sm:right-0 z-10 mt-2 w-48 origin-top-left sm:origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",Ti,[s(t(re),null,{default:m(({active:N})=>[e("a",{onClick:C,class:b([N?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Seleccionar todo ",2)]),_:1}),s(t(re),null,{default:m(({active:N})=>[e("a",{onClick:se,class:b([N?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Deseleccionar todo ",2)]),_:1})])]),_:1})]),_:1})])])]),e("div",Mi,[e("div",Li,[e("table",Pi,[e("thead",Ii,[e("tr",null,[e("th",ji,[e("input",{type:"checkbox",checked:G.value,onChange:k,class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,Bi)]),Ui,Ni,qi])]),e("tbody",zi,[(o(!0),l(le,null,me(ne.value,(N,$e)=>(o(),l("tr",{key:N.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:_e=>at(N)},[e("td",{class:"px-6 py-4 whitespace-nowrap",onClick:v[7]||(v[7]=ve(()=>{},["stop"]))},[e("input",{type:"checkbox",checked:Z.value.includes(N.id),onChange:_e=>M(N.id),class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,Ri)]),e("td",Vi,[e("div",Qi,[e("div",Gi,[e("div",Zi,[s(t(Re),{class:"h-5 w-5 text-blue-600"})])]),e("div",Wi,[e("div",Hi,h(N.title),1)])])]),e("td",Ki,[e("span",{class:b(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",be(N)])},h(pe(N)),3)]),e("td",Ji,[e("div",Yi,[(o(!0),l(le,null,me(N.tags,_e=>(o(),l("span",{key:_e.id,class:b(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",ce(_e)])},h(_e.name),3))),128)),!N.tags||N.tags.length===0?(o(),l("span",Xi,"-")):D("",!0)])])],8,Oi))),128))])])]),Se.value>1?(o(),l("div",ed,[e("div",td,[e("button",{onClick:Q,disabled:A.value===1,class:b(["relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",A.value===1?"opacity-50 cursor-not-allowed":""])}," Anterior ",10,sd),e("button",{onClick:z,disabled:A.value===Se.value,class:b(["relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",A.value===Se.value?"opacity-50 cursor-not-allowed":""])}," Siguiente ",10,od)]),e("div",rd,[e("div",null,[e("p",nd,[te(" Mostrando "),e("span",ld,h(Ge.value.start),1),te(" a "),e("span",ad,h(Ge.value.end),1),te(" de "),e("span",id,h(Ge.value.total),1),te(" resultados ")])]),e("div",null,[e("nav",dd,[e("button",{onClick:Q,disabled:A.value===1,class:b(["relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",A.value===1?"opacity-50 cursor-not-allowed":""])},[ud,s(t(pt),{class:"h-5 w-5","aria-hidden":"true"})],10,cd),(o(!0),l(le,null,me(H.value,N=>(o(),l(le,{key:N},[N!=="..."?(o(),l("button",{key:0,onClick:$e=>ae(N),class:b(["relative inline-flex items-center px-4 py-2 text-sm font-semibold focus:z-20 focus:outline-offset-0",A.value===N?"z-10 bg-secondary text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-secondary":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50"])},h(N),11,md)):(o(),l("span",gd," ... "))],64))),128)),e("button",{onClick:z,disabled:A.value===Se.value,class:b(["relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",A.value===Se.value?"opacity-50 cursor-not-allowed":""])},[hd,s(t(ot),{class:"h-5 w-5","aria-hidden":"true"})],10,pd)])])])])):D("",!0)]),fe.value.length===0?(o(),l("div",fd,[s(t(rt),{class:"mx-auto h-12 w-12 text-gray-400"}),vd,bd])):D("",!0),s(Mt,{isVisible:t(st),documentData:t(Tt),onClose:v[8]||(v[8]=N=>st.value=!1)},null,8,["isVisible","documentData"]),(o(),ee(ht,{to:"body"},[t(u).edit.isOpen?(o(),ee(t(Ct),{key:0,document:t(u).edit.document,"user-role":t(U)(),onClose:v[9]||(v[9]=N=>t(F)("edit")),onRefresh:v[10]||(v[10]=N=>x("refresh"))},null,8,["document","user-role"])):D("",!0),t(u).email.isOpen?(o(),ee(t(Dt),{key:1,document:t(u).email.document,onClose:v[11]||(v[11]=N=>t(F)("email"))},null,8,["document"])):D("",!0),t(u).signatures.isOpen?(o(),ee(t(Qt),{key:2,"document-id":(W=t(u).signatures.document)==null?void 0:W.id,onClose:v[12]||(v[12]=N=>t(F)("signatures")),onRefresh:v[13]||(v[13]=N=>x("refresh"))},null,8,["document-id"])):D("",!0),t(u).permissions.isOpen?(o(),ee(t(us),{key:3,"is-open":t(u).permissions.isOpen,document:t(u).permissions.document,onClose:v[14]||(v[14]=N=>t(F)("permissions")),onSaved:v[15]||(v[15]=N=>x("refresh"))},null,8,["is-open","document"])):D("",!0),t(u).letterhead.isOpen?(o(),ee(bt,{key:4,"is-visible":t(u).letterhead.isOpen,document:t(u).letterhead.document,onClose:v[16]||(v[16]=N=>t(F)("letterhead")),onUploaded:v[17]||(v[17]=N=>x("refresh")),onDeleted:v[18]||(v[18]=N=>x("refresh"))},null,8,["is-visible","document"])):D("",!0),t(u).relationships.isOpen?(o(),ee(St,{key:5,"is-open":t(u).relationships.isOpen,document:t(u).relationships.document,onClose:v[19]||(v[19]=N=>t(F)("relationships")),onRefresh:v[20]||(v[20]=N=>x("refresh"))},null,8,["is-open","document"])):D("",!0),Ie.value?(o(),ee(Et,{key:6,"is-visible":Ie.value,document:Be.value,"card-type":"lawyer",context:"table","user-store":t(c),onClose:v[21]||(v[21]=N=>Ie.value=!1),onAction:Jt},null,8,["is-visible","document","user-store"])):D("",!0)]))])}}},xd=yt(yd,[["__scopeId","data-v-f7aff6da"]]),_d={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-3 sm:p-4 mb-6"},wd={class:"mb-4"},$d={class:"relative w-full"},kd={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-4"},Cd={class:"flex items-center gap-2 min-w-0"},Dd={class:"truncate"},Sd={class:"py-1"},Ed=["onClick"],Fd={class:"flex items-center justify-stretch"},Ad=e("span",null,"Limpiar",-1),Td={class:"flex flex-col gap-3 pt-4 border-t border-gray-200"},Md={class:"flex flex-col sm:flex-row gap-3 items-start sm:items-center justify-between"},Ld={class:"text-sm text-gray-500"},Pd={class:"font-medium"},Id=e("span",{class:"hidden sm:inline"},"Ordenar:",-1),jd={class:"py-1"},Bd={class:"flex items-center gap-2"},Ud=e("span",{class:"hidden sm:inline"},"Exportar",-1),Nd={class:"py-1"},qd={class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",style:{"overflow-x":"visible","overflow-y":"hidden"}},zd={class:"overflow-x-auto",style:{"overflow-y":"visible"}},Od={class:"min-w-full divide-y divide-gray-200"},Rd={class:"bg-gray-50"},Vd={scope:"col",class:"w-12 px-6 py-3"},Qd=["checked"],Gd=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Nombre Documento ",-1),Zd=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Cliente ",-1),Wd=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado ",-1),Hd=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etiqueta ",-1),Kd={class:"bg-white divide-y divide-gray-200"},Jd=["onClick"],Yd=["checked","onChange"],Xd={class:"px-6 py-4 whitespace-nowrap"},ec={class:"flex items-center"},tc={class:"flex-shrink-0 h-10 w-10"},sc={class:"h-10 w-10 rounded-lg bg-green-100 flex items-center justify-center"},oc={class:"ml-4"},rc={class:"text-sm font-medium text-gray-900"},nc={class:"px-6 py-4 whitespace-nowrap"},lc={class:"text-sm text-gray-900"},ac=e("td",{class:"px-6 py-4 whitespace-nowrap"},[e("span",{class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-700 border border-green-200"}," Completado ")],-1),ic={class:"px-6 py-4 whitespace-nowrap"},dc={class:"flex flex-wrap gap-1"},cc={key:0,class:"text-sm text-gray-400"},uc={key:0,class:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"},mc={class:"flex flex-1 justify-between sm:hidden"},gc=["disabled"],pc=["disabled"],hc={class:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between"},fc={class:"text-sm text-gray-700"},vc={class:"font-medium"},bc={class:"font-medium"},yc={class:"font-medium"},xc={class:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination"},_c=["disabled"],wc=e("span",{class:"sr-only"},"Anterior",-1),$c=["onClick"],kc={key:1,class:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700"},Cc=["disabled"],Dc=e("span",{class:"sr-only"},"Siguiente",-1),Sc={key:0,class:"text-center py-12"},Ec=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No hay documentos completados",-1),Fc=e("p",{class:"mt-1 text-sm text-gray-500"},"Los documentos completados por clientes aparecer√°n aqu√≠.",-1),Ac={__name:"DocumentFinishedByClientListTable",props:{searchQuery:String,selectedTags:{type:Array,default:()=>[]}},emits:["refresh"],setup(r,{emit:f}){const i=Oe(),c=We(),S=Xe(),x=r,u=f,{activeModals:$,openModal:F,closeModal:U,getUserRole:K}=ft(i,c),{handlePreviewDocument:O,deleteDocument:J,downloadPDFDocument:E,downloadWordDocument:n}=vt(i,c,u),y=L(""),g=L(null),T=L("recent"),w=L([]),B=L(1),Y=L(10);qe(()=>{i.init(),c.init()});const P=j(()=>{const p=i.completedDocumentsByClient,d=x.selectedTags?x.selectedTags.map(G=>G.id):[];return i.filteredDocumentsBySearchAndTags(x.searchQuery,c,d).filter(G=>p.some(k=>k.id===G.id))}),_=j(()=>{let p=[...P.value];const d=y.value.toLowerCase();return d&&(p=p.filter(a=>{var G,k;return((G=a.title)==null?void 0:G.toLowerCase().includes(d))||((k=a.tags)==null?void 0:k.some(M=>{var C;return(C=M.name)==null?void 0:C.toLowerCase().includes(d)}))})),g.value&&(p=p.filter(a=>a.tags&&a.tags.some(G=>G.id===g.value))),T.value==="name"?p.sort((a,G)=>{const k=(a.title||"").toLowerCase(),M=(G.title||"").toLowerCase();return k.localeCompare(M)}):T.value==="recent"&&p.sort((a,G)=>G.id-a.id),p}),q=j(()=>{const p=(B.value-1)*Y.value,d=p+Y.value;return _.value.slice(p,d)}),V=j(()=>Math.ceil(_.value.length/Y.value)),R=j(()=>{const p=(B.value-1)*Y.value+1,d=Math.min(B.value*Y.value,_.value.length);return{start:p,end:d,total:_.value.length}});ke([y,g],()=>{B.value=1});const X=j(()=>{const p=new Map;return P.value.forEach(d=>{d.tags&&d.tags.length>0&&d.tags.forEach(a=>{p.has(a.id)||p.set(a.id,a)})}),Array.from(p.values()).sort((d,a)=>d.name.localeCompare(a.name))}),ye=j(()=>{if(!g.value)return null;const p=X.value.find(d=>d.id===g.value);return p?p.name:null}),Z=j(()=>{switch(T.value){case"name":return"Nombre (A-Z)";case"recent":default:return"M√°s recientes"}}),A=p=>p.client_name?p.client_name:p.client?`${p.client.first_name||""} ${p.client.last_name||""}`.trim():"Cliente",oe=p=>{const d=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],a=p.id%d.length;return d[a]},pe=j(()=>_.value.length>0&&w.value.length===_.value.length),be=()=>{pe.value?w.value=[]:w.value=_.value.map(p=>p.id)},ce=p=>{const d=w.value.indexOf(p);d>-1?w.value.splice(d,1):w.value.push(p)},xe=()=>{w.value=_.value.map(p=>p.id)},ge=()=>{w.value=[]},he=()=>{g.value=null},Pe=()=>{B.value>1&&B.value--},je=()=>{B.value<V.value&&B.value++},Ve=p=>{p>=1&&p<=V.value&&(B.value=p)},ue=j(()=>{const p=V.value,d=B.value,a=[];if(p<=7)for(let G=1;G<=p;G++)a.push(G);else if(d<=4){for(let G=1;G<=5;G++)a.push(G);a.push("..."),a.push(p)}else if(d>=p-3){a.push(1),a.push("...");for(let G=p-4;G<=p;G++)a.push(G)}else a.push(1),a.push("..."),a.push(d-1),a.push(d),a.push(d+1),a.push("..."),a.push(p);return a}),ie=()=>{const p=w.value.length>0?_.value.filter(se=>w.value.includes(se.id)):_.value,d=["Nombre Documento","Cliente","Estado","Etiquetas"],a=p.map(se=>[se.title||"",A(se),"Completado",se.tags?se.tags.map(de=>de.name).join(", "):""]),G=[d.join(","),...a.map(se=>se.map(de=>`"${de}"`).join(","))].join(`
`),k=new Blob([G],{type:"text/csv;charset=utf-8;"}),M=document.createElement("a"),C=URL.createObjectURL(k);M.setAttribute("href",C),M.setAttribute("download",`documentos_completados_${new Date().toISOString().split("T")[0]}.csv`),M.style.visibility="hidden",document.body.appendChild(M),M.click(),document.body.removeChild(M)},De=async(p,d)=>{try{switch(p){case"editForm":F("edit",d,{userRole:K()});break;case"editDocument":S.push(`/dynamic_document_dashboard/client/editor/edit/${d.id}`);break;case"preview":await O(d);break;case"delete":await J(d);break;case"letterhead":F("letterhead",d);break;case"relationships":F("relationships",d);break;case"downloadPDF":await E(d);break;case"downloadWord":await n(d);break;case"email":F("email",d);break;default:console.warn("Unknown action:",p)}}catch(a){console.error(`Error executing action ${p}:`,a)}},fe=L(!1),ne=L(null),Se=p=>{ne.value=p,fe.value=!0},Ge=async(p,d)=>{fe.value=!1,await De(p,d)};return(p,d)=>(o(),l("div",null,[e("div",_d,[e("div",wd,[e("div",$d,[s(t(Qe),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),Me(e("input",{"onUpdate:modelValue":d[0]||(d[0]=a=>y.value=a),type:"text",placeholder:"Buscar...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent text-sm"},null,512),[[ze,y.value]])])]),e("div",kd,[s(t(Fe),{as:"div",class:"relative"},{default:m(()=>[s(t(Ae),{class:"w-full inline-flex items-center justify-between gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:m(()=>[e("div",Cd,[s(t(tt),{class:"h-4 w-4 flex-shrink-0"}),e("span",Dd,h(ye.value||"Etiqueta"),1)]),s(t(Ne),{class:"h-4 w-4 flex-shrink-0"})]),_:1}),s(t(Te),{class:"absolute left-0 z-10 mt-2 w-full min-w-[16rem] origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none max-h-60 overflow-y-auto"},{default:m(()=>[e("div",Sd,[s(t(re),null,{default:m(({active:a})=>[e("a",{onClick:d[1]||(d[1]=G=>g.value=null),class:b([a?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Todos ",2)]),_:1}),(o(!0),l(le,null,me(X.value,a=>(o(),ee(t(re),{key:a.id},{default:m(({active:G})=>[e("a",{onClick:k=>g.value=a.id,class:b([G?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])},h(a.name),11,Ed)]),_:2},1024))),128))])]),_:1})]),_:1}),e("div",Fd,[g.value?(o(),l("button",{key:0,onClick:he,class:"w-full inline-flex items-center justify-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",title:"Limpiar filtros"},[s(t(Le),{class:"h-4 w-4 flex-shrink-0"}),Ad])):D("",!0)])]),e("div",Td,[e("div",Md,[e("div",Ld,[e("span",Pd,h(_.value.length),1),te(" resultados ")]),s(t(Fe),{as:"div",class:"relative"},{default:m(()=>[s(t(Ae),{class:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:m(()=>[Id,te(" "+h(Z.value)+" ",1),s(t(Ne),{class:"h-4 w-4"})]),_:1}),s(t(Te),{class:"absolute left-0 sm:left-auto sm:right-0 z-10 mt-2 w-48 origin-top-left sm:origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",jd,[s(t(re),null,{default:m(({active:a})=>[e("a",{onClick:d[2]||(d[2]=G=>T.value="recent"),class:b([a?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," M√°s recientes ",2)]),_:1}),s(t(re),null,{default:m(({active:a})=>[e("a",{onClick:d[3]||(d[3]=G=>T.value="name"),class:b([a?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Nombre (A-Z) ",2)]),_:1})])]),_:1})]),_:1})]),e("div",Bd,[e("button",{onClick:ie,class:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},[s(t(nt),{class:"h-4 w-4"}),Ud]),s(t(Fe),{as:"div",class:"relative"},{default:m(()=>[s(t(Ae),{class:"inline-flex items-center justify-center w-10 h-10 rounded-md hover:bg-gray-100"},{default:m(()=>[s(t(et),{class:"h-5 w-5 text-gray-500"})]),_:1}),s(t(Te),{class:"absolute left-0 sm:left-auto sm:right-0 z-10 mt-2 w-48 origin-top-left sm:origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",Nd,[s(t(re),null,{default:m(({active:a})=>[e("a",{onClick:xe,class:b([a?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Seleccionar todo ",2)]),_:1}),s(t(re),null,{default:m(({active:a})=>[e("a",{onClick:ge,class:b([a?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Deseleccionar todo ",2)]),_:1})])]),_:1})]),_:1})])])]),e("div",qd,[e("div",zd,[e("table",Od,[e("thead",Rd,[e("tr",null,[e("th",Vd,[e("input",{type:"checkbox",checked:pe.value,onChange:be,class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,Qd)]),Gd,Zd,Wd,Hd])]),e("tbody",Kd,[(o(!0),l(le,null,me(q.value,(a,G)=>(o(),l("tr",{key:a.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:k=>Se(a)},[e("td",{class:"px-6 py-4 whitespace-nowrap",onClick:d[4]||(d[4]=ve(()=>{},["stop"]))},[e("input",{type:"checkbox",checked:w.value.includes(a.id),onChange:k=>ce(a.id),class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,Yd)]),e("td",Xd,[e("div",ec,[e("div",tc,[e("div",sc,[s(t(Re),{class:"h-5 w-5 text-green-600"})])]),e("div",oc,[e("div",rc,h(a.title),1)])])]),e("td",nc,[e("div",lc,h(A(a)),1)]),ac,e("td",ic,[e("div",dc,[(o(!0),l(le,null,me(a.tags,k=>(o(),l("span",{key:k.id,class:b(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",oe(k)])},h(k.name),3))),128)),!a.tags||a.tags.length===0?(o(),l("span",cc,"-")):D("",!0)])])],8,Jd))),128))])])]),V.value>1?(o(),l("div",uc,[e("div",mc,[e("button",{onClick:Pe,disabled:B.value===1,class:b(["relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",B.value===1?"opacity-50 cursor-not-allowed":""])}," Anterior ",10,gc),e("button",{onClick:je,disabled:B.value===V.value,class:b(["relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",B.value===V.value?"opacity-50 cursor-not-allowed":""])}," Siguiente ",10,pc)]),e("div",hc,[e("div",null,[e("p",fc,[te(" Mostrando "),e("span",vc,h(R.value.start),1),te(" a "),e("span",bc,h(R.value.end),1),te(" de "),e("span",yc,h(R.value.total),1),te(" resultados ")])]),e("div",null,[e("nav",xc,[e("button",{onClick:Pe,disabled:B.value===1,class:b(["relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",B.value===1?"opacity-50 cursor-not-allowed":""])},[wc,s(t(pt),{class:"h-5 w-5","aria-hidden":"true"})],10,_c),(o(!0),l(le,null,me(ue.value,a=>(o(),l(le,{key:a},[a!=="..."?(o(),l("button",{key:0,onClick:G=>Ve(a),class:b(["relative inline-flex items-center px-4 py-2 text-sm font-semibold focus:z-20 focus:outline-offset-0",B.value===a?"z-10 bg-secondary text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-secondary":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50"])},h(a),11,$c)):(o(),l("span",kc," ... "))],64))),128)),e("button",{onClick:je,disabled:B.value===V.value,class:b(["relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",B.value===V.value?"opacity-50 cursor-not-allowed":""])},[Dc,s(t(ot),{class:"h-5 w-5","aria-hidden":"true"})],10,Cc)])])])])):D("",!0)]),_.value.length===0?(o(),l("div",Sc,[s(t(rt),{class:"mx-auto h-12 w-12 text-gray-400"}),Ec,Fc])):D("",!0),(o(),ee(ht,{to:"body"},[t($).edit.isOpen?(o(),ee(t(Ct),{key:0,document:t($).edit.document,"user-role":t(K)(),onClose:d[5]||(d[5]=a=>t(U)("edit")),onRefresh:d[6]||(d[6]=a=>u("refresh"))},null,8,["document","user-role"])):D("",!0),t($).email.isOpen?(o(),ee(t(Dt),{key:1,document:t($).email.document,onClose:d[7]||(d[7]=a=>t(U)("email"))},null,8,["document"])):D("",!0),t($).letterhead.isOpen?(o(),ee(bt,{key:2,"is-visible":t($).letterhead.isOpen,document:t($).letterhead.document,onClose:d[8]||(d[8]=a=>t(U)("letterhead")),onUploaded:d[9]||(d[9]=a=>u("refresh")),onDeleted:d[10]||(d[10]=a=>u("refresh"))},null,8,["is-visible","document"])):D("",!0),t($).relationships.isOpen?(o(),ee(St,{key:3,"is-open":t($).relationships.isOpen,document:t($).relationships.document,onClose:d[11]||(d[11]=a=>t(U)("relationships")),onRefresh:d[12]||(d[12]=a=>u("refresh"))},null,8,["is-open","document"])):D("",!0),fe.value?(o(),ee(Et,{key:4,"is-visible":fe.value,document:ne.value,"card-type":"client",context:"table","user-store":t(c),onClose:d[13]||(d[13]=a=>fe.value=!1),onAction:Ge},null,8,["is-visible","document","user-store"])):D("",!0)]))]))}},Tc={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-3 sm:p-4 mb-6"},Mc={class:"mb-4"},Lc={class:"relative w-full"},Pc={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-4"},Ic={class:"flex items-center gap-2 min-w-0"},jc={class:"truncate"},Bc={class:"py-1"},Uc=["onClick"],Nc={class:"flex items-center justify-stretch"},qc=e("span",null,"Limpiar",-1),zc={class:"flex flex-col gap-3 pt-4 border-t border-gray-200"},Oc={class:"flex flex-col sm:flex-row gap-3 items-start sm:items-center justify-between"},Rc={class:"text-sm text-gray-500"},Vc={class:"font-medium"},Qc=e("span",{class:"hidden sm:inline"},"Ordenar:",-1),Gc={class:"py-1"},Zc={class:"flex items-center gap-2"},Wc=e("span",{class:"hidden sm:inline"},"Exportar",-1),Hc={class:"py-1"},Kc={class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",style:{"overflow-x":"visible","overflow-y":"hidden"}},Jc={class:"overflow-x-auto",style:{"overflow-y":"visible"}},Yc={class:"min-w-full divide-y divide-gray-200"},Xc={class:"bg-gray-50"},eu={scope:"col",class:"w-12 px-6 py-3"},tu=["checked"],su=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Nombre Documento ",-1),ou=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Cliente ",-1),ru=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado ",-1),nu=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etiqueta ",-1),lu={class:"bg-white divide-y divide-gray-200"},au=["onClick"],iu=["checked","onChange"],du={class:"px-6 py-4 whitespace-nowrap"},cu={class:"flex items-center"},uu={class:"flex-shrink-0 h-10 w-10"},mu={class:"h-10 w-10 rounded-lg bg-blue-100 flex items-center justify-center"},gu={class:"ml-4"},pu={class:"text-sm font-medium text-gray-900"},hu={class:"px-6 py-4 whitespace-nowrap"},fu={class:"text-sm text-gray-900"},vu=e("td",{class:"px-6 py-4 whitespace-nowrap"},[e("span",{class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-700 border border-blue-200"}," En Progreso ")],-1),bu={class:"px-6 py-4 whitespace-nowrap"},yu={class:"flex flex-wrap gap-1"},xu={key:0,class:"text-sm text-gray-400"},_u={key:0,class:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"},wu={class:"flex flex-1 justify-between sm:hidden"},$u=["disabled"],ku=["disabled"],Cu={class:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between"},Du={class:"text-sm text-gray-700"},Su={class:"font-medium"},Eu={class:"font-medium"},Fu={class:"font-medium"},Au={class:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination"},Tu=["disabled"],Mu=e("span",{class:"sr-only"},"Anterior",-1),Lu=["onClick"],Pu={key:1,class:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700"},Iu=["disabled"],ju=e("span",{class:"sr-only"},"Siguiente",-1),Bu={key:0,class:"text-center py-12"},Uu=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No hay documentos en progreso",-1),Nu=e("p",{class:"mt-1 text-sm text-gray-500"},"Los documentos en progreso por clientes aparecer√°n aqu√≠.",-1),qu={__name:"DocumentInProgressByClientListTable",props:{searchQuery:String,selectedTags:{type:Array,default:()=>[]}},emits:["refresh"],setup(r,{emit:f}){const i=Oe(),c=We(),S=Xe(),x=r,u=f,{activeModals:$,openModal:F,closeModal:U,getUserRole:K}=ft(i,c),{handlePreviewDocument:O,deleteDocument:J,downloadPDFDocument:E,downloadWordDocument:n}=vt(i,c,u),y=L(""),g=L(null),T=L("recent"),w=L([]),B=L(1),Y=L(10);qe(()=>{i.init(),c.init()});const P=j(()=>{const p=i.progressDocumentsByClient,d=x.selectedTags?x.selectedTags.map(G=>G.id):[];return i.filteredDocumentsBySearchAndTags(x.searchQuery,c,d).filter(G=>p.some(k=>k.id===G.id))}),_=j(()=>{let p=[...P.value];const d=y.value.toLowerCase();return d&&(p=p.filter(a=>{var G,k;return((G=a.title)==null?void 0:G.toLowerCase().includes(d))||((k=a.tags)==null?void 0:k.some(M=>{var C;return(C=M.name)==null?void 0:C.toLowerCase().includes(d)}))})),g.value&&(p=p.filter(a=>a.tags&&a.tags.some(G=>G.id===g.value))),T.value==="name"?p.sort((a,G)=>{const k=(a.title||"").toLowerCase(),M=(G.title||"").toLowerCase();return k.localeCompare(M)}):T.value==="recent"&&p.sort((a,G)=>G.id-a.id),p}),q=j(()=>{const p=(B.value-1)*Y.value,d=p+Y.value;return _.value.slice(p,d)}),V=j(()=>Math.ceil(_.value.length/Y.value)),R=j(()=>{const p=(B.value-1)*Y.value+1,d=Math.min(B.value*Y.value,_.value.length);return{start:p,end:d,total:_.value.length}});ke([y,g],()=>{B.value=1});const X=j(()=>{const p=new Map;return P.value.forEach(d=>{d.tags&&d.tags.length>0&&d.tags.forEach(a=>{p.has(a.id)||p.set(a.id,a)})}),Array.from(p.values()).sort((d,a)=>d.name.localeCompare(a.name))}),ye=j(()=>{if(!g.value)return null;const p=X.value.find(d=>d.id===g.value);return p?p.name:null}),Z=j(()=>{switch(T.value){case"name":return"Nombre (A-Z)";case"recent":default:return"M√°s recientes"}}),A=p=>p.client_name?p.client_name:p.client?`${p.client.first_name||""} ${p.client.last_name||""}`.trim():"Cliente",oe=p=>{const d=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],a=p.id%d.length;return d[a]},pe=j(()=>_.value.length>0&&w.value.length===_.value.length),be=()=>{pe.value?w.value=[]:w.value=_.value.map(p=>p.id)},ce=p=>{const d=w.value.indexOf(p);d>-1?w.value.splice(d,1):w.value.push(p)},xe=()=>{w.value=_.value.map(p=>p.id)},ge=()=>{w.value=[]},he=()=>{g.value=null},Pe=()=>{B.value>1&&B.value--},je=()=>{B.value<V.value&&B.value++},Ve=p=>{p>=1&&p<=V.value&&(B.value=p)},ue=j(()=>{const p=V.value,d=B.value,a=[];if(p<=7)for(let G=1;G<=p;G++)a.push(G);else if(d<=4){for(let G=1;G<=5;G++)a.push(G);a.push("..."),a.push(p)}else if(d>=p-3){a.push(1),a.push("...");for(let G=p-4;G<=p;G++)a.push(G)}else a.push(1),a.push("..."),a.push(d-1),a.push(d),a.push(d+1),a.push("..."),a.push(p);return a}),ie=()=>{const p=w.value.length>0?_.value.filter(se=>w.value.includes(se.id)):_.value,d=["Nombre Documento","Cliente","Estado","Etiquetas"],a=p.map(se=>[se.title||"",A(se),"En Progreso",se.tags?se.tags.map(de=>de.name).join(", "):""]),G=[d.join(","),...a.map(se=>se.map(de=>`"${de}"`).join(","))].join(`
`),k=new Blob([G],{type:"text/csv;charset=utf-8;"}),M=document.createElement("a"),C=URL.createObjectURL(k);M.setAttribute("href",C),M.setAttribute("download",`documentos_en_progreso_${new Date().toISOString().split("T")[0]}.csv`),M.style.visibility="hidden",document.body.appendChild(M),M.click(),document.body.removeChild(M)},De=async(p,d)=>{try{switch(p){case"editForm":F("edit",d,{userRole:K()});break;case"editDocument":S.push(`/dynamic_document_dashboard/client/editor/edit/${d.id}`);break;case"preview":await O(d);break;case"delete":await J(d);break;case"letterhead":F("letterhead",d);break;case"relationships":F("relationships",d);break;case"downloadPDF":await E(d);break;case"downloadWord":await n(d);break;case"email":F("email",d);break;default:console.warn("Unknown action:",p)}}catch(a){console.error(`Error executing action ${p}:`,a)}},fe=L(!1),ne=L(null),Se=p=>{ne.value=p,fe.value=!0},Ge=async(p,d)=>{fe.value=!1,await De(p,d)};return(p,d)=>(o(),l("div",null,[e("div",Tc,[e("div",Mc,[e("div",Lc,[s(t(Qe),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),Me(e("input",{"onUpdate:modelValue":d[0]||(d[0]=a=>y.value=a),type:"text",placeholder:"Buscar...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent text-sm"},null,512),[[ze,y.value]])])]),e("div",Pc,[s(t(Fe),{as:"div",class:"relative"},{default:m(()=>[s(t(Ae),{class:"w-full inline-flex items-center justify-between gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:m(()=>[e("div",Ic,[s(t(tt),{class:"h-4 w-4 flex-shrink-0"}),e("span",jc,h(ye.value||"Etiqueta"),1)]),s(t(Ne),{class:"h-4 w-4 flex-shrink-0"})]),_:1}),s(t(Te),{class:"absolute left-0 z-10 mt-2 w-full min-w-[16rem] origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none max-h-60 overflow-y-auto"},{default:m(()=>[e("div",Bc,[s(t(re),null,{default:m(({active:a})=>[e("a",{onClick:d[1]||(d[1]=G=>g.value=null),class:b([a?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Todos ",2)]),_:1}),(o(!0),l(le,null,me(X.value,a=>(o(),ee(t(re),{key:a.id},{default:m(({active:G})=>[e("a",{onClick:k=>g.value=a.id,class:b([G?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])},h(a.name),11,Uc)]),_:2},1024))),128))])]),_:1})]),_:1}),e("div",Nc,[g.value?(o(),l("button",{key:0,onClick:he,class:"w-full inline-flex items-center justify-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",title:"Limpiar filtros"},[s(t(Le),{class:"h-4 w-4 flex-shrink-0"}),qc])):D("",!0)])]),e("div",zc,[e("div",Oc,[e("div",Rc,[e("span",Vc,h(_.value.length),1),te(" resultados ")]),s(t(Fe),{as:"div",class:"relative"},{default:m(()=>[s(t(Ae),{class:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:m(()=>[Qc,te(" "+h(Z.value)+" ",1),s(t(Ne),{class:"h-4 w-4"})]),_:1}),s(t(Te),{class:"absolute left-0 sm:left-auto sm:right-0 z-10 mt-2 w-48 origin-top-left sm:origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",Gc,[s(t(re),null,{default:m(({active:a})=>[e("a",{onClick:d[2]||(d[2]=G=>T.value="recent"),class:b([a?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," M√°s recientes ",2)]),_:1}),s(t(re),null,{default:m(({active:a})=>[e("a",{onClick:d[3]||(d[3]=G=>T.value="name"),class:b([a?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Nombre (A-Z) ",2)]),_:1})])]),_:1})]),_:1})]),e("div",Zc,[e("button",{onClick:ie,class:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},[s(t(nt),{class:"h-4 w-4"}),Wc]),s(t(Fe),{as:"div",class:"relative"},{default:m(()=>[s(t(Ae),{class:"inline-flex items-center justify-center w-10 h-10 rounded-md hover:bg-gray-100"},{default:m(()=>[s(t(et),{class:"h-5 w-5 text-gray-500"})]),_:1}),s(t(Te),{class:"absolute left-0 sm:left-auto sm:right-0 z-10 mt-2 w-48 origin-top-left sm:origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",Hc,[s(t(re),null,{default:m(({active:a})=>[e("a",{onClick:xe,class:b([a?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Seleccionar todo ",2)]),_:1}),s(t(re),null,{default:m(({active:a})=>[e("a",{onClick:ge,class:b([a?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Deseleccionar todo ",2)]),_:1})])]),_:1})]),_:1})])])]),e("div",Kc,[e("div",Jc,[e("table",Yc,[e("thead",Xc,[e("tr",null,[e("th",eu,[e("input",{type:"checkbox",checked:pe.value,onChange:be,class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,tu)]),su,ou,ru,nu])]),e("tbody",lu,[(o(!0),l(le,null,me(q.value,(a,G)=>(o(),l("tr",{key:a.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:k=>Se(a)},[e("td",{class:"px-6 py-4 whitespace-nowrap",onClick:d[4]||(d[4]=ve(()=>{},["stop"]))},[e("input",{type:"checkbox",checked:w.value.includes(a.id),onChange:k=>ce(a.id),class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,iu)]),e("td",du,[e("div",cu,[e("div",uu,[e("div",mu,[s(t(Re),{class:"h-5 w-5 text-blue-600"})])]),e("div",gu,[e("div",pu,h(a.title),1)])])]),e("td",hu,[e("div",fu,h(A(a)),1)]),vu,e("td",bu,[e("div",yu,[(o(!0),l(le,null,me(a.tags,k=>(o(),l("span",{key:k.id,class:b(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",oe(k)])},h(k.name),3))),128)),!a.tags||a.tags.length===0?(o(),l("span",xu,"-")):D("",!0)])])],8,au))),128))])])]),V.value>1?(o(),l("div",_u,[e("div",wu,[e("button",{onClick:Pe,disabled:B.value===1,class:b(["relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",B.value===1?"opacity-50 cursor-not-allowed":""])}," Anterior ",10,$u),e("button",{onClick:je,disabled:B.value===V.value,class:b(["relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",B.value===V.value?"opacity-50 cursor-not-allowed":""])}," Siguiente ",10,ku)]),e("div",Cu,[e("div",null,[e("p",Du,[te(" Mostrando "),e("span",Su,h(R.value.start),1),te(" a "),e("span",Eu,h(R.value.end),1),te(" de "),e("span",Fu,h(R.value.total),1),te(" resultados ")])]),e("div",null,[e("nav",Au,[e("button",{onClick:Pe,disabled:B.value===1,class:b(["relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",B.value===1?"opacity-50 cursor-not-allowed":""])},[Mu,s(t(pt),{class:"h-5 w-5","aria-hidden":"true"})],10,Tu),(o(!0),l(le,null,me(ue.value,a=>(o(),l(le,{key:a},[a!=="..."?(o(),l("button",{key:0,onClick:G=>Ve(a),class:b(["relative inline-flex items-center px-4 py-2 text-sm font-semibold focus:z-20 focus:outline-offset-0",B.value===a?"z-10 bg-secondary text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-secondary":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50"])},h(a),11,Lu)):(o(),l("span",Pu," ... "))],64))),128)),e("button",{onClick:je,disabled:B.value===V.value,class:b(["relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",B.value===V.value?"opacity-50 cursor-not-allowed":""])},[ju,s(t(ot),{class:"h-5 w-5","aria-hidden":"true"})],10,Iu)])])])])):D("",!0)]),_.value.length===0?(o(),l("div",Bu,[s(t(rt),{class:"mx-auto h-12 w-12 text-gray-400"}),Uu,Nu])):D("",!0),(o(),ee(ht,{to:"body"},[t($).edit.isOpen?(o(),ee(t(Ct),{key:0,document:t($).edit.document,"user-role":t(K)(),onClose:d[5]||(d[5]=a=>t(U)("edit")),onRefresh:d[6]||(d[6]=a=>u("refresh"))},null,8,["document","user-role"])):D("",!0),t($).email.isOpen?(o(),ee(t(Dt),{key:1,document:t($).email.document,onClose:d[7]||(d[7]=a=>t(U)("email"))},null,8,["document"])):D("",!0),t($).letterhead.isOpen?(o(),ee(bt,{key:2,"is-visible":t($).letterhead.isOpen,document:t($).letterhead.document,onClose:d[8]||(d[8]=a=>t(U)("letterhead")),onUploaded:d[9]||(d[9]=a=>u("refresh")),onDeleted:d[10]||(d[10]=a=>u("refresh"))},null,8,["is-visible","document"])):D("",!0),t($).relationships.isOpen?(o(),ee(St,{key:3,"is-open":t($).relationships.isOpen,document:t($).relationships.document,onClose:d[11]||(d[11]=a=>t(U)("relationships")),onRefresh:d[12]||(d[12]=a=>u("refresh"))},null,8,["is-open","document"])):D("",!0),fe.value?(o(),ee(Et,{key:4,"is-visible":fe.value,document:ne.value,"card-type":"client",context:"table","user-store":t(c),onClose:d[13]||(d[13]=a=>fe.value=!1),onAction:Ge},null,8,["is-visible","document","user-store"])):D("",!0)]))]))}},zu={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-3 sm:p-4 mb-6"},Ou={class:"mb-4"},Ru={class:"relative w-full"},Vu={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-4"},Qu={class:"flex items-center gap-2 min-w-0"},Gu={class:"truncate"},Zu={class:"p-2"},Wu={class:"relative mb-2"},Hu={class:"max-h-60 overflow-y-auto"},Ku=["onClick"],Ju={class:"truncate"},Yu={key:0,class:"px-3 py-2 text-sm text-gray-500 text-center"},Xu={class:"flex items-center justify-stretch"},em=e("span",null,"Limpiar",-1),tm={class:"flex flex-col gap-3 pt-4 border-t border-gray-200"},sm={class:"flex flex-col sm:flex-row gap-3 items-start sm:items-center justify-between"},om={class:"text-sm text-gray-500"},rm={class:"font-medium"},nm=e("span",{class:"hidden sm:inline"},"Ordenar:",-1),lm={class:"py-1"},am={class:"flex items-center gap-2"},im=e("span",{class:"hidden sm:inline"},"Exportar",-1),dm={class:"py-1"},cm={class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",style:{"overflow-x":"visible","overflow-y":"hidden"}},um={class:"overflow-x-auto",style:{"overflow-y":"visible"}},mm={class:"min-w-full divide-y divide-gray-200"},gm={class:"bg-gray-50"},pm={scope:"col",class:"w-12 px-6 py-3"},hm=["checked"],fm=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Nombre Documento ",-1),vm=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado Firma ",-1),bm=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etiqueta ",-1),ym={class:"bg-white divide-y divide-gray-200"},xm=["onClick"],_m=["checked","onChange"],wm={class:"px-6 py-4 whitespace-nowrap"},$m={class:"flex items-center"},km={class:"flex-shrink-0 h-10 w-10"},Cm={class:"h-10 w-10 rounded-lg bg-purple-100 flex items-center justify-center"},Dm={class:"ml-4"},Sm={class:"text-sm font-medium text-gray-900"},Em={class:"px-6 py-4 whitespace-nowrap"},Fm={class:"px-6 py-4 whitespace-nowrap"},Am={class:"flex flex-wrap gap-1"},Tm={key:0,class:"text-sm text-gray-400"},Mm={key:0,class:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"},Lm={class:"flex flex-1 justify-between sm:hidden"},Pm=["disabled"],Im=["disabled"],jm={class:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between"},Bm={class:"text-sm text-gray-700"},Um={class:"font-medium"},Nm={class:"font-medium"},qm={class:"font-medium"},zm={class:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination"},Om=["disabled"],Rm=e("span",{class:"sr-only"},"Anterior",-1),Vm=["onClick"],Qm={key:1,class:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700"},Gm=["disabled"],Zm=e("span",{class:"sr-only"},"Siguiente",-1),Wm={key:0,class:"text-center py-12"},Hm={class:"mt-2 text-sm font-medium text-gray-900"},Km={class:"mt-1 text-sm text-gray-500"},Jm={key:1,class:"text-center py-12"},Ym=e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-secondary"},null,-1),Xm=e("p",{class:"mt-2 text-sm text-gray-500"},"Cargando documentos...",-1),eg=[Ym,Xm],Ot={__name:"SignaturesListTable",props:{state:{type:String,required:!0,validator:r=>["PendingSignatures","FullySigned"].includes(r)},searchQuery:{type:String,default:""},selectedTags:{type:Array,default:()=>[]}},emits:["refresh"],setup(r,{expose:f,emit:i}){const c=r,S=i,x=We(),u=Oe();Xe();const{activeModals:$,openModal:F,closeModal:U,getUserRole:K}=ft(u,x),{handlePreviewDocument:O,downloadPDFDocument:J,signDocument:E,downloadSignedDocument:n}=vt(u,x,S);L([]);const y=L(!1),g=L(""),T=L(""),w=L(null),B=L("recent"),Y=L([]),P=L(1),_=L(10),q=j(()=>c.state==="PendingSignatures"?"No tienes documentos pendientes por firmar":"No tienes documentos firmados"),V=j(()=>c.state==="PendingSignatures"?"Cuando tengas documentos que requieran tu firma electr√≥nica aparecer√°n aqu√≠.":"Una vez que firmes documentos electr√≥nicamente, aparecer√°n aqu√≠."),R=j(()=>{const Q=x.currentUser.role,z=x.currentUser.id,ae=x.currentUser.email;let H=[];return Q==="lawyer"?c.state==="PendingSignatures"?H=u.pendingSignatureDocuments.filter(Ce=>Ce.created_by===z):H=u.fullySignedDocuments.filter(Ce=>Ce.created_by===z):c.state==="PendingSignatures"?H=u.documents.filter(Ce=>{var Ie;return Ce.state!=="PendingSignatures"?!1:(Ie=Ce.signatures)==null?void 0:Ie.some(Be=>Be.signer_email===ae)}):H=u.documents.filter(Ce=>{var Ie;return Ce.state!=="FullySigned"?!1:(Ie=Ce.signatures)==null?void 0:Ie.some(Be=>Be.signer_email===ae&&Be.signed)}),H}),X=j(()=>{let Q=[...R.value];const z=g.value.toLowerCase();return z&&(Q=Q.filter(ae=>{var H,Ce;return((H=ae.title)==null?void 0:H.toLowerCase().includes(z))||((Ce=ae.tags)==null?void 0:Ce.some(Ee=>{var Ie;return(Ie=Ee.name)==null?void 0:Ie.toLowerCase().includes(z)}))})),w.value&&(Q=Q.filter(ae=>ae.tags&&ae.tags.some(H=>H.id===w.value))),B.value==="name"?Q.sort((ae,H)=>{const Ce=(ae.title||"").toLowerCase(),Ee=(H.title||"").toLowerCase();return Ce.localeCompare(Ee)}):B.value==="recent"&&Q.sort((ae,H)=>H.id-ae.id),Q}),ye=j(()=>{const Q=(P.value-1)*_.value,z=Q+_.value;return X.value.slice(Q,z)}),Z=j(()=>Math.ceil(X.value.length/_.value)),A=j(()=>{const Q=(P.value-1)*_.value+1,z=Math.min(P.value*_.value,X.value.length);return{start:Q,end:z,total:X.value.length}});ke([g,w],()=>{P.value=1});const oe=j(()=>{const Q=new Map;return R.value.forEach(z=>{z.tags&&z.tags.length>0&&z.tags.forEach(ae=>{Q.has(ae.id)||Q.set(ae.id,ae)})}),Array.from(Q.values()).sort((z,ae)=>z.name.localeCompare(ae.name))}),pe=j(()=>{if(!T.value)return oe.value;const Q=T.value.toLowerCase();return oe.value.filter(z=>z.name.toLowerCase().includes(Q))}),be=j(()=>{if(!w.value)return null;const Q=oe.value.find(z=>z.id===w.value);return Q?Q.name:null}),ce=Q=>{const z=["bg-blue-500","bg-purple-500","bg-pink-500","bg-yellow-500","bg-green-500","bg-red-500","bg-indigo-500","bg-orange-500"],ae=Q.id%z.length;return z[ae]},xe=j(()=>{switch(B.value){case"name":return"Nombre (A-Z)";case"recent":default:return"M√°s recientes"}}),ge=Q=>{const z=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],ae=Q.id%z.length;return z[ae]},he=Q=>c.state==="FullySigned"?"bg-green-100 text-green-700 border border-green-200":"bg-yellow-100 text-yellow-700 border border-yellow-200",Pe=Q=>c.state==="FullySigned"?"Firmado":"Pendiente",je=j(()=>X.value.length>0&&Y.value.length===X.value.length),Ve=()=>{je.value?Y.value=[]:Y.value=X.value.map(Q=>Q.id)},ue=Q=>{const z=Y.value.indexOf(Q);z>-1?Y.value.splice(z,1):Y.value.push(Q)},ie=()=>{Y.value=X.value.map(Q=>Q.id)},De=()=>{Y.value=[]},fe=()=>{w.value=null},ne=()=>{P.value>1&&P.value--},Se=()=>{P.value<Z.value&&P.value++},Ge=Q=>{Q>=1&&Q<=Z.value&&(P.value=Q)},p=j(()=>{const Q=Z.value,z=P.value,ae=[];if(Q<=7)for(let H=1;H<=Q;H++)ae.push(H);else if(z<=4){for(let H=1;H<=5;H++)ae.push(H);ae.push("..."),ae.push(Q)}else if(z>=Q-3){ae.push(1),ae.push("...");for(let H=Q-4;H<=Q;H++)ae.push(H)}else ae.push(1),ae.push("..."),ae.push(z-1),ae.push(z),ae.push(z+1),ae.push("..."),ae.push(Q);return ae}),d=()=>{const Q=Y.value.length>0?X.value.filter(Be=>Y.value.includes(Be.id)):X.value,z=["Nombre Documento","Estado Firma","Etiquetas"],ae=Q.map(Be=>[Be.title||"",Pe(),Be.tags?Be.tags.map(at=>at.name).join(", "):""]),H=[z.join(","),...ae.map(Be=>Be.map(at=>`"${at}"`).join(","))].join(`
`),Ce=new Blob([H],{type:"text/csv;charset=utf-8;"}),Ee=document.createElement("a"),Ie=URL.createObjectURL(Ce);Ee.setAttribute("href",Ie),Ee.setAttribute("download",`documentos_firmas_${new Date().toISOString().split("T")[0]}.csv`),Ee.style.visibility="hidden",document.body.appendChild(Ee),Ee.click(),document.body.removeChild(Ee)},a=L(!1),G=L(null),k=Q=>{G.value=Q,a.value=!0},M=async(Q,z)=>{a.value=!1,await C(Q,z)},C=async(Q,z)=>{try{switch(Q){case"preview":await O(z);break;case"letterhead":F("letterhead",z);break;case"viewSignatures":F("signatures",z);break;case"sign":await E(z,F);break;case"downloadSignedDocument":await n(z);break;case"downloadPDF":await J(z);break;default:console.warn("Unknown action:",Q)}}catch(ae){console.error(`Error executing action ${Q}:`,ae)}},se=async()=>{y.value=!0;try{await u.init(!0)}catch(Q){console.error("Error refreshing documents:",Q),we("Error al actualizar documentos","error")}finally{y.value=!1}},de=async()=>{await se(),S("refresh")};return qe(async()=>{await se()}),f({refresh:de}),ke(()=>x.currentUser,()=>{de()}),(Q,z)=>{var ae;return o(),l("div",null,[e("div",zu,[e("div",Ou,[e("div",Ru,[s(t(Qe),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),Me(e("input",{"onUpdate:modelValue":z[0]||(z[0]=H=>g.value=H),type:"text",placeholder:"Buscar...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent text-sm"},null,512),[[ze,g.value]])])]),e("div",Vu,[s(t(Fe),{as:"div",class:"relative"},{default:m(()=>[s(t(Ae),{class:"w-full inline-flex items-center justify-between gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:m(()=>[e("div",Qu,[s(t(tt),{class:"h-4 w-4 flex-shrink-0"}),e("span",Gu,h(be.value||"Etiqueta"),1)]),s(t(Ne),{class:"h-4 w-4 flex-shrink-0"})]),_:1}),s(t(Te),{class:"absolute left-0 z-10 mt-2 w-full min-w-[16rem] origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",Zu,[e("div",Wu,[s(t(Qe),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),Me(e("input",{"onUpdate:modelValue":z[1]||(z[1]=H=>T.value=H),type:"text",placeholder:"Buscar etiquetas...",class:"w-full pl-9 pr-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent",onClick:z[2]||(z[2]=ve(()=>{},["stop"]))},null,512),[[ze,T.value]])]),e("div",Hu,[s(t(re),null,{default:m(({active:H})=>[e("a",{onClick:z[3]||(z[3]=Ce=>w.value=null),class:b([H?"bg-gray-100":"","block px-3 py-2 text-sm text-gray-700 cursor-pointer rounded-md"])}," Todos ",2)]),_:1}),(o(!0),l(le,null,me(pe.value,H=>(o(),ee(t(re),{key:H.id},{default:m(({active:Ce})=>[e("a",{onClick:Ee=>w.value=H.id,class:b([Ce?"bg-gray-100":"","flex items-center gap-2 px-3 py-2 text-sm cursor-pointer rounded-md"])},[e("span",{class:b(["w-3 h-3 rounded-full flex-shrink-0",ce(H)])},null,2),e("span",Ju,h(H.name),1)],10,Ku)]),_:2},1024))),128)),pe.value.length===0?(o(),l("div",Yu," No se encontraron etiquetas ")):D("",!0)])])]),_:1})]),_:1}),e("div",Xu,[w.value?(o(),l("button",{key:0,onClick:fe,class:"w-full inline-flex items-center justify-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",title:"Limpiar filtros"},[s(t(Le),{class:"h-4 w-4 flex-shrink-0"}),em])):D("",!0)])]),e("div",tm,[e("div",sm,[e("div",om,[e("span",rm,h(X.value.length),1),te(" resultados ")]),s(t(Fe),{as:"div",class:"relative"},{default:m(()=>[s(t(Ae),{class:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:m(()=>[nm,te(" "+h(xe.value)+" ",1),s(t(Ne),{class:"h-4 w-4"})]),_:1}),s(t(Te),{class:"absolute left-0 sm:left-auto sm:right-0 z-10 mt-2 w-48 origin-top-left sm:origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",lm,[s(t(re),null,{default:m(({active:H})=>[e("a",{onClick:z[4]||(z[4]=Ce=>B.value="recent"),class:b([H?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," M√°s recientes ",2)]),_:1}),s(t(re),null,{default:m(({active:H})=>[e("a",{onClick:z[5]||(z[5]=Ce=>B.value="name"),class:b([H?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Nombre (A-Z) ",2)]),_:1})])]),_:1})]),_:1})]),e("div",am,[e("button",{onClick:d,class:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},[s(t(nt),{class:"h-4 w-4"}),im]),s(t(Fe),{as:"div",class:"relative"},{default:m(()=>[s(t(Ae),{class:"inline-flex items-center justify-center w-10 h-10 rounded-md hover:bg-gray-100"},{default:m(()=>[s(t(et),{class:"h-5 w-5 text-gray-500"})]),_:1}),s(t(Te),{class:"absolute left-0 sm:left-auto sm:right-0 z-10 mt-2 w-48 origin-top-left sm:origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:m(()=>[e("div",dm,[s(t(re),null,{default:m(({active:H})=>[e("a",{onClick:ie,class:b([H?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Seleccionar todo ",2)]),_:1}),s(t(re),null,{default:m(({active:H})=>[e("a",{onClick:De,class:b([H?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Deseleccionar todo ",2)]),_:1})])]),_:1})]),_:1})])])]),e("div",cm,[e("div",um,[e("table",mm,[e("thead",gm,[e("tr",null,[e("th",pm,[e("input",{type:"checkbox",checked:je.value,onChange:Ve,class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,hm)]),fm,vm,bm])]),e("tbody",ym,[(o(!0),l(le,null,me(ye.value,(H,Ce)=>(o(),l("tr",{key:H.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:Ee=>k(H)},[e("td",{class:"px-6 py-4 whitespace-nowrap",onClick:z[6]||(z[6]=ve(()=>{},["stop"]))},[e("input",{type:"checkbox",checked:Y.value.includes(H.id),onChange:Ee=>ue(H.id),class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,_m)]),e("td",wm,[e("div",$m,[e("div",km,[e("div",Cm,[s(t(Re),{class:"h-5 w-5 text-purple-600"})])]),e("div",Dm,[e("div",Sm,h(H.title),1)])])]),e("td",Em,[e("span",{class:b(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",he()])},h(Pe()),3)]),e("td",Fm,[e("div",Am,[(o(!0),l(le,null,me(H.tags,Ee=>(o(),l("span",{key:Ee.id,class:b(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",ge(Ee)])},h(Ee.name),3))),128)),!H.tags||H.tags.length===0?(o(),l("span",Tm,"-")):D("",!0)])])],8,xm))),128))])])]),Z.value>1?(o(),l("div",Mm,[e("div",Lm,[e("button",{onClick:ne,disabled:P.value===1,class:b(["relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",P.value===1?"opacity-50 cursor-not-allowed":""])}," Anterior ",10,Pm),e("button",{onClick:Se,disabled:P.value===Z.value,class:b(["relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",P.value===Z.value?"opacity-50 cursor-not-allowed":""])}," Siguiente ",10,Im)]),e("div",jm,[e("div",null,[e("p",Bm,[te(" Mostrando "),e("span",Um,h(A.value.start),1),te(" a "),e("span",Nm,h(A.value.end),1),te(" de "),e("span",qm,h(A.value.total),1),te(" resultados ")])]),e("div",null,[e("nav",zm,[e("button",{onClick:ne,disabled:P.value===1,class:b(["relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",P.value===1?"opacity-50 cursor-not-allowed":""])},[Rm,s(t(pt),{class:"h-5 w-5","aria-hidden":"true"})],10,Om),(o(!0),l(le,null,me(p.value,H=>(o(),l(le,{key:H},[H!=="..."?(o(),l("button",{key:0,onClick:Ce=>Ge(H),class:b(["relative inline-flex items-center px-4 py-2 text-sm font-semibold focus:z-20 focus:outline-offset-0",P.value===H?"z-10 bg-secondary text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-secondary":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50"])},h(H),11,Vm)):(o(),l("span",Qm," ... "))],64))),128)),e("button",{onClick:Se,disabled:P.value===Z.value,class:b(["relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",P.value===Z.value?"opacity-50 cursor-not-allowed":""])},[Zm,s(t(ot),{class:"h-5 w-5","aria-hidden":"true"})],10,Gm)])])])])):D("",!0)]),X.value.length===0&&!y.value?(o(),l("div",Wm,[s(t(rt),{class:"mx-auto h-12 w-12 text-gray-400"}),e("h3",Hm,h(q.value),1),e("p",Km,h(V.value),1)])):D("",!0),y.value?(o(),l("div",Jm,eg)):D("",!0),s(Mt,{isVisible:t(st),documentData:t(Tt),onClose:z[7]||(z[7]=H=>st.value=!1)},null,8,["isVisible","documentData"]),(o(),ee(ht,{to:"body"},[t($).signatures.isOpen?(o(),ee(t(Qt),{key:0,"document-id":(ae=t($).signatures.document)==null?void 0:ae.id,onClose:z[8]||(z[8]=H=>t(U)("signatures")),onRefresh:z[9]||(z[9]=H=>S("refresh"))},null,8,["document-id"])):D("",!0),t($).letterhead.isOpen?(o(),ee(bt,{key:1,"is-visible":t($).letterhead.isOpen,document:t($).letterhead.document,onClose:z[10]||(z[10]=H=>t(U)("letterhead")),onUploaded:z[11]||(z[11]=H=>S("refresh")),onDeleted:z[12]||(z[12]=H=>S("refresh"))},null,8,["is-visible","document"])):D("",!0),a.value?(o(),ee(Et,{key:2,"is-visible":a.value,document:G.value,"card-type":"signatures",context:"table","user-store":t(x),onClose:z[13]||(z[13]=H=>a.value=!1),onAction:M},null,8,["is-visible","document","user-store"])):D("",!0)]))])}}},tg={class:"bg-white rounded-lg p-6 shadow-xl max-w-lg w-full"},sg={class:"flex justify-end"},og=e("label",{for:"document-name",class:"block text-base font-medium leading-6 text-primary"},[te(" Nombre "),e("span",{class:"text-red-500"},"*")],-1),rg={class:"mt-2"},ng={class:"flex gap-2 mt-2.5"},lg=["disabled"],ag=e("span",null,"Actualizar nombre",-1),ig=[ag],dg=["disabled"],cg={__name:"CreateDocumentByLawyer",emits:["close"],setup(r,{emit:f}){const i=Xe(),c=Oe(),S=f,x=L(""),u=L("");Rt(()=>{var E;(E=c.selectedDocument)!=null&&E.title?(x.value=c.selectedDocument.title,u.value=c.selectedDocument.title):(x.value="",u.value="")});const $=E=>{E.key==="Escape"&&S("close")};qe(()=>{document.addEventListener("keydown",$)}),ut(()=>{document.removeEventListener("keydown",$)});const F=j(()=>x.value.trim().length>0),U=j(()=>{var E;return!!((E=c.selectedDocument)!=null&&E.id)}),K=j(()=>U.value&&x.value.trim()!==u.value.trim()&&x.value.trim().length>0);async function O(){if(U.value&&K.value)try{const E={title:x.value.trim()};await c.updateDocument(c.selectedDocument.id,E),u.value=x.value.trim(),c.selectedDocument.title=x.value.trim(),c.lastUpdatedDocumentId=c.selectedDocument.id,localStorage.setItem("lastUpdatedDocumentId",c.selectedDocument.id);const n=c.selectedDocument.id;S("close",{updatedDocId:n});const y=window.location.pathname;y==="/dynamic_document_dashboard"||y==="/dynamic_document_dashboard/"?setTimeout(()=>{window.forceDocumentHighlight&&window.forceDocumentHighlight(n)},100):setTimeout(()=>{window.location.href="/dynamic_document_dashboard"},1e3)}catch(E){console.error("Error updating document name:",E)}}const J=async()=>{if(!F.value)return;const E=encodeURIComponent(x.value.trim());U.value?(c.selectedDocument.title=x.value,c.selectedDocument.id&&(c.lastUpdatedDocumentId=c.selectedDocument.id,localStorage.setItem("lastUpdatedDocumentId",c.selectedDocument.id.toString())),i.push(`/dynamic_document_dashboard/lawyer/editor/edit/${c.selectedDocument.id}`)):(c.selectedDocument={title:x.value.trim()},i.push(`/dynamic_document_dashboard/lawyer/editor/create/${E}`))};return(E,n)=>(o(),l("div",tg,[e("div",sg,[e("button",{onClick:n[0]||(n[0]=y=>S("close"))},[s(t(Le),{class:"size-6"})])]),e("form",{onSubmit:ve(J,["prevent"])},[e("div",null,[og,e("div",rg,[Me(e("input",{"onUpdate:modelValue":n[1]||(n[1]=y=>x.value=y),type:"text",name:"document-name",id:"document-name",class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-secondary sm:text-sm sm:leading-6",required:""},null,512),[[ze,x.value]])])]),e("div",ng,[U.value?(o(),l("button",{key:0,type:"button",onClick:O,disabled:!K.value,class:b(["p-2.5 text-sm font-medium rounded-md flex gap-2",K.value?"bg-primary text-white cursor-pointer":"bg-gray-200 text-gray-400 cursor-not-allowed opacity-70"])},ig,10,lg)):D("",!0),e("button",{type:"submit",class:b(["p-2.5 text-sm font-medium rounded-md flex gap-2",F.value?"bg-secondary text-white":"bg-gray-200 text-secondary border-2 border-dashed border-secondary cursor-not-allowed bg-opacity-50"]),disabled:!F.value},[e("span",null,h(U.value?"Editar Documento":"Continuar"),1)],10,dg)])],32)]))}},Ue=r=>(mt("data-v-07bc4810"),r=r(),gt(),r),ug={class:"relative bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col"},mg={class:"px-6 py-4 border-b border-gray-200"},gg=Ue(()=>e("h2",{class:"text-xl font-semibold text-gray-800"},"Gesti√≥n de Membrete Global",-1)),pg=Ue(()=>e("p",{class:"text-sm text-gray-500 mt-1"}," Este membrete se aplicar√° por defecto a todos tus documentos ",-1)),hg={class:"p-6 overflow-y-auto flex-grow"},fg={key:0,class:"text-center py-10"},vg=Ue(()=>e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1)),bg={class:"mt-4 text-gray-500"},yg={key:1,class:"space-y-6"},xg={key:0,class:"space-y-4"},_g=Ue(()=>e("h3",{class:"text-lg font-medium text-gray-900"},"Membrete Global Actual",-1)),wg={class:"border border-gray-200 rounded-lg p-4 bg-gray-50"},$g=["src"],kg={class:"mt-4 flex justify-center space-x-3"},Cg=["disabled"],Dg={key:1,class:"text-center py-8"},Sg=Ue(()=>e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"Sin Membrete Global",-1)),Eg=Ue(()=>e("p",{class:"mt-1 text-sm text-gray-500"}," No tienes una imagen de membrete global configurada. ",-1)),Fg=Ue(()=>e("p",{class:"mt-1 text-xs text-gray-400"}," El membrete global se aplicar√° a todos los documentos que no tengan un membrete espec√≠fico. ",-1)),Ag={class:"space-y-4"},Tg={class:"text-lg font-medium text-gray-900"},Mg={class:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-gray-400 transition-colors"},Lg={key:0},Pg={class:"mt-4"},Ig=Ue(()=>e("p",{class:"mt-2 text-sm text-gray-500"}," Solo archivos PNG, m√°ximo 10MB ",-1)),jg=Ue(()=>e("p",{class:"text-xs text-gray-400 mt-1"}," Dimensiones ideales: 612 √ó 612 p√≠xeles (8.5:11 Carta) ",-1)),Bg={key:1,class:"space-y-4"},Ug={class:"flex items-center justify-center space-x-2 text-sm text-gray-600"},Ng={class:"text-gray-400"},qg={key:0,class:"mt-4"},zg=["src"],Og={class:"flex justify-center space-x-3"},Rg=["disabled"],Vg={key:1,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},Qg={key:2,class:"bg-blue-50 border border-blue-200 rounded-lg p-6 space-y-6"},Gg={class:"flex items-center space-x-2"},Zg=Ue(()=>e("h3",{class:"text-lg font-semibold text-blue-900"},"Especificaciones del Membrete Global",-1)),Wg=Ue(()=>e("div",{class:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},[e("h4",{class:"font-medium text-yellow-800 mb-2"},"üîÑ Prioridad de Membrete"),e("div",{class:"text-sm text-yellow-700 space-y-1"},[e("div",null,[e("strong",null,"1¬∫ Prioridad:"),te(" Membrete espec√≠fico del documento")]),e("div",null,[e("strong",null,"2¬∫ Prioridad:"),te(" Membrete global del usuario (este)")]),e("div",null,[e("strong",null,"3¬∫ Prioridad:"),te(" Sin membrete")])])],-1)),Hg=Ue(()=>e("div",{class:"space-y-3"},[e("h4",{class:"font-medium text-gray-900"},"üìê Dimensiones Exactas"),e("div",{class:"bg-white rounded-lg p-4 border border-blue-200"},[e("div",{class:"grid grid-cols-2 gap-4 text-sm"},[e("div",null,[e("span",{class:"font-medium text-gray-700"},"Ancho:"),e("span",{class:"ml-2 text-blue-600 font-mono"},"612 p√≠xeles")]),e("div",null,[e("span",{class:"font-medium text-gray-700"},"Alto:"),e("span",{class:"ml-2 text-blue-600 font-mono"},"612 p√≠xeles")]),e("div",null,[e("span",{class:"font-medium text-gray-700"},"Proporci√≥n:"),e("span",{class:"ml-2 text-blue-600"},"8.5:11 (Carta)")]),e("div",null,[e("span",{class:"font-medium text-gray-700"},"Tolerancia:"),e("span",{class:"ml-2 text-orange-600"},"¬±10%")])])])],-1)),Kg=Ue(()=>e("div",{class:"space-y-3"},[e("h4",{class:"font-medium text-gray-900"},"üé® Distribuci√≥n Recomendada"),e("div",{class:"bg-white rounded-lg p-4 border border-blue-200"},[e("div",{class:"space-y-4"},[e("div",{class:"mx-auto w-40 h-44 border-2 border-gray-300 rounded bg-gradient-to-b from-blue-100 via-yellow-50 to-green-100 relative text-xs"},[e("div",{class:"absolute top-0 left-0 right-0 h-12 bg-blue-200 bg-opacity-70 border-b border-blue-300 flex items-center justify-center text-blue-800 font-medium"}," HEADER ZONE "),e("div",{class:"absolute top-10 left-1 text-blue-700 text-[10px]"},"120-150px"),e("div",{class:"absolute top-12 left-0 right-0 bottom-12 bg-yellow-100 bg-opacity-50 border-y border-yellow-300 flex items-center justify-center text-yellow-800 font-medium"},[e("div",{class:"text-center"},[e("div",null,"BODY ZONE"),e("div",{class:"text-[10px] mt-1"},"‚ö†Ô∏è ZONA CR√çTICA")])]),e("div",{class:"absolute top-20 left-1 text-yellow-700 text-[10px]"},"300-400px"),e("div",{class:"absolute bottom-0 left-0 right-0 h-12 bg-green-200 bg-opacity-70 border-t border-green-300 flex items-center justify-center text-green-800 font-medium"}," FOOTER ZONE "),e("div",{class:"absolute bottom-10 left-1 text-green-700 text-[10px]"},"80-120px")]),e("div",{class:"space-y-3 text-sm"},[e("div",{class:"flex items-start space-x-3"},[e("div",{class:"w-4 h-4 bg-blue-200 border border-blue-300 rounded mt-0.5 flex-shrink-0"}),e("div",null,[e("span",{class:"font-medium text-blue-800"},"Header (Superior):"),e("span",{class:"text-gray-600 ml-1"},"Logos, nombre de empresa. Puede tener mayor intensidad visual.")])]),e("div",{class:"flex items-start space-x-3"},[e("div",{class:"w-4 h-4 bg-yellow-100 border border-yellow-300 rounded mt-0.5 flex-shrink-0"}),e("div",null,[e("span",{class:"font-medium text-yellow-800"},"Body (Centro):"),e("span",{class:"text-gray-600 ml-1"},"Mant√©n semi-transparente. El texto del documento se superpone aqu√≠.")])]),e("div",{class:"flex items-start space-x-3"},[e("div",{class:"w-4 h-4 bg-green-200 border border-green-300 rounded mt-0.5 flex-shrink-0"}),e("div",null,[e("span",{class:"font-medium text-green-800"},"Footer (Inferior):"),e("span",{class:"text-gray-600 ml-1"},"Direcciones, tel√©fonos, emails, informaci√≥n de contacto.")])])])])])],-1)),Jg=Ue(()=>e("div",{class:"space-y-3"},[e("h4",{class:"font-medium text-gray-900"},"üîß Consideraciones T√©cnicas"),e("div",{class:"bg-white rounded-lg p-4 border border-blue-200"},[e("div",{class:"space-y-2 text-sm text-gray-700"},[e("div",{class:"flex items-start space-x-2"},[e("span",{class:"text-blue-600 font-medium"},"‚Ä¢"),e("span",null,[e("strong",null,"Posicionamiento:"),te(" La imagen se centra autom√°ticamente en el documento")])]),e("div",{class:"flex items-start space-x-2"},[e("span",{class:"text-blue-600 font-medium"},"‚Ä¢"),e("span",null,[e("strong",null,"Transparencia:"),te(" Usa PNG con canal alpha para efectos de transparencia")])]),e("div",{class:"flex items-start space-x-2"},[e("span",{class:"text-blue-600 font-medium"},"‚Ä¢"),e("span",null,[e("strong",null,"M√°rgenes:"),te(" Deja 30-50px de margen en los lados para seguridad")])]),e("div",{class:"flex items-start space-x-2"},[e("span",{class:"text-blue-600 font-medium"},"‚Ä¢"),e("span",null,[e("strong",null,"Resoluci√≥n:"),te(" 72-150 DPI es suficiente para documentos digitales")])]),e("div",{class:"flex items-start space-x-2"},[e("span",{class:"text-orange-600 font-medium"},"‚ö†Ô∏è"),e("span",null,[e("strong",null,"Zona cr√≠tica:"),te(" Evita elementos gr√°ficos densos en el centro (300-400px de altura)")])])])])],-1)),Yg=Ue(()=>e("div",{class:"bg-gradient-to-r from-green-50 to-blue-50 border border-green-200 rounded-lg p-4"},[e("h4",{class:"font-medium text-green-800 mb-2"},"üí° Tips de Dise√±o R√°pido"),e("div",{class:"text-sm text-green-700 space-y-1"},[e("div",null,"‚Ä¢ Si solo tienes header, ub√≠calo en los primeros 120-150px"),e("div",null,"‚Ä¢ El resto de la imagen debe ser transparente o blanco"),e("div",null,"‚Ä¢ Para footer, usa los √∫ltimos 80-120px"),e("div",null,"‚Ä¢ El texto se superpone en toda la imagen, mant√©n el centro claro")])],-1)),Xg={key:3,class:"space-y-2"},e0={class:"flex"},t0={class:"text-sm text-yellow-700"},s0={__name:"GlobalLetterheadModal",props:{isVisible:{type:Boolean,default:!1}},emits:["close","uploaded","deleted"],setup(r,{emit:f}){const i=r,c=f;ke(()=>i.isVisible,Z=>{});const S=Oe(),x=L(!1),u=L(""),$=L(!1),F=L(!1),U=L(null),K=L(null),O=L(null),J=L([]),E=L(null),n=L(!1),y=L(!1),g=()=>{B(),c("close")},T=Z=>{const A=Z.target.files[0];if(!A)return;if(!A.type.includes("png")){alert("Solo se permiten archivos PNG");return}if(A.size>10*1024*1024){alert("El archivo no puede ser mayor a 10MB");return}U.value=A,J.value=[];const oe=new FileReader;oe.onload=pe=>{K.value=pe.target.result;const be=new Image;be.onload=()=>{w(be.width,be.height)},be.src=pe.target.result},oe.readAsDataURL(A)},w=(Z,A)=>{const ce=Z/A,xe=612/612,ge=Math.abs(ce-xe)/xe;if(Z===612&&A===612){J.value.push("‚úÖ Dimensiones perfectas: 612 √ó 612 p√≠xeles");return}ge<=.1?(J.value.push(`‚ÑπÔ∏è Buenas proporciones detectadas: ${Z} √ó ${A} p√≠xeles (${ce.toFixed(3)})`),(Z!==612||A!==612)&&J.value.push("üí° Para mejores resultados, usa exactamente 612 √ó 612 p√≠xeles")):(J.value.push(`‚ö†Ô∏è Proporciones no ideales: ${Z} √ó ${A} p√≠xeles (${ce.toFixed(3)})`),J.value.push(`üéØ Proporciones recomendadas: ${xe.toFixed(3)} (8.5:11)`),J.value.push("üìê Considera redimensionar tu imagen a 612 √ó 612 p√≠xeles")),(Z<300||A<300)&&J.value.push("‚ö†Ô∏è Imagen muy peque√±a - puede verse pixelada en documentos"),(Z>1200||A>1600)&&J.value.push("‚ÑπÔ∏è Imagen muy grande - se redimensionar√° autom√°ticamente")},B=()=>{U.value=null,K.value=null,J.value=[],n.value=!1,E.value&&(E.value.value="")},Y=async()=>{var Z;if(U.value){$.value=!0,J.value=[];try{const A=await S.uploadGlobalLetterheadImage(U.value);(Z=A.data)!=null&&Z.warnings&&A.data.warnings.length>0&&(J.value=A.data.warnings),y.value=!1,await P(),B(),c("uploaded",A.data)}catch(A){console.error("Error uploading global letterhead:",A),alert("Error al subir la imagen. Por favor intenta nuevamente.")}finally{$.value=!1}}},P=async()=>{if(!(O.value===null&&y.value)){y.value=!0;try{const Z=await S.getGlobalLetterheadImage();Z.data&&(O.value=URL.createObjectURL(Z.data))}catch{O.value=null}}},_=()=>{confirm("¬øEst√°s seguro de que deseas eliminar la imagen de membrete global?")&&q()},q=async()=>{F.value=!0;try{await S.deleteGlobalLetterheadImage(),O.value&&URL.revokeObjectURL(O.value),O.value=null,y.value=!0,c("deleted")}catch(Z){console.error("Error deleting global letterhead:",Z),alert("Error al eliminar la imagen. Por favor intenta nuevamente.")}finally{F.value=!1}},V=()=>{if(O.value){const Z=document.createElement("a");Z.href=O.value,Z.download="membrete-global.png",document.body.appendChild(Z),Z.click(),document.body.removeChild(Z)}},R=()=>{O.value=null},X=Z=>{if(Z===0)return"0 Bytes";const A=1024,oe=["Bytes","KB","MB","GB"],pe=Math.floor(Math.log(Z)/Math.log(A));return parseFloat((Z/Math.pow(A,pe)).toFixed(2))+" "+oe[pe]};ke(()=>i.isVisible,Z=>{Z&&P()});const ye=()=>{O.value&&URL.revokeObjectURL(O.value),K.value&&URL.revokeObjectURL(K.value)};return qe(()=>{i.isVisible&&P()}),ut(ye),(Z,A)=>Me((o(),ee(Ye,null,{default:m(()=>[e("div",ug,[e("div",mg,[gg,pg,e("button",{onClick:g,class:"absolute top-4 right-4 text-gray-400 hover:text-gray-500"},[s(t(Le),{class:"h-6 w-6"})])]),e("div",hg,[x.value?(o(),l("div",fg,[vg,e("p",bg,h(u.value),1)])):(o(),l("div",yg,[O.value?(o(),l("div",xg,[_g,e("div",wg,[e("img",{src:O.value,alt:"Membrete global actual",class:"max-w-full h-auto max-h-64 mx-auto shadow-sm",onError:R},null,40,$g),e("div",kg,[e("button",{onClick:V,class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},[s(t(nt),{class:"h-4 w-4 mr-2"}),te(" Descargar ")]),e("button",{onClick:_,disabled:F.value,class:"inline-flex items-center px-3 py-2 border border-transparent shadow-sm text-sm leading-4 font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50"},[s(t(Zt),{class:"h-4 w-4 mr-2"}),te(" "+h(F.value?"Eliminando...":"Eliminar"),1)],8,Cg)])])])):(o(),l("div",Dg,[s(t(ct),{class:"mx-auto h-12 w-12 text-gray-400"}),Sg,Eg,Fg])),e("div",Ag,[e("h3",Tg,h(O.value?"Reemplazar Membrete Global":"Subir Membrete Global"),1),e("div",Mg,[e("input",{ref_key:"fileInput",ref:E,type:"file",accept:".png",onChange:T,class:"hidden"},null,544),U.value?(o(),l("div",Bg,[e("div",Ug,[s(t(Wt),{class:"h-5 w-5 text-green-500"}),e("span",null,h(U.value.name),1),e("span",Ng,"("+h(X(U.value.size))+")",1)]),K.value?(o(),l("div",qg,[e("img",{src:K.value,alt:"Vista previa",class:"max-w-full h-auto max-h-32 mx-auto border border-gray-200 rounded"},null,8,zg)])):D("",!0),e("div",Og,[e("button",{onClick:B,class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"}," Cancelar "),e("button",{onClick:Y,disabled:$.value,class:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50"},[$.value?(o(),l("div",Vg)):(o(),ee(t(vs),{key:0,class:"h-4 w-4 mr-2"})),te(" "+h($.value?"Subiendo...":"Subir Imagen"),1)],8,Rg)])])):(o(),l("div",Lg,[s(t(Ht),{class:"mx-auto h-12 w-12 text-gray-400"}),e("div",Pg,[e("button",{onClick:A[0]||(A[0]=oe=>Z.$refs.fileInput.click()),class:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}," Seleccionar Imagen PNG "),e("button",{onClick:A[1]||(A[1]=oe=>n.value=!n.value),class:"ml-3 inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"},[s(t(Nt),{class:"h-4 w-4 mr-2"}),te(" "+h(n.value?"Ocultar":"Ver")+" Especificaciones ",1)])]),Ig,jg]))])]),n.value?(o(),l("div",Qg,[e("div",Gg,[s(t(Nt),{class:"h-6 w-6 text-blue-600"}),Zg]),Wg,Hg,Kg,Jg,Yg])):D("",!0),J.value.length>0?(o(),l("div",Xg,[(o(!0),l(le,null,me(J.value,(oe,pe)=>(o(),l("div",{key:pe,class:"bg-yellow-50 border border-yellow-200 rounded-md p-3"},[e("div",e0,[s(t(bs),{class:"h-5 w-5 text-yellow-400 mr-2 flex-shrink-0 mt-0.5"}),e("p",t0,h(oe),1)])]))),128))])):D("",!0)]))])])]),_:1},512)),[[kt,r.isVisible]])}},o0=yt(s0,[["__scopeId","data-v-07bc4810"]]),r0={class:"min-h-screen bg-gray-50"},n0={class:"sticky top-0 flex h-16 shrink-0 items-center gap-x-4 border-b border-gray-200 bg-white px-4 shadow-sm sm:gap-x-6 sm:px-6 lg:px-8"},l0={class:"p-4 sm:p-6 lg:p-8"},a0={key:0},i0={class:"mb-6 border-b border-gray-200"},d0={class:"hidden md:block"},c0={class:"flex flex-wrap gap-x-4 gap-y-2 md:gap-x-8 mb-4","aria-label":"Tabs"},u0=["onClick"],m0={class:"flex gap-3"},g0=["disabled"],p0=e("span",null,"Firma Electr√≥nica",-1),h0=e("span",null,"Membrete Global",-1),f0=e("span",null,"Nueva Minuta",-1),v0={class:"md:hidden space-y-3 relative"},b0=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1),y0=[b0],x0={key:0,class:"absolute z-20 mt-2 bg-white border border-gray-300 rounded-lg shadow-lg overflow-hidden w-full"},_0=["onClick"],w0={class:"grid grid-cols-3 gap-2"},$0=["disabled"],k0=e("span",{class:"font-medium text-xs leading-tight"},"Firma",-1),C0=e("span",{class:"font-medium text-xs leading-tight"},"Membrete",-1),D0=e("span",{class:"font-medium text-xs leading-tight"},"Nueva",-1),S0={key:0},E0={key:1},F0={key:2},A0={key:3},T0={key:4},M0={key:5,class:"mt-6 text-center text-gray-400 font-regular"},L0=e("p",null,"No hay documentos disponibles para mostrar.",-1),P0=[L0],I0={key:1},j0={class:"mb-6 border-b border-gray-200"},B0={class:"hidden md:flex items-center justify-between"},U0={class:"-mb-px flex flex-wrap gap-x-4 gap-y-2 md:gap-x-8","aria-label":"Tabs"},N0=["onClick"],q0={class:"flex items-center gap-2 mb-4"},z0=["disabled"],O0=["disabled"],R0={class:"md:hidden relative"},V0=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1),Q0=[V0],G0={key:0,class:"absolute top-full left-0 right-0 z-50 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg overflow-hidden"},Z0=["onClick"],W0={class:"md:hidden mt-4 mb-4 flex flex-col gap-2"},H0=["disabled"],K0=["disabled"],J0={key:0},Y0={key:1},X0={class:"p-4 sm:p-6"},ep={class:"bg-white rounded-xl shadow-xl max-w-3xl w-full mx-auto"},tp={class:"flex justify-between items-center p-4 border-b"},sp=e("h2",{class:"text-lg font-medium text-primary"},"Firma Electr√≥nica",-1),op={class:"p-4 sm:p-6"},rp={class:"p-4 sm:p-6"},np={class:"bg-white rounded-xl shadow-xl max-w-3xl w-full mx-auto"},lp={class:"flex justify-between items-center p-4 border-b"},ap=e("h2",{class:"text-lg font-medium text-primary"},"Firma Electr√≥nica",-1),ip={class:"p-4 sm:p-6"},Pp={__name:"Dashboard",setup(r){const f=We(),i=Oe(),c=Lt(),S=Xe(),{isBasicUser:x,handleFeatureAccess:u}=Pt(),$=L(""),F=L("default"),U=L(!1),K=L("folders"),O=L("legal-documents"),J=L(!1),E=L(!1),n=L(!1),y=L(!1),g=L(!1),T=L(null),w=L([]),B=L("recent");ke(O,(ue,ie)=>{},{immediate:!0}),j(()=>[]),j(()=>B.value==="recent"?"M√°s recientes":"Nombre (A-Z)");const Y=j(()=>f.currentUser),P=j(()=>Y.value?Y.value.role:(S.push("/login"),null)),_=j(()=>{let ue=[];P.value==="lawyer"?ue=i.draftAndPublishedDocumentsUnassigned:(P.value==="client"||P.value==="basic"||P.value==="corporate_client")&&(ue=i.progressAndCompletedDocumentsByClient(Y.value.id));const ie=w.value&&Array.isArray(w.value)?w.value.map(De=>De.id):[];return i.filteredDocumentsBySearchAndTags($.value,f,ie).filter(De=>ue.some(fe=>fe.id===De.id))}),q=async ue=>{F.value=ue,i.selectedDocument=null;try{await i.init(!0)}catch(ie){console.error("Error loading documents for useDocument section:",ie)}},V=()=>{U.value=!1,F.value="default",i.selectedDocument=null},R=async()=>{await i.init(!0)},X=()=>{if(!Y.value){console.error("Cannot open signature modal: currentUser is not loaded");return}E.value=!0},ye=()=>{if(!Y.value){console.error("Cannot open signature modal: currentUser is not loaded");return}u("Firma Electr√≥nica",()=>{J.value=!0})},Z=()=>{if(!Y.value){console.error("Cannot open letterhead modal: currentUser is not loaded");return}u("Membrete Global",()=>{n.value=!0})},A=ue=>{we("Membrete global subido correctamente","success")},oe=()=>{we("Membrete global eliminado correctamente","success")},pe=async()=>{if(F.value==="useDocument"){F.value="default",K.value="my-documents";return}K.value="folders";try{await new Promise(ue=>setTimeout(ue,100)),await c.fetchFolders(!0)}catch{}};ke(()=>i.lastUpdatedDocumentId,(ue,ie)=>{if(ue&&ue!==ie&&F.value==="default"){const De=Date.now();(!ke.lastExecutionTime||De-ke.lastExecutionTime>100)&&(ke.lastExecutionTime=De,F.value="default")}},{immediate:!1}),ke(y,ue=>{}),ke(g,ue=>{}),ke(T,ue=>{});const be=[{name:"folders",label:"Carpetas"},{name:"my-documents",label:"Mis Documentos"}],ce=[{name:"legal-documents",label:"Minutas"},{name:"pending-signatures",label:"Dcs. Por Firmar"},{name:"signed-documents",label:"Dcs. Firmados"},{name:"finished-documents",label:"Dcs. Clientes"},{name:"in-progress-documents",label:"Dcs. Clientes en Progreso"}],xe=L(!1),ge=L(!1),he=()=>{xe.value=!1,ge.value=!1},Pe=ue=>{O.value=ue,xe.value=!1,he()},je=ue=>{K.value=ue,ge.value=!1,he()};qe(async()=>{await f.init(),await i.init(),await c.init(),i.selectedDocument=null,F.value="default";const ue=localStorage.getItem("lastUpdatedDocumentId");ue&&i.documents.some(De=>De.id.toString()===ue)&&(i.lastUpdatedDocumentId=parseInt(ue))});const Ve=async ue=>{await f.getUserInfo(),f.currentUser&&(f.currentUser.has_signature=!0),we("Firma electr√≥nica guardada correctamente","success"),setTimeout(()=>{E.value=!1},500)};return(ue,ie)=>{var De,fe;return o(),l(le,null,[e("div",r0,[e("div",n0,[Vt(ue.$slots,"default")]),e("div",l0,[P.value==="lawyer"?(o(),l("div",a0,[e("div",i0,[e("div",d0,[e("nav",c0,[(o(),l(le,null,me(ce,ne=>e("button",{key:ne.name,onClick:ve(Se=>Pe(ne.name),["stop"]),class:b([O.value===ne.name?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm cursor-pointer"])},h(ne.label),11,u0)),64))]),e("div",m0,[e("button",{onClick:ve(X,["stop"]),disabled:!Y.value,class:b(["inline-flex items-center gap-2 px-4 py-2 rounded-lg border border-purple-200 text-sm font-medium transition-all duration-200",Y.value?"bg-white text-gray-700 hover:bg-purple-50 hover:border-purple-300":"bg-gray-50 text-gray-400 cursor-not-allowed opacity-60"])},[s(t(_t),{class:"size-5 text-purple-500"}),p0],10,g0),e("button",{onClick:ie[0]||(ie[0]=ve(ne=>n.value=!0,["stop"])),class:"inline-flex items-center gap-2 px-4 py-2 rounded-lg border border-green-200 bg-white text-sm font-medium text-gray-700 hover:bg-green-50 hover:border-green-300 transition-all duration-200"},[s(t(Re),{class:"size-5 text-green-500"}),h0]),e("button",{onClick:ie[1]||(ie[1]=ve(ne=>U.value=!0,["stop"])),class:"inline-flex items-center gap-2 px-4 py-2 rounded-lg border border-secondary bg-secondary text-sm font-medium text-white hover:bg-blue-700 transition-all duration-200"},[s(t(Ke),{class:"size-5"}),f0])])]),e("div",v0,[e("button",{onClick:ie[2]||(ie[2]=ve(ne=>xe.value=!xe.value,["stop"])),class:"dropdown-button w-full flex items-center justify-between py-4 px-3 bg-white border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary"},[e("span",null,h(((De=ce.find(ne=>ne.name===O.value))==null?void 0:De.label)||"Seleccionar secci√≥n"),1),(o(),l("svg",{class:b(["ml-2 h-5 w-5 transition-transform duration-200",xe.value?"transform rotate-180":""]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},y0,2))]),xe.value?(o(),l("div",x0,[(o(),l(le,null,me(ce,ne=>e("button",{key:ne.name,onClick:ve(Se=>Pe(ne.name),["stop"]),class:b(["w-full text-left px-4 py-3 text-sm transition-colors duration-150",O.value===ne.name?"bg-primary text-white":"text-gray-700 hover:bg-gray-50"])},h(ne.label),11,_0)),64))])):D("",!0),e("div",w0,[e("button",{onClick:ve(X,["stop"]),disabled:!Y.value,class:b(["flex flex-col items-center justify-center py-3 px-2 rounded-lg border border-purple-200 text-center transition-all duration-200",Y.value?"bg-white hover:bg-purple-50":"bg-gray-50 cursor-not-allowed opacity-60"])},[s(t(_t),{class:"size-6 text-purple-500 mb-1"}),k0],10,$0),e("button",{onClick:ie[3]||(ie[3]=ve(ne=>n.value=!0,["stop"])),class:"flex flex-col items-center justify-center py-3 px-2 rounded-lg border border-green-200 bg-white text-center transition-all duration-200 hover:bg-green-50"},[s(t(Re),{class:"size-6 text-green-500 mb-1"}),C0]),e("button",{onClick:ie[4]||(ie[4]=ve(ne=>U.value=!0,["stop"])),class:"flex flex-col items-center justify-center py-3 px-2 rounded-lg border border-secondary bg-secondary text-white text-center transition-all duration-200 hover:bg-blue-700"},[s(t(Ke),{class:"size-6 mb-1"}),D0])])])]),O.value==="legal-documents"?(o(),l("div",S0,[s(xd,{searchQuery:$.value,selectedTags:w.value},null,8,["searchQuery","selectedTags"])])):D("",!0),O.value==="pending-signatures"?(o(),l("div",E0,[s(Ot,{state:"PendingSignatures",searchQuery:$.value,selectedTags:w.value},null,8,["searchQuery","selectedTags"])])):D("",!0),O.value==="signed-documents"?(o(),l("div",F0,[s(Ot,{state:"FullySigned",searchQuery:$.value,selectedTags:w.value},null,8,["searchQuery","selectedTags"])])):D("",!0),O.value==="finished-documents"?(o(),l("div",A0,[s(Ac,{searchQuery:$.value,selectedTags:w.value},null,8,["searchQuery","selectedTags"])])):D("",!0),O.value==="in-progress-documents"?(o(),l("div",T0,[s(qu,{searchQuery:$.value,selectedTags:w.value},null,8,["searchQuery","selectedTags"])])):D("",!0),_.value.length===0?(o(),l("div",M0,P0)):D("",!0)])):D("",!0),P.value==="client"||P.value==="basic"||P.value==="corporate_client"?(o(),l("div",I0,[e("div",j0,[e("div",B0,[e("nav",U0,[(o(),l(le,null,me(be,ne=>e("button",{key:ne.name,onClick:ve(Se=>je(ne.name),["stop"]),class:b([K.value===ne.name?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])},h(ne.label),11,N0)),64))]),e("div",q0,[e("button",{onClick:ve(ye,["stop"]),disabled:t(x),class:b(["inline-flex items-center gap-2 px-3 py-2 text-sm font-medium rounded-lg transition-colors border",t(x)?"text-purple-400 bg-gray-50 border-gray-200 cursor-not-allowed opacity-60":"text-purple-600 hover:bg-purple-50 border-purple-200"])},[s(t(_t),{class:"h-4 w-4"}),te(" Firma Electr√≥nica ")],10,z0),e("button",{onClick:ve(Z,["stop"]),disabled:t(x),class:b(["inline-flex items-center gap-2 px-3 py-2 text-sm font-medium rounded-lg transition-colors border",t(x)?"text-green-400 bg-gray-50 border-gray-200 cursor-not-allowed opacity-60":"text-green-600 hover:bg-green-50 border-green-200"])},[s(t(Re),{class:"h-4 w-4"}),te(" Membrete Global ")],10,O0),e("button",{onClick:ie[5]||(ie[5]=ve(ne=>q("useDocument"),["stop"])),class:"inline-flex items-center gap-2 px-3 py-2 text-sm font-medium text-white bg-secondary hover:bg-blue-700 rounded-lg transition-colors",type:"button"},[s(t(Ke),{class:"h-4 w-4"}),te(" Nuevo Documento ")])])]),e("div",R0,[e("button",{onClick:ie[6]||(ie[6]=ve(ne=>ge.value=!ge.value,["stop"])),class:"w-full flex items-center justify-between py-4 px-3 bg-white border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary"},[e("span",null,h(((fe=be.find(ne=>ne.name===K.value))==null?void 0:fe.label)||"Seleccionar secci√≥n"),1),(o(),l("svg",{class:b(["ml-2 h-5 w-5 transition-transform duration-200",ge.value?"transform rotate-180":""]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Q0,2))]),ge.value?(o(),l("div",G0,[(o(),l(le,null,me(be,ne=>e("button",{key:ne.name,onClick:ve(Se=>je(ne.name),["stop"]),class:b(["w-full text-left px-4 py-3 text-sm transition-colors duration-150",K.value===ne.name?"bg-primary text-white":"text-gray-700 hover:bg-gray-50"])},h(ne.label),11,Z0)),64))])):D("",!0)]),e("div",W0,[e("button",{onClick:ve(ye,["stop"]),disabled:t(x),class:b(["w-full flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium rounded-lg transition-colors",t(x)?"text-purple-400 bg-gray-50 cursor-not-allowed opacity-60":"text-purple-600 bg-purple-50 hover:bg-purple-100"])},[s(t(_t),{class:"h-5 w-5"}),te(" Firma Electr√≥nica ")],10,H0),e("button",{onClick:ve(Z,["stop"]),disabled:t(x),class:b(["w-full flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium rounded-lg transition-colors",t(x)?"text-green-400 bg-gray-50 cursor-not-allowed opacity-60":"text-green-600 bg-green-50 hover:bg-green-100"])},[s(t(Re),{class:"h-5 w-5"}),te(" Membrete Global ")],10,K0),e("button",{onClick:ie[7]||(ie[7]=ve(ne=>q("useDocument"),["stop"])),class:"w-full flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium text-white bg-secondary hover:bg-blue-700 rounded-lg transition-colors",type:"button"},[s(t(Ke),{class:"h-5 w-5"}),te(" Nuevo Documento ")])])]),F.value==="useDocument"?(o(),l("div",J0,[s(za,{searchQuery:$.value,selectedTags:w.value,onGoBack:pe},null,8,["searchQuery","selectedTags"])])):(o(),l("div",Y0,[K.value==="my-documents"?(o(),ee(oa,{key:0,searchQuery:$.value,selectedTags:w.value,onRefresh:R},null,8,["searchQuery","selectedTags"])):D("",!0),K.value==="folders"?(o(),ee(Wn,{key:1,searchQuery:$.value,selectedTags:w.value,onRefresh:R,onNavigateToMain:pe},null,8,["searchQuery","selectedTags"])):D("",!0)]))])):D("",!0)])]),U.value?(o(),ee(Ye,{key:0},{default:m(()=>[s(cg,{onClose:V})]),_:1})):D("",!0),E.value&&Y.value?(o(),ee(Ye,{key:1},{default:m(()=>[e("div",X0,[e("div",ep,[e("div",tp,[sp,e("button",{onClick:ie[8]||(ie[8]=ne=>E.value=!1),class:"text-gray-400 hover:text-gray-500 p-1 rounded-full hover:bg-gray-100"},[s(t(Le),{class:"h-6 w-6"})])]),e("div",op,[s(It,{"user-id":Y.value.id,"initial-show-options":!Y.value.has_signature,onSignatureSaved:Ve,onCancel:ie[9]||(ie[9]=ne=>E.value=!1)},null,8,["user-id","initial-show-options"])])])])]),_:1})):D("",!0),J.value&&Y.value?(o(),ee(Ye,{key:2},{default:m(()=>[e("div",rp,[e("div",np,[e("div",lp,[ap,e("button",{onClick:ie[10]||(ie[10]=ne=>J.value=!1),class:"text-gray-400 hover:text-gray-500 p-1 rounded-full hover:bg-gray-100"},[s(t(Le),{class:"h-6 w-6"})])]),e("div",ip,[s(It,{"user-id":Y.value.id,"initial-show-options":!Y.value.has_signature,onSignatureSaved:Ve,onCancel:ie[11]||(ie[11]=ne=>J.value=!1)},null,8,["user-id","initial-show-options"])])])])]),_:1})):D("",!0),s(Mt,{isVisible:t(st),documentData:t(Tt),onClose:ie[12]||(ie[12]=ne=>st.value=!1)},null,8,["isVisible","documentData"]),s(o0,{isVisible:n.value,onClose:ie[13]||(ie[13]=ne=>n.value=!1),onUploaded:A,onDeleted:oe},null,8,["isVisible"])],64)}}};export{Pp as default};
