import{K as m,r as w,o as v,e as _,f as k,C as x,D as T,E as b}from"./index-BWL8Y4C8.js";const C="/static/frontend/img/logo2.png",K=m({__name:"vueRecaptcha",props:{sitekey:{type:String,required:!0},size:{type:String,required:!1,default:"normal"},theme:{type:String,required:!1,default:"light"},hl:{type:String,required:!1},loadingTimeout:{type:Number,required:!1,default:0}},emits:{verify:e=>e!=null&&e!="",error:e=>e,expire:null,fail:null},setup(e,{expose:a,emit:c}){const t=e,u=w(null);let o=null;a({execute:function(){window.grecaptcha.execute(o)},reset:function(){window.grecaptcha.reset(o)}});function d(){o=window.grecaptcha.render(u.value,{sitekey:t.sitekey,theme:t.theme,size:t.size,callback:r=>c("verify",r),"expired-callback":()=>c("expire"),"error-callback":()=>c("fail")})}return v(()=>{window.grecaptcha==null?new Promise((r,f)=>{let s,n=!1;window.recaptchaReady=function(){n||(n=!0,clearTimeout(s),r())};const p="recaptcha-script",l=g=>()=>{var y;n||(n=!0,clearTimeout(s),(y=document.getElementById(p))==null||y.remove(),f(g))};t.loadingTimeout>0&&(s=setTimeout(l("timeout"),t.loadingTimeout));const h=window.document,i=h.createElement("script");i.id=p,i.onerror=l("error"),i.onabort=l("aborted"),i.setAttribute("src",`https://www.google.com/recaptcha/api.js?onload=recaptchaReady&render=explicit&hl=${t.hl}&_=${+new Date}`),h.head.appendChild(i)}).then(()=>{d()}).catch(r=>{c("error",r)}):d()}),(r,f)=>(_(),k("div",{ref_key:"recaptchaDiv",ref:u},null,512))}}),S=x("captcha",{state:()=>({siteKey:null,verified:!1}),actions:{async fetchSiteKey(){if(this.siteKey)return this.siteKey;try{const e=await T("google-captcha/site-key/");return this.siteKey=e.data.site_key,this.siteKey}catch(e){throw console.error("Error fetching site key:",e),e}},async verify(e){if(!e)return!1;try{const a=await b("google-captcha/verify/",{token:e});return this.verified=a.data.success===!0,this.verified}catch(a){return console.error("Error verifying reCAPTCHA:",a),this.verified=!1,!1}},reset(){this.verified=!1}}});export{C as _,K as a,S as u};
