import{u as Q,H as R,r as b,c as y,T as q,o as D,w as G,Q as H,e as a,k,i as L,g as e,f as l,t,h as w,j as C,G as J,l as I,F as S,N as M,p as v,a2 as O,I as z,am as K,a9 as W,J as X}from"./index.js";import{_ as Y}from"./SearchBarAndFilterBy.js";import{r as Z}from"./CubeTransparentIcon.js";import{r as ee}from"./ChevronRightIcon2.js";import"./MagnifyingGlassIcon2.js";const te={class:"relative bg-white rounded-xl shadow-xl max-w-3xl w-full max-h-[90vh] flex flex-col overflow-hidden"},se={class:"bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-5 flex items-center justify-between"},oe={class:"flex items-center gap-3"},re={class:"relative"},ae=["src","alt"],le={key:1,class:"h-12 w-12 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center text-white font-semibold text-lg shadow-sm"},ie={class:"min-w-0"},ne={class:"text-lg font-semibold text-white truncate"},ce={class:"text-blue-100 text-xs mt-0.5 truncate"},de={class:"flex-1 overflow-y-auto px-6 py-5 space-y-6 bg-gray-50"},ue={class:"bg-white rounded-lg border border-gray-200 shadow-sm p-4 sm:p-5"},_e=e("h3",{class:"text-sm font-semibold text-gray-900 mb-3"},"Información del usuario",-1),he={class:"grid grid-cols-1 sm:grid-cols-2 gap-x-6 gap-y-3 text-sm"},me=e("dt",{class:"text-gray-500"},"Nombre completo",-1),fe={class:"mt-0.5 text-gray-900"},xe=e("dt",{class:"text-gray-500"},"Correo electrónico",-1),ge={class:"mt-0.5 text-gray-900 truncate"},ye=e("dt",{class:"text-gray-500"},"Identificación",-1),pe={class:"mt-0.5 text-gray-900"},be=e("dt",{class:"text-gray-500"},"Contacto",-1),ve={class:"mt-0.5 text-gray-900"},we=e("dt",{class:"text-gray-500"},"Rol",-1),$e={class:"mt-0.5 text-gray-900"},ke=e("dt",{class:"text-gray-500"},"Fecha de nacimiento",-1),Ce={class:"mt-0.5 text-gray-900"},Se={class:"bg-white rounded-lg border border-gray-200 shadow-sm p-4 sm:p-5"},Pe={class:"flex items-center justify-between mb-3"},je=e("h3",{class:"text-sm font-semibold text-gray-900"},"Procesos del usuario",-1),Ue={class:"text-xs text-gray-500 mt-0.5"},Ne={key:0,class:"flex items-center justify-center py-8"},Ve=e("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"},null,-1),Ae=e("span",{class:"ml-3 text-sm text-gray-500"},"Cargando procesos...",-1),Be=[Ve,Ae],De={key:1,class:"flex flex-col items-center justify-center py-8 text-center"},Le=e("p",{class:"mt-2 text-sm text-gray-600"},"No se encontraron procesos para este usuario.",-1),Ie={key:2,class:"space-y-3 max-h-[40vh] overflow-y-auto pr-1"},Me={class:"min-w-0 flex-1"},Te={class:"text-sm font-semibold text-blue-700 truncate"},Fe={class:"mt-0.5 text-xs text-gray-600 truncate"},Ee={class:"mt-1 text-[11px] text-gray-500 truncate"},Qe={class:"font-medium"},Re={class:"font-medium"},qe={class:"mt-1 text-[11px] text-gray-500"},Ge={class:"font-medium"},He={class:"flex flex-col items-end gap-2 flex-shrink-0"},Je={class:"inline-flex items-center rounded-full px-2 py-0.5 text-[11px] font-medium bg-blue-50 text-blue-700 border border-blue-100"},Oe=["onClick"],ze={__name:"DirectoryUserDetailsModal",props:{isVisible:{type:Boolean,default:!1},user:{type:Object,required:!0}},emits:["close"],setup(n,{emit:p}){const s=n,u=p,_=Q(),h=R(),m=b(!1),f=y(()=>{if(!s.user)return"";const r=s.user.first_name||"",c=s.user.last_name||"";return`${r} ${c}`.trim()||s.user.email||"Usuario"}),x=y(()=>{if(!s.user)return"";const r=(s.user.first_name||"").charAt(0),c=(s.user.last_name||"").charAt(0);return`${r}${c}`.trim()||(s.user.email?s.user.email.charAt(0).toUpperCase():"?")}),g=y(()=>{var c;const r=(c=s.user)==null?void 0:c.role;return r==="client"?"Cliente":r==="basic"?"Básico":r==="corporate_client"?"Corporativo":r==="lawyer"?"Abogado":"Usuario"}),o=y(()=>{if(!s.user||!h.processes||h.processes.length===0)return[];const r=s.user.role,c=s.user.id;return h.processes.filter(d=>d?r==="client"||r==="basic"||r==="corporate_client"?d.client&&d.client.id===c:r==="lawyer"?d.lawyer&&d.lawyer.id===c:!1:!1)}),$=async()=>{if(!h.dataLoaded){m.value=!0;try{await h.fetchProcessesData()}finally{m.value=!1}}},T=()=>{u("close")},F=r=>{u("close"),_.push({name:"process_detail",params:{process_id:r}})},E=()=>{s.user&&(u("close"),_.push({name:"process_list",params:{user_id:s.user.id,display:""}}))};return q(()=>s.isVisible,r=>{r&&$()}),D(()=>{s.isVisible&&$()}),(r,c)=>G((a(),k(O,null,{default:L(()=>{var d,P,j,U,N,V;return[e("div",te,[e("div",se,[e("div",oe,[e("div",re,[(d=n.user)!=null&&d.photo_profile?(a(),l("img",{key:0,src:n.user.photo_profile,alt:f.value,class:"h-12 w-12 rounded-full object-cover border-2 border-white/40 shadow-sm"},null,8,ae)):(a(),l("div",le,t(x.value),1))]),e("div",ie,[e("h2",ne,t(f.value),1),e("p",ce,t(g.value)+" · "+t((P=n.user)==null?void 0:P.email),1)])]),e("button",{type:"button",onClick:T,class:"p-2.5 rounded-full text-white hover:text-blue-100 hover:bg-white/10 transition-colors"},[w(C(J),{class:"h-5 w-5"})])]),e("div",de,[e("section",ue,[_e,e("dl",he,[e("div",null,[me,e("dd",fe,t(f.value||"Sin información"),1)]),e("div",null,[xe,e("dd",ge,t(((j=n.user)==null?void 0:j.email)||"Sin información"),1)]),e("div",null,[ye,e("dd",pe,t(((U=n.user)==null?void 0:U.identification)||"Sin información"),1)]),e("div",null,[be,e("dd",ve,t(((N=n.user)==null?void 0:N.contact)||"Sin información"),1)]),e("div",null,[we,e("dd",$e,t(g.value),1)]),e("div",null,[ke,e("dd",Ce,t(((V=n.user)==null?void 0:V.birthday)||"Sin información"),1)])])]),e("section",Se,[e("div",Pe,[e("div",null,[je,e("p",Ue,t(o.value.length>0?`Se encontraron ${o.value.length} proceso(s) asociados`:"Este usuario no tiene procesos registrados."),1)]),o.value.length>0?(a(),l("button",{key:0,type:"button",onClick:E,class:"inline-flex items-center px-3 py-1.5 rounded-md border border-gray-200 text-xs font-medium text-gray-700 bg-gray-50 hover:bg-gray-100"}," Ver todos en Procesos ")):I("",!0)]),m.value?(a(),l("div",Ne,Be)):o.value.length===0?(a(),l("div",De,[w(C(Z),{class:"h-10 w-10 text-gray-300"}),Le])):(a(),l("div",Ie,[(a(!0),l(S,null,M(o.value,i=>{var A,B;return a(),l("article",{key:i.id,class:"rounded-lg border border-gray-200 bg-gray-50 px-4 py-3 flex items-start justify-between gap-3 hover:border-blue-200 hover:bg-blue-50/40 transition-colors"},[e("div",Me,[e("h4",Te,t(((A=i.case)==null?void 0:A.type)||"Proceso sin tipo"),1),e("p",Fe,t(i.subcase||"Sin descripción"),1),e("p",Ee,[v(" Radicado: "),e("span",Qe,t(i.ref||"N/A"),1),v(" · Autoridad: "),e("span",Re,t(i.authority||"N/A"),1)]),e("p",qe,[v(" Última etapa: "),e("span",Ge,t(i.stages&&i.stages.length>0?i.stages[i.stages.length-1].status:"Sin etapas"),1)])]),e("div",He,[e("span",Je,t((B=i.case)!=null&&B.type?"Expediente":"Proceso")+" #"+t(i.id),1),e("button",{type:"button",onClick:nt=>F(i.id),class:"inline-flex items-center px-3 py-1.5 rounded-md text-xs font-medium text-blue-700 bg-white border border-blue-200 hover:bg-blue-50"}," Ver proceso ",8,Oe)])])}),128))]))])])])]}),_:1},512)),[[H,n.isVisible]])}},Ke={class:"flex-1"},We={role:"list",class:"divide-y divide-gray-100 grid xl:grid-cols-2"},Xe=["onClick"],Ye={class:"flex min-w-0 gap-x-4"},Ze=["src"],et={key:1,class:"h-12 w-12 flex-none rounded-full bg-gray-50",src:X,alt:"Photo Profile"},tt={class:"min-w-0 flex-auto"},st={class:"text-sm font-semibold leading-6 text-gray-900"},ot=e("span",{class:"absolute inset-x-0 -top-px bottom-0"},null,-1),rt={class:"text-gray-400"},at={class:"mt-1 flex text-xs leading-5 text-gray-500"},lt=["href"],it={class:"flex shrink-0 items-center gap-x-4"},mt={__name:"DirectoryList",setup(n){const p=z(),s=b(""),u=b(!1),_=b(null),h=y(()=>p.filteredUsers(s.value));D(async()=>{await p.init()});const m=x=>{_.value=x,u.value=!0},f=()=>{u.value=!1,_.value=null};return(x,g)=>(a(),l(S,null,[w(Y,{"onUpdate:searchQuery":g[0]||(g[0]=o=>s.value=o)},{default:L(()=>[W(x.$slots,"default")]),_:3}),e("div",Ke,[e("div",null,[e("ul",We,[(a(!0),l(S,null,M(h.value,o=>(a(),l("li",{key:o.id,class:"relative flex justify-between gap-x-6 px-4 py-5 hover:bg-gray-50 sm:px-6 lg:px-8 cursor-pointer",onClick:$=>m(o)},[e("div",Ye,[o.photo_profile?(a(),l("img",{key:0,class:"h-12 w-12 flex-none rounded-full bg-gray-50 object-cover object-center",src:o.photo_profile,alt:"Photo Profile"},null,8,Ze)):(a(),l("img",et)),e("div",tt,[e("p",st,[e("a",null,[ot,v(" "+t(o.last_name)+" "+t(o.first_name)+" ",1),e("span",rt," ("+t(o.role=="client"?"Cliente":o.role=="basic"?"Básico":o.role=="corporate_client"?"Corporativo":"Abogado")+") ",1)])]),e("p",at,[e("a",{href:`mailto:${o.email}`,class:"relative truncate hover:underline"},t(o.email),9,lt)])])]),e("div",it,[w(C(ee),{class:"h-5 w-5 flex-none text-gray-400","aria-hidden":"true"})])],8,Xe))),128))])])]),(a(),k(K,{to:"body"},[u.value&&_.value?(a(),k(ze,{key:0,"is-visible":u.value,user:_.value,onClose:f},null,8,["is-visible","user"])):I("",!0)]))],64))}};export{mt as default};
