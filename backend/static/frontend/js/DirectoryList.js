import{_ as Q}from"./SearchBarAndFilterBy.js";import{u as q,L as J,r as $,c as p,W as N,o as F,w as O,U as W,e as a,k as U,i as T,g as e,f as l,t,h as C,j,B as z,l as E,F as P,J as R,p as k,a5 as G,I as H,an as K,ac as X}from"./index.js";import{r as Y}from"./CubeTransparentIcon.js";import{r as Z}from"./ChevronRightIcon2.js";import"./MagnifyingGlassIcon2.js";const ee={class:"relative bg-white rounded-xl shadow-xl max-w-3xl w-full max-h-[90vh] flex flex-col overflow-hidden"},te={class:"bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-5 flex items-center justify-between"},se={class:"flex items-center gap-3"},oe={class:"relative"},re=["src","alt"],ae={key:1,class:"h-12 w-12 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center text-white font-semibold text-lg shadow-sm"},le={class:"min-w-0"},ie={class:"text-lg font-semibold text-white truncate"},ne={class:"text-blue-100 text-xs mt-0.5 truncate"},ce={class:"flex-1 overflow-y-auto px-6 py-5 space-y-6 bg-gray-50"},de={class:"bg-white rounded-lg border border-gray-200 shadow-sm p-4 sm:p-5"},ue=e("h3",{class:"text-sm font-semibold text-gray-900 mb-3"},"Información del usuario",-1),_e={class:"grid grid-cols-1 sm:grid-cols-2 gap-x-6 gap-y-3 text-sm"},he=e("dt",{class:"text-gray-500"},"Nombre completo",-1),me={class:"mt-0.5 text-gray-900"},fe=e("dt",{class:"text-gray-500"},"Correo electrónico",-1),xe={class:"mt-0.5 text-gray-900 truncate"},ge=e("dt",{class:"text-gray-500"},"Identificación",-1),pe={class:"mt-0.5 text-gray-900"},be=e("dt",{class:"text-gray-500"},"Contacto",-1),ye={class:"mt-0.5 text-gray-900"},ve=e("dt",{class:"text-gray-500"},"Rol",-1),we={class:"mt-0.5 text-gray-900"},$e=e("dt",{class:"text-gray-500"},"Fecha de nacimiento",-1),ke={class:"mt-0.5 text-gray-900"},Ce={class:"bg-white rounded-lg border border-gray-200 shadow-sm p-4 sm:p-5"},Se={class:"flex items-center justify-between mb-3"},Ue=e("h3",{class:"text-sm font-semibold text-gray-900"},"Procesos del usuario",-1),je={class:"text-xs text-gray-500 mt-0.5"},Pe={key:0,class:"flex items-center justify-center py-8"},Ae=e("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"},null,-1),Ve=e("span",{class:"ml-3 text-sm text-gray-500"},"Cargando procesos...",-1),Be=[Ae,Ve],De={key:1,class:"flex flex-col items-center justify-center py-8 text-center"},Le=e("p",{class:"mt-2 text-sm text-gray-600"},"No se encontraron procesos para este usuario.",-1),Ie={key:2,class:"space-y-3 max-h-[40vh] overflow-y-auto pr-1"},Me={class:"min-w-0 flex-1"},Fe={class:"text-sm font-semibold text-blue-700 truncate"},Te={class:"mt-0.5 text-xs text-gray-600 truncate"},Ee={class:"mt-1 text-[11px] text-gray-500 truncate"},Re={class:"font-medium"},Qe={class:"font-medium"},qe={class:"mt-1 text-[11px] text-gray-500"},Je={class:"font-medium"},Ne={class:"flex flex-col items-end gap-2 flex-shrink-0"},Oe={class:"inline-flex items-center rounded-full px-2 py-0.5 text-[11px] font-medium bg-blue-50 text-blue-700 border border-blue-100"},We=["onClick"],ze={__name:"DirectoryUserDetailsModal",props:{isVisible:{type:Boolean,default:!1},user:{type:Object,required:!0}},emits:["close"],setup(c,{emit:b}){const s=c,h=b,m=q(),f=J(),x=$(!1),g=p(()=>{if(!s.user)return"";const r=s.user.first_name||"",u=s.user.last_name||"";return`${r} ${u}`.trim()||s.user.email||"Usuario"}),S=p(()=>{if(!s.user)return"";const r=(s.user.first_name||"").charAt(0),u=(s.user.last_name||"").charAt(0);return`${r}${u}`.trim()||(s.user.email?s.user.email.charAt(0).toUpperCase():"?")}),d=p(()=>{var u;const r=(u=s.user)==null?void 0:u.role;return r==="client"?"Cliente":r==="basic"?"Básico":r==="corporate_client"?"Corporativo":r==="lawyer"?"Abogado":"Usuario"}),i=p(()=>{if(!s.user||!f.processes||f.processes.length===0)return[];const r=s.user.role,u=s.user.id;return f.processes.filter(_=>_?r==="client"||r==="basic"||r==="corporate_client"?_.client&&_.client.id===u:r==="lawyer"?_.lawyer&&_.lawyer.id===u:!1:!1)}),o=async()=>{if(!f.dataLoaded){x.value=!0;try{await f.fetchProcessesData()}finally{x.value=!1}}},y=()=>{h("close")},v=r=>{h("close"),m.push({name:"process_detail",params:{process_id:r}})},w=()=>{s.user&&(h("close"),m.push({name:"process_list",params:{user_id:s.user.id,display:""}}))};return N(()=>s.isVisible,r=>{r&&o()}),F(()=>{s.isVisible&&o()}),(r,u)=>O((a(),U(G,null,{default:T(()=>{var _,A,V,B,D,L;return[e("div",ee,[e("div",te,[e("div",se,[e("div",oe,[(_=c.user)!=null&&_.photo_profile?(a(),l("img",{key:0,src:c.user.photo_profile,alt:g.value,class:"h-12 w-12 rounded-full object-cover border-2 border-white/40 shadow-sm"},null,8,re)):(a(),l("div",ae,t(S.value),1))]),e("div",le,[e("h2",ie,t(g.value),1),e("p",ne,t(d.value)+" · "+t((A=c.user)==null?void 0:A.email),1)])]),e("button",{type:"button",onClick:y,class:"p-2.5 rounded-full text-white hover:text-blue-100 hover:bg-white/10 transition-colors"},[C(j(z),{class:"h-5 w-5"})])]),e("div",ce,[e("section",de,[ue,e("dl",_e,[e("div",null,[he,e("dd",me,t(g.value||"Sin información"),1)]),e("div",null,[fe,e("dd",xe,t(((V=c.user)==null?void 0:V.email)||"Sin información"),1)]),e("div",null,[ge,e("dd",pe,t(((B=c.user)==null?void 0:B.identification)||"Sin información"),1)]),e("div",null,[be,e("dd",ye,t(((D=c.user)==null?void 0:D.contact)||"Sin información"),1)]),e("div",null,[ve,e("dd",we,t(d.value),1)]),e("div",null,[$e,e("dd",ke,t(((L=c.user)==null?void 0:L.birthday)||"Sin información"),1)])])]),e("section",Ce,[e("div",Se,[e("div",null,[Ue,e("p",je,t(i.value.length>0?`Se encontraron ${i.value.length} proceso(s) asociados`:"Este usuario no tiene procesos registrados."),1)]),i.value.length>0?(a(),l("button",{key:0,type:"button",onClick:w,class:"inline-flex items-center px-3 py-1.5 rounded-md border border-gray-200 text-xs font-medium text-gray-700 bg-gray-50 hover:bg-gray-100"}," Ver todos en Procesos ")):E("",!0)]),x.value?(a(),l("div",Pe,Be)):i.value.length===0?(a(),l("div",De,[C(j(Y),{class:"h-10 w-10 text-gray-300"}),Le])):(a(),l("div",Ie,[(a(!0),l(P,null,R(i.value,n=>{var I,M;return a(),l("article",{key:n.id,class:"rounded-lg border border-gray-200 bg-gray-50 px-4 py-3 flex items-start justify-between gap-3 hover:border-blue-200 hover:bg-blue-50/40 transition-colors"},[e("div",Me,[e("h4",Fe,t(((I=n.case)==null?void 0:I.type)||"Proceso sin tipo"),1),e("p",Te,t(n.subcase||"Sin descripción"),1),e("p",Ee,[k(" Radicado: "),e("span",Re,t(n.ref||"N/A"),1),k(" · Autoridad: "),e("span",Qe,t(n.authority||"N/A"),1)]),e("p",qe,[k(" Última etapa: "),e("span",Je,t(n.stages&&n.stages.length>0?n.stages[n.stages.length-1].status:"Sin etapas"),1)])]),e("div",Ne,[e("span",Oe,t((M=n.case)!=null&&M.type?"Expediente":"Proceso")+" #"+t(n.id),1),e("button",{type:"button",onClick:it=>v(n.id),class:"inline-flex items-center px-3 py-1.5 rounded-md text-xs font-medium text-blue-700 bg-white border border-blue-200 hover:bg-blue-50"}," Ver proceso ",8,We)])])}),128))]))])])])]}),_:1},512)),[[W,c.isVisible]])}},Ge={class:"flex-1"},He={role:"list",class:"divide-y divide-gray-100 grid xl:grid-cols-2"},Ke=["onClick"],Xe={class:"flex min-w-0 gap-x-4"},Ye=["src"],Ze={key:1,class:"h-12 w-12 flex-none rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center text-white font-semibold text-lg shadow-sm"},et={class:"min-w-0 flex-auto"},tt={class:"text-sm font-semibold leading-6 text-gray-900"},st=e("span",{class:"absolute inset-x-0 -top-px bottom-0"},null,-1),ot={class:"text-gray-400"},rt={class:"mt-1 flex text-xs leading-5 text-gray-500"},at=["href"],lt={class:"flex shrink-0 items-center gap-x-4"},ht={__name:"DirectoryList",setup(c){const b=H(),s=$(""),h=$(!1),m=$(null),f=p(()=>b.filteredUsers(s.value));F(async()=>{await b.init()});const x=d=>{m.value=d,h.value=!0},g=()=>{h.value=!1,m.value=null},S=(d,i)=>{var v,w;const o=((v=d==null?void 0:d.charAt(0))==null?void 0:v.toUpperCase())||"",y=((w=i==null?void 0:i.charAt(0))==null?void 0:w.toUpperCase())||"";return`${o}${y}`||"?"};return(d,i)=>(a(),l(P,null,[C(Q,{"onUpdate:searchQuery":i[0]||(i[0]=o=>s.value=o)},{default:T(()=>[X(d.$slots,"default")]),_:3}),e("div",Ge,[e("div",null,[e("ul",He,[(a(!0),l(P,null,R(f.value,o=>(a(),l("li",{key:o.id,class:"relative flex justify-between gap-x-6 px-4 py-5 hover:bg-gray-50 sm:px-6 lg:px-8 cursor-pointer",onClick:y=>x(o)},[e("div",Xe,[o.photo_profile?(a(),l("img",{key:0,class:"h-12 w-12 flex-none rounded-full bg-gray-50 object-cover object-center",src:o.photo_profile,alt:"Photo Profile"},null,8,Ye)):(a(),l("div",Ze,t(S(o.first_name,o.last_name)),1)),e("div",et,[e("p",tt,[e("a",null,[st,k(" "+t(o.first_name)+" "+t(o.last_name)+" ",1),e("span",ot," ("+t(o.role=="client"?"Cliente":o.role=="basic"?"Básico":o.role=="corporate_client"?"Corporativo":"Abogado")+") ",1)])]),e("p",rt,[e("a",{href:`mailto:${o.email}`,class:"relative truncate hover:underline"},t(o.email),9,at)])])]),e("div",lt,[C(j(Z),{class:"h-5 w-5 flex-none text-gray-400","aria-hidden":"true"})])],8,Ke))),128))])])]),(a(),U(K,{to:"body"},[h.value&&m.value?(a(),U(ze,{key:0,"is-visible":h.value,user:m.value,onClose:g},null,8,["is-visible","user"])):E("",!0)]))],64))}};export{ht as default};
