import{u as w,r as k,o as V,e as r,f as m,g as e,t as p,l as x,F as C,H as T,s as U,m as h,w as _,v as y,i as S,O as N,ah as E}from"./index.js";import{u as B}from"./dynamicDocument.js";const I={class:"pb-10 px-4 sm:px-6 lg:px-8 lg:pt-10"},F={class:"w-full p-5 rounded-lg border-2 border-stroke bg-terciary"},M={class:"text-primary text-xl font-semibold"},P={class:"mt-4 space-y-4"},$={class:"text-primary text-lg font-semibold col-span-12"},O={class:"col-span-4"},q=["for"],A=e("span",{class:"text-red-500"},"*",-1),G=["onUpdate:modelValue","id"],H={key:0,class:"text-red-500 text-sm mt-1"},L={class:"col-span-4"},R=e("label",{for:"tooltip",class:"block text-sm font-medium leading-6 text-primary"}," Tooltip ",-1),j=["onUpdate:modelValue"],z={class:"col-span-4"},J=e("label",{for:"field_type",class:"block text-sm font-medium leading-6 text-primary"},[h(" Tipo de input "),e("span",{class:"text-red-500"},"*")],-1),K=["onUpdate:modelValue"],Q=e("option",{value:"input"},"Texto simple",-1),W=e("option",{value:"text_area"},"Texto largo",-1),X=[Q,W],Y={class:"mt-6 flex space-x-4"},oe={__name:"DocumentVariablesConfig",setup(Z){const f=w(),o=B(),c=k([]);V(()=>{o.selectedDocument||console.error("No selected document found")});const b=()=>{var s;c.value=[];let l=!0;return(s=o.selectedDocument)==null||s.variables.forEach((d,i)=>{(!d.name_es||d.name_es.trim()==="")&&(c.value[i]="Este campo es obligatorio.",l=!1)}),l||E.fire({title:"Campos incompletos",text:"Por favor, completa todos los campos obligatorios.",icon:"warning"}),l},g=l=>{b()&&D(l)},D=async l=>{try{const s={title:o.selectedDocument.title,content:o.selectedDocument.content,state:l,variables:o.selectedDocument.variables.map(n=>({name_en:n.name_en,name_es:n.name_es,tooltip:n.tooltip||"",field_type:n.field_type,value:n.value}))},d=o.selectedDocument.title,i=o.selectedDocument.content;let t,a;if(o.selectedDocument.id?(t=o.selectedDocument.id,a=await o.updateDocument(t,s)):(a=await o.createDocument(s),a&&a.id&&(t=a.id)),o.selectedDocument=null,await o.init(),!t){const n=o.documents.find(u=>u.title===d&&u.content===i&&u.state===l);n&&(t=n.id)}t&&(window.localStorage.setItem("lastUpdatedDocumentId",t.toString()),o.lastUpdatedDocumentId=t),await U(l==="Draft"?"Documento guardado como borrador":"Documento publicado exitosamente","success"),setTimeout(()=>{f.push("/dynamic_document_dashboard")},300)}catch(s){console.error("Error saving document:",s)}},v=()=>{f.push("/dynamic_document_dashboard")};return(l,s)=>{var d,i;return r(),m("div",I,[e("div",F,[e("h1",M,p((d=x(o).selectedDocument)==null?void 0:d.title),1),e("div",P,[(r(!0),m(C,null,T(((i=x(o).selectedDocument)==null?void 0:i.variables)||[],(t,a)=>(r(),m("div",{key:a,class:"grid grid-cols-12 gap-4 items-center"},[e("h2",$,p(t.name_en),1),e("div",O,[e("label",{for:"name_es_"+a,class:"block text-sm font-medium leading-6 text-primary"},[h(" Nombre en pantalla "),A],8,q),_(e("input",{type:"text","onUpdate:modelValue":n=>t.name_es=n,id:"name_es_"+a,class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm ring-1 ring-inset ring-gray-300",required:""},null,8,G),[[y,t.name_es]]),c.value[a]?(r(),m("p",H,p(c.value[a]),1)):S("",!0)]),e("div",L,[R,_(e("input",{type:"text","onUpdate:modelValue":n=>t.tooltip=n,id:"tooltip",class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm ring-1 ring-inset ring-gray-300",placeholder:"Opcional"},null,8,j),[[y,t.tooltip]])]),e("div",z,[J,_(e("select",{"onUpdate:modelValue":n=>t.field_type=n,id:"field_type",class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm"},X,8,K),[[N,t.field_type]])])]))),128))]),e("div",Y,[e("button",{onClick:s[0]||(s[0]=t=>g("Draft")),class:"p-2.5 text-sm font-medium rounded-md bg-secondary text-white"}," Guardar como borrador "),e("button",{onClick:s[1]||(s[1]=t=>g("Published")),class:"p-2.5 text-sm font-medium rounded-md bg-gray-200 text-secondary border-2"}," Publicar "),e("button",{onClick:s[2]||(s[2]=t=>v()),type:"button",class:"p-2.5 text-sm font-medium rounded-md flex gap-2 bg-red-600/80 text-white cursor-pointer"}," Cancelar ")])])])}}};export{oe as default};
