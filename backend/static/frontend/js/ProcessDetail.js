import{e as a,f as i,g as e,c as h,t as c,F as $,N as j,ac as M,n as L,l as P,m as I,x as N,ab as Z,u as q,H as G,I as J,aj as K,r as C,T as Q,a9 as W,h as y,j as k,w as X,v as Y,ak as ee}from"./index.js";import{_ as te}from"./file-01.js";import{r as se}from"./MagnifyingGlassIcon2.js";import{r as oe}from"./EyeIcon.js";import{r as ne}from"./ChevronRightIcon2.js";function ae(p,d){return a(),i("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M11.78 5.22a.75.75 0 0 1 0 1.06L8.06 10l3.72 3.72a.75.75 0 1 1-1.06 1.06l-4.25-4.25a.75.75 0 0 1 0-1.06l4.25-4.25a.75.75 0 0 1 1.06 0Z","clip-rule":"evenodd"})])}const ie={class:"w-full"},re={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4"},le={class:"flex-1 min-w-0"},ce=e("h3",{class:"text-sm font-semibold text-blue-600"},"Etapa Procesal",-1),de={class:"text-sm sm:text-base font-medium text-gray-900 mt-1 truncate"},ue=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 sm:h-5 sm:w-5 sm:mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),me=e("span",{class:"hidden sm:inline"},"Histórico Procesal",-1),xe=e("span",{class:"sm:hidden ml-1"},"Histórico",-1),he=[ue,me,xe],pe={class:"relative"},_e={class:"flex justify-between mb-2 text-xs font-medium text-gray-600"},ge=e("span",{class:"truncate max-w-[80px] sm:max-w-none"},"Inicio",-1),fe={class:"hidden sm:inline truncate px-2"},ve=e("span",{class:"truncate max-w-[80px] sm:max-w-none text-right"},"Fin Proceso",-1),we={class:"flex items-center"},ye={class:"flex-1 flex items-center"},be={class:"mt-2 text-center sm:text-right"},ke={class:"text-xs sm:text-sm font-medium text-gray-700"},$e={__name:"ProcessStageProgress",props:{stages:{type:Array,default:()=>[]},totalStagesExpected:{type:Number,default:5}},emits:["openHistory"],setup(p){const d=p,f=h(()=>!d.stages||d.stages.length===0?"Sin etapa":d.stages[d.stages.length-1].status),v=h(()=>{if(!d.stages||d.stages.length===0)return 0;const m=d.stages.length/d.totalStagesExpected*100;return Math.min(Math.round(m),100)}),u=h(()=>{const m=[],t=Math.ceil(v.value/100*5);for(let o=0;o<5;o++)m.push({active:o<t});return m});return(m,_)=>(a(),i("div",ie,[e("div",re,[e("div",le,[ce,e("p",de,c(f.value),1)]),e("button",{onClick:_[0]||(_[0]=t=>m.$emit("openHistory")),class:"inline-flex items-center justify-center px-3 py-2 sm:px-4 border border-blue-300 rounded-md shadow-sm text-xs sm:text-sm font-medium text-blue-700 bg-blue-50 hover:bg-blue-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors whitespace-nowrap flex-shrink-0"},he)]),e("div",pe,[e("div",_e,[ge,e("span",fe,c(f.value),1),ve]),e("div",we,[e("div",ye,[(a(!0),i($,null,j(u.value,(t,o)=>(a(),i("div",{key:o,class:"relative flex-1 h-8 sm:h-10",style:M({zIndex:u.value.length-o})},[e("div",{class:L(["absolute inset-0 flex items-center transition-all duration-300",[t.active?"opacity-100":"opacity-40"]])},[e("div",{class:L(["h-full flex-1 flex items-center justify-center relative",[t.active?"bg-blue-600":"bg-gray-300"]]),style:M({clipPath:(o===u.value.length-1,"polygon(0 0, calc(100% - 15px) 0, 100% 50%, calc(100% - 15px) 100%, 0 100%, 15px 50%)"),marginLeft:o===0?"0":"-15px"})},[t.active?(a(),i("span",{key:0,class:"text-white text-xs font-medium px-2 truncate",style:M({marginLeft:o===0?"0":"15px"})},null,4)):P("",!0)],6)],2)],4))),128))])]),e("div",be,[e("span",ke,c(v.value)+"% completado ",1)])])]))}},Ce={class:"bg-white rounded-xl shadow-xl max-w-3xl w-full mx-4 max-h-[85vh] flex flex-col"},je=N('<div class="flex items-center space-x-3"><div class="p-2 bg-white bg-opacity-20 rounded-lg"><svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg></div><div><h3 class="text-lg font-semibold text-white"> Histórico Procesal </h3><p class="text-blue-100 text-sm"> Registro cronológico de etapas </p></div></div>',1),Pe=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),De=[Pe],Se={class:"p-6 overflow-y-auto flex-1 min-h-0"},Be={key:0,class:"space-y-4"},Me={class:"flex-shrink-0"},Le={class:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center"},ze={class:"text-blue-700 font-semibold text-sm"},Ae={class:"flex-1 min-w-0"},Ee={class:"text-base font-medium text-gray-900"},He={class:"text-sm text-gray-500 mt-1"},Ve={key:1,class:"text-center py-12"},Te=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),Ue=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"Sin etapas registradas",-1),Oe=e("p",{class:"mt-1 text-sm text-gray-500"}," No hay etapas procesales registradas para este proceso. ",-1),Re=[Te,Ue,Oe],Fe={__name:"ProcessHistoryModal",props:{isOpen:{type:Boolean,default:!1},stages:{type:Array,default:()=>[]}},emits:["close"],setup(p,{emit:d}){const f=p,v=d,u=()=>{v("close")},m=h(()=>f.stages?[...f.stages].sort((t,o)=>{const r=t.date||t.created_at,x=o.date||o.created_at;return new Date(x)-new Date(r)}):[]),_=t=>{if(!t)return"Fecha no disponible";let o;if(typeof t=="string"&&t.length===10&&t.includes("-")&&!t.includes("T")){const[x,b,D]=t.split("-").map(Number);return o=new Date(x,b-1,D),o.toLocaleDateString("es-CO",{year:"numeric",month:"long",day:"numeric"})}o=new Date(t);const r={year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"America/Bogota"};return o.toLocaleDateString("es-CO",r)};return(t,o)=>p.isOpen?(a(),i("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/40",onClick:I(u,["self"])},[e("div",Ce,[e("div",{class:"bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-4 flex-shrink-0"},[e("div",{class:"flex items-center justify-between"},[je,e("button",{onClick:u,class:"text-white hover:text-blue-200 transition-colors p-2 hover:bg-white hover:bg-opacity-10 rounded-lg"},De)])]),e("div",Se,[p.stages&&p.stages.length>0?(a(),i("div",Be,[(a(!0),i($,null,j(m.value,(r,x)=>(a(),i("div",{key:r.id,class:"flex items-start space-x-4 p-4 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors"},[e("div",Me,[e("div",Le,[e("span",ze,c(x+1),1)])]),e("div",Ae,[e("h4",Ee,c(r.status),1),e("p",He,c(_(r.date||r.created_at)),1)])]))),128))])):(a(),i("div",Ve,Re))]),e("div",{class:"bg-gray-50 px-6 py-4 flex justify-end border-t border-gray-200 flex-shrink-0 rounded-b-xl"},[e("button",{onClick:u,class:"px-5 py-2.5 bg-white border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors"}," Cerrar ")])])])):P("",!0)}},Ie={class:"sticky top-0 z-40 flex h-16 shrink-0 items-center gap-x-4 border-b border-gray-200 bg-white px-4 shadow-sm sm:gap-x-6 sm:px-6 lg:px-8"},Ne={class:"py-10 px-4 sm:px-6 lg:px-8"},Ze={key:0,class:"space-y-6"},qe={class:"p-6 rounded-lg border border-gray-200 bg-white shadow-sm"},Ge={class:"flex flex-col gap-4 md:flex-row md:items-start md:justify-between mb-6"},Je={class:"flex items-center gap-3"},Ke=e("img",{src:te,class:"h-6 w-6 sm:h-8 sm:w-8 text-blue-600 flex-shrink-0"},null,-1),Qe={class:"min-w-0 flex-1"},We={class:"text-base sm:text-xl font-semibold text-blue-600 break-words"},Xe={class:"text-xs sm:text-sm text-gray-600 mt-1 break-words"},Ye={class:"flex items-center gap-2 sm:gap-3 min-w-0"},et=["src","alt"],tt={key:1,class:"w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center text-white font-semibold text-base sm:text-lg shadow-md flex-shrink-0"},st={class:"min-w-0 flex-1"},ot={class:"text-xs sm:text-sm font-medium text-gray-900 truncate"},nt={class:"text-xs text-gray-500 truncate"},at={class:"grid md:grid-cols-2 gap-6"},it={class:"space-y-4"},rt={class:"bg-gray-50 rounded-lg p-3 sm:p-4 border border-gray-200"},lt=e("h3",{class:"text-xs sm:text-sm font-semibold text-blue-600 mb-3 break-words"},"Oficina de Control Interno Disciplinario",-1),ct={class:"space-y-2"},dt={class:"flex flex-col sm:flex-row sm:items-start gap-1"},ut=e("span",{class:"text-xs sm:text-sm font-medium text-gray-600 sm:w-32 flex-shrink-0"},"Autoridad:",-1),mt={class:"text-xs sm:text-sm text-gray-900 break-words"},xt={class:"flex flex-col sm:flex-row sm:items-start gap-1"},ht=e("span",{class:"text-xs sm:text-sm font-medium text-gray-600 sm:w-32 flex-shrink-0"},"Email:",-1),pt={class:"text-xs sm:text-sm text-blue-600 break-all"},_t={class:"flex flex-col sm:flex-row sm:items-start gap-1"},gt=e("span",{class:"text-xs sm:text-sm font-medium text-gray-600 sm:w-32 flex-shrink-0"},"Radicado:",-1),ft={class:"text-xs sm:text-sm text-gray-900 break-words"},vt={class:"bg-gray-50 rounded-lg p-3 sm:p-4 border border-gray-200"},wt=e("h3",{class:"text-xs sm:text-sm font-semibold text-blue-600 mb-3"},"Partes del Proceso",-1),yt={class:"space-y-2"},bt={class:"flex flex-col sm:flex-row sm:items-start gap-1"},kt=e("span",{class:"text-xs sm:text-sm font-medium text-gray-600 sm:w-32 flex-shrink-0"},"Dte./Accionante:",-1),$t={class:"text-xs sm:text-sm text-gray-900 break-words"},Ct={class:"flex flex-col sm:flex-row sm:items-start gap-1"},jt=e("span",{class:"text-xs sm:text-sm font-medium text-gray-600 sm:w-32 flex-shrink-0"},"Ddo./Accionado:",-1),Pt={class:"text-xs sm:text-sm text-gray-900 break-words"},Dt={class:"p-6 rounded-lg border border-gray-200 bg-white shadow-sm"},St={class:"flex flex-col gap-3 justify-between font-medium md:flex-row mb-4"},Bt=e("h3",{class:"text-lg font-semibold text-blue-600"},"Expediente",-1),Mt={class:"max-w-lg lg:max-w-xs"},Lt=e("label",{for:"search",class:"sr-only"},"Buscar",-1),zt={class:"relative"},At={class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},Et={key:0,class:"flex flex-col items-center justify-center py-12 text-center"},Ht=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-16 w-16 text-gray-300 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),Vt=e("h3",{class:"text-base font-medium text-gray-900 mb-1"},"No hay expedientes registrados",-1),Tt=e("p",{class:"text-sm text-gray-500 max-w-sm"}," Este proceso aún no tiene documentos de expediente asociados. Los archivos que se agreguen aparecerán aquí. ",-1),Ut=[Ht,Vt,Tt],Ot={key:1,class:"flow-root overflow-y-auto max-h-[400px] whitespace-nowrap"},Rt={class:"-my-2 sm:-mx-6 lg:-mx-8"},Ft={class:"inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8"},It={class:"min-w-full divide-y divide-gray-300"},Nt=e("thead",null,[e("tr",{class:"text-left text-base font-regular text-primary"},[e("th",{scope:"col",class:"py-3.5 pr-3 w-2/5"},"Documento"),e("th",{scope:"col",class:"px-3 py-3.5 w-2/5"},"Fecha"),e("th",{scope:"col",class:"px-3 py-3.5 w-1/5"},"Acción")])],-1),Zt={class:"divide-y divide-gray-200"},qt={class:"w-2/5 py-4 pr-3 text-sm font-medium text-stone-700 sm:pl-0 break-words"},Gt={class:"whitespace-nowrap w-2/5 px-3 py-4 text-sm text-stone-700"},Jt={class:"whitespace-nowrap w-1/5 px-3 py-4 text-sm text-primary flex space-x-2"},Kt=["onClick"],Qt=["onClick"],Wt={class:"w-full flex justify-between mt-4"},Xt={class:"flex items-center justify-between"},Yt={class:"sm:flex sm:flex-1 sm:items-center sm:justify-between"},es={class:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination"},ts=["disabled"],ss=e("span",{class:"sr-only"},"Anterior",-1),os=["onClick"],ns=["disabled"],as=e("span",{class:"sr-only"},"Siguiente",-1),is={key:0},rs=e("span",{class:"lg:block"},"Editar",-1),ls=[rs],hs={__name:"ProcessDetail",setup(p){const d=Z(),f=q(),v=G(),u=J(),m=h(()=>u.currentUser),_=d.params.process_id,t=h(()=>v.processById(_));K(async()=>{try{await Promise.all([v.init(),u.init()])}catch(n){console.error("Error initializing process detail:",n)}});const o=C(""),r=C(1),x=C(10),b=C(!1);Q(o,()=>{r.value=1});function D(){f.push({name:"process_form",params:{action:"edit",process_id:_}})}const S=h(()=>o.value?t.value.case_files.filter(n=>z(n.file).toLowerCase().includes(o.value.toLowerCase())):t.value.case_files),E=h(()=>{const n=(r.value-1)*x.value,l=n+x.value;return S.value.slice(n,l)}),B=h(()=>Math.ceil(S.value.length/x.value));function H(){r.value>1&&r.value--}function V(){r.value<B.value&&r.value++}function T(n){r.value=n}function z(n){return n.split("/").pop()}function U(n){window.open(n,"_blank")}const O=async n=>{try{const l=await fetch(n);if(!l.ok)throw new Error(`Failed to fetch the file: ${l.statusText}`);const g=await l.blob(),s=document.createElement("a");s.href=window.URL.createObjectURL(g);const w=n.split("/").pop();s.download=w,document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(s.href)}catch(l){console.error("An error occurred while downloading the file:",l)}},R=n=>{const l=new Date(n),g={timeZone:"America/Bogota",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1};return l.toLocaleString("en-CA",g)},F=(n,l)=>{var w,A;const g=((w=n==null?void 0:n.charAt(0))==null?void 0:w.toUpperCase())||"",s=((A=l==null?void 0:l.charAt(0))==null?void 0:A.toUpperCase())||"";return`${g}${s}`};return(n,l)=>{var g;return a(),i($,null,[e("div",Ie,[W(n.$slots,"default")]),e("div",Ne,[t.value?(a(),i("div",Ze,[e("div",qe,[e("div",Ge,[e("div",Je,[Ke,e("div",Qe,[e("h1",We,c(t.value.case.type),1),e("p",Xe,c(t.value.subcase),1)])]),e("div",Ye,[t.value.client.photo_profile?(a(),i("img",{key:0,src:t.value.client.photo_profile,alt:t.value.client.first_name,class:"w-10 h-10 sm:w-12 sm:h-12 rounded-full object-cover border-2 border-gray-200 shadow-sm flex-shrink-0"},null,8,et)):(a(),i("div",tt,c(F(t.value.client.first_name,t.value.client.last_name)),1)),e("div",st,[e("p",ot,c(t.value.client.first_name)+" "+c(t.value.client.last_name),1),e("p",nt,c(t.value.client.email||"Cliente"),1)])])]),e("div",at,[e("div",it,[e("div",rt,[lt,e("div",ct,[e("div",dt,[ut,e("span",mt,c(t.value.authority),1)]),e("div",xt,[ht,e("span",pt,c(t.value.authority.toLowerCase().replace(/\s+/g,""))+"@colpensiones.gov.co",1)]),e("div",_t,[gt,e("span",ft,c(t.value.ref),1)])])]),e("div",vt,[wt,e("div",yt,[e("div",bt,[kt,e("span",$t,c(t.value.plaintiff),1)]),e("div",Ct,[jt,e("span",Pt,c(t.value.defendant),1)])])])]),e("div",null,[y($e,{stages:t.value.stages,"total-stages-expected":5,onOpenHistory:l[0]||(l[0]=s=>b.value=!0)},null,8,["stages"])])])]),e("div",Dt,[e("div",St,[Bt,e("div",Mt,[Lt,e("div",zt,[e("div",At,[y(k(se),{class:"h-5 w-5 text-gray-400","aria-hidden":"true"})]),X(e("input",{id:"search",name:"search","onUpdate:modelValue":l[1]||(l[1]=s=>o.value=s),class:"block w-full rounded-md border-0 bg-white py-1.5 pl-10 pr-3 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-secondary sm:text-sm sm:leading-6",placeholder:"Buscar",type:"search"},null,512),[[Y,o.value]])])])]),S.value.length===0?(a(),i("div",Et,Ut)):(a(),i("div",Ot,[e("div",Rt,[e("div",Ft,[e("table",It,[Nt,e("tbody",Zt,[(a(!0),i($,null,j(E.value,s=>(a(),i("tr",{key:s.id},[e("td",qt,c(z(s.file)),1),e("td",Gt,c(R(s.created_at)),1),e("td",Jt,[e("button",{onClick:w=>O(s.file)},[y(k(ee),{class:"h-5 w-5","aria-hidden":"true"})],8,Kt),e("button",{onClick:w=>U(s.file)},[y(k(oe),{class:"h-5 w-5","aria-hidden":"true"})],8,Qt)])]))),128))])])])])]))]),e("div",Wt,[e("div",Xt,[e("div",Yt,[e("div",null,[e("nav",es,[e("button",{onClick:H,disabled:r.value===1,class:"relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0"},[ss,y(k(ae),{class:"h-5 w-5","aria-hidden":"true"})],8,ts),(a(!0),i($,null,j(B.value,s=>(a(),i("span",{key:s,onClick:w=>T(s),class:L(["relative inline-flex items-center px-4 py-2 text-sm font-semibold focus:z-20 focus:outline-offset-0",{"bg-secondary text-white":r.value===s},{"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 cursor-pointer":r.value!==s}])},c(s),11,os))),128)),e("button",{onClick:V,disabled:r.value===B.value,class:"relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0"},[as,y(k(ne),{class:"h-5 w-5","aria-hidden":"true"})],8,ns)])])])]),m.value.role!=="client"?(a(),i("div",is,[e("button",{onClick:D,type:"button",class:"p-2.5 text-sm text-white font-medium bg-secondary rounded-md flex gap-2"},ls)])):P("",!0)])])):P("",!0)]),y(Fe,{"is-open":b.value,stages:((g=t.value)==null?void 0:g.stages)||[],onClose:l[2]||(l[2]=s=>b.value=!1)},null,8,["is-open","stages"])],64)}}};export{hs as default};
