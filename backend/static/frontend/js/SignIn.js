import{u as T,a as q,r as _,c as y,b as B,o as G,d as L,e as m,f as h,g as e,w as b,v as k,h as l,i as f,j as i,k as M,l as v,m as A,n as z,p as c,t as C,F,_ as P,R as p,s as a,q as U}from"./index.js";import{u as D,_ as K,a as O,b as W}from"./captcha.js";import{l as $}from"./login_with_google.js";const H=e("div",{class:"relative xl:absolute"},[e("div",{class:"flex justify-start p-4"},[e("img",{class:"w-40 hidden xl:block",src:K}),e("img",{class:"w-20 block xl:hidden",src:P})])],-1),Y={class:"flex mt-6 justify-center xl:mt-0 xl:h-screen xl:items-center"},J={class:"space-y-5 px-8 w-full md:px-32 2xl:px-72 xl:w-1/2 2xl:w-2/3 order-2"},Q=e("h1",{class:"font-bold text-center text-2xl xl:text-3xl 2xl:text-4xl"}," Te damos la bienvenida de nuevo ",-1),X=e("label",{for:"email",class:"block mb-2 text-sm font-medium text-gray-900"}," Correo electronico ",-1),Z=e("label",{for:"password",class:"block mb-2 text-sm font-medium text-gray-900"}," Contraseña ",-1),ee={class:"text-sm font-medium text-secondary"},se={class:"flex flex-col space-y-2"},te=["disabled"],oe={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},ae=e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),re=e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1),ne=[ae,re],le={key:0,class:"text-start text-sm mt-2 text-gray-600"},ie=e("span",{class:"font-regular"},"Intentar de nuevo en ",-1),ce={class:"font-bold"},de=e("span",{class:"font-regular"}," segundos.",-1),ue=e("span",{class:"font-regular"},"¿Nuevo en G&M?",-1),me={class:"flex flex-col items-center justify-center text-center"},fe=e("div",{class:"flex items-center w-full mx-4"},[e("div",{class:"flex-grow border-t border-gray-300"}),e("span",{class:"mx-4 text-gray-500"},"O continuar con"),e("div",{class:"flex-grow border-t border-gray-300"})],-1),pe={class:"w-full flex justify-around items-center text-center text-secondary font font-regular text-sm"},xe=e("div",{class:"h-screen hidden overflow-hidden order-1 xl:w-1/2 2xl:w-1/3 xl:block"},[e("img",{src:O,alt:"illustration",class:"w-full h-full object-cover"})],-1),we={__name:"SignIn",setup(ge){const w=T(),r=q(),I=D(),x=_(""),d=_(""),S=async s=>{d.value=s},V=()=>{d.value=""},j=y(()=>r.signInTries),n=y(()=>r.signInSecondsRemaining),o=_(!1),t=B({email:"",password:""});G(async()=>{r.attempsSignIn("initial"),x.value=await I.fetchSiteKey(),await r.isAuthenticated()&&w.push({name:"dashboard",params:{user_id:"",display:""}})});const E=async()=>{if(!t.email){a("Email is required!","warning");return}if(!t.password){a("Password is required!","warning");return}if(!d.value){a("Por favor verifica que no eres un robot","warning");return}if(!o.value){if(r.attempsSignIn(),j.value%3===0)a("You have exceeded the maximum number of attempts. Please try again later.","warning");else{o.value=!0;try{const s=await U.post("/api/sign_in/",{email:t.email,password:t.password,captcha_token:d.value});r.login(s.data),a("¡Inicio de sesión exitoso!","success"),window.location.href="/dashboard"}catch(s){s.response&&s.response.status===401?a("Credenciales inválidas!","warning"):s.response&&s.response.status===400?a(s.response.data.error||"Error de validación","error"):a("¡Error en el inicio de sesión!","error")}finally{o.value=!1}}t.password=""}},N=s=>{$(s,w,r)};return(s,u)=>{const R=L("GoogleLogin");return m(),h(F,null,[H,e("section",Y,[e("form",J,[Q,e("div",null,[X,b(e("input",{"onUpdate:modelValue":u[0]||(u[0]=g=>t.email=g),type:"email",id:"email",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-secondary focus:border-secondary block w-full p-2.5",required:""},null,512),[[k,t.email]])]),e("div",null,[Z,b(e("input",{"onUpdate:modelValue":u[1]||(u[1]=g=>t.password=g),type:"password",id:"password",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-secondary focus:border-secondary block w-full p-2.5",placeholder:""},null,512),[[k,t.password]]),e("a",ee,[l(i(p),{to:{name:"forget_password"}},{default:f(()=>[c(" ¿Olvidaste tu contraseña? ")]),_:1})])]),e("div",null,[x.value?(m(),M(i(W),{key:0,sitekey:x.value,onVerify:S,onExpire:V,hl:"es",class:"mx-auto"},null,8,["sitekey"])):v("",!0)]),e("div",se,[e("div",null,[e("button",{onClick:A(E,["prevent"]),type:"submit",disabled:n.value>1||o.value,class:z({"w-full text-white bg-secondary hover:bg-blue-800 font-medium rounded-lg text-sm px-5 py-2.5 text-center flex items-center justify-center":n.value<1&&!o.value,"w-full text-white bg-gray-400 cursor-not-allowed font-medium rounded-lg text-sm px-5 py-2.5 text-center flex items-center justify-center":n.value>=1||o.value})},[o.value?(m(),h("svg",oe,ne)):v("",!0),c(" "+C(o.value?"Validando credenciales...":"Iniciar sesión"),1)],10,te),n.value>0?(m(),h("div",le,[ie,e("span",ce,C(n.value),1),de])):v("",!0)]),e("p",null,[ue,l(i(p),{to:{name:"sign_on"},class:"font-regular text-secondary"},{default:f(()=>[c(" Registrarse. ")]),_:1})])]),e("div",me,[fe,l(R,{class:"mt-6",callback:N,"select-account":"","auto-login":!1})]),e("div",pe,[l(i(p),{to:{name:"terms_of_use"},class:"cursor-pointer"},{default:f(()=>[c("Condiciones de uso")]),_:1}),l(i(p),{to:{name:"privacy_policy"},class:"cursor-pointer"},{default:f(()=>[c("Aviso de privacidad")]),_:1})])]),xe])],64)}}};export{we as default};
