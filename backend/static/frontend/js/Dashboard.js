import{e as n,f as m,g as e,r as $,j as o,l as a,n as S,i as P,F as C,s as B,W as he,b as _e,c as F,D as xe,z as Z,w as U,v as re,h as R,G as Q,X as O,U as z,Y as ie,t as M,m as H,P as ye,u as X,am as fe,N as we,k as _,B as J,S as Y,T as K,M as ee,I as A,H as te,aA as De,o as ce,J as ke}from"./index.js";import{u as j,o as se,s as V,p as oe}from"./dynamicDocument.js";import{_ as $e}from"./SearchBarAndFilterBy.js";import{r as Ce,a as Me,_ as q}from"./ModalTransition.js";import{s as Pe,h as me,r as le}from"./loading_message.js";import"./MagnifyingGlassIcon.js";function de(b,s){return n(),m("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}function Se(b,s){return n(),m("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"})])}function ae(b,s){return n(),m("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5ZM12 12.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5ZM12 18.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5Z"})])}function G(b,s){return n(),m("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 12.75V12A2.25 2.25 0 0 1 4.5 9.75h15A2.25 2.25 0 0 1 21.75 12v.75m-8.69-6.44-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"})])}function Ee(b,s){return n(),m("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M18.364 18.364A9 9 0 0 0 5.636 5.636m12.728 12.728A9 9 0 0 1 5.636 5.636m12.728 12.728L5.636 5.636"})])}function ue(b,s){return n(),m("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"})])}function pe(b,s){return n(),m("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4.5v15m7.5-7.5h-15"})])}const ze={key:0,class:"pb-8 border-b border-gray-200 flex gap-6 flex-wrap"},Fe=e("div",{class:"grid"},[e("span",{class:"font-medium text-base"},"Documentos"),e("span",{class:"text-gray-400 font-regular text-sm"},"Mi unidad")],-1),Be=e("div",{class:"grid"},[e("span",{class:"font-medium text-base"},"Documentos Finalizados"),e("span",{class:"text-gray-400 font-regular text-sm"},"Clientes")],-1),Ne=e("div",{class:"grid"},[e("span",{class:"font-medium text-base"},"Documentos en Progreso"),e("span",{class:"text-gray-400 font-regular text-sm"},"Clientes")],-1),Ue=e("div",{class:"grid"},[e("span",{class:"font-medium text-base"},"Nuevo Documento")],-1),Ae={key:1,class:"pb-8 border-b border-gray-200 flex gap-6 flex-wrap"},Qe=e("div",{class:"grid"},[e("span",{class:"font-medium text-base"},"Mis Documentos")],-1),Ve=e("div",{class:"grid"},[e("span",{class:"font-medium text-base"},"Nuevo Documento")],-1),je={__name:"DocumentsNavigation",props:{role:String},emits:["updateCurrentSection","openNewDocument"],setup(b,{emit:s}){const p=s,i=$("default"),d=b,g=x=>{i.value=x,p("updateCurrentSection",x)};return(x,r)=>(n(),m(C,null,[(d==null?void 0:d.role)==="lawyer"?(n(),m("div",ze,[e("button",{onClick:r[0]||(r[0]=u=>g("default")),class:S(["flex gap-2 items-center py-2 px-4 rounded-xl border-2 border-yellow-300 text-start bg-white",{"bg-yellow-300/30":i.value=="default"}])},[o(a(G),{class:"size-6 text-yellow-500 font-semibold"}),Fe],2),e("button",{onClick:r[1]||(r[1]=u=>g("documentFinished")),class:S(["flex gap-2 items-center py-2 px-4 rounded-xl border-2 border-yellow-300 bg-white text-start",{"bg-yellow-300/30":i.value=="documentFinished"}])},[o(a(G),{class:"size-6 text-yellow-500 font-semibold"}),Be],2),e("button",{onClick:r[2]||(r[2]=u=>g("documentInProgress")),class:S(["flex gap-2 items-center py-2 px-4 rounded-xl border-2 border-yellow-300 bg-white text-start",{"bg-yellow-300/30":i.value=="documentInProgress"}])},[o(a(G),{class:"size-6 text-yellow-500 font-semibold"}),Ne],2),e("button",{onClick:r[3]||(r[3]=u=>x.$emit("openNewDocument")),class:"flex gap-2 items-center py-2 px-4 rounded-md bg-white text-start hover:bg-gray-100"},[o(a(pe),{class:"size-6 text-secondary font-semibold"}),Ue])])):P("",!0),(d==null?void 0:d.role)==="client"?(n(),m("div",Ae,[e("button",{onClick:r[4]||(r[4]=u=>g("default")),class:S(["flex gap-2 items-center py-2 px-4 rounded-md border-2 border-yellow-300 bg-white text-start",{"bg-yellow-300/30":i.value=="default"}])},[o(a(G),{class:"size-6 text-yellow-500 font-semibold"}),Qe],2),e("button",{onClick:r[5]||(r[5]=u=>g("useDocument")),class:S(["flex gap-2 items-center py-2 px-4 rounded-md bg-white text-start hover:bg-gray-100",{"bg-selected-background":i.value=="useDocument"}])},[o(a(pe),{class:"size-6 text-secondary font-semibold"}),Ve],2)])):P("",!0)],64))}};function Ie(){const b=$(!1),s=$("");async function p(i,d,g="",x="",r=[],u={}){if(!d)throw s.value="Recipient email is required.",await B(s.value,"error"),new Error(s.value);const w=new FormData;w.append("to_email",d),w.append("subject",g),w.append("body",x),r.forEach((v,f)=>{w.append(`attachments[${f}]`,v)});for(const[v,f]of Object.entries(u))w.append(v,f);try{b.value=!0,s.value="",Pe("Sending email...","Please wait while we send the email.");const v=await he(i,w);return me(),await B("Email sent successfully.","success"),v.data}catch(v){throw me(),console.error("Error sending email:",v.message),s.value="An error occurred while sending the email. Please try again.",await B(s.value,"error"),v}finally{b.value=!1}}return{sendEmail:p,isLoading:b,errorMessage:s}}const Le={class:"bg-white rounded-lg p-6 shadow-xl max-w-lg w-full"},Oe={class:"flex justify-end"},Te=e("label",{for:"email",class:"block text-base font-medium leading-6 text-primary"},[H(" Correo electrónico "),e("span",{class:"text-red-500"},"*")],-1),We={class:"mt-2"},qe={class:"mt-4"},Re=e("label",{for:"files",class:"block text-base font-medium leading-6 text-primary"}," Anexos ",-1),Ze={key:0,class:"text-center"},Ge={class:"mt-4 flex text-sm/6 text-gray-600"},He={for:"file-upload",class:"relative cursor-pointer rounded-md bg-white font-semibold text-indigo-600 focus-within:outline-none focus-within:ring-2 focus-within:ring-indigo-600 focus-within:ring-offset-2 hover:text-indigo-500"},Xe=e("span",null,"Sube un archivo",-1),Je=e("p",{class:"pl-1"},"o arrastra y suelta",-1),Ye=e("p",{class:"text-xs/5 text-gray-600"}," PNG, JPG, PDF, DOCX de hasta 20MB ",-1),Ke={key:1,class:"w-full flex flex-wrap gap-3"},et=["onMouseenter","onMouseleave"],tt=["onClick"],st={class:"text-center text-xs truncate w-20"},ot=["disabled"],at=e("span",null,"Enviar",-1),nt=[at],lt="dynamic-documents/send_email_with_attachments/",rt=20*1024*1024,it={__name:"SendDocument",props:{emailDocument:{type:Object,required:!0}},emits:["closeEmailModal"],setup(b,{emit:s}){const p=s,{sendEmail:i}=Ie(),d=$(null),g=b,x=()=>{r.email="",u.value=[],d.value=null},r=_e({email:""}),u=$([]),w=c=>{const y=Array.from(c.target.files);f(y),c.target.value=null},v=c=>{const y=Array.from(c.dataTransfer.files);f(y)},f=c=>{let y=u.value.reduce((D,W)=>D+W.file.size,0);c.forEach(D=>{if(D.size>rt){B(`The file "${D.name}" exceeds the 20 MB limit.`,"warning");return}const W=D.name.split(".").pop().toLowerCase();let I="",L={general:"",xMark:""};switch(W){case"png":case"jpg":case"jpeg":I=Me,L.general="border-gray-200 text-gray-400",L.xMark="bg-gray-400";break;case"pdf":I=le,L.general="border-red-600/20 text-red-600/60",L.xMark="bg-red-600/60";break;case"docx":I=le,L.general="border-blue-600/20 text-blue-600/60",L.xMark="bg-blue-600/60";break;default:B("Unsupported file type. Only PDF, DOCX, JPG, and PNG are allowed.","warning");return}u.value.push({name:D.name,icon:I,style:L,hover:!1,file:D}),y+=D.size})},t=c=>{u.value.splice(c,1)},l=c=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(c),h=F(()=>l(r.email)),E=F(()=>h.value),T=async c=>{try{const y=await ye(`dynamic-documents/${c}/download-pdf/`,"blob");if(!y||!y.data)throw new Error("Invalid response from server");return new File([y.data],`document_${c}.pdf`,{type:"application/pdf"})}catch(y){return console.error("Error downloading PDF:",y),B("No se pudo descargar el documento PDF.","error"),null}};xe(()=>g.emailDocument,c=>{c&&Object.keys(c).length>0&&c.id&&T(c.id)},{immediate:!0});const k=async()=>{try{if(g.emailDocument.id){const y=await T(g.emailDocument.id);y&&u.value.push({name:y.name,file:y,icon:le,style:{general:"border-blue-600/20 text-blue-600/60",xMark:"bg-blue-600/60"},hover:!1})}const c=u.value.map(y=>y.file);await i(lt,r.email,g.emailDocument.title,"Attached is the requested document along with additional attachments.",c,{documentId:g.emailDocument.id})}catch(c){console.error("Error sending the email:",c)}finally{N()}},N=()=>{x(),p("closeEmailModal")};return(c,y)=>(n(),m("div",Le,[e("div",Oe,[e("button",{onClick:y[0]||(y[0]=D=>N())},[o(a(Z),{class:"size-6"})])]),e("form",{onSubmit:R(k,["prevent"])},[e("div",null,[Te,e("div",We,[U(e("input",{"onUpdate:modelValue":y[1]||(y[1]=D=>r.email=D),type:"text",name:"email",id:"email",class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-secondary sm:text-sm sm:leading-6",required:""},null,512),[[re,r.email]])])]),e("div",qe,[Re,e("div",{class:"mt-2 flex justify-center rounded-lg border border-dashed border-gray-900/25 bg-white px-6 py-10",onDragover:y[2]||(y[2]=R(()=>{},["prevent"])),onDrop:R(v,["prevent"])},[u.value.length<1?(n(),m("div",Ze,[o(a(Ce),{class:"mx-auto size-12 text-gray-300","aria-hidden":"true"}),e("div",Ge,[e("label",He,[Xe,e("input",{id:"file-upload",name:"file-upload",type:"file",class:"sr-only",onChange:w},null,32)]),Je]),Ye])):(n(),m("div",Ke,[(n(!0),m(C,null,Q(u.value,(D,W)=>(n(),m("div",{key:W,class:S(["relative p-4 grid rounded-md bg-white border-2",D.style.general]),onMouseenter:I=>D.hover=!0,onMouseleave:I=>D.hover=!1},[U(e("div",{class:S(["absolute p-0.5 mt-2 ml-2 rounded-full",D.style.xMark]),onClick:I=>t(W)},[o(a(Z),{class:"size-3 text-white"})],10,tt),[[O,D.hover]]),(n(),z(ie(D.icon),{class:"size-12 mx-auto"})),e("span",st,M(D.name),1)],42,et))),128))]))],32)]),e("button",{type:"submit",class:S(["mt-4 p-2.5 text-sm font-medium rounded-md flex gap-2",E.value?"bg-secondary text-white":"bg-gray-200 text-secondary border-2 border-dashed border-secondary cursor-not-allowed bg-opacity-50"]),disabled:!E.value},nt,10,ot)],32)]))}},ct={class:"bg-white rounded-lg p-6 shadow-xl max-w-lg w-full"},dt={class:"flex justify-end"},ut=e("label",{for:"document-name",class:"block text-base font-medium leading-6 text-primary"},[H(" Nombre "),e("span",{class:"text-red-500"},"*")],-1),mt={class:"mt-2"},pt=["disabled"],ge={__name:"UseDocumentByClient",props:{documentId:{type:[Number,null],required:!1,default:null}},setup(b){const s=b,p=X(),i=j(),d=$("");fe(()=>{var r;i.selectedDocument?d.value=((r=i.selectedDocument)==null?void 0:r.title)||"":d.value=""});const g=F(()=>d.value.trim().length>0);function x(){const r=encodeURIComponent(d.value.trim());if(s.documentId&&!i.selectedDocument)p.push(`/dynamic_document_dashboard/document/use/creator/${s.documentId}/${r}`);else if(i.selectedDocument){const u=encodeURIComponent(d.value.trim());p.push(`/dynamic_document_dashboard/document/use/editor/${i.selectedDocument.id}/${u}`)}else B("Error: No se pudo continuar. Documento no seleccionado.","error")}return(r,u)=>(n(),m("div",ct,[e("div",dt,[e("button",{onClick:u[0]||(u[0]=w=>r.$emit("close"))},[o(a(Z),{class:"size-6"})])]),e("form",{onSubmit:R(x,["prevent"])},[e("div",null,[ut,e("div",mt,[U(e("input",{"onUpdate:modelValue":u[1]||(u[1]=w=>d.value=w),type:"text",id:"document-name",class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm ring-1 ring-inset ring-gray-300",required:""},null,512),[[re,d.value]])])]),e("button",{type:"submit",class:S(["mt-2.5 p-2.5 text-sm font-medium rounded-md flex gap-2",g.value?"bg-secondary text-white":"bg-gray-200 text-secondary border-2 border-dashed border-secondary cursor-not-allowed bg-opacity-50"]),disabled:!g.value}," Continuar ",10,pt)],32)]))}};function be(b){return we.fire({title:b,icon:"question",showCancelButton:!0,confirmButtonText:"Aceptar",cancelButtonText:"Cancelar",buttonsStyling:!1}).then(s=>s.isConfirmed)}const ft={class:"bg-white rounded-lg shadow-xl p-6 max-w-4xl w-full overflow-auto max-h-[80vh]"},gt={class:"flex justify-between items-center mb-4"},bt={class:"text-lg font-bold"},vt=["innerHTML"],ne={__name:"DocumentPreviewModal",props:{isVisible:Boolean,documentData:{type:Object,default:()=>({title:"",content:""})}},emits:["close"],setup(b,{emit:s}){const p=s,i=()=>{p("close")};return(d,g)=>U((n(),z(q,null,{default:_(()=>[e("div",ft,[e("div",gt,[e("h2",bt," Previsualización del Documento: "+M(b.documentData.title),1),e("button",{onClick:i},[o(a(Z),{class:"size-6 text-gray-500 hover:text-gray-700"})])]),e("div",{class:"prose max-w-none",innerHTML:b.documentData.content},null,8,vt)])]),_:1},512)),[[O,b.isVisible]])}},ht={class:"mt-8 flex flex-wrap gap-6"},_t={class:"grid gap-1"},xt={class:"text-base font-medium"},yt={class:"text-sm font-regular text-gray-400"},wt={class:"py-1"},Dt=["onClick"],kt=["onClick"],$t=["onClick"],Ct=["onClick"],Mt=["onClick"],Pt=["onClick"],St={key:0,class:"mt-6 flex flex-col items-center justify-center text-center text-gray-500 w-full"},Et=e("p",{class:"text-lg font-semibold"}," No hay documentos disponibles para mostrar. ",-1),zt=e("p",{class:"text-sm"}," Contacta a tu abogado para gestionar tus documentos. ",-1),Ft=[Et,zt],Bt={__name:"DocumentListClient",props:{searchQuery:String},setup(b){const s=j(),p=J(),i=F(()=>p.getCurrentUser),d=$(!1),g=$(null),x=$(!1),r=$({}),u=b,w=F(()=>{const k=s.progressAndCompletedDocumentsByClient(i.value.id);return s.filteredDocuments(u.searchQuery,p).filter(N=>k.some(c=>c.id===N.id))}),v=k=>{s.downloadPDF(k.id,k.title)},f=k=>{s.downloadWord(k.id,k.title)},t=async k=>{await be(`¿Deseas eliminar el documento "${k.title}"?`)&&(await s.deleteDocument(k.id),await B("Documento eliminado exitosamente.","success"))},l=k=>{s.selectedDocument=k,g.value=k.id,d.value=!0},h=()=>{d.value=!1,s.clearSelectedDocument()},E=k=>{r.value=k,x.value=!0},T=()=>{r.value={},x.value=!1};return(k,N)=>(n(),m(C,null,[e("div",ht,[(n(!0),m(C,null,Q(w.value,c=>(n(),m("div",{key:c.id,class:S(["flex items-center gap-3 py-2 px-4 border rounded-xl cursor-pointer",{"border-green-400 bg-green-300/30":c.state==="Completed","border-stroke bg-white":c.state==="Progress"}])},[(n(),z(ie(c.state==="Completed"?a(de):a(ue)),{class:S(["size-6",{"text-green-500":c.state==="Completed","text-secondary":c.state==="Progress"}])},null,8,["class"])),e("div",_t,[e("span",xt,M(c.title),1),e("span",yt,M(c.description),1)]),o(a(te),{as:"div",class:"relative inline-block text-left"},{default:_(()=>[o(a(Y),{class:"flex items-center text-gray-400"},{default:_(()=>[o(a(ae),{class:"size-6","aria-hidden":"true"})]),_:1}),o(K,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:_(()=>[o(a(ee),{class:"absolute left-0 z-10 mt-2 w-56 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black/5 focus:outline-none"},{default:_(()=>[e("div",wt,[o(a(A),null,{default:_(()=>[e("button",{class:"block w-full text-left px-4 py-2 text-sm font-regular hover:bg-gray-100 transition",onClick:y=>l(c)},M(c.state==="Completed"?"Editar":"Completar"),9,Dt)]),_:2},1024),c.state==="Completed"?(n(),z(a(A),{key:0},{default:_(()=>[e("button",{class:"block w-full text-left px-4 py-2 text-sm font-regular hover:bg-gray-100 transition",onClick:y=>a(se)(c)}," Previsualizar ",8,kt)]),_:2},1024)):P("",!0),o(a(A),null,{default:_(()=>[e("button",{class:"block w-full text-left px-4 py-2 text-sm font-regular hover:bg-gray-100 transition",onClick:y=>t(c)}," Eliminar ",8,$t)]),_:2},1024),c.state==="Completed"?(n(),m(C,{key:1},[o(a(A),null,{default:_(()=>[e("button",{class:"block w-full text-left px-4 py-2 text-sm font-regular hover:bg-gray-100 transition",onClick:y=>v(c)}," Descargar PDF ",8,Ct)]),_:2},1024),o(a(A),null,{default:_(()=>[e("button",{class:"block w-full text-left px-4 py-2 text-sm font-regular hover:bg-gray-100 transition",onClick:y=>f(c)}," Descargar Word ",8,Mt)]),_:2},1024),o(a(A),null,{default:_(()=>[e("button",{class:"block w-full text-left px-4 py-2 text-sm font-regular hover:bg-gray-100 transition",onClick:y=>E(c)}," Enviar ",8,Pt)]),_:2},1024)],64)):P("",!0)])]),_:2},1024)]),_:2},1024)]),_:2},1024)],2))),128)),w.value.length===0?(n(),m("div",St,Ft)):P("",!0),U(o(q,null,{default:_(()=>[o(ge,{"document-id":g.value,onClose:h},null,8,["document-id"])]),_:1},512),[[O,d.value]])]),o(ne,{isVisible:a(V),documentData:a(oe),onClose:N[0]||(N[0]=c=>V.value=!1)},null,8,["isVisible","documentData"]),U(o(q,null,{default:_(()=>[o(it,{onCloseEmailModal:N[1]||(N[1]=c=>T()),emailDocument:r.value},null,8,["emailDocument"])]),_:1},512),[[O,x.value]])],64))}},Nt={class:"mt-8 flex flex-wrap gap-6"},Ut=["onClick"],At={class:"grid gap-1"},Qt={class:"text-base font-medium"},Vt={class:"text-sm font-regular text-gray-400"},jt={__name:"UseDocument",props:{searchQuery:String},setup(b){const s=j(),p=$(!1),i=$(null),d=b,g=F(()=>{const u=s.publishedDocumentsUnassigned;return s.filteredDocuments(d.searchQuery,"").filter(w=>u.some(v=>v.id===w.id))});function x(u){u&&(i.value=u,p.value=!0)}function r(){p.value=!1,i.value=null}return(u,w)=>(n(),m("div",Nt,[(n(!0),m(C,null,Q(g.value,v=>(n(),m("button",{key:v.id,onClick:f=>x(v.id),class:"flex items-center gap-3 py-2 px-4 border rounded-xl border-stroke bg-white hover:bg-gray-100"},[o(a(De),{class:"size-6 text-secondary"}),e("div",At,[e("span",Qt,M(v.title),1),e("span",Vt,M(v.description),1)]),o(a(Se),{class:"size-6 text-gray-400"})],8,Ut))),128)),U(o(q,null,{default:_(()=>[i.value!==null?(n(),z(ge,{key:0,"document-id":i.value,onClose:r},null,8,["document-id"])):P("",!0)]),_:1},512),[[O,p.value]])]))}},It={class:"bg-white rounded-lg p-6 shadow-xl max-w-lg w-full"},Lt={class:"flex justify-end"},Ot=e("label",{for:"document-name",class:"block text-base font-medium leading-6 text-primary"},[H(" Nombre "),e("span",{class:"text-red-500"},"*")],-1),Tt={class:"mt-2"},Wt=["disabled"],ve={__name:"CreateDocumentByLawyer",setup(b){const s=X(),p=j(),i=$("");fe(()=>{var r;i.value=((r=p.selectedDocument)==null?void 0:r.title)||""});const d=F(()=>i.value.trim().length>0),g=F(()=>{var r;return!!((r=p.selectedDocument)!=null&&r.id)});function x(){if(d.value){const r=encodeURIComponent(i.value.trim());g.value&&(p.selectedDocument.title=i.value),g.value?s.push(`/dynamic_document_dashboard/lawyer/editor/edit/${p.selectedDocument.id}`):s.push(`/dynamic_document_dashboard/lawyer/editor/create/${r}`)}}return(r,u)=>(n(),m("div",It,[e("div",Lt,[e("button",{onClick:u[0]||(u[0]=w=>r.$emit("close"))},[o(a(Z),{class:"size-6"})])]),e("form",{onSubmit:R(x,["prevent"])},[e("div",null,[Ot,e("div",Tt,[U(e("input",{"onUpdate:modelValue":u[1]||(u[1]=w=>i.value=w),type:"text",name:"document-name",id:"document-name",class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-secondary sm:text-sm sm:leading-6",required:""},null,512),[[re,i.value]])])]),e("button",{type:"submit",class:S(["mt-2.5 p-2.5 text-sm font-medium rounded-md flex gap-2",d.value?"bg-secondary text-white":"bg-gray-200 text-secondary border-2 border-dashed border-secondary cursor-not-allowed bg-opacity-50"]),disabled:!d.value},[e("span",null,M(g.value?"Editar":"Continuar"),1)],10,Wt)],32)]))}},qt={class:"mt-8 flex flex-wrap gap-6"},Rt={class:"text-base font-medium"},Zt=["disabled","onClick"],Gt={__name:"DocumentListLawyer",props:{searchQuery:String},setup(b){const s=j(),p=$(!1),i=b,d=F(()=>{const f=s.draftAndPublishedDocumentsUnassigned;return s.filteredDocuments(i.searchQuery,"").filter(t=>f.some(l=>l.id===t.id))}),g=f=>{const t=[{label:"Editar",action:"edit"},{label:"Eliminar",action:"delete"},{label:"Previsualización",action:"preview"}];return f.state==="Draft"?t.push({label:"Publicar",action:"publish",disabled:!x(f)}):f.state==="Published"&&t.push({label:"Mover a Borrador",action:"draft",disabled:!1}),t},x=f=>f.variables.every(t=>t.value&&t.value.trim().length>0),r=async(f,t)=>{switch(f){case"edit":s.selectedDocument=t,p.value=!0;break;case"delete":await be(`¿Deseas eliminar el documento '${t.title}'?`)&&(await s.deleteDocument(t.id),await B("Documento eliminado correctamente.","success"));break;case"publish":await u(t),await B("Documento publicado correctamente.","success");break;case"draft":await w(t),await B("Documento movido a borrador.","info");break;case"preview":se(t);break;default:console.warn(`Acción desconocida: ${f}`)}},u=async f=>{const t={...f,state:"Published"};await s.updateDocument(f.id,t)},w=async f=>{const t={...f,state:"Draft"};await s.updateDocument(f.id,t)},v=()=>{p.value=!1,s.selectedDocument=null};return(f,t)=>(n(),m(C,null,[e("div",qt,[(n(!0),m(C,null,Q(d.value,l=>(n(),m("div",{key:l.id,class:S(["flex items-center gap-2 py-2 px-4 border rounded-md cursor-pointer transition",l.state==="Published"?"border-green-400 bg-green-300/30 hover:bg-green-300/50":"border-stroke bg-white hover:bg-gray-100"])},[(n(),z(ie(l.state==="Published"?a(de):a(ue)),{class:S(l.state==="Published"?"size-6 text-green-500":"size-6 text-secondary")},null,8,["class"])),e("span",Rt,M(l.title),1),o(a(te),{as:"div",class:"relative inline-block text-left"},{default:_(()=>[o(a(Y),{class:"flex items-center text-gray-400"},{default:_(()=>[o(a(ae),{class:"size-6","aria-hidden":"true"})]),_:1}),o(K,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:_(()=>[o(a(ee),{class:"absolute left-0 z-10 mt-2 w-56 rounded-md bg-white shadow-lg ring-1 ring-black/5"},{default:_(()=>[(n(!0),m(C,null,Q(g(l),h=>(n(),z(a(A),{key:h.label},{default:_(()=>[e("button",{class:S(["w-full text-left px-4 py-2 text-sm font-regular transition flex items-center gap-2",{"opacity-50 cursor-not-allowed":h.disabled,"cursor-pointer":!h.disabled}]),disabled:h.disabled,onClick:E=>!h.disabled&&r(h.action,l)},[h.disabled?(n(),z(a(Ee),{key:0,class:"size-5 text-gray-400","aria-hidden":"true"})):P("",!0),H(" "+M(h.label),1)],10,Zt)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)],2))),128))]),U(o(q,null,{default:_(()=>[o(ve,{onClose:v})]),_:1},512),[[O,p.value]]),o(ne,{isVisible:a(V),documentData:a(oe),onClose:t[0]||(t[0]=l=>V.value=!1)},null,8,["isVisible","documentData"])],64))}},Ht={class:"mt-8 flex flex-wrap gap-6"},Xt={class:"grid gap-1"},Jt={class:"text-base font-medium"},Yt={class:"text-sm font-regular text-gray-400"},Kt=e("span",{class:"sr-only"},"Open options",-1),es={class:"py-1"},ts=["onClick"],ss={__name:"DocumentFinishedByClientList",props:{searchQuery:String},setup(b){const s=j(),p=J(),i=X();ce(()=>{s.init(),p.init()});const d=b,g=F(()=>{const t=s.completedDocumentsByClient;return s.filteredDocuments(d.searchQuery,p).filter(l=>t.some(h=>h.id===l.id))}),x=[{label:"Editar",action:"edit"},{label:"Previsualización",action:"preview"},{label:"Descargar PDF",action:"downloadPDF"},{label:"Descargar Word",action:"downloadWord"}],r=(t,l)=>{switch(t.action){case"edit":u(l);break;case"preview":se(l);break;case"downloadPDF":v(l);break;case"downloadWord":f(l);break;default:console.warn("Unknown action:",t.action)}},u=t=>{const l=encodeURIComponent(t.title.trim());i.push(`/dynamic_document_dashboard/document/use/editor/${t.id}/${l}`)},w=t=>{const l=p.userById(t);return l?`${l.first_name} ${l.last_name}`:"Desconocido"},v=t=>{s.downloadPDF(t.id,t.title)},f=t=>{s.downloadWord(t.id,t.title)};return(t,l)=>(n(),m(C,null,[e("div",Ht,[(n(!0),m(C,null,Q(g.value,h=>(n(),m("div",{key:h.id,class:"flex items-center gap-3 py-2 px-4 border rounded-xl border-green-400 bg-green-300/30"},[o(a(de),{class:"size-6 text-green-500"}),e("div",Xt,[e("span",Jt,M(h.title),1),e("span",Yt,M(w(h.assigned_to)),1)]),o(a(te),{as:"div",class:"relative inline-block text-left"},{default:_(()=>[e("div",null,[o(a(Y),{class:"flex items-center text-gray-400"},{default:_(()=>[Kt,o(a(ae),{class:"size-6","aria-hidden":"true"})]),_:1})]),o(K,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:_(()=>[o(a(ee),{class:"absolute left-0 z-10 mt-2 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black/5"},{default:_(()=>[e("div",es,[(n(),m(C,null,Q(x,E=>o(a(A),{key:E.label},{default:_(()=>[e("button",{onClick:T=>r(E,h),class:"block w-full text-left px-4 py-2 text-sm font-regular cursor-pointer hover:bg-gray-100 transition"},M(E.label),9,ts)]),_:2},1024)),64))])]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))]),o(ne,{isVisible:a(V),documentData:a(oe),onClose:l[0]||(l[0]=h=>V.value=!1)},null,8,["isVisible","documentData"])],64))}},os={class:"mt-8 flex flex-wrap gap-6"},as={class:"grid gap-1"},ns={class:"text-base font-medium"},ls={class:"text-sm font-regular text-gray-400"},rs=e("span",{class:"sr-only"},"Open options",-1),is={class:"py-1"},cs=["onClick"],ds={__name:"DocumentInProgressByClientList",props:{searchQuery:String},setup(b){const s=j(),p=J(),i=X();ce(()=>{s.init(),p.init()});const d=b,g=F(()=>{const t=s.progressDocumentsByClient;return s.filteredDocuments(d.searchQuery,p).filter(l=>t.some(h=>h.id===l.id))}),x=[{label:"Editar",action:"edit"},{label:"Previsualización",action:"preview"},{label:"Descargar PDF",action:"downloadPDF"},{label:"Descargar Word",action:"downloadWord"}],r=(t,l)=>{switch(t.action){case"edit":u(l);break;case"preview":se(l);break;case"downloadPDF":v(l);break;case"downloadWord":f(l);break;default:console.warn("Unknown action:",t.action)}},u=t=>{const l=encodeURIComponent(t.title.trim());i.push(`/dynamic_document_dashboard/document/use/editor/${t.id}/${l}`)},w=t=>{const l=p.userById(t);return l?`${l.first_name} ${l.last_name}`:"Desconocido"},v=t=>{s.downloadPDF(t.id,t.title)},f=t=>{s.downloadWord(t.id,t.title)};return(t,l)=>(n(),m(C,null,[e("div",os,[(n(!0),m(C,null,Q(g.value,h=>(n(),m("div",{key:h.id,class:"flex items-center gap-3 py-2 px-4 border rounded-xl border-stroke bg-white"},[o(a(ue),{class:"size-6 text-secondary"}),e("div",as,[e("span",ns,M(h.title),1),e("span",ls,M(w(h.assigned_to)),1)]),o(a(te),{as:"div",class:"relative inline-block text-left"},{default:_(()=>[e("div",null,[o(a(Y),{class:"flex items-center text-gray-400"},{default:_(()=>[rs,o(a(ae),{class:"size-6","aria-hidden":"true"})]),_:1})]),o(K,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:_(()=>[o(a(ee),{class:"absolute left-0 z-10 mt-2 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black/5"},{default:_(()=>[e("div",is,[(n(),m(C,null,Q(x,E=>o(a(A),{key:E.label},{default:_(()=>[e("button",{onClick:T=>r(E,h),class:"block w-full text-left px-4 py-2 text-sm font-regular cursor-pointer hover:bg-gray-100 transition"},M(E.label),9,cs)]),_:2},1024)),64))])]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))]),o(ne,{isVisible:a(V),documentData:a(oe),onClose:l[0]||(l[0]=h=>V.value=!1)},null,8,["isVisible","documentData"])],64))}},us={class:"p-10 px-4 sm:px-6 lg:px-8"},ms={key:0},ps={key:3,class:"mt-6 text-center text-gray-400 font-regular"},fs=e("p",null,"No hay documentos disponibles para mostrar.",-1),gs=[fs],bs={key:1},Ds={__name:"Dashboard",setup(b){const s=J(),p=j(),i=$(""),d=$("default"),g=$(!1),x=F(()=>s.getCurrentUser),r=F(()=>{var f,t;let v=[];return((f=x.value)==null?void 0:f.role)==="lawyer"?v=p.draftAndPublishedDocumentsUnassigned:((t=x.value)==null?void 0:t.role)==="client"&&(v=p.progressAndCompletedDocumentsByClient(x.value.id)),p.filteredDocuments(i.value,s).filter(l=>v.some(h=>h.id===l.id))});ce(async()=>{await s.setCurrentUser(),await p.init(),p.selectedDocument=null});const u=v=>{d.value=v},w=()=>{g.value=!1};return(v,f)=>{var t,l;return n(),m(C,null,[o($e,{"onUpdate:searchQuery":f[0]||(f[0]=h=>i.value=h)},{default:_(()=>[ke(v.$slots,"default")]),_:3}),e("div",us,[o(je,{onOpenNewDocument:f[1]||(f[1]=h=>g.value=!0),onUpdateCurrentSection:u,role:x.value.role},null,8,["role"]),((t=x.value)==null?void 0:t.role)==="lawyer"?(n(),m("div",ms,[d.value==="documentFinished"?(n(),z(ss,{key:0,searchQuery:i.value},null,8,["searchQuery"])):P("",!0),d.value==="documentInProgress"?(n(),z(ds,{key:1,searchQuery:i.value},null,8,["searchQuery"])):P("",!0),d.value==="default"?(n(),z(Gt,{key:2,searchQuery:i.value},null,8,["searchQuery"])):P("",!0),d.value==="default"&&r.value.length===0?(n(),m("div",ps,gs)):P("",!0)])):P("",!0),((l=x.value)==null?void 0:l.role)==="client"?(n(),m("div",bs,[d.value==="useDocument"?(n(),z(jt,{key:0,searchQuery:i.value},null,8,["searchQuery"])):P("",!0),d.value==="default"?(n(),z(Bt,{key:1,searchQuery:i.value},null,8,["searchQuery"])):P("",!0)])):P("",!0)]),U(o(q,null,{default:_(()=>[o(ve,{onClose:w})]),_:1},512),[[O,g.value]])],64)}}};export{Ds as default};
