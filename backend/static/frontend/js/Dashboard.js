import{e as a,f,g as e,r as $,j as o,l as n,n as S,i as C,F as M,ay as pe,U as E,k as _,J as ge,T as G,s as B,W as ye,b as xe,c as F,D as we,z as Z,w as U,v as re,h as R,G as I,X as O,Y as ie,t as P,m as X,P as De,u as J,am as be,N as ke,B as Y,S as K,M as ee,I as A,H as te,az as $e,o as ce}from"./index.js";import{u as Q,o as se,s as j,p as oe}from"./dynamicDocument.js";import{_ as Ce}from"./SearchBarAndFilterBy.js";import{s as Me,h as me,r as le}from"./loading_message.js";import{r as Pe,a as Se}from"./PhotoIcon.js";import"./MagnifyingGlassIcon.js";function de(p,t){return a(),f("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}function Ee(p,t){return a(),f("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"})])}function ae(p,t){return a(),f("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5ZM12 12.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5ZM12 18.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5Z"})])}function H(p,t){return a(),f("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 12.75V12A2.25 2.25 0 0 1 4.5 9.75h15A2.25 2.25 0 0 1 21.75 12v.75m-8.69-6.44-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"})])}function ze(p,t){return a(),f("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M18.364 18.364A9 9 0 0 0 5.636 5.636m12.728 12.728A9 9 0 0 1 5.636 5.636m12.728 12.728L5.636 5.636"})])}function ue(p,t){return a(),f("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"})])}function fe(p,t){return a(),f("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4.5v15m7.5-7.5h-15"})])}const Fe={key:0,class:"pb-8 border-b border-gray-200 flex gap-6 flex-wrap"},Be=e("div",{class:"grid"},[e("span",{class:"font-medium text-base"},"Documentos"),e("span",{class:"text-gray-400 font-regular text-sm"},"Mi unidad")],-1),Ne=e("div",{class:"grid"},[e("span",{class:"font-medium text-base"},"Documentos Finalizados"),e("span",{class:"text-gray-400 font-regular text-sm"},"Clientes")],-1),Ue=e("div",{class:"grid"},[e("span",{class:"font-medium text-base"},"Documentos en Progreso"),e("span",{class:"text-gray-400 font-regular text-sm"},"Clientes")],-1),Ae=e("div",{class:"grid"},[e("span",{class:"font-medium text-base"},"Nuevo Documento")],-1),Ie={key:1,class:"pb-8 border-b border-gray-200 flex gap-6 flex-wrap"},je=e("div",{class:"grid"},[e("span",{class:"font-medium text-base"},"Mis Documentos")],-1),Qe=e("div",{class:"grid"},[e("span",{class:"font-medium text-base"},"Nuevo Documento")],-1),Ve={__name:"DocumentsNavigation",props:{role:String},emits:["updateCurrentSection","openNewDocument"],setup(p,{emit:t}){const m=t,l=$("default"),c=p,b=y=>{l.value=y,m("updateCurrentSection",y)};return(y,i)=>(a(),f(M,null,[(c==null?void 0:c.role)==="lawyer"?(a(),f("div",Fe,[e("button",{onClick:i[0]||(i[0]=u=>b("default")),class:S(["flex gap-2 items-center py-2 px-4 rounded-xl border-2 border-yellow-300 text-start bg-white",{"bg-yellow-300/30":l.value=="default"}])},[o(n(H),{class:"size-6 text-yellow-500 font-semibold"}),Be],2),e("button",{onClick:i[1]||(i[1]=u=>b("documentFinished")),class:S(["flex gap-2 items-center py-2 px-4 rounded-xl border-2 border-yellow-300 bg-white text-start",{"bg-yellow-300/30":l.value=="documentFinished"}])},[o(n(H),{class:"size-6 text-yellow-500 font-semibold"}),Ne],2),e("button",{onClick:i[2]||(i[2]=u=>b("documentInProgress")),class:S(["flex gap-2 items-center py-2 px-4 rounded-xl border-2 border-yellow-300 bg-white text-start",{"bg-yellow-300/30":l.value=="documentInProgress"}])},[o(n(H),{class:"size-6 text-yellow-500 font-semibold"}),Ue],2),e("button",{onClick:i[3]||(i[3]=u=>y.$emit("openNewDocument")),class:"flex gap-2 items-center py-2 px-4 rounded-md bg-white text-start hover:bg-gray-100"},[o(n(fe),{class:"size-6 text-secondary font-semibold"}),Ae])])):C("",!0),(c==null?void 0:c.role)==="client"?(a(),f("div",Ie,[e("button",{onClick:i[4]||(i[4]=u=>b("default")),class:S(["flex gap-2 items-center py-2 px-4 rounded-md border-2 border-yellow-300 bg-white text-start",{"bg-yellow-300/30":l.value=="default"}])},[o(n(H),{class:"size-6 text-yellow-500 font-semibold"}),je],2),e("button",{onClick:i[5]||(i[5]=u=>b("useDocument")),class:S(["flex gap-2 items-center py-2 px-4 rounded-md bg-white text-start hover:bg-gray-100",{"bg-selected-background":l.value=="useDocument"}])},[o(n(fe),{class:"size-6 text-secondary font-semibold"}),Qe],2)])):C("",!0)],64))}};function Le(p){pe.fromTo(p,{opacity:0},{opacity:1,duration:.5,ease:"power2.out"})}function Oe(p,t){pe.to(p,{opacity:0,duration:.4,ease:"power2.in",onComplete:t})}const Te={key:0,class:"fixed inset-0 z-50 bg-gray-400 bg-opacity-40 backdrop-blur-md flex items-center justify-center"},q={__name:"ModalTransition",setup(p){function t(l,c){Le(l),c()}function m(l,c){Oe(l,c),c()}return(l,c)=>(a(),E(G,{onEnter:t,onLeave:m},{default:_(()=>[l.$slots.default?(a(),f("div",Te,[ge(l.$slots,"default")])):C("",!0)]),_:3}))}};function We(){const p=$(!1),t=$("");async function m(l,c,b="",y="",i=[],u={}){if(!c)throw t.value="Recipient email is required.",await B(t.value,"error"),new Error(t.value);const w=new FormData;w.append("to_email",c),w.append("subject",b),w.append("body",y),i.forEach((v,g)=>{w.append(`attachments[${g}]`,v)});for(const[v,g]of Object.entries(u))w.append(v,g);try{p.value=!0,t.value="",Me("Sending email...","Please wait while we send the email.");const v=await ye(l,w);return me(),await B("Email sent successfully.","success"),v.data}catch(v){throw me(),console.error("Error sending email:",v.message),t.value="An error occurred while sending the email. Please try again.",await B(t.value,"error"),v}finally{p.value=!1}}return{sendEmail:m,isLoading:p,errorMessage:t}}const qe={class:"bg-white rounded-lg p-6 shadow-xl max-w-lg w-full"},Re={class:"flex justify-end"},Ze=e("label",{for:"email",class:"block text-base font-medium leading-6 text-primary"},[X(" Correo electrónico "),e("span",{class:"text-red-500"},"*")],-1),Ge={class:"mt-2"},He={class:"mt-4"},Xe=e("label",{for:"files",class:"block text-base font-medium leading-6 text-primary"}," Anexos ",-1),Je={key:0,class:"text-center"},Ye={class:"mt-4 flex text-sm/6 text-gray-600"},Ke={for:"file-upload",class:"relative cursor-pointer rounded-md bg-white font-semibold text-indigo-600 focus-within:outline-none focus-within:ring-2 focus-within:ring-indigo-600 focus-within:ring-offset-2 hover:text-indigo-500"},et=e("span",null,"Sube un archivo",-1),tt=e("p",{class:"pl-1"},"o arrastra y suelta",-1),st=e("p",{class:"text-xs/5 text-gray-600"}," PNG, JPG, PDF, DOCX de hasta 20MB ",-1),ot={key:1,class:"w-full flex flex-wrap gap-3"},at=["onMouseenter","onMouseleave"],nt=["onClick"],lt={class:"text-center text-xs truncate w-20"},rt=["disabled"],it=e("span",null,"Enviar",-1),ct=[it],dt="dynamic-documents/send_email_with_attachments/",ut=20*1024*1024,mt={__name:"SendDocument",props:{emailDocument:{type:Object,required:!0}},emits:["closeEmailModal"],setup(p,{emit:t}){const m=t,{sendEmail:l}=We(),c=$(null),b=p,y=()=>{i.email="",u.value=[],c.value=null},i=xe({email:""}),u=$([]),w=d=>{const x=Array.from(d.target.files);g(x),d.target.value=null},v=d=>{const x=Array.from(d.dataTransfer.files);g(x)},g=d=>{let x=u.value.reduce((D,W)=>D+W.file.size,0);d.forEach(D=>{if(D.size>ut){B(`The file "${D.name}" exceeds the 20 MB limit.`,"warning");return}const W=D.name.split(".").pop().toLowerCase();let V="",L={general:"",xMark:""};switch(W){case"png":case"jpg":case"jpeg":V=Se,L.general="border-gray-200 text-gray-400",L.xMark="bg-gray-400";break;case"pdf":V=le,L.general="border-red-600/20 text-red-600/60",L.xMark="bg-red-600/60";break;case"docx":V=le,L.general="border-blue-600/20 text-blue-600/60",L.xMark="bg-blue-600/60";break;default:B("Unsupported file type. Only PDF, DOCX, JPG, and PNG are allowed.","warning");return}u.value.push({name:D.name,icon:V,style:L,hover:!1,file:D}),x+=D.size})},s=d=>{u.value.splice(d,1)},r=d=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(d),h=F(()=>r(i.email)),z=F(()=>h.value),T=async d=>{try{const x=await De(`dynamic-documents/${d}/download-pdf/`,"blob");if(!x||!x.data)throw new Error("Invalid response from server");return new File([x.data],`document_${d}.pdf`,{type:"application/pdf"})}catch(x){return console.error("Error downloading PDF:",x),B("No se pudo descargar el documento PDF.","error"),null}};we(()=>b.emailDocument,d=>{d&&Object.keys(d).length>0&&d.id&&T(d.id)},{immediate:!0});const k=async()=>{try{if(b.emailDocument.id){const x=await T(b.emailDocument.id);x&&u.value.push({name:x.name,file:x,icon:le,style:{general:"border-blue-600/20 text-blue-600/60",xMark:"bg-blue-600/60"},hover:!1})}const d=u.value.map(x=>x.file);await l(dt,i.email,b.emailDocument.title,"Attached is the requested document along with additional attachments.",d,{documentId:b.emailDocument.id})}catch(d){console.error("Error sending the email:",d)}finally{N()}},N=()=>{y(),m("closeEmailModal")};return(d,x)=>(a(),f("div",qe,[e("div",Re,[e("button",{onClick:x[0]||(x[0]=D=>N())},[o(n(Z),{class:"size-6"})])]),e("form",{onSubmit:R(k,["prevent"])},[e("div",null,[Ze,e("div",Ge,[U(e("input",{"onUpdate:modelValue":x[1]||(x[1]=D=>i.email=D),type:"text",name:"email",id:"email",class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-secondary sm:text-sm sm:leading-6",required:""},null,512),[[re,i.email]])])]),e("div",He,[Xe,e("div",{class:"mt-2 flex justify-center rounded-lg border border-dashed border-gray-900/25 bg-white px-6 py-10",onDragover:x[2]||(x[2]=R(()=>{},["prevent"])),onDrop:R(v,["prevent"])},[u.value.length<1?(a(),f("div",Je,[o(n(Pe),{class:"mx-auto size-12 text-gray-300","aria-hidden":"true"}),e("div",Ye,[e("label",Ke,[et,e("input",{id:"file-upload",name:"file-upload",type:"file",class:"sr-only",onChange:w},null,32)]),tt]),st])):(a(),f("div",ot,[(a(!0),f(M,null,I(u.value,(D,W)=>(a(),f("div",{key:W,class:S(["relative p-4 grid rounded-md bg-white border-2",D.style.general]),onMouseenter:V=>D.hover=!0,onMouseleave:V=>D.hover=!1},[U(e("div",{class:S(["absolute p-0.5 mt-2 ml-2 rounded-full",D.style.xMark]),onClick:V=>s(W)},[o(n(Z),{class:"size-3 text-white"})],10,nt),[[O,D.hover]]),(a(),E(ie(D.icon),{class:"size-12 mx-auto"})),e("span",lt,P(D.name),1)],42,at))),128))]))],32)]),e("button",{type:"submit",class:S(["mt-4 p-2.5 text-sm font-medium rounded-md flex gap-2",z.value?"bg-secondary text-white":"bg-gray-200 text-secondary border-2 border-dashed border-secondary cursor-not-allowed bg-opacity-50"]),disabled:!z.value},ct,10,rt)],32)]))}},ft={class:"bg-white rounded-lg p-6 shadow-xl max-w-lg w-full"},pt={class:"flex justify-end"},gt=e("label",{for:"document-name",class:"block text-base font-medium leading-6 text-primary"},[X(" Nombre "),e("span",{class:"text-red-500"},"*")],-1),bt={class:"mt-2"},vt=["disabled"],ve={__name:"UseDocumentByClient",props:{documentId:{type:[Number,null],required:!1,default:null}},setup(p){const t=p,m=J(),l=Q(),c=$("");be(()=>{var i;l.selectedDocument?c.value=((i=l.selectedDocument)==null?void 0:i.title)||"":c.value=""});const b=F(()=>c.value.trim().length>0);function y(){const i=encodeURIComponent(c.value.trim());if(t.documentId&&!l.selectedDocument)m.push(`/dynamic_document_dashboard/document/use/creator/${t.documentId}/${i}`);else if(l.selectedDocument){const u=encodeURIComponent(c.value.trim());m.push(`/dynamic_document_dashboard/document/use/editor/${l.selectedDocument.id}/${u}`)}else B("Error: No se pudo continuar. Documento no seleccionado.","error")}return(i,u)=>(a(),f("div",ft,[e("div",pt,[e("button",{onClick:u[0]||(u[0]=w=>i.$emit("close"))},[o(n(Z),{class:"size-6"})])]),e("form",{onSubmit:R(y,["prevent"])},[e("div",null,[gt,e("div",bt,[U(e("input",{"onUpdate:modelValue":u[1]||(u[1]=w=>c.value=w),type:"text",id:"document-name",class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm ring-1 ring-inset ring-gray-300",required:""},null,512),[[re,c.value]])])]),e("button",{type:"submit",class:S(["mt-2.5 p-2.5 text-sm font-medium rounded-md flex gap-2",b.value?"bg-secondary text-white":"bg-gray-200 text-secondary border-2 border-dashed border-secondary cursor-not-allowed bg-opacity-50"]),disabled:!b.value}," Continuar ",10,vt)],32)]))}};function he(p){return ke.fire({title:p,icon:"question",showCancelButton:!0,confirmButtonText:"Aceptar",cancelButtonText:"Cancelar",buttonsStyling:!1}).then(t=>t.isConfirmed)}const ht={class:"bg-white rounded-lg shadow-xl p-6 max-w-4xl w-full overflow-auto max-h-[80vh]"},_t={class:"flex justify-between items-center mb-4"},yt={class:"text-lg font-bold"},xt=["innerHTML"],ne={__name:"DocumentPreviewModal",props:{isVisible:Boolean,documentData:{type:Object,default:()=>({title:"",content:""})}},emits:["close"],setup(p,{emit:t}){const m=t,l=()=>{m("close")};return(c,b)=>U((a(),E(q,null,{default:_(()=>[e("div",ht,[e("div",_t,[e("h2",yt," Previsualización del Documento: "+P(p.documentData.title),1),e("button",{onClick:l},[o(n(Z),{class:"size-6 text-gray-500 hover:text-gray-700"})])]),e("div",{class:"prose max-w-none",innerHTML:p.documentData.content},null,8,xt)])]),_:1},512)),[[O,p.isVisible]])}},wt={class:"mt-8 flex flex-wrap gap-6"},Dt={class:"grid gap-1"},kt={class:"text-base font-medium"},$t={class:"text-sm font-regular text-gray-400"},Ct={class:"py-1"},Mt=["onClick"],Pt=["onClick"],St=["onClick"],Et=["onClick"],zt=["onClick"],Ft=["onClick"],Bt={key:0,class:"mt-6 flex flex-col items-center justify-center text-center text-gray-500 w-full"},Nt=e("p",{class:"text-lg font-semibold"}," No hay documentos disponibles para mostrar. ",-1),Ut=e("p",{class:"text-sm"}," Contacta a tu abogado para gestionar tus documentos. ",-1),At=[Nt,Ut],It={__name:"DocumentListClient",props:{searchQuery:String},setup(p){const t=Q(),m=Y(),l=F(()=>m.getCurrentUser),c=$(!1),b=$(null),y=$(!1),i=$({}),u=p,w=F(()=>{const k=t.progressAndCompletedDocumentsByClient(l.value.id);return t.filteredDocuments(u.searchQuery,m).filter(N=>k.some(d=>d.id===N.id))}),v=k=>{t.downloadPDF(k.id,k.title)},g=k=>{t.downloadWord(k.id,k.title)},s=async k=>{await he(`¿Deseas eliminar el documento "${k.title}"?`)&&(await t.deleteDocument(k.id),await B("Documento eliminado exitosamente.","success"))},r=k=>{t.selectedDocument=k,b.value=k.id,c.value=!0},h=()=>{c.value=!1,t.clearSelectedDocument()},z=k=>{i.value=k,y.value=!0},T=()=>{i.value={},y.value=!1};return(k,N)=>(a(),f(M,null,[e("div",wt,[(a(!0),f(M,null,I(w.value,d=>(a(),f("div",{key:d.id,class:S(["flex items-center gap-3 py-2 px-4 border rounded-xl cursor-pointer",{"border-green-400 bg-green-300/30":d.state==="Completed","border-stroke bg-white":d.state==="Progress"}])},[(a(),E(ie(d.state==="Completed"?n(de):n(ue)),{class:S(["size-6",{"text-green-500":d.state==="Completed","text-secondary":d.state==="Progress"}])},null,8,["class"])),e("div",Dt,[e("span",kt,P(d.title),1),e("span",$t,P(d.description),1)]),o(n(te),{as:"div",class:"relative inline-block text-left"},{default:_(()=>[o(n(K),{class:"flex items-center text-gray-400"},{default:_(()=>[o(n(ae),{class:"size-6","aria-hidden":"true"})]),_:1}),o(G,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:_(()=>[o(n(ee),{class:"absolute left-0 z-10 mt-2 w-56 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black/5 focus:outline-none"},{default:_(()=>[e("div",Ct,[o(n(A),null,{default:_(()=>[e("button",{class:"block w-full text-left px-4 py-2 text-sm font-regular hover:bg-gray-100 transition",onClick:x=>r(d)},P(d.state==="Completed"?"Editar":"Completar"),9,Mt)]),_:2},1024),d.state==="Completed"?(a(),E(n(A),{key:0},{default:_(()=>[e("button",{class:"block w-full text-left px-4 py-2 text-sm font-regular hover:bg-gray-100 transition",onClick:x=>n(se)(d)}," Previsualizar ",8,Pt)]),_:2},1024)):C("",!0),o(n(A),null,{default:_(()=>[e("button",{class:"block w-full text-left px-4 py-2 text-sm font-regular hover:bg-gray-100 transition",onClick:x=>s(d)}," Eliminar ",8,St)]),_:2},1024),d.state==="Completed"?(a(),f(M,{key:1},[o(n(A),null,{default:_(()=>[e("button",{class:"block w-full text-left px-4 py-2 text-sm font-regular hover:bg-gray-100 transition",onClick:x=>v(d)}," Descargar PDF ",8,Et)]),_:2},1024),o(n(A),null,{default:_(()=>[e("button",{class:"block w-full text-left px-4 py-2 text-sm font-regular hover:bg-gray-100 transition",onClick:x=>g(d)}," Descargar Word ",8,zt)]),_:2},1024),o(n(A),null,{default:_(()=>[e("button",{class:"block w-full text-left px-4 py-2 text-sm font-regular hover:bg-gray-100 transition",onClick:x=>z(d)}," Enviar ",8,Ft)]),_:2},1024)],64)):C("",!0)])]),_:2},1024)]),_:2},1024)]),_:2},1024)],2))),128)),w.value.length===0?(a(),f("div",Bt,At)):C("",!0),U(o(q,null,{default:_(()=>[o(ve,{"document-id":b.value,onClose:h},null,8,["document-id"])]),_:1},512),[[O,c.value]])]),o(ne,{isVisible:n(j),documentData:n(oe),onClose:N[0]||(N[0]=d=>j.value=!1)},null,8,["isVisible","documentData"]),U(o(q,null,{default:_(()=>[o(mt,{onCloseEmailModal:N[1]||(N[1]=d=>T()),emailDocument:i.value},null,8,["emailDocument"])]),_:1},512),[[O,y.value]])],64))}},jt={class:"mt-8 flex flex-wrap gap-6"},Qt=["onClick"],Vt={class:"grid gap-1"},Lt={class:"text-base font-medium"},Ot={class:"text-sm font-regular text-gray-400"},Tt={__name:"UseDocument",props:{searchQuery:String},setup(p){const t=Q(),m=$(!1),l=$(null),c=p,b=F(()=>{const u=t.publishedDocumentsUnassigned;return t.filteredDocuments(c.searchQuery,"").filter(w=>u.some(v=>v.id===w.id))});function y(u){u&&(l.value=u,m.value=!0)}function i(){m.value=!1,l.value=null}return(u,w)=>(a(),f("div",jt,[(a(!0),f(M,null,I(b.value,v=>(a(),f("button",{key:v.id,onClick:g=>y(v.id),class:"flex items-center gap-3 py-2 px-4 border rounded-xl border-stroke bg-white hover:bg-gray-100"},[o(n($e),{class:"size-6 text-secondary"}),e("div",Vt,[e("span",Lt,P(v.title),1),e("span",Ot,P(v.description),1)]),o(n(Ee),{class:"size-6 text-gray-400"})],8,Qt))),128)),U(o(q,null,{default:_(()=>[l.value!==null?(a(),E(ve,{key:0,"document-id":l.value,onClose:i},null,8,["document-id"])):C("",!0)]),_:1},512),[[O,m.value]])]))}},Wt={class:"bg-white rounded-lg p-6 shadow-xl max-w-lg w-full"},qt={class:"flex justify-end"},Rt=e("label",{for:"document-name",class:"block text-base font-medium leading-6 text-primary"},[X(" Nombre "),e("span",{class:"text-red-500"},"*")],-1),Zt={class:"mt-2"},Gt=["disabled"],_e={__name:"CreateDocumentByLawyer",setup(p){const t=J(),m=Q(),l=$("");be(()=>{var i;l.value=((i=m.selectedDocument)==null?void 0:i.title)||""});const c=F(()=>l.value.trim().length>0),b=F(()=>{var i;return!!((i=m.selectedDocument)!=null&&i.id)});function y(){if(c.value){const i=encodeURIComponent(l.value.trim());b.value&&(m.selectedDocument.title=l.value),b.value?t.push(`/dynamic_document_dashboard/lawyer/editor/edit/${m.selectedDocument.id}`):t.push(`/dynamic_document_dashboard/lawyer/editor/create/${i}`)}}return(i,u)=>(a(),f("div",Wt,[e("div",qt,[e("button",{onClick:u[0]||(u[0]=w=>i.$emit("close"))},[o(n(Z),{class:"size-6"})])]),e("form",{onSubmit:R(y,["prevent"])},[e("div",null,[Rt,e("div",Zt,[U(e("input",{"onUpdate:modelValue":u[1]||(u[1]=w=>l.value=w),type:"text",name:"document-name",id:"document-name",class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-secondary sm:text-sm sm:leading-6",required:""},null,512),[[re,l.value]])])]),e("button",{type:"submit",class:S(["mt-2.5 p-2.5 text-sm font-medium rounded-md flex gap-2",c.value?"bg-secondary text-white":"bg-gray-200 text-secondary border-2 border-dashed border-secondary cursor-not-allowed bg-opacity-50"]),disabled:!c.value},[e("span",null,P(b.value?"Editar":"Continuar"),1)],10,Gt)],32)]))}},Ht={class:"mt-8 flex flex-wrap gap-6"},Xt={class:"text-base font-medium"},Jt=["disabled","onClick"],Yt={__name:"DocumentListLawyer",props:{searchQuery:String},setup(p){const t=Q(),m=$(!1),l=p,c=F(()=>{const g=t.draftAndPublishedDocumentsUnassigned;return t.filteredDocuments(l.searchQuery,"").filter(s=>g.some(r=>r.id===s.id))}),b=g=>{const s=[{label:"Editar",action:"edit"},{label:"Eliminar",action:"delete"},{label:"Previsualización",action:"preview"}];return g.state==="Draft"?s.push({label:"Publicar",action:"publish",disabled:!y(g)}):g.state==="Published"&&s.push({label:"Mover a Borrador",action:"draft",disabled:!1}),s},y=g=>g.variables.every(s=>s.value&&s.value.trim().length>0),i=async(g,s)=>{switch(g){case"edit":t.selectedDocument=s,m.value=!0;break;case"delete":await he(`¿Deseas eliminar el documento '${s.title}'?`)&&(await t.deleteDocument(s.id),await B("Documento eliminado correctamente.","success"));break;case"publish":await u(s),await B("Documento publicado correctamente.","success");break;case"draft":await w(s),await B("Documento movido a borrador.","info");break;case"preview":se(s);break;default:console.warn(`Acción desconocida: ${g}`)}},u=async g=>{const s={...g,state:"Published"};await t.updateDocument(g.id,s)},w=async g=>{const s={...g,state:"Draft"};await t.updateDocument(g.id,s)},v=()=>{m.value=!1,t.selectedDocument=null};return(g,s)=>(a(),f(M,null,[e("div",Ht,[(a(!0),f(M,null,I(c.value,r=>(a(),f("div",{key:r.id,class:S(["flex items-center gap-2 py-2 px-4 border rounded-md cursor-pointer transition",r.state==="Published"?"border-green-400 bg-green-300/30 hover:bg-green-300/50":"border-stroke bg-white hover:bg-gray-100"])},[(a(),E(ie(r.state==="Published"?n(de):n(ue)),{class:S(r.state==="Published"?"size-6 text-green-500":"size-6 text-secondary")},null,8,["class"])),e("span",Xt,P(r.title),1),o(n(te),{as:"div",class:"relative inline-block text-left"},{default:_(()=>[o(n(K),{class:"flex items-center text-gray-400"},{default:_(()=>[o(n(ae),{class:"size-6","aria-hidden":"true"})]),_:1}),o(G,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:_(()=>[o(n(ee),{class:"absolute left-0 z-10 mt-2 w-56 rounded-md bg-white shadow-lg ring-1 ring-black/5"},{default:_(()=>[(a(!0),f(M,null,I(b(r),h=>(a(),E(n(A),{key:h.label},{default:_(()=>[e("button",{class:S(["w-full text-left px-4 py-2 text-sm font-regular transition flex items-center gap-2",{"opacity-50 cursor-not-allowed":h.disabled,"cursor-pointer":!h.disabled}]),disabled:h.disabled,onClick:z=>!h.disabled&&i(h.action,r)},[h.disabled?(a(),E(n(ze),{key:0,class:"size-5 text-gray-400","aria-hidden":"true"})):C("",!0),X(" "+P(h.label),1)],10,Jt)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)],2))),128))]),U(o(q,null,{default:_(()=>[o(_e,{onClose:v})]),_:1},512),[[O,m.value]]),o(ne,{isVisible:n(j),documentData:n(oe),onClose:s[0]||(s[0]=r=>j.value=!1)},null,8,["isVisible","documentData"])],64))}},Kt={class:"mt-8 flex flex-wrap gap-6"},es={class:"grid gap-1"},ts={class:"text-base font-medium"},ss={class:"text-sm font-regular text-gray-400"},os=e("span",{class:"sr-only"},"Open options",-1),as={class:"py-1"},ns=["onClick"],ls={__name:"DocumentFinishedByClientList",props:{searchQuery:String},setup(p){const t=Q(),m=Y(),l=J();ce(()=>{t.init(),m.init()});const c=p,b=F(()=>{const s=t.completedDocumentsByClient;return t.filteredDocuments(c.searchQuery,m).filter(r=>s.some(h=>h.id===r.id))}),y=[{label:"Editar",action:"edit"},{label:"Previsualización",action:"preview"},{label:"Descargar PDF",action:"downloadPDF"},{label:"Descargar Word",action:"downloadWord"}],i=(s,r)=>{switch(s.action){case"edit":u(r);break;case"preview":se(r);break;case"downloadPDF":v(r);break;case"downloadWord":g(r);break;default:console.warn("Unknown action:",s.action)}},u=s=>{const r=encodeURIComponent(s.title.trim());l.push(`/dynamic_document_dashboard/document/use/editor/${s.id}/${r}`)},w=s=>{const r=m.userById(s);return r?`${r.first_name} ${r.last_name}`:"Desconocido"},v=s=>{t.downloadPDF(s.id,s.title)},g=s=>{t.downloadWord(s.id,s.title)};return(s,r)=>(a(),f(M,null,[e("div",Kt,[(a(!0),f(M,null,I(b.value,h=>(a(),f("div",{key:h.id,class:"flex items-center gap-3 py-2 px-4 border rounded-xl border-green-400 bg-green-300/30"},[o(n(de),{class:"size-6 text-green-500"}),e("div",es,[e("span",ts,P(h.title),1),e("span",ss,P(w(h.assigned_to)),1)]),o(n(te),{as:"div",class:"relative inline-block text-left"},{default:_(()=>[e("div",null,[o(n(K),{class:"flex items-center text-gray-400"},{default:_(()=>[os,o(n(ae),{class:"size-6","aria-hidden":"true"})]),_:1})]),o(G,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:_(()=>[o(n(ee),{class:"absolute left-0 z-10 mt-2 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black/5"},{default:_(()=>[e("div",as,[(a(),f(M,null,I(y,z=>o(n(A),{key:z.label},{default:_(()=>[e("button",{onClick:T=>i(z,h),class:"block w-full text-left px-4 py-2 text-sm font-regular cursor-pointer hover:bg-gray-100 transition"},P(z.label),9,ns)]),_:2},1024)),64))])]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))]),o(ne,{isVisible:n(j),documentData:n(oe),onClose:r[0]||(r[0]=h=>j.value=!1)},null,8,["isVisible","documentData"])],64))}},rs={class:"mt-8 flex flex-wrap gap-6"},is={class:"grid gap-1"},cs={class:"text-base font-medium"},ds={class:"text-sm font-regular text-gray-400"},us=e("span",{class:"sr-only"},"Open options",-1),ms={class:"py-1"},fs=["onClick"],ps={__name:"DocumentInProgressByClientList",props:{searchQuery:String},setup(p){const t=Q(),m=Y(),l=J();ce(()=>{t.init(),m.init()});const c=p,b=F(()=>{const s=t.progressDocumentsByClient;return t.filteredDocuments(c.searchQuery,m).filter(r=>s.some(h=>h.id===r.id))}),y=[{label:"Editar",action:"edit"},{label:"Previsualización",action:"preview"},{label:"Descargar PDF",action:"downloadPDF"},{label:"Descargar Word",action:"downloadWord"}],i=(s,r)=>{switch(s.action){case"edit":u(r);break;case"preview":se(r);break;case"downloadPDF":v(r);break;case"downloadWord":g(r);break;default:console.warn("Unknown action:",s.action)}},u=s=>{const r=encodeURIComponent(s.title.trim());l.push(`/dynamic_document_dashboard/document/use/editor/${s.id}/${r}`)},w=s=>{const r=m.userById(s);return r?`${r.first_name} ${r.last_name}`:"Desconocido"},v=s=>{t.downloadPDF(s.id,s.title)},g=s=>{t.downloadWord(s.id,s.title)};return(s,r)=>(a(),f(M,null,[e("div",rs,[(a(!0),f(M,null,I(b.value,h=>(a(),f("div",{key:h.id,class:"flex items-center gap-3 py-2 px-4 border rounded-xl border-stroke bg-white"},[o(n(ue),{class:"size-6 text-secondary"}),e("div",is,[e("span",cs,P(h.title),1),e("span",ds,P(w(h.assigned_to)),1)]),o(n(te),{as:"div",class:"relative inline-block text-left"},{default:_(()=>[e("div",null,[o(n(K),{class:"flex items-center text-gray-400"},{default:_(()=>[us,o(n(ae),{class:"size-6","aria-hidden":"true"})]),_:1})]),o(G,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:_(()=>[o(n(ee),{class:"absolute left-0 z-10 mt-2 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black/5"},{default:_(()=>[e("div",ms,[(a(),f(M,null,I(y,z=>o(n(A),{key:z.label},{default:_(()=>[e("button",{onClick:T=>i(z,h),class:"block w-full text-left px-4 py-2 text-sm font-regular cursor-pointer hover:bg-gray-100 transition"},P(z.label),9,fs)]),_:2},1024)),64))])]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))]),o(ne,{isVisible:n(j),documentData:n(oe),onClose:r[0]||(r[0]=h=>j.value=!1)},null,8,["isVisible","documentData"])],64))}},gs={class:"p-10 px-4 sm:px-6 lg:px-8"},bs={key:0},vs={key:3,class:"mt-6 text-center text-gray-400 font-regular"},hs=e("p",null,"No hay documentos disponibles para mostrar.",-1),_s=[hs],ys={key:1},Ms={__name:"Dashboard",setup(p){const t=Y(),m=Q(),l=$(""),c=$("default"),b=$(!1),y=F(()=>t.getCurrentUser),i=F(()=>{var g,s;let v=[];return((g=y.value)==null?void 0:g.role)==="lawyer"?v=m.draftAndPublishedDocumentsUnassigned:((s=y.value)==null?void 0:s.role)==="client"&&(v=m.progressAndCompletedDocumentsByClient(y.value.id)),m.filteredDocuments(l.value,t).filter(r=>v.some(h=>h.id===r.id))});ce(async()=>{await t.setCurrentUser(),await m.init(),m.selectedDocument=null});const u=v=>{c.value=v},w=()=>{b.value=!1};return(v,g)=>{var s,r;return a(),f(M,null,[o(Ce,{"onUpdate:searchQuery":g[0]||(g[0]=h=>l.value=h)},{default:_(()=>[ge(v.$slots,"default")]),_:3}),e("div",gs,[o(Ve,{onOpenNewDocument:g[1]||(g[1]=h=>b.value=!0),onUpdateCurrentSection:u,role:y.value.role},null,8,["role"]),((s=y.value)==null?void 0:s.role)==="lawyer"?(a(),f("div",bs,[c.value==="documentFinished"?(a(),E(ls,{key:0,searchQuery:l.value},null,8,["searchQuery"])):C("",!0),c.value==="documentInProgress"?(a(),E(ps,{key:1,searchQuery:l.value},null,8,["searchQuery"])):C("",!0),c.value==="default"?(a(),E(Yt,{key:2,searchQuery:l.value},null,8,["searchQuery"])):C("",!0),c.value==="default"&&i.value.length===0?(a(),f("div",vs,_s)):C("",!0)])):C("",!0),((r=y.value)==null?void 0:r.role)==="client"?(a(),f("div",ys,[c.value==="useDocument"?(a(),E(Tt,{key:0,searchQuery:l.value},null,8,["searchQuery"])):C("",!0),c.value==="default"?(a(),E(It,{key:1,searchQuery:l.value},null,8,["searchQuery"])):C("",!0)])):C("",!0)]),U(o(q,null,{default:_(()=>[o(_e,{onClose:w})]),_:1},512),[[O,b.value]])],64)}}};export{Ms as default};
