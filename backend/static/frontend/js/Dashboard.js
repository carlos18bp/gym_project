import{e as a,f,g as e,r as $,j as o,l,n as S,i as C,F as M,ay as fe,Q as E,k as h,I as _e,T as G,s as B,V as xe,b as ye,c as z,C as we,ax as Z,w as N,v as re,h as R,E as I,W as O,X as ie,t as P,m as X,O as De,u as J,al as ge,L as ke,A as K,S as Y,M as ee,H as A,G as te,az as $e,o as ce}from"./index.js";import{u as j,o as se,s as V,p as oe}from"./dynamicDocument.js";import{_ as Ce}from"./SearchBarAndFilterBy.js";import{s as Me,h as me,r as le}from"./loading_message.js";import{r as Pe,a as Se}from"./PhotoIcon.js";import"./MagnifyingGlassIcon.js";function de(g,t){return a(),f("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}function Ee(g,t){return a(),f("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"})])}function ae(g,t){return a(),f("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5ZM12 12.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5ZM12 18.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5Z"})])}function H(g,t){return a(),f("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 12.75V12A2.25 2.25 0 0 1 4.5 9.75h15A2.25 2.25 0 0 1 21.75 12v.75m-8.69-6.44-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"})])}function ze(g,t){return a(),f("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M18.364 18.364A9 9 0 0 0 5.636 5.636m12.728 12.728A9 9 0 0 1 5.636 5.636m12.728 12.728L5.636 5.636"})])}function ue(g,t){return a(),f("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"})])}function pe(g,t){return a(),f("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4.5v15m7.5-7.5h-15"})])}const Fe={key:0,class:"pb-8 border-b border-gray-200 flex gap-6 flex-wrap"},Be=e("div",{class:"grid"},[e("span",{class:"font-medium text-base"},"Documentos"),e("span",{class:"text-gray-400 font-regular text-sm"},"Mi unidad")],-1),Ue=e("div",{class:"grid"},[e("span",{class:"font-medium text-base"},"Documentos Finalizados"),e("span",{class:"text-gray-400 font-regular text-sm"},"Clientes")],-1),Ne=e("div",{class:"grid"},[e("span",{class:"font-medium text-base"},"Documentos en Progreso"),e("span",{class:"text-gray-400 font-regular text-sm"},"Clientes")],-1),Ae=e("div",{class:"grid"},[e("span",{class:"font-medium text-base"},"Nuevo Documento")],-1),Ie={key:1,class:"pb-8 border-b border-gray-200 flex gap-6 flex-wrap"},Ve=e("div",{class:"grid"},[e("span",{class:"font-medium text-base"},"Mis Documentos")],-1),je=e("div",{class:"grid"},[e("span",{class:"font-medium text-base"},"Nuevo Documento")],-1),Qe={__name:"DocumentsNavigation",props:{role:String},emits:["updateCurrentSection","openNewDocument"],setup(g,{emit:t}){const m=t,r=$("default"),c=g,b=_=>{r.value=_,m("updateCurrentSection",_)};return(_,i)=>(a(),f(M,null,[(c==null?void 0:c.role)==="lawyer"?(a(),f("div",Fe,[e("button",{onClick:i[0]||(i[0]=u=>b("default")),class:S(["flex gap-2 items-center py-2 px-4 rounded-xl border-2 border-yellow-300 text-start bg-white",{"bg-yellow-300/30":r.value=="default"}])},[o(l(H),{class:"size-6 text-yellow-500 font-semibold"}),Be],2),e("button",{onClick:i[1]||(i[1]=u=>b("documentFinished")),class:S(["flex gap-2 items-center py-2 px-4 rounded-xl border-2 border-yellow-300 bg-white text-start",{"bg-yellow-300/30":r.value=="documentFinished"}])},[o(l(H),{class:"size-6 text-yellow-500 font-semibold"}),Ue],2),e("button",{onClick:i[2]||(i[2]=u=>b("documentInProgress")),class:S(["flex gap-2 items-center py-2 px-4 rounded-xl border-2 border-yellow-300 bg-white text-start",{"bg-yellow-300/30":r.value=="documentInProgress"}])},[o(l(H),{class:"size-6 text-yellow-500 font-semibold"}),Ne],2),e("button",{onClick:i[3]||(i[3]=u=>_.$emit("openNewDocument")),class:"flex gap-2 items-center py-2 px-4 rounded-md bg-white text-start hover:bg-gray-100"},[o(l(pe),{class:"size-6 text-secondary font-semibold"}),Ae])])):C("",!0),(c==null?void 0:c.role)==="client"?(a(),f("div",Ie,[e("button",{onClick:i[4]||(i[4]=u=>b("default")),class:S(["flex gap-2 items-center py-2 px-4 rounded-md border-2 border-yellow-300 bg-white text-start",{"bg-yellow-300/30":r.value=="default"}])},[o(l(H),{class:"size-6 text-yellow-500 font-semibold"}),Ve],2),e("button",{onClick:i[5]||(i[5]=u=>b("useDocument")),class:S(["flex gap-2 items-center py-2 px-4 rounded-md bg-white text-start hover:bg-gray-100",{"bg-selected-background":r.value=="useDocument"}])},[o(l(pe),{class:"size-6 text-secondary font-semibold"}),je],2)])):C("",!0)],64))}};function Le(g){fe.fromTo(g,{opacity:0},{opacity:1,duration:.5,ease:"power2.out"})}function Oe(g,t){fe.to(g,{opacity:0,duration:.4,ease:"power2.in",onComplete:t})}const Te={key:0,class:"fixed inset-0 z-50 bg-gray-400 bg-opacity-40 backdrop-blur-md flex items-center justify-center"},W={__name:"ModalTransition",setup(g){function t(r,c){Le(r),c()}function m(r,c){Oe(r,c),c()}return(r,c)=>(a(),E(G,{onEnter:t,onLeave:m},{default:h(()=>[r.$slots.default?(a(),f("div",Te,[_e(r.$slots,"default")])):C("",!0)]),_:3}))}};function We(){const g=$(!1),t=$("");async function m(r,c,b="",_="",i=[],u={}){if(!c)throw t.value="Recipient email is required.",await B(t.value,"error"),new Error(t.value);const w=new FormData;w.append("to_email",c),w.append("subject",b),w.append("body",_),i.forEach((v,n)=>{w.append(`attachments[${n}]`,v)});for(const[v,n]of Object.entries(u))w.append(v,n);try{g.value=!0,t.value="",Me("Sending email...","Please wait while we send the email.");const v=await xe(r,w);return me(),await B("Email sent successfully.","success"),v.data}catch(v){throw me(),console.error("Error sending email:",v.message),t.value="An error occurred while sending the email. Please try again.",await B(t.value,"error"),v}finally{g.value=!1}}return{sendEmail:m,isLoading:g,errorMessage:t}}const qe={class:"bg-white rounded-lg p-6 shadow-xl max-w-lg w-full"},Re={class:"flex justify-end"},Ze=e("label",{for:"email",class:"block text-base font-medium leading-6 text-primary"},[X(" Correo electrónico "),e("span",{class:"text-red-500"},"*")],-1),Ge={class:"mt-2"},He={class:"mt-4"},Xe=e("label",{for:"files",class:"block text-base font-medium leading-6 text-primary"}," Anexos ",-1),Je={key:0,class:"text-center"},Ke={class:"mt-4 flex text-sm/6 text-gray-600"},Ye={for:"file-upload",class:"relative cursor-pointer rounded-md bg-white font-semibold text-indigo-600 focus-within:outline-none focus-within:ring-2 focus-within:ring-indigo-600 focus-within:ring-offset-2 hover:text-indigo-500"},et=e("span",null,"Sube un archivo",-1),tt=e("p",{class:"pl-1"},"o arrastra y suelta",-1),st=e("p",{class:"text-xs/5 text-gray-600"}," PNG, JPG, PDF, DOCX de hasta 20MB ",-1),ot={key:1,class:"w-full flex flex-wrap gap-3"},at=["onMouseenter","onMouseleave"],nt=["onClick"],lt={class:"text-center text-xs truncate w-20"},rt=["disabled"],it=e("span",null,"Enviar",-1),ct=[it],dt="dynamic-documents/send_email_with_attachments/",ut=20*1024*1024,mt={__name:"SendDocument",props:{emailDocument:{type:Object,required:!0}},emits:["closeEmailModal"],setup(g,{emit:t}){const m=t,{sendEmail:r}=We(),c=$(null),b=g,_=()=>{i.email="",u.value=[],c.value=null},i=ye({email:""}),u=$([]),w=d=>{const x=Array.from(d.target.files);n(x),d.target.value=null},v=d=>{const x=Array.from(d.dataTransfer.files);n(x)},n=d=>{let x=u.value.reduce((D,T)=>D+T.file.size,0);d.forEach(D=>{if(D.size>ut){B(`The file "${D.name}" exceeds the 20 MB limit.`,"warning");return}const T=D.name.split(".").pop().toLowerCase();let Q="",L={general:"",xMark:""};switch(T){case"png":case"jpg":case"jpeg":Q=Se,L.general="border-gray-200 text-gray-400",L.xMark="bg-gray-400";break;case"pdf":Q=le,L.general="border-red-600/20 text-red-600/60",L.xMark="bg-red-600/60";break;case"docx":Q=le,L.general="border-blue-600/20 text-blue-600/60",L.xMark="bg-blue-600/60";break;default:B("Unsupported file type. Only PDF, DOCX, JPG, and PNG are allowed.","warning");return}u.value.push({name:D.name,icon:Q,style:L,hover:!1,file:D}),x+=D.size})},s=d=>{u.value.splice(d,1)},p=d=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(d),y=z(()=>p(i.email)),F=z(()=>y.value),q=async d=>{try{const x=await De(`dynamic-documents/${d}/download-pdf/`,"blob");if(!x||!x.data)throw new Error("Invalid response from server");return new File([x.data],`document_${d}.pdf`,{type:"application/pdf"})}catch(x){return console.error("Error downloading PDF:",x),B("No se pudo descargar el documento PDF.","error"),null}};we(()=>b.emailDocument,d=>{d&&Object.keys(d).length>0&&d.id&&q(d.id)},{immediate:!0});const k=async()=>{try{if(b.emailDocument.id){const x=await q(b.emailDocument.id);x&&u.value.push({name:x.name,file:x,icon:le,style:{general:"border-blue-600/20 text-blue-600/60",xMark:"bg-blue-600/60"},hover:!1})}const d=u.value.map(x=>x.file);await r(dt,i.email,b.emailDocument.title,"Attached is the requested document along with additional attachments.",d,{documentId:b.emailDocument.id})}catch(d){console.error("Error sending the email:",d)}finally{U()}},U=()=>{_(),m("closeEmailModal")};return(d,x)=>(a(),f("div",qe,[e("div",Re,[e("button",{onClick:x[0]||(x[0]=D=>U())},[o(l(Z),{class:"size-6"})])]),e("form",{onSubmit:R(k,["prevent"])},[e("div",null,[Ze,e("div",Ge,[N(e("input",{"onUpdate:modelValue":x[1]||(x[1]=D=>i.email=D),type:"text",name:"email",id:"email",class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-secondary sm:text-sm sm:leading-6",required:""},null,512),[[re,i.email]])])]),e("div",He,[Xe,e("div",{class:"mt-2 flex justify-center rounded-lg border border-dashed border-gray-900/25 bg-white px-6 py-10",onDragover:x[2]||(x[2]=R(()=>{},["prevent"])),onDrop:R(v,["prevent"])},[u.value.length<1?(a(),f("div",Je,[o(l(Pe),{class:"mx-auto size-12 text-gray-300","aria-hidden":"true"}),e("div",Ke,[e("label",Ye,[et,e("input",{id:"file-upload",name:"file-upload",type:"file",class:"sr-only",onChange:w},null,32)]),tt]),st])):(a(),f("div",ot,[(a(!0),f(M,null,I(u.value,(D,T)=>(a(),f("div",{key:T,class:S(["relative p-4 grid rounded-md bg-white border-2",D.style.general]),onMouseenter:Q=>D.hover=!0,onMouseleave:Q=>D.hover=!1},[N(e("div",{class:S(["absolute p-0.5 mt-2 ml-2 rounded-full",D.style.xMark]),onClick:Q=>s(T)},[o(l(Z),{class:"size-3 text-white"})],10,nt),[[O,D.hover]]),(a(),E(ie(D.icon),{class:"size-12 mx-auto"})),e("span",lt,P(D.name),1)],42,at))),128))]))],32)]),e("button",{type:"submit",class:S(["mt-4 p-2.5 text-sm font-medium rounded-md flex gap-2",F.value?"bg-secondary text-white":"bg-gray-200 text-secondary border-2 border-dashed border-secondary cursor-not-allowed bg-opacity-50"]),disabled:!F.value},ct,10,rt)],32)]))}},pt={class:"bg-white rounded-lg p-6 shadow-xl max-w-lg w-full"},ft={class:"flex justify-end"},gt=e("label",{for:"document-name",class:"block text-base font-medium leading-6 text-primary"},[X(" Nombre "),e("span",{class:"text-red-500"},"*")],-1),bt={class:"mt-2"},vt=["disabled"],be={__name:"UseDocumentByClient",props:{documentId:{type:[Number,null],required:!1,default:null}},setup(g){const t=g,m=J(),r=j(),c=$("");ge(()=>{var i;r.selectedDocument?c.value=((i=r.selectedDocument)==null?void 0:i.title)||"":c.value=""});const b=z(()=>c.value.trim().length>0);function _(){const i=encodeURIComponent(c.value.trim());if(t.documentId&&!r.selectedDocument)m.push(`/dynamic_document_dashboard/document/use/creator/${t.documentId}/${i}`);else if(r.selectedDocument){const u=encodeURIComponent(c.value.trim());m.push(`/dynamic_document_dashboard/document/use/editor/${r.selectedDocument.id}/${u}`)}else B("Error: No se pudo continuar. Documento no seleccionado.","error")}return(i,u)=>(a(),f("div",pt,[e("div",ft,[e("button",{onClick:u[0]||(u[0]=w=>i.$emit("close"))},[o(l(Z),{class:"size-6"})])]),e("form",{onSubmit:R(_,["prevent"])},[e("div",null,[gt,e("div",bt,[N(e("input",{"onUpdate:modelValue":u[1]||(u[1]=w=>c.value=w),type:"text",id:"document-name",class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm ring-1 ring-inset ring-gray-300",required:""},null,512),[[re,c.value]])])]),e("button",{type:"submit",class:S(["mt-2.5 p-2.5 text-sm font-medium rounded-md flex gap-2",b.value?"bg-secondary text-white":"bg-gray-200 text-secondary border-2 border-dashed border-secondary cursor-not-allowed bg-opacity-50"]),disabled:!b.value}," Continuar ",10,vt)],32)]))}};function ve(g){return ke.fire({title:g,icon:"question",showCancelButton:!0,confirmButtonText:"Aceptar",cancelButtonText:"Cancelar",buttonsStyling:!1}).then(t=>t.isConfirmed)}const ht={class:"bg-white rounded-lg shadow-xl p-6 max-w-4xl w-full overflow-auto max-h-[80vh]"},_t={class:"flex justify-between items-center mb-4"},xt={class:"text-lg font-bold"},yt=["innerHTML"],ne={__name:"DocumentPreviewModal",props:{isVisible:Boolean,documentData:{type:Object,default:()=>({title:"",content:""})}},emits:["close"],setup(g,{emit:t}){const m=t,r=()=>{m("close")};return(c,b)=>N((a(),E(W,null,{default:h(()=>[e("div",ht,[e("div",_t,[e("h2",xt," Previsualización del Documento: "+P(g.documentData.title),1),e("button",{onClick:r},[o(l(Z),{class:"size-6 text-gray-500 hover:text-gray-700"})])]),e("div",{class:"prose max-w-none",innerHTML:g.documentData.content},null,8,yt)])]),_:1},512)),[[O,g.isVisible]])}},wt={class:"mt-8 flex flex-wrap gap-6"},Dt={class:"grid gap-1"},kt={class:"text-base font-medium"},$t={class:"text-sm font-regular text-gray-400"},Ct={class:"py-1"},Mt=["onClick"],Pt=["onClick"],St=["onClick"],Et=["onClick"],zt=["onClick"],Ft=["onClick"],Bt={key:0,class:"mt-6 flex flex-col items-center justify-center text-center text-gray-500 w-full"},Ut=e("p",{class:"text-lg font-semibold"}," No hay documentos disponibles para mostrar. ",-1),Nt=e("p",{class:"text-sm"}," Contacta a tu abogado para gestionar tus documentos. ",-1),At=[Ut,Nt],It={__name:"DocumentListClient",props:{searchQuery:String},setup(g){const t=j(),m=K(),r=z(()=>m.getCurrentUser),c=$(!1),b=$(null),_=$(!1),i=$({}),u=g,w=z(()=>{const k=t.progressAndCompletedDocumentsByClient(r.value.id);return t.filteredDocuments(u.searchQuery,m).filter(U=>k.some(d=>d.id===U.id))}),v=k=>{t.downloadPDF(k.id,k.title)},n=k=>{t.downloadWord(k.id,k.title)},s=async k=>{await ve(`¿Deseas eliminar el documento "${k.title}"?`)&&(await t.deleteDocument(k.id),await B("Documento eliminado exitosamente.","success"))},p=k=>{t.selectedDocument=k,b.value=k.id,c.value=!0},y=()=>{c.value=!1,t.clearSelectedDocument()},F=k=>{i.value=k,_.value=!0},q=()=>{i.value={},_.value=!1};return(k,U)=>(a(),f(M,null,[e("div",wt,[(a(!0),f(M,null,I(w.value,d=>(a(),f("div",{key:d.id,class:S(["flex items-center gap-3 py-2 px-4 border rounded-xl cursor-pointer",{"border-green-400 bg-green-300/30":d.state==="Completed","border-stroke bg-white":d.state==="Progress"}])},[(a(),E(ie(d.state==="Completed"?l(de):l(ue)),{class:S(["size-6",{"text-green-500":d.state==="Completed","text-secondary":d.state==="Progress"}])},null,8,["class"])),e("div",Dt,[e("span",kt,P(d.title),1),e("span",$t,P(d.description),1)]),o(l(te),{as:"div",class:"relative inline-block text-left"},{default:h(()=>[o(l(Y),{class:"flex items-center text-gray-400"},{default:h(()=>[o(l(ae),{class:"size-6","aria-hidden":"true"})]),_:1}),o(G,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:h(()=>[o(l(ee),{class:"absolute left-0 z-10 mt-2 w-56 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black/5 focus:outline-none"},{default:h(()=>[e("div",Ct,[o(l(A),null,{default:h(()=>[e("button",{class:"block w-full text-left px-4 py-2 text-sm font-regular hover:bg-gray-100 transition",onClick:x=>p(d)},P(d.state==="Completed"?"Editar":"Completar"),9,Mt)]),_:2},1024),d.state==="Completed"?(a(),E(l(A),{key:0},{default:h(()=>[e("button",{class:"block w-full text-left px-4 py-2 text-sm font-regular hover:bg-gray-100 transition",onClick:x=>l(se)(d)}," Previsualizar ",8,Pt)]),_:2},1024)):C("",!0),o(l(A),null,{default:h(()=>[e("button",{class:"block w-full text-left px-4 py-2 text-sm font-regular hover:bg-gray-100 transition",onClick:x=>s(d)}," Eliminar ",8,St)]),_:2},1024),d.state==="Completed"?(a(),f(M,{key:1},[o(l(A),null,{default:h(()=>[e("button",{class:"block w-full text-left px-4 py-2 text-sm font-regular hover:bg-gray-100 transition",onClick:x=>v(d)}," Descargar PDF ",8,Et)]),_:2},1024),o(l(A),null,{default:h(()=>[e("button",{class:"block w-full text-left px-4 py-2 text-sm font-regular hover:bg-gray-100 transition",onClick:x=>n(d)}," Descargar Word ",8,zt)]),_:2},1024),o(l(A),null,{default:h(()=>[e("button",{class:"block w-full text-left px-4 py-2 text-sm font-regular hover:bg-gray-100 transition",onClick:x=>F(d)}," Enviar ",8,Ft)]),_:2},1024)],64)):C("",!0)])]),_:2},1024)]),_:2},1024)]),_:2},1024)],2))),128)),w.value.length===0?(a(),f("div",Bt,At)):C("",!0),N(o(W,null,{default:h(()=>[o(be,{"document-id":b.value,onClose:y},null,8,["document-id"])]),_:1},512),[[O,c.value]])]),o(ne,{isVisible:l(V),documentData:l(oe),onClose:U[0]||(U[0]=d=>V.value=!1)},null,8,["isVisible","documentData"]),N(o(W,null,{default:h(()=>[o(mt,{onCloseEmailModal:U[1]||(U[1]=d=>q()),emailDocument:i.value},null,8,["emailDocument"])]),_:1},512),[[O,_.value]])],64))}},Vt={class:"mt-8 flex flex-wrap gap-6"},jt=["onClick"],Qt={class:"grid gap-1"},Lt={class:"text-base font-medium"},Ot={class:"text-sm font-regular text-gray-400"},Tt={__name:"UseDocument",props:{searchQuery:String},setup(g){const t=j(),m=$(!1),r=$(null),c=g,b=z(()=>{const u=t.publishedDocumentsUnassigned;return t.filteredDocuments(c.searchQuery,"").filter(w=>u.some(v=>v.id===w.id))});function _(u){u&&(r.value=u,m.value=!0)}function i(){m.value=!1,r.value=null}return(u,w)=>(a(),f("div",Vt,[(a(!0),f(M,null,I(b.value,v=>(a(),f("button",{key:v.id,onClick:n=>_(v.id),class:"flex items-center gap-3 py-2 px-4 border rounded-xl border-stroke bg-white hover:bg-gray-100"},[o(l($e),{class:"size-6 text-secondary"}),e("div",Qt,[e("span",Lt,P(v.title),1),e("span",Ot,P(v.description),1)]),o(l(Ee),{class:"size-6 text-gray-400"})],8,jt))),128)),N(o(W,null,{default:h(()=>[r.value!==null?(a(),E(be,{key:0,"document-id":r.value,onClose:i},null,8,["document-id"])):C("",!0)]),_:1},512),[[O,m.value]])]))}},Wt={class:"bg-white rounded-lg p-6 shadow-xl max-w-lg w-full"},qt={class:"flex justify-end"},Rt=e("label",{for:"document-name",class:"block text-base font-medium leading-6 text-primary"},[X(" Nombre "),e("span",{class:"text-red-500"},"*")],-1),Zt={class:"mt-2"},Gt=["disabled"],he={__name:"CreateDocumentByLawyer",setup(g){const t=J(),m=j(),r=$("");ge(()=>{var i;r.value=((i=m.selectedDocument)==null?void 0:i.title)||""});const c=z(()=>r.value.trim().length>0),b=z(()=>{var i;return!!((i=m.selectedDocument)!=null&&i.id)});function _(){if(c.value){const i=encodeURIComponent(r.value.trim());b.value&&(m.selectedDocument.title=r.value),b.value?t.push(`/dynamic_document_dashboard/lawyer/editor/edit/${m.selectedDocument.id}`):t.push(`/dynamic_document_dashboard/lawyer/editor/create/${i}`)}}return(i,u)=>(a(),f("div",Wt,[e("div",qt,[e("button",{onClick:u[0]||(u[0]=w=>i.$emit("close"))},[o(l(Z),{class:"size-6"})])]),e("form",{onSubmit:R(_,["prevent"])},[e("div",null,[Rt,e("div",Zt,[N(e("input",{"onUpdate:modelValue":u[1]||(u[1]=w=>r.value=w),type:"text",name:"document-name",id:"document-name",class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-secondary sm:text-sm sm:leading-6",required:""},null,512),[[re,r.value]])])]),e("button",{type:"submit",class:S(["mt-2.5 p-2.5 text-sm font-medium rounded-md flex gap-2",c.value?"bg-secondary text-white":"bg-gray-200 text-secondary border-2 border-dashed border-secondary cursor-not-allowed bg-opacity-50"]),disabled:!c.value},[e("span",null,P(b.value?"Editar":"Continuar"),1)],10,Gt)],32)]))}},Ht={class:"mt-8 flex flex-wrap gap-6"},Xt={class:"text-base font-medium"},Jt=["disabled","onClick"],Kt={__name:"DocumentListLawyer",props:{searchQuery:String},setup(g){const t=j(),m=$(!1),r=g,c=z(()=>{const n=t.draftAndPublishedDocumentsUnassigned;return t.filteredDocuments(r.searchQuery,"").filter(s=>n.some(p=>p.id===s.id))}),b=n=>{const s=[{label:"Editar",action:"edit"},{label:"Eliminar",action:"delete"},{label:"Previsualización",action:"preview"}];return n.state==="Draft"?s.push({label:"Publicar",action:"publish",disabled:!_(n)}):n.state==="Published"&&s.push({label:"Mover a Borrador",action:"draft",disabled:!1}),s},_=n=>n.variables.every(s=>s.value&&s.value.trim().length>0),i=async(n,s)=>{switch(n){case"edit":t.selectedDocument=s,m.value=!0;break;case"delete":await ve(`¿Deseas eliminar el documento '${s.title}'?`)&&(await t.deleteDocument(s.id),await B("Documento eliminado correctamente.","success"));break;case"publish":await u(s),await B("Documento publicado correctamente.","success");break;case"draft":await w(s),await B("Documento movido a borrador.","info");break;case"preview":se(s);break;default:console.warn(`Acción desconocida: ${n}`)}},u=async n=>{const s={...n,state:"Published"};await t.updateDocument(n.id,s)},w=async n=>{const s={...n,state:"Draft"};await t.updateDocument(n.id,s)},v=()=>{m.value=!1,t.selectedDocument=null};return(n,s)=>(a(),f(M,null,[e("div",Ht,[(a(!0),f(M,null,I(c.value,p=>(a(),f("div",{key:p.id,class:S(["flex items-center gap-2 py-2 px-4 border rounded-md cursor-pointer transition",p.state==="Published"?"border-green-400 bg-green-300/30 hover:bg-green-300/50":"border-stroke bg-white hover:bg-gray-100"])},[(a(),E(ie(p.state==="Published"?l(de):l(ue)),{class:S(p.state==="Published"?"size-6 text-green-500":"size-6 text-secondary")},null,8,["class"])),e("span",Xt,P(p.title),1),o(l(te),{as:"div",class:"relative inline-block text-left"},{default:h(()=>[o(l(Y),{class:"flex items-center text-gray-400"},{default:h(()=>[o(l(ae),{class:"size-6","aria-hidden":"true"})]),_:1}),o(G,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:h(()=>[o(l(ee),{class:"absolute left-0 z-10 mt-2 w-56 rounded-md bg-white shadow-lg ring-1 ring-black/5"},{default:h(()=>[(a(!0),f(M,null,I(b(p),y=>(a(),E(l(A),{key:y.label},{default:h(()=>[e("button",{class:S(["w-full text-left px-4 py-2 text-sm font-regular transition flex items-center gap-2",{"opacity-50 cursor-not-allowed":y.disabled,"cursor-pointer":!y.disabled}]),disabled:y.disabled,onClick:F=>!y.disabled&&i(y.action,p)},[y.disabled?(a(),E(l(ze),{key:0,class:"size-5 text-gray-400","aria-hidden":"true"})):C("",!0),X(" "+P(y.label),1)],10,Jt)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)],2))),128))]),N(o(W,null,{default:h(()=>[o(he,{onClose:v})]),_:1},512),[[O,m.value]]),o(ne,{isVisible:l(V),documentData:l(oe),onClose:s[0]||(s[0]=p=>V.value=!1)},null,8,["isVisible","documentData"])],64))}},Yt={class:"mt-8 flex flex-wrap gap-6"},es={class:"grid gap-1"},ts={class:"text-base font-medium"},ss={class:"text-sm font-regular text-gray-400"},os=e("span",{class:"sr-only"},"Open options",-1),as={class:"py-1"},ns=["onClick"],ls={__name:"DocumentFinishedByClientList",props:{searchQuery:String},setup(g){const t=j(),m=K(),r=J();ce(()=>{t.init(),m.init()});const c=z(()=>{var n;return t.completedDocumentsByClient((n=m.getCurrentUser)==null?void 0:n.id)}),b=[{label:"Editar",action:"edit"},{label:"Previsualización",action:"preview"},{label:"Descargar PDF",action:"downloadPDF"},{label:"Descargar Word",action:"downloadWord"}],_=(n,s)=>{switch(n.action){case"edit":i(s);break;case"preview":se(s);break;case"downloadPDF":w(s);break;case"downloadWord":v(s);break;default:console.warn("Unknown action:",n.action)}},i=n=>{const s=encodeURIComponent(n.title.trim());r.push(`/dynamic_document_dashboard/document/use/editor/${n.id}/${s}`)},u=n=>{const s=m.userById(n);return s?`${s.first_name} ${s.last_name}`:"Desconocido"},w=n=>{t.downloadPDF(n.id,n.title)},v=n=>{t.downloadWord(n.id,n.title)};return(n,s)=>(a(),f(M,null,[e("div",Yt,[(a(!0),f(M,null,I(c.value,p=>(a(),f("div",{key:p.id,class:"flex items-center gap-3 py-2 px-4 border rounded-xl border-green-400 bg-green-300/30"},[o(l(de),{class:"size-6 text-green-500"}),e("div",es,[e("span",ts,P(p.title),1),e("span",ss,P(u(p.assigned_to)),1)]),o(l(te),{as:"div",class:"relative inline-block text-left"},{default:h(()=>[e("div",null,[o(l(Y),{class:"flex items-center text-gray-400"},{default:h(()=>[os,o(l(ae),{class:"size-6","aria-hidden":"true"})]),_:1})]),o(G,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:h(()=>[o(l(ee),{class:"absolute left-0 z-10 mt-2 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black/5"},{default:h(()=>[e("div",as,[(a(),f(M,null,I(b,y=>o(l(A),{key:y.label},{default:h(()=>[e("button",{onClick:F=>_(y,p),class:"block w-full text-left px-4 py-2 text-sm font-regular cursor-pointer hover:bg-gray-100 transition"},P(y.label),9,ns)]),_:2},1024)),64))])]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))]),o(ne,{isVisible:l(V),documentData:l(oe),onClose:s[0]||(s[0]=p=>V.value=!1)},null,8,["isVisible","documentData"])],64))}},rs={class:"mt-8 flex flex-wrap gap-6"},is={class:"grid gap-1"},cs={class:"text-base font-medium"},ds={class:"text-sm font-regular text-gray-400"},us=e("span",{class:"sr-only"},"Open options",-1),ms={class:"py-1"},ps=["onClick"],fs={__name:"DocumentInProgressByClientList",props:{searchQuery:String},setup(g){const t=j(),m=K(),r=J();ce(()=>{t.init(),m.init()});const c=g,b=z(()=>{var p;const s=t.progressDocumentsByClient((p=m.getCurrentUser)==null?void 0:p.id);return t.filteredDocuments(c.searchQuery,m).filter(y=>s.some(F=>F.id===y.id))}),_=[{label:"Editar",action:"edit"},{label:"Previsualización",action:"preview"},{label:"Descargar PDF",action:"downloadPDF"},{label:"Descargar Word",action:"downloadWord"}],i=(s,p)=>{switch(s.action){case"edit":u(p);break;case"preview":se(p);break;case"downloadPDF":v(p);break;case"downloadWord":n(p);break;default:console.warn("Unknown action:",s.action)}},u=s=>{const p=encodeURIComponent(s.title.trim());r.push(`/dynamic_document_dashboard/document/use/editor/${s.id}/${p}`)},w=s=>{const p=m.userById(s);return p?`${p.first_name} ${p.last_name}`:"Desconocido"},v=s=>{t.downloadPDF(s.id,s.title)},n=s=>{t.downloadWord(s.id,s.title)};return(s,p)=>(a(),f(M,null,[e("div",rs,[(a(!0),f(M,null,I(b.value,y=>(a(),f("div",{key:y.id,class:"flex items-center gap-3 py-2 px-4 border rounded-xl border-stroke bg-white"},[o(l(ue),{class:"size-6 text-secondary"}),e("div",is,[e("span",cs,P(y.title),1),e("span",ds,P(w(y.assigned_to)),1)]),o(l(te),{as:"div",class:"relative inline-block text-left"},{default:h(()=>[e("div",null,[o(l(Y),{class:"flex items-center text-gray-400"},{default:h(()=>[us,o(l(ae),{class:"size-6","aria-hidden":"true"})]),_:1})]),o(G,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:h(()=>[o(l(ee),{class:"absolute left-0 z-10 mt-2 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black/5"},{default:h(()=>[e("div",ms,[(a(),f(M,null,I(_,F=>o(l(A),{key:F.label},{default:h(()=>[e("button",{onClick:q=>i(F,y),class:"block w-full text-left px-4 py-2 text-sm font-regular cursor-pointer hover:bg-gray-100 transition"},P(F.label),9,ps)]),_:2},1024)),64))])]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))]),o(ne,{isVisible:l(V),documentData:l(oe),onClose:p[0]||(p[0]=y=>V.value=!1)},null,8,["isVisible","documentData"])],64))}},gs={class:"pb-10 px-4 sm:px-6 lg:px-8 lg:pt-10"},bs={key:0},vs={key:3,class:"mt-6 text-center text-gray-500"},hs=e("p",null,"No documents available to display.",-1),_s=e("p",null,'Use the "New" button to create a document.',-1),xs=[hs,_s],ys={key:1},Ps={__name:"Dashboard",setup(g){const t=K(),m=j(),r=$(""),c=$("default"),b=$(!1),_=z(()=>t.getCurrentUser),i=z(()=>{var n,s;let v=[];return((n=_.value)==null?void 0:n.role)==="lawyer"?v=m.draftAndPublishedDocumentsUnassigned:((s=_.value)==null?void 0:s.role)==="client"&&(v=m.progressAndCompletedDocumentsByClient(_.value.id)),m.filteredDocuments(r.value,t).filter(p=>v.some(y=>y.id===p.id))});ce(async()=>{await t.setCurrentUser(),await m.init(),m.selectedDocument=null});const u=v=>{c.value=v},w=()=>{b.value=!1};return(v,n)=>{var s,p;return a(),f(M,null,[o(Ce,{"onUpdate:searchQuery":n[0]||(n[0]=y=>r.value=y)}),e("div",gs,[o(Qe,{onOpenNewDocument:n[1]||(n[1]=y=>b.value=!0),onUpdateCurrentSection:u,role:_.value.role},null,8,["role"]),((s=_.value)==null?void 0:s.role)==="lawyer"?(a(),f("div",bs,[c.value==="documentFinished"?(a(),E(ls,{key:0,searchQuery:r.value},null,8,["searchQuery"])):C("",!0),c.value==="documentInProgress"?(a(),E(fs,{key:1,searchQuery:r.value},null,8,["searchQuery"])):C("",!0),c.value==="default"?(a(),E(Kt,{key:2,searchQuery:r.value},null,8,["searchQuery"])):C("",!0),c.value==="default"&&i.value.length===0?(a(),f("div",vs,xs)):C("",!0)])):C("",!0),((p=_.value)==null?void 0:p.role)==="client"?(a(),f("div",ys,[c.value==="useDocument"?(a(),E(Tt,{key:0,searchQuery:r.value},null,8,["searchQuery"])):C("",!0),c.value==="default"?(a(),E(It,{key:1,searchQuery:r.value},null,8,["searchQuery"])):C("",!0)])):C("",!0)]),N(o(W,null,{default:h(()=>[o(he,{onClose:w})]),_:1},512),[[O,b.value]])],64)}}};export{Ps as default};
