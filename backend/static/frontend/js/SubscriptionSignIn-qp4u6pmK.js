import{u as M,G as A,a as L,r as h,c as b,b as R,o as T,d as w,e as u,f as v,g as e,m as z,w as k,v as C,h as p,i as _,k as U,j as D,l as y,n as H,p as c,t as I,x as K,s as t,q as S}from"./index-BROrgVaC.js";import{u as O,_ as $,a as F}from"./captcha-n4RixfcF.js";const P={class:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8"},W={class:"max-w-md w-full"},J=e("div",{class:"text-center mb-8"},[e("img",{class:"mx-auto h-16 w-auto",src:$,alt:"G&M Abogados"}),e("h2",{class:"mt-6 text-3xl font-bold text-primary"}," Inicia sesión para continuar "),e("p",{class:"mt-2 text-sm text-gray-600"}," Accede a tu cuenta para completar tu suscripción ")],-1),Q={class:"bg-white rounded-xl border border-gray-200 shadow-sm p-8"},X=e("label",{for:"email",class:"block text-sm font-medium text-gray-900 mb-2"}," Correo electrónico ",-1),Y=e("label",{for:"password",class:"block text-sm font-medium text-gray-900 mb-2"}," Contraseña ",-1),Z=["disabled"],ee={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},se=e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),te=e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1),oe=[se,te],ae={key:0,class:"text-center text-sm mt-2 text-gray-600"},ne=e("span",{class:"font-regular"},"Intentar de nuevo en ",-1),re={class:"font-bold"},ie=e("span",{class:"font-regular"}," segundos.",-1),le={class:"text-center"},ce={class:"text-sm text-gray-600"},de={class:"mt-6"},ue=K('<div class="relative"><div class="absolute inset-0 flex items-center"><div class="w-full border-t border-gray-300"></div></div><div class="relative flex justify-center text-sm"><span class="px-2 bg-white text-gray-500">O continuar con</span></div></div>',1),pe={class:"mt-6 flex justify-center"},me={class:"mt-6 text-center"},ge=e("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),ve={__name:"SubscriptionSignIn",setup(xe){const m=M(),g=A(),r=L(),q=O(),x=h(""),d=h(""),V=async s=>{d.value=s},j=()=>{d.value=""},E=b(()=>r.signInTries),i=b(()=>r.signInSecondsRemaining),n=h(!1),o=R({email:"",password:""});T(async()=>{if(r.attempsSignIn("initial"),x.value=await q.fetchSiteKey(),await r.isAuthenticated()){const s=g.query.plan||"basico";m.push({name:"checkout",params:{plan:s}})}});const G=async()=>{if(!o.email){t("El correo electrónico es requerido","warning");return}if(!o.password){t("La contraseña es requerida","warning");return}if(!d.value){t("Por favor verifica que no eres un robot","warning");return}if(!n.value){if(r.attempsSignIn(),E.value%3===0)t("Has excedido el número máximo de intentos. Intenta más tarde.","warning");else{n.value=!0;try{const s=await S.post("/api/sign_in/",{email:o.email,password:o.password,captcha_token:d.value});r.login(s.data),t("¡Inicio de sesión exitoso!","success");const a=g.query.plan||"basico";m.push({name:"checkout",params:{plan:a}})}catch(s){s.response&&s.response.status===401?t("Credenciales inválidas","warning"):s.response&&s.response.status===400?t(s.response.data.error||"Error de validación","error"):t("Error en el inicio de sesión","error")}finally{n.value=!1}}o.password=""}},N=async s=>{try{const a=await S.post("/api/google_login/",{credential:s.credential});r.login(a.data),t("¡Inicio de sesión exitoso con Google!","success");const l=g.query.plan||"basico";m.push({name:"checkout",params:{plan:l}})}catch{t("Error al iniciar sesión con Google","error")}};return(s,a)=>{const l=w("router-link"),B=w("GoogleLogin");return u(),v("div",P,[e("div",W,[J,e("div",Q,[e("form",{class:"space-y-6",onSubmit:z(G,["prevent"])},[e("div",null,[X,k(e("input",{"onUpdate:modelValue":a[0]||(a[0]=f=>o.email=f),type:"email",id:"email",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-secondary focus:border-secondary block w-full p-2.5",required:""},null,512),[[C,o.email]])]),e("div",null,[Y,k(e("input",{"onUpdate:modelValue":a[1]||(a[1]=f=>o.password=f),type:"password",id:"password",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-secondary focus:border-secondary block w-full p-2.5",required:""},null,512),[[C,o.password]]),p(l,{to:{name:"forget_password"},class:"text-sm font-medium text-secondary hover:text-blue-700 mt-2 inline-block"},{default:_(()=>[c(" ¿Olvidaste tu contraseña? ")]),_:1})]),e("div",null,[x.value?(u(),U(D(F),{key:0,sitekey:x.value,onVerify:V,onExpire:j,hl:"es",class:"mx-auto"},null,8,["sitekey"])):y("",!0)]),e("div",null,[e("button",{type:"submit",disabled:i.value>1||n.value,class:H({"w-full text-white bg-secondary hover:bg-blue-700 font-semibold rounded-lg text-sm px-5 py-3 text-center flex items-center justify-center transition-colors":i.value<1&&!n.value,"w-full text-white bg-gray-400 cursor-not-allowed font-semibold rounded-lg text-sm px-5 py-3 text-center flex items-center justify-center":i.value>=1||n.value})},[n.value?(u(),v("svg",ee,oe)):y("",!0),c(" "+I(n.value?"Validando credenciales...":"Iniciar sesión"),1)],10,Z),i.value>0?(u(),v("div",ae,[ne,e("span",re,I(i.value),1),ie])):y("",!0)]),e("div",le,[e("p",ce,[c(" ¿No tienes cuenta? "),p(l,{to:{name:"subscription_sign_up",query:{plan:s.$route.query.plan}},class:"font-medium text-secondary hover:text-blue-700"},{default:_(()=>[c(" Regístrate aquí ")]),_:1},8,["to"])])])],32),e("div",de,[ue,e("div",pe,[p(B,{callback:N,"select-account":"","auto-login":!1})])])]),e("div",me,[p(l,{to:{name:"subscriptions"},class:"text-sm text-gray-600 hover:text-primary flex items-center justify-center gap-2"},{default:_(()=>[ge,c(" Volver a planes ")]),_:1})])])])}}};export{ve as default};
