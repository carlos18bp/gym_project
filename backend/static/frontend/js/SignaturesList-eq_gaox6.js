import{H as T,r as b,c as _,o as B,V as w,e as m,f as S,F as I,I as L,g as o,t as x,p as M,l as k,h as $,j as g,C as z,s as F,k as Q,P as R,Q as j}from"./index-BROrgVaC.js";import{u as A,s as C,p as H}from"./index-DD7IbEzR.js";import{_ as G}from"./DocumentRelationshipsModal-CAdaHpvt.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-CtP5KBQa.js";import{_ as K}from"./SignatureDocumentCard-DIdFcJIC.js";import"./MagnifyingGlassIcon-CXCj2kTH.js";import"./DocumentIcon-C7Y5428u.js";import"./LinkIcon-DdDRh74t.js";import"./TrashIcon-DyZxV_p1.js";import"./DocumentPermissionsManager-BF_9sj_Q.js";import"./useRecentViews-Dqtww0kV.js";import"./PhotoIcon-3-nF9FKJ.js";import"./CheckCircleIcon-CmyiFrWB.js";import"./CloudArrowUpIcon-CnTi9Fz2.js";import"./ExclamationTriangleIcon-Eb0O5_Hn.js";import"./EllipsisVerticalIcon-CczxQbp9.js";import"./ChevronRightIcon-DYnoKygb.js";import"./PencilIcon-YGP1YVK5.js";import"./loading_message-zJHSeb-D.js";const v=c=>(R("data-v-1b0481ad"),c=c(),j(),c),O={key:0,class:"mt-6 flex flex-col items-center justify-center text-center text-gray-500 w-full p-12 rounded-xl bg-gray-50 border-2 border-dashed border-gray-200"},W=v(()=>o("svg",{class:"w-16 h-16 mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})],-1)),X={class:"text-lg font-semibold mb-2 text-gray-700"},Y={class:"text-sm mb-4 max-w-md"},Z={class:"flex flex-col sm:flex-row gap-3 mt-2"},ee={class:"text-xs text-gray-400 bg-gray-100 px-3 py-2 rounded-lg"},te={key:1,class:"mt-6 flex justify-center"},se=v(()=>o("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[o("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),o("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),re=v(()=>o("span",null,"Cargando documentos...",-1)),ne=[se,re],oe={__name:"SignaturesList",props:{state:{type:String,required:!0,validator:c=>["PendingSignatures","FullySigned"].includes(c)},searchQuery:{type:String,default:""},selectedTags:{type:Array,default:()=>[]}},emits:["refresh"],setup(c,{expose:U,emit:P}){const r=c,E=P,l=T(),n=A();b([]);const p=b(!1),V=_(()=>r.state==="PendingSignatures"?"No tienes documentos pendientes por firmar":"No tienes documentos firmados"),q=_(()=>r.state==="PendingSignatures"?"Cuando tengas documentos que requieran tu firma electrÃ³nica aparecerÃ¡n aquÃ­. Tu abogado te notificarÃ¡ cuando haya documentos listos para firmar.":"Una vez que firmes documentos electrÃ³nicamente, aparecerÃ¡n aquÃ­ con el registro completo de firmas y podrÃ¡s descargarlos cuando estÃ©n completamente firmados."),f=_(()=>{const s=l.currentUser.role,a=l.currentUser.id,i=l.currentUser.email;let t=[];if(s==="lawyer"?r.state==="PendingSignatures"?t=n.pendingSignatureDocuments.filter(e=>e.created_by===a):t=n.fullySignedDocuments.filter(e=>e.created_by===a):r.state==="PendingSignatures"?t=n.documents.filter(e=>{var d;return e.state!=="PendingSignatures"?!1:(d=e.signatures)==null?void 0:d.some(y=>y.signer_email===i)}):t=n.documents.filter(e=>{var d;return e.state!=="FullySigned"?!1:(d=e.signatures)==null?void 0:d.some(y=>y.signer_email===i&&y.signed)}),r.searchQuery&&(t=t.filter(e=>e.title.toLowerCase().includes(r.searchQuery.toLowerCase()))),r.selectedTags&&r.selectedTags.length>0){const e=r.selectedTags.map(u=>u.id);t=t.filter(u=>!u.tags||u.tags.length===0?!1:u.tags.some(d=>e.includes(d.id)))}return t}),N=_(()=>{const s=n.lastUpdatedDocumentId,a=localStorage.getItem("lastUpdatedDocumentId");return s&&f.value.some(t=>String(t.id)===String(s))?s:a&&f.value.some(e=>String(e.id)===String(a))?a:null}),D=async()=>{p.value=!0;try{if(await n.init(!0),n.pendingSignatureDocuments.length===0&&n.fullySignedDocuments.length===0){const s=l.currentUser.id,i=l.currentUser.role==="lawyer"?`dynamic-documents/created-by/${s}/pending-signatures/`:`dynamic-documents/user/${s}/pending-documents-full/`,t=await z(i);t&&t.data&&n.$patch(e=>{e.documents=[...e.documents,...t.data]})}}catch(s){console.error("Error refreshing documents:",s),F("Error al actualizar documentos","error")}finally{p.value=!1}},h=async()=>{await D(),E("refresh")};return B(async()=>{await D()}),U({refresh:h}),w(()=>n.documents,s=>{},{deep:!0}),w(()=>l.currentUser,s=>{h()}),w(()=>r.searchQuery,s=>{s||h()}),(s,a)=>(m(),S(I,null,[(m(!0),S(I,null,L(f.value,i=>(m(),Q(g(K),{key:i.id,document:i,"card-type":"signatures","card-context":"list","highlighted-doc-id":N.value,"document-store":g(n),"user-store":g(l),onRefresh:h,class:"mb-4"},null,8,["document","highlighted-doc-id","document-store","user-store"]))),128)),f.value.length===0&&!p.value?(m(),S("div",O,[W,o("h3",X,x(V.value),1),o("p",Y,x(q.value),1),o("div",Z,[o("div",ee,[M(x(r.state==="PendingSignatures"?"ðŸ“":"âœ…")+" ",1),o("strong",null,x(r.state==="PendingSignatures"?"Firmas pendientes":"Documentos firmados"),1)])])])):k("",!0),p.value?(m(),S("div",te,ne)):k("",!0),$(G,{isVisible:g(C),documentData:g(H),onClose:a[0]||(a[0]=i=>C.value=!1)},null,8,["isVisible","documentData"])],64))}},ke=J(oe,[["__scopeId","data-v-1b0481ad"]]);export{ke as default};
