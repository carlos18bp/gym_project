import{e as n,f as r,g as o,z as D,u as B,r as _,o as V,c as U,t as i,F as z,E,n as h,s as x,j as F,l as G,i as y,w,v as b}from"./index.js";import{u as M}from"./dynamicDocument.js";function N(k,d){return n(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"})])}const $={key:0,class:"pb-10 px-4 sm:px-6 lg:px-8 lg:pt-10"},j={class:"w-full p-5 rounded-lg border-2 border-stroke bg-terciary"},I={class:"text-primary text-xl font-semibold"},R={class:"mt-4 grid grid-cols-1 gap-6 sm:grid-cols-3"},S={class:"flex items-center gap-2"},Z=["for"],H={key:0,class:"relative group"},L={class:"absolute hidden group-hover:block top-2 left-4 transform translate-y-[-100%] px-3 py-2 text-sm text-white bg-gray-800 rounded-lg shadow-lg",style:{"white-space":"nowrap","z-index":"10"}},P=["onUpdate:modelValue","id"],T=["onUpdate:modelValue","id"],q={class:"mt-6 flex space-x-4"},A=["disabled"],J={key:1,class:"text-center text-gray-500"},K=o("p",null,"Cargando documento...",-1),O=[K],X={__name:"DocumentForm",setup(k){const d=D(),v=B(),l=M(),u=_(null),t=_(null),c=_(!1);V(async()=>{var s;const a=d.params.id;c.value=d.params.mode=="editor",u.value=await l.documentById(a),d.params.mode=="creator"&&(t.value={title:d.params.title,variables:u.value.variables,content:u.value.content,created_by:u.value.created_by,assigned_to:((s=l.currentUser)==null?void 0:s.id)||null}),d.params.mode=="editor"&&(t.value=u.value,t.value.title=d.params.title)});const g=U(()=>{var a;return(a=t.value)==null?void 0:a.variables.every(s=>s.value&&s.value.trim().length>0)}),f=async a=>{var s;try{t.value.state=a,t.value.assigned_to=(s=l.currentUser)==null?void 0:s.id,c.value?(t.value.variables=t.value.variables.map(e=>({id:e.id,name_en:e.name_en,name_es:e.name_es,field_type:e.field_type,value:e.value})),await l.updateDocument(t.value.id,t.value),await x(a==="Completed"?"Document successfully completed":"Document updated.","success")):(t.value.variables=t.value.variables.map(e=>({name_en:e.name_en,name_es:e.name_es,field_type:e.field_type,value:e.value})),await l.createDocument(t.value),await x(a==="Completed"?"Document successfully generated":"Document saved as draft","success")),v.push("/dynamic_document_dashboard")}catch(e){console.error("Error saving document:",e)}},C=()=>{v.push("/dynamic_document_dashboard")};return(a,s)=>t.value?(n(),r("div",$,[o("div",j,[o("div",null,[o("h1",I,i(t.value.title),1)]),o("div",R,[(n(!0),r(z,null,E(t.value.variables,(e,m)=>(n(),r("div",{key:m,class:h({"col-span-3":e.field_type==="text_area","col-span-1":e.field_type==="input"})},[o("div",S,[o("label",{for:"field-"+m,class:"text-base font-medium text-primary"},i(e.name_es||e.name_en),9,Z),e.tooltip?(n(),r("div",H,[F(G(N),{class:"size-5 text-gray-400 hover:text-secondary cursor-pointer"}),o("div",L,i(e.tooltip),1)])):y("",!0)]),e.field_type==="input"?w((n(),r("input",{key:0,type:"text","onUpdate:modelValue":p=>e.value=p,id:"field-"+m,class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm ring-1 ring-inset ring-gray-300"},null,8,P)),[[b,e.value]]):y("",!0),e.field_type==="text_area"?w((n(),r("textarea",{key:1,"onUpdate:modelValue":p=>e.value=p,id:"field-"+m,class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm ring-1 ring-inset ring-gray-300"},null,8,T)),[[b,e.value]]):y("",!0)],2))),128))]),o("div",q,[o("button",{type:"button",class:"p-2.5 text-sm font-medium rounded-md flex gap-2 bg-secondary text-white",onClick:s[0]||(s[0]=e=>f("Progress"))},i(c.value?"Guardar cambios como Borrador":"Guardar progreso"),1),o("button",{type:"button",class:h(["p-2.5 text-sm font-medium rounded-md flex gap-2",g.value?"bg-secondary text-white":"bg-gray-200 text-secondary border-2 border-dashed border-secondary cursor-not-allowed bg-opacity-50"]),disabled:!g.value,onClick:s[1]||(s[1]=e=>f("Completed"))},i(c.value?"Completar y Generar":"Generar"),11,A),o("button",{onClick:s[2]||(s[2]=e=>C()),type:"button",class:"p-2.5 text-sm font-medium rounded-md flex gap-2 bg-red-600/80 text-white cursor-pointer"}," Cancelar ")])])])):(n(),r("div",J,O))}};export{X as default};
