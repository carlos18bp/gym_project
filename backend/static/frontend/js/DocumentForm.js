import{e as r,f as n,g as s,z as D,u as B,r as _,o as V,c as U,t as c,F as z,E,n as h,s as x,j as F,l as G,i as y,w,v as b}from"./index.js";import{u as I}from"./dynamicDocument.js";function M(k,l){return r(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"})])}const N={key:0,class:"pb-10 px-4 sm:px-6 lg:px-8 lg:pt-10"},$={class:"w-full p-5 rounded-lg border-2 border-stroke bg-terciary"},j={class:"text-primary text-xl font-semibold"},R={class:"mt-4 grid grid-cols-1 gap-6 sm:grid-cols-3"},S={class:"flex items-center gap-2"},Z=["for"],H={key:0,class:"relative group"},L={class:"absolute hidden group-hover:block top-2 left-4 transform translate-y-[-100%] px-3 py-2 text-sm text-white bg-gray-800 rounded-lg shadow-lg",style:{"white-space":"nowrap","z-index":"10"}},P=["onUpdate:modelValue","id","placeholder"],T=["onUpdate:modelValue","id","placeholder"],q={class:"mt-6 flex space-x-4"},A=["disabled"],J={key:1,class:"text-center text-gray-500"},K=s("p",null,"Cargando documento...",-1),O=[K],X={__name:"DocumentForm",setup(k){const l=D(),v=B(),d=I(),u=_(null),t=_(null),i=_(!1);V(async()=>{var o;const a=l.params.id;i.value=l.params.mode=="editor",u.value=await d.documentById(a),l.params.mode=="creator"&&(t.value={title:l.params.title,variables:u.value.variables,content:u.value.content,created_by:u.value.created_by,assigned_to:((o=d.currentUser)==null?void 0:o.id)||null}),l.params.mode=="editor"&&(t.value=u.value,t.value.title=l.params.title)});const g=U(()=>{var a;return(a=t.value)==null?void 0:a.variables.every(o=>o.value&&o.value.trim().length>0)}),f=async a=>{var o;try{t.value.state=a,t.value.assigned_to=(o=d.currentUser)==null?void 0:o.id,i.value?(t.value.variables=t.value.variables.map(e=>({id:e.id,name_en:e.name_en,name_es:e.name_es,field_type:e.field_type,value:e.value})),await d.updateDocument(t.value.id,t.value),await x(a==="Completed"?"Document successfully completed":"Document updated.","success")):(t.value.variables=t.value.variables.map(e=>({name_en:e.name_en,name_es:e.name_es,field_type:e.field_type,value:e.value})),await d.createDocument(t.value),await x(a==="Completed"?"Document successfully generated":"Document saved as draft","success")),v.push("/dynamic_document_dashboard")}catch(e){console.error("Error saving document:",e)}},C=()=>{v.push("/dynamic_document_dashboard")};return(a,o)=>t.value?(r(),n("div",N,[s("div",$,[s("div",null,[s("h1",j,c(t.value.title),1)]),s("div",R,[(r(!0),n(z,null,E(t.value.variables,(e,m)=>(r(),n("div",{key:m,class:h({"col-span-3":e.field_type==="text_area","col-span-1":e.field_type==="input"})},[s("div",S,[s("label",{for:"field-"+m,class:"text-base font-medium text-primary"},c(e.name_es||e.name_en),9,Z),e.tooltip?(r(),n("div",H,[F(G(M),{class:"size-5 text-gray-400 hover:text-secondary cursor-pointer"}),s("div",L,c(e.tooltip),1)])):y("",!0)]),e.field_type==="input"?w((r(),n("input",{key:0,type:"text","onUpdate:modelValue":p=>e.value=p,id:"field-"+m,class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm ring-1 ring-inset ring-gray-300",placeholder:e.tooltip||"Ingrese un valor"},null,8,P)),[[b,e.value]]):y("",!0),e.field_type==="text_area"?w((r(),n("textarea",{key:1,"onUpdate:modelValue":p=>e.value=p,id:"field-"+m,class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm ring-1 ring-inset ring-gray-300",placeholder:e.tooltip||"Ingrese un texto largo"},null,8,T)),[[b,e.value]]):y("",!0)],2))),128))]),s("div",q,[s("button",{type:"button",class:"p-2.5 text-sm font-medium rounded-md flex gap-2 bg-secondary text-white",onClick:o[0]||(o[0]=e=>f("Progress"))},c(i.value?"Guardar cambios como Borrador":"Guardar progreso"),1),s("button",{type:"button",class:h(["p-2.5 text-sm font-medium rounded-md flex gap-2",g.value?"bg-secondary text-white":"bg-gray-200 text-secondary border-2 border-dashed border-secondary cursor-not-allowed bg-opacity-50"]),disabled:!g.value,onClick:o[1]||(o[1]=e=>f("Completed"))},c(i.value?"Completar y Generar":"Generar"),11,A),s("button",{onClick:o[2]||(o[2]=e=>C()),type:"button",class:"p-2.5 text-sm font-medium rounded-md flex gap-2 bg-red-600/80 text-white cursor-pointer"}," Cancelar ")])])])):(r(),n("div",J,O))}};export{X as default};
