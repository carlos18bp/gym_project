import{e as s,f as o,g as e,u as st,r as h,aL as is,o as He,at as yt,c as I,h as r,j as t,B as Te,w as Fe,v as Pe,n as j,l as f,t as m,m as pe,p as K,s as De,b6 as vs,i as T,ae as We,ac as ds,b7 as bs,U as vt,k as de,a5 as Ke,F as fe,D as Yt,E as cs,G as xs,a3 as _s,C as ws,W as ke,J as he,I as Xe,a4 as Ve,ai as Le,af as Ie,ag as Be,ah as xe,b8 as $s,Q as Dt,T as Ft,a8 as ks,aj as rt,aZ as Cs,ak as bt,an as Qt,ao as Ds,ap as Fs,H as Ss,b9 as wt,ba as Xt}from"./index-BWL8Y4C8.js";import{u as Ge,o as Es,s as ot,p as Wt}from"./index-B3uj7xYX.js";import{g as ft,a as ht}from"./DocumentPermissionsManager-DyE5pOdS.js";import{r as Ps,_ as Ht,a as St}from"./DocumentRelationshipsModal-Bl2SggzY.js";import{_ as Et}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{B as Ts,r as js,a as Pt,b as Tt,_ as Gt,c as Zt,D as us,d as Ms,L as jt,s as es}from"./index-CYkB1iZ0.js";import{r as kt}from"./FolderIcon-ymULWogX.js";import{r as Ze}from"./PlusIcon-B9TUYxiY.js";import{r as ct}from"./EllipsisVerticalIcon-ClEvr_61.js";import{r as nt}from"./DocumentIcon-B6a6hSZ_.js";import{_ as As}from"./DocumentCard-BoADMErz.js";import{r as ms}from"./EyeIcon-BjXYBs62.js";import{r as ut}from"./ChevronRightIcon-91CPyZ-h.js";import{_ as ts}from"./SignatureDocumentCard-BSsV09yj.js";import{r as qt,a as Ls,b as Is}from"./TagIcon--ZRGDfce.js";import{r as Qe}from"./ChevronDownIcon-CJY7G5V9.js";import{r as Je}from"./MagnifyingGlassIcon-BigcnpWN.js";import{r as Ct}from"./CheckCircleIcon-5KrPOvi5.js";import{r as ss}from"./PencilIcon-BFtYwlqE.js";import{r as Vt}from"./TrashIcon-DKnvP76G.js";import{a as gs,r as os}from"./LinkIcon-Bs7Xg6iM.js";import{r as ps}from"./PhotoIcon-seYPDBFV.js";import{r as at,a as Bs}from"./FunnelIcon-BLp5mB8s.js";import{r as Rs}from"./ArrowLeftIcon-BDmVvHPn.js";import{r as Mt}from"./CubeTransparentIcon-DBaoKOMz.js";import{r as as}from"./CloudArrowUpIcon-C8Wj7AzK.js";import{r as zs}from"./ExclamationTriangleIcon-B-2Z1d1e.js";import"./useRecentViews-CjQubHcR.js";import"./loading_message-CJtQO8sa.js";function rs(a,w){return s(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"})])}function Us(a,w){return s(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z"})])}function Ns(a,w){return s(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7.217 10.907a2.25 2.25 0 1 0 0 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186 9.566-5.314m-9.566 7.5 9.566 5.314m0 0a2.25 2.25 0 1 0 3.935 2.186 2.25 2.25 0 0 0-3.935-2.186Zm0-12.814a2.25 2.25 0 1 0 3.933-2.185 2.25 2.25 0 0 0-3.933 2.185Z"})])}function Os(a,w){return s(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}const qs={class:"bg-white rounded-lg p-6 shadow-xl max-w-lg w-full"},Vs={class:"flex justify-end"},Qs=e("label",{for:"document-name",class:"block text-base font-medium leading-6 text-primary"},[K(" Nombre "),e("span",{class:"text-red-500"},"*")],-1),Ws={class:"mt-2"},Hs={class:"flex gap-2 mt-2.5"},Gs=["disabled"],Zs=e("span",null,"Actualizar nombre",-1),Js=[Zs],Ks=["disabled"],fs={__name:"UseDocumentByClient",props:{documentId:{type:[Number,null],required:!1,default:null}},emits:["close"],setup(a,{emit:w}){const i=a,c=st(),D=Ge(),v=w,y=h(""),M=h(""),p=()=>{v("close")};is(()=>{var B,k;D.selectedDocument?(y.value=((B=D.selectedDocument)==null?void 0:B.title)||"",M.value=((k=D.selectedDocument)==null?void 0:k.title)||""):(y.value="",M.value="")});const L=B=>{B.key==="Escape"&&p()};He(()=>{document.addEventListener("keydown",L)}),yt(()=>{document.removeEventListener("keydown",L)});const J=I(()=>y.value.trim().length>0),ee=I(()=>{var B;return!!((B=D.selectedDocument)!=null&&B.id)}),G=I(()=>ee.value&&y.value.trim()!==M.value.trim()&&y.value.trim().length>0);async function U(){if(ee.value&&G.value)try{const B={title:y.value.trim()};await D.updateDocument(D.selectedDocument.id,B),M.value=y.value.trim(),D.selectedDocument.title=y.value.trim();const k=D.selectedDocument.id;De("Document name successfully updated.","success"),v("close",{updatedDocId:k});const S=window.location.pathname;S==="/dynamic_document_dashboard"||S==="/dynamic_document_dashboard/"||setTimeout(()=>{window.location.href="/dynamic_document_dashboard"},1e3)}catch(B){console.error("Error updating document name:",B),De("Error updating document name.","error")}}function re(){const B=encodeURIComponent(y.value.trim());i.documentId&&!D.selectedDocument?c.push(`/dynamic_document_dashboard/document/use/creator/${i.documentId}/${B}`):D.selectedDocument?(D.selectedDocument.title=y.value.trim(),c.push(`/dynamic_document_dashboard/document/use/editor/${D.selectedDocument.id}/${B}`)):De("Error: No se pudo continuar. Documento no seleccionado.","error")}return(B,k)=>(s(),o("div",qs,[e("div",Vs,[e("button",{onClick:p},[r(t(Te),{class:"size-6"})])]),e("form",{onSubmit:pe(re,["prevent"])},[e("div",null,[Qs,e("div",Ws,[Fe(e("input",{"onUpdate:modelValue":k[0]||(k[0]=d=>y.value=d),type:"text",id:"document-name",class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm ring-1 ring-inset ring-gray-300",required:""},null,512),[[Pe,y.value]])])]),e("div",Hs,[ee.value?(s(),o("button",{key:0,type:"button",onClick:U,disabled:!G.value,class:j(["p-2.5 text-sm font-medium rounded-md flex gap-2",G.value?"bg-primary text-white cursor-pointer":"bg-gray-200 text-gray-400 cursor-not-allowed opacity-70"])},Js,10,Gs)):f("",!0),e("button",{type:"submit",class:j(["p-2.5 text-sm font-medium rounded-md flex gap-2",J.value?"bg-secondary text-white":"bg-gray-200 text-secondary border-2 border-dashed border-secondary cursor-not-allowed bg-opacity-50"]),disabled:!J.value},[e("span",null,m(ee.value?"Editar Documento":"Continuar"),1)],10,Ks)])],32)]))}},Ys={class:"mt-3 pt-2 border-t border-gray-100"},Xs={class:"flex items-center gap-2 text-xs text-gray-500"},eo=e("span",null,"Hacer clic para usar este documento",-1),to={__name:"UseDocumentCard",props:{document:{type:Object,required:!0},showTags:{type:Boolean,default:!0},cardType:{type:String,default:"default"},cardContext:{type:String,default:"list"},documentStore:{type:Object,default:null},userStore:{type:Object,default:null},menuOptions:{type:Array,default:null},disableInternalActions:{type:Boolean,default:!1},showMenuOptions:{type:Boolean,default:null},additionalClasses:{type:String,default:""}},emits:["click","remove-from-folder","document-created"],setup(a,{emit:w}){const i=a,c=w,D=h(!1),v=h(null),y=ft(9),M=I(()=>"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium !bg-purple-100 !text-purple-700 !border !border-purple-200"),p=I(()=>y.dark),L=I(()=>{const k="group !border-purple-400 !bg-purple-50/50 !shadow-purple-100";return i.additionalClasses?`${k} ${i.additionalClasses}`:k}),J=I(()=>i.menuOptions!==null?i.menuOptions:[{label:"Usar",action:"use",icon:Us,iconClasses:"w-4 h-4 text-purple-600"},{label:"Previsualización",action:"preview",icon:ms,iconClasses:"w-4 h-4 text-gray-600"}]),ee=I(()=>!1),G=(k,d)=>{i.disableInternalActions?c("click",k,d):re(k.id)},U=(k,d)=>{switch(k){case"use":re(d.id);break;case"preview":Es(d);break;default:console.warn("Unknown menu action:",k)}};function re(k){k?(v.value=k,D.value=!0):console.error("Document ID is required:",k)}function B(k){if(D.value=!1,v.value=null,k&&k.updatedDocId){c("document-created",k);const d=window.location.pathname;d==="/dynamic_document_dashboard"||d==="/dynamic_document_dashboard/"?setTimeout(()=>{window.forceDocumentHighlight&&window.forceDocumentHighlight(k.updatedDocId)},100):setTimeout(()=>{window.location.href="/dynamic_document_dashboard"},500)}}return(k,d)=>(s(),o(fe,null,[r(Ts,{document:a.document,"card-type":a.cardType,"card-context":a.cardContext,"status-icon":t(bs),"status-text":"Disponible","status-badge-classes":M.value,"menu-options":J.value,"highlighted-doc-id":null,"show-tags":a.showTags,"document-store":a.documentStore,"user-store":a.userStore,"additional-classes":L.value,"disable-internal-actions":a.disableInternalActions,"show-menu-options":a.showMenuOptions,onClick:G,onMenuAction:U,onRemoveFromFolder:d[0]||(d[0]=S=>k.$emit("remove-from-folder",S))},vs({"additional-actions":T(()=>[ds(k.$slots,"additional-actions")]),_:2},[ee.value?{name:"right-action",fn:T(()=>[r(t(ut),{class:"w-5 h-5 text-gray-400 group-hover:text-gray-600 transition-colors"})]),key:"0"}:void 0,a.disableInternalActions?void 0:{name:"footer",fn:T(()=>[e("div",Ys,[e("div",Xs,[e("div",{class:"w-2 h-2 rounded-full",style:We({backgroundColor:p.value})},null,4),eo])])]),key:"1"}]),1032,["document","card-type","card-context","status-icon","status-badge-classes","menu-options","show-tags","document-store","user-store","additional-classes","disable-internal-actions","show-menu-options"]),Fe(r(Ke,null,{default:T(()=>[v.value!==null?(s(),de(fs,{key:0,"document-id":v.value,onClose:B},null,8,["document-id"])):f("",!0)]),_:1},512),[[vt,D.value]])],64))}},so=()=>({folders:[],currentFolder:null,isLoading:!1,error:null,lastUpdatedFolderId:null}),oo={sortedFolders:a=>[...a.folders].sort((w,i)=>new Date(i.created_at)-new Date(w.created_at)),getFolderById:a=>w=>a.folders.find(i=>i.id===w),getFoldersByColor:a=>w=>a.folders.filter(i=>i.color_id===w),getFolderWithColor:a=>w=>{const i=a.folders.find(c=>c.id===w);return i?{...i,color:ft(i.color_id)}:null},getFoldersContainingDocument:a=>w=>a.folders.filter(i=>i.document_ids&&i.document_ids.includes(w)),totalDocumentsInFolders:a=>a.folders.reduce((w,i)=>w+(i.document_ids?i.document_ids.length:0),0),hasFolders:a=>a.folders.length>0,availableColors:()=>ht()},ao={async init(a=!1){if(!(this.folders.length>0&&!a)){this.isLoading=!0,this.error=null;try{await this.fetchFolders()}catch(w){console.error("Error initializing document folder store:",w),this.error="Error al inicializar las carpetas"}finally{this.isLoading=!1}}},async fetchFolders(){try{const a=await Yt("dynamic-documents/folders/");if(a.status===200)return this.folders=a.data,a.data;throw new Error(`Error fetching folders: ${a.status}`)}catch(a){throw console.error("Error fetching folders:",a),this.error="Error al obtener las carpetas",a}},async fetchFolder(a){this.isLoading=!0,this.error=null;try{const w=await Yt(`dynamic-documents/folders/${a}/`);if(w.status===200){const i=w.data,c=this.folders.findIndex(D=>D.id===i.id);return c!==-1?this.folders[c]=i:this.folders.push(i),this.currentFolder=i,i}else throw new Error(`Error fetching folder: ${w.status}`)}catch(w){throw console.error("Error fetching folder:",w),this.error="Error al obtener la carpeta",w}finally{this.isLoading=!1}},async createFolder(a){this.isLoading=!0,this.error=null;try{if(!a.name||a.name.trim()==="")throw new Error("El nombre de la carpeta es requerido");const w=a.color_id??0;if(w<0||w>=ht().length)throw new Error("Color de carpeta no válido");const i={name:a.name.trim(),color_id:w,...a.document_ids&&{document_ids:a.document_ids}},c=await cs("dynamic-documents/folders/create/",i);if(c.status===200||c.status===201){const D=c.data;return this.folders.push(D),this.lastUpdatedFolderId=D.id,De("Carpeta creada exitosamente","success"),D}else throw new Error(`Error creating folder: ${c.status}`)}catch(w){throw console.error("Error creating folder:",w),this.error=w.message||"Error al crear la carpeta",De(this.error,"error"),w}finally{this.isLoading=!1}},async updateFolder(a,w){this.isLoading=!0,this.error=null;try{if(w.name&&w.name.trim()==="")throw new Error("El nombre de la carpeta no puede estar vacío");if(w.color_id!==void 0){const D=w.color_id;if(D<0||D>=ht().length)throw new Error("Color de carpeta no válido")}const i={};w.name&&(i.name=w.name.trim()),w.color_id!==void 0&&(i.color_id=w.color_id),w.document_ids!==void 0&&(i.document_ids=w.document_ids);const c=await xs(`dynamic-documents/folders/${a}/update/`,i);if(c.status===200){const D=c.data,v=this.folders.findIndex(y=>y.id===a);return v!==-1&&(this.folders[v]=D),this.currentFolder&&this.currentFolder.id===a&&(this.currentFolder=D),this.lastUpdatedFolderId=a,De("Carpeta actualizada exitosamente","success"),D}else throw new Error(`Error updating folder: ${c.status}`)}catch(i){throw console.error("Error updating folder:",i),this.error=i.message||"Error al actualizar la carpeta",De(this.error,"error"),i}finally{this.isLoading=!1}},async deleteFolder(a){this.isLoading=!0,this.error=null;try{const w=await _s(`dynamic-documents/folders/${a}/delete/`);if(w.status===204||w.status===200)return this.folders=this.folders.filter(i=>i.id!==a),this.currentFolder&&this.currentFolder.id===a&&(this.currentFolder=null),await De("Carpeta eliminada exitosamente","success"),!0;throw new Error(`Error deleting folder: ${w.status}`)}catch(w){throw console.error("Error deleting folder:",w),this.error=w.message||"Error al eliminar la carpeta",await De(this.error,"error"),w}finally{this.isLoading=!1}},setCurrentFolder(a){this.currentFolder=a},clearCurrentFolder(){this.currentFolder=null},reset(){this.folders=[],this.currentFolder=null,this.isLoading=!1,this.error=null,this.lastUpdatedFolderId=null}},ro={async addDocumentsToFolder(a,w){const i=this.getFolderById(a);if(!i)throw new Error("Carpeta no encontrada");const c=i.document_ids||[],D=[...new Set([...c,...w])];return await this.updateFolder(a,{document_ids:D})},async removeDocumentsFromFolder(a,w){const i=this.getFolderById(a);if(!i)throw new Error("Carpeta no encontrada");const D=(i.document_ids||[]).filter(v=>!w.includes(v));return await this.updateFolder(a,{document_ids:D})},async moveDocumentsBetweenFolders(a,w,i){try{w&&await this.removeDocumentsFromFolder(w,a),i&&await this.addDocumentsToFolder(i,a),await De("Documentos movidos exitosamente","success")}catch(c){throw console.error("Error moving documents between folders:",c),await De("Error al mover documentos","error"),c}},getFolderColor(a){const w=this.getFolderById(a);return w?ft(w.color_id):ft(0)},validateFolderData(a){const w=[];if((!a.name||a.name.trim()==="")&&w.push("El nombre de la carpeta es requerido"),a.name&&a.name.length>100&&w.push("El nombre de la carpeta no puede exceder 100 caracteres"),a.color_id!==void 0){const i=a.color_id;(i<0||i>=ht().length)&&w.push("Color de carpeta no válido")}return a.document_ids&&!Array.isArray(a.document_ids)&&w.push("Los IDs de documentos deben ser un array"),{isValid:w.length===0,errors:w}}},Jt=ws("documentFolder",{state:so,getters:oo,actions:{...ao,...ro}}),no={class:"bg-white rounded-xl shadow-xl max-w-md w-full"},lo={class:"flex justify-between items-center p-6 border-b"},io={class:"text-lg font-semibold text-gray-900"},co={class:"mb-4"},uo=e("label",{for:"folderName",class:"block text-sm font-medium text-gray-700 mb-2"}," Nombre de la carpeta ",-1),mo={class:"mb-6"},go=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"}," Color de la carpeta ",-1),po={class:"grid grid-cols-8 gap-2"},fo=["onClick","title"],ho={class:"flex gap-3"},yo=["disabled"],vo={__name:"CreateEditFolderModal",props:{isVisible:{type:Boolean,required:!0},editingFolder:{type:Object,default:null}},emits:["close","success"],setup(a,{emit:w}){const i=a,c=w,D=Jt(),v=h(!1),y=h({name:"",color_id:0}),M=I(()=>ht()),p=()=>{y.value={name:"",color_id:0}};ke(()=>i.editingFolder,ee=>{ee?y.value={name:ee.name,color_id:ee.color_id}:p()},{immediate:!0}),ke(()=>i.isVisible,ee=>{ee||p()});const L=()=>{c("close")},J=async()=>{if(y.value.name.trim()){v.value=!0;try{i.editingFolder?await D.updateFolder(i.editingFolder.id,y.value):await D.createFolder(y.value),v.value=!1,c("success")}catch{v.value=!1}}};return(ee,G)=>a.isVisible?(s(),de(Ke,{key:0},{default:T(()=>[e("div",{class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:pe(L,["self"])},[e("div",no,[e("div",lo,[e("h3",io,m(a.editingFolder?"Editar Carpeta":"Nueva Carpeta"),1),e("button",{onClick:L,class:"text-gray-400 hover:text-gray-500"},[r(t(Te),{class:"w-6 h-6"})])]),e("form",{onSubmit:pe(J,["prevent"]),class:"p-6"},[e("div",co,[uo,Fe(e("input",{id:"folderName","onUpdate:modelValue":G[0]||(G[0]=U=>y.value.name=U),type:"text",required:"",maxlength:"100",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Ej: Contratos Laborales"},null,512),[[Pe,y.value.name]])]),e("div",mo,[go,e("div",po,[(s(!0),o(fe,null,he(M.value,U=>(s(),o("button",{key:U.id,type:"button",onClick:re=>y.value.color_id=U.id,class:j(["w-8 h-8 rounded-full border-2 transition-all",y.value.color_id===U.id?"border-gray-800 scale-110":"border-gray-300 hover:border-gray-400"]),style:We({backgroundColor:U.hex}),title:U.name},null,14,fo))),128))])]),e("div",ho,[e("button",{type:"button",onClick:L,class:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"}," Cancelar "),e("button",{type:"submit",disabled:!y.value.name.trim()||v.value,class:"flex-1 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},m(v.value?"Guardando...":a.editingFolder?"Actualizar":"Crear"),9,yo)])],32)])])]),_:1})):f("",!0)}},bo={class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},xo={class:"bg-white rounded-xl shadow-xl max-w-6xl w-full max-h-[90vh] overflow-hidden flex flex-col"},_o={class:"border-b px-6 py-4 flex-shrink-0"},wo={class:"flex justify-between items-center"},$o={class:"flex items-center gap-3"},ko={class:"text-xl font-semibold text-gray-900"},Co={class:"text-sm text-gray-600"},Do={class:"flex items-center gap-2"},Fo={class:"flex-1 overflow-y-auto p-6"},So={key:0,class:"bg-white rounded-lg shadow-sm border border-gray-200"},Eo={class:"min-w-full divide-y divide-gray-200"},Po=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Documento "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Tipo "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etiquetas "),e("th",{scope:"col",class:"w-16 px-6 py-3"})])],-1),To={class:"bg-white divide-y divide-gray-200"},jo=["onClick"],Mo={class:"px-6 py-4 whitespace-nowrap"},Ao={class:"flex items-center"},Lo={class:"flex-shrink-0 h-10 w-10"},Io={class:"h-10 w-10 rounded-lg bg-blue-100 flex items-center justify-center"},Bo={class:"ml-4"},Ro={class:"text-sm font-medium text-gray-900"},zo={class:"px-6 py-4 whitespace-nowrap"},Uo={class:"text-sm text-gray-600"},No={class:"px-6 py-4 whitespace-nowrap"},Oo={class:"px-6 py-4 whitespace-nowrap"},qo={class:"flex flex-wrap gap-1"},Vo={key:0,class:"px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-600"},Qo={key:1,class:"text-sm text-gray-400"},Wo={class:"py-1"},Ho=["onClick"],Go=["onClick"],Zo={key:1,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center"},Jo=e("h4",{class:"text-lg font-medium text-gray-900 mb-2"},"Esta carpeta está vacía",-1),Ko=e("p",{class:"text-gray-600 mb-4"},"Agrega documentos para organizar tu trabajo",-1),Yo={__name:"FolderDetailsModalTable",props:{folder:{type:Object,default:null}},emits:["close","add-documents","remove-document","view-document","use-document","document-action"],setup(a,{emit:w}){const i=a,c=w;Xe(),Ge();const D=h({}),v=h({}),y=h(!1),M=h(-1),p=[{name:"blue",hex:"#3B82F6"},{name:"purple",hex:"#8B5CF6"},{name:"pink",hex:"#EC4899"},{name:"green",hex:"#10B981"},{name:"yellow",hex:"#F59E0B"},{name:"red",hex:"#EF4444"},{name:"indigo",hex:"#6366F1"},{name:"teal",hex:"#14B8A6"}],L=I(()=>{if(!i.folder)return p[0];if(i.folder.color)return p.find(z=>z.name===i.folder.color)||p[0];const x=i.folder.id%p.length;return p[x]}),J=x=>x.state==="Published"||x.state==="Draft"?"Formato":x.state==="PendingSignatures"||x.state==="FullySigned"?"Para Firmar":x.state==="Progress"||x.state==="Completed"?"Mis Documentos":"Documento",ee=x=>({Published:"Publicado",Draft:"Borrador",Progress:"En Progreso",Completed:"Completado",PendingSignatures:"Pendiente Firma",FullySigned:"Firmado"})[x.state]||x.state,G=x=>({Published:"bg-green-100 text-green-700 border border-green-200",Draft:"bg-gray-100 text-gray-700 border border-gray-200",Progress:"bg-blue-100 text-blue-700 border border-blue-200",Completed:"bg-green-100 text-green-700 border border-green-200",PendingSignatures:"bg-yellow-100 text-yellow-700 border border-yellow-200",FullySigned:"bg-green-100 text-green-700 border border-green-200"})[x.state]||"bg-gray-100 text-gray-700 border border-gray-200",U=x=>{const z=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],Y=x.id%z.length;return z[Y]},re=()=>{c("close")},B=()=>{c("add-documents",i.folder)},k=x=>{c("remove-document",{folderId:i.folder.id,documentId:x.id})},d=x=>{const z=J(x);c(z==="Formato"?"use-document":"view-document",x)},S=()=>!y.value||!i.folder?"auto":i.folder.documents.length===1?"280px":i.folder.documents.length===2&&M.value===1?"340px":"280px",E=(x,z)=>{x&&(D.value[z]=x)},te=(x,z)=>{x&&(v.value[z]=x)},R=(x,z)=>{y.value=!z,M.value=z?-1:x,z||setTimeout(()=>{const Y=v.value[x];if(Y){const ue=Y.$el||Y;if(ue&&ue.getBoundingClientRect){const le=ue.getBoundingClientRect(),oe=window.innerHeight;if(x===0){if(le.bottom>oe-20){const C=le.bottom-oe+40;window.scrollBy({top:C,behavior:"smooth"})}}else if(le.bottom>oe-10){const C=le.bottom-oe+30;window.scrollBy({top:C,behavior:"smooth"})}else if(le.top<80){const C=le.top-100;window.scrollBy({top:C,behavior:"smooth"})}}}},100)};return(x,z)=>a.folder?(s(),de(Ke,{key:0},{default:T(()=>[e("div",bo,[e("div",xo,[e("div",_o,[e("div",wo,[e("div",$o,[e("div",{class:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",style:We({backgroundColor:L.value.hex+"20"})},[r(t(kt),{class:"h-6 w-6",style:We({color:L.value.hex})},null,8,["style"])],4),e("div",null,[e("h3",ko,m(a.folder.name),1),e("p",Co,m(a.folder.documents.length)+" documento"+m(a.folder.documents.length!==1?"s":""),1)])]),e("div",Do,[e("button",{onClick:B,class:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-blue-600 hover:bg-blue-50 rounded-lg transition-colors"},[r(t(Ze),{class:"w-5 h-5"}),K(" Agregar documentos ")]),e("button",{onClick:re,class:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors"},[r(t(Te),{class:"w-6 h-6"})])])])]),e("div",Fo,[a.folder.documents.length>0?(s(),o("div",So,[e("div",{class:"overflow-x-auto",style:We({minHeight:S()})},[e("table",Eo,[Po,e("tbody",To,[(s(!0),o(fe,null,he(a.folder.documents,(Y,ue)=>{var le;return s(),o("tr",{key:Y.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:oe=>d(Y)},[e("td",Mo,[e("div",Ao,[e("div",Lo,[e("div",Io,[r(t(Ve),{class:"h-5 w-5 text-blue-600"})])]),e("div",Bo,[e("div",Ro,m(Y.title),1)])])]),e("td",zo,[e("span",Uo,m(J(Y)),1)]),e("td",No,[e("span",{class:j(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",G(Y)])},m(ee(Y)),3)]),e("td",Oo,[e("div",qo,[(s(!0),o(fe,null,he((le=Y.tags)==null?void 0:le.slice(0,2),oe=>(s(),o("span",{key:oe.id,class:j(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",U(oe)])},m(oe.name),3))),128)),Y.tags&&Y.tags.length>2?(s(),o("span",Vo," +"+m(Y.tags.length-2),1)):f("",!0),!Y.tags||Y.tags.length===0?(s(),o("span",Qo,"-")):f("",!0)])]),e("td",{class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",onClick:z[0]||(z[0]=pe(()=>{},["stop"]))},[r(t(Le),{as:"div",class:"relative inline-block text-left"},{default:T(({open:oe})=>[r(t(Ie),{ref_for:!0,ref:C=>E(C,ue),onClick:C=>R(ue,oe),class:"inline-flex items-center justify-center w-8 h-8 rounded-md hover:bg-gray-100"},{default:T(()=>[r(t(ct),{class:"h-5 w-5 text-gray-500"})]),_:2},1032,["onClick"]),r(t(Be),{ref_for:!0,ref:C=>te(C,ue),class:j([a.folder.documents.length>2&&ue>0&&ue>=a.folder.documents.length-3?"absolute right-0 z-[9999] bottom-full mb-2 w-48 origin-bottom-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none":"absolute right-0 z-[9999] mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"])},{default:T(()=>[e("div",Wo,[r(t(xe),null,{default:T(({active:C})=>[e("a",{onClick:se=>d(Y),class:j([C?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Ver documento ",10,Ho)]),_:2},1024),r(t(xe),null,{default:T(({active:C})=>[e("a",{onClick:se=>k(Y),class:j([C?"bg-gray-100":"","block px-4 py-2 text-sm text-red-600 cursor-pointer"])}," Quitar de carpeta ",10,Go)]),_:2},1024)])]),_:2},1032,["class"])]),_:2},1024)])],8,jo)}),128))])])],4)])):(s(),o("div",Zo,[r(t(nt),{class:"w-12 h-12 text-gray-300 mx-auto mb-4"}),Jo,Ko,e("button",{onClick:B,class:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"},[r(t(Ze),{class:"w-5 h-5"}),K(" Agregar documentos ")])]))])])])]),_:1})):f("",!0)}},xt=a=>(Dt("data-v-d403a707"),a=a(),Ft(),a),Xo={class:"tag-filter-container"},ea={class:"relative"},ta={class:"flex items-center"},sa={key:0,class:"ml-2 inline-flex items-center justify-center h-5 w-5 bg-primary text-white text-xs rounded-full font-medium"},oa={key:0,class:"absolute left-0 mt-2 w-full sm:w-80 bg-white rounded-xl shadow-xl ring-1 ring-black ring-opacity-5 border border-gray-100 z-50 overflow-hidden"},aa={class:"bg-gray-50 p-4 border-b border-gray-200"},ra={class:"flex items-center justify-between mb-3"},na=xt(()=>e("h3",{class:"text-sm font-semibold text-gray-900"},"Filtrar por etiquetas",-1)),la={key:0,class:"text-xs text-gray-500"},ia={class:"relative"},da={key:0,class:"px-4 py-2 bg-blue-50 border-b border-blue-100"},ca={class:"flex items-center justify-between"},ua={class:"text-xs font-medium text-blue-700"},ma={class:"max-h-52 overflow-y-auto"},ga={key:0,class:"px-4 py-8 text-center"},pa=xt(()=>e("p",{class:"text-gray-500 text-sm"},"No hay etiquetas disponibles",-1)),fa={key:1,class:"px-4 py-8 text-center"},ha={class:"text-gray-500 text-sm"},ya={key:2,class:"px-4 py-8 text-center"},va=xt(()=>e("div",{class:"flex items-center justify-center"},[e("div",{class:"animate-spin rounded-full h-5 w-5 border-2 border-primary border-t-transparent"}),e("span",{class:"ml-3 text-sm text-gray-600"},"Cargando etiquetas...")],-1)),ba=[va],xa={key:3,class:"py-2"},_a=["onClick"],wa={class:"flex items-center h-5"},$a={class:"relative"},ka=["id","checked","onChange"],Ca={key:0,class:"w-2.5 h-2.5 text-white",fill:"currentColor",viewBox:"0 0 20 20"},Da=xt(()=>e("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"},null,-1)),Fa=[Da],Sa={class:"ml-3 flex items-center flex-1 min-w-0"},Ea={class:"text-sm font-medium text-gray-900 truncate"},Pa={key:0,class:"mt-4"},Ta={class:"flex items-start gap-2"},ja=xt(()=>e("span",{class:"text-xs font-medium text-gray-500 mt-1.5 flex-shrink-0"},"Activos:",-1)),Ma={class:"flex flex-wrap gap-2"},Aa=["onClick"],La={class:"mr-1"},Ia={class:"ml-1 p-0.5 rounded-full hover:bg-white/50 transition-colors duration-150"},Ba={__name:"TagFilter",props:{modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue"],setup(a,{emit:w}){const i=a,c=w,D=Ge(),v=h(!1),y=h([]),M=h(!1),p=h(""),L=I(()=>D.sortedTags),J=I(()=>{if(!p.value.trim())return L.value;const d=p.value.toLowerCase().trim();return L.value.filter(S=>S.name.toLowerCase().includes(d))}),ee=d=>{const S=ft(d.color_id);return{hex:S&&S.hex?S.hex:"#9CA3AF",dark:S&&S.dark?S.dark:"#374151"}},G=()=>{v.value=!v.value,v.value&&(p.value="")},U=d=>y.value.some(S=>S.id===d.id),re=d=>{const S=y.value.findIndex(E=>E.id===d.id);S>=0?y.value.splice(S,1):y.value.push(d),c("update:modelValue",y.value)},B=()=>{y.value=[],c("update:modelValue",[])},k=d=>{d.target.closest(".tag-filter-container")||(v.value=!1,p.value="")};return He(async()=>{try{M.value=!0,await D.initTags()}catch(d){console.error("Error loading tags:",d)}finally{M.value=!1}document.addEventListener("click",k)}),ke(()=>i.modelValue,d=>{y.value=d||[]},{immediate:!0}),yt(()=>{document.removeEventListener("click",k)}),(d,S)=>(s(),o("div",Xo,[e("div",ea,[e("button",{onClick:G,class:j(["group inline-flex items-center justify-between w-full sm:w-auto sm:min-w-[200px] px-4 py-3 border border-gray-200 rounded-xl shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 hover:border-gray-300 focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-primary transition-all duration-200",{"ring-2 ring-primary border-primary bg-blue-50":v.value,"border-primary bg-primary/5":y.value.length>0&&!v.value}])},[e("div",ta,[r(t(qt),{class:j(["h-5 w-5 mr-2.5 text-gray-500 group-hover:text-gray-600",{"text-primary":y.value.length>0||v.value}])},null,8,["class"]),e("span",{class:j(["text-gray-700",{"text-primary font-semibold":y.value.length>0||v.value}])}," Filtrar por etiquetas ",2),y.value.length>0?(s(),o("span",sa,m(y.value.length),1)):f("",!0)]),r(t(Qe),{class:j(["ml-3 h-4 w-4 text-gray-400 transition-all duration-200 group-hover:text-gray-600",{"rotate-180 text-primary":v.value,"text-primary":y.value.length>0&&!v.value}])},null,8,["class"])],2),r($s,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:T(()=>[v.value?(s(),o("div",oa,[e("div",aa,[e("div",ra,[na,L.value.length>0?(s(),o("span",la,m(L.value.length)+" disponibles ",1)):f("",!0)]),e("div",ia,[r(t(Je),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),Fe(e("input",{"onUpdate:modelValue":S[0]||(S[0]=E=>p.value=E),type:"text",placeholder:"Buscar etiquetas...",class:"w-full pl-9 pr-4 py-2.5 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-200"},null,512),[[Pe,p.value]])])]),y.value.length>0?(s(),o("div",da,[e("div",ca,[e("span",ua,m(y.value.length)+" etiqueta"+m(y.value.length!==1?"s":"")+" seleccionada"+m(y.value.length!==1?"s":""),1),e("button",{onClick:B,class:"text-xs text-red-600 hover:text-red-700 font-medium px-2 py-1 rounded-md hover:bg-red-50 transition-all duration-200"}," Limpiar todo ")])])):f("",!0),e("div",ma,[!M.value&&J.value.length===0&&p.value.trim()===""?(s(),o("div",ga,[r(t(qt),{class:"h-8 w-8 text-gray-300 mx-auto mb-2"}),pa])):f("",!0),!M.value&&J.value.length===0&&p.value.trim()!==""?(s(),o("div",fa,[r(t(Je),{class:"h-8 w-8 text-gray-300 mx-auto mb-2"}),e("p",ha,'Sin resultados para "'+m(p.value)+'"',1),e("button",{onClick:S[1]||(S[1]=E=>p.value=""),class:"text-xs text-primary hover:text-primary-dark mt-2 font-medium"}," Ver todas las etiquetas ")])):f("",!0),M.value?(s(),o("div",ya,ba)):f("",!0),!M.value&&J.value.length>0?(s(),o("div",xa,[(s(!0),o(fe,null,he(J.value,E=>(s(),o("div",{key:E.id,class:"group flex items-center px-4 py-2.5 hover:bg-gray-50 cursor-pointer transition-colors duration-150",onClick:te=>re(E)},[e("div",wa,[e("div",$a,[e("input",{id:`tag-${E.id}`,type:"checkbox",checked:U(E),onChange:te=>re(E),class:"sr-only"},null,40,ka),e("div",{class:j(["w-4 h-4 border-2 rounded transition-all duration-200 flex items-center justify-center",U(E)?"bg-primary border-primary":"border-gray-300 group-hover:border-gray-400"])},[U(E)?(s(),o("svg",Ca,Fa)):f("",!0)],2)])]),e("div",Sa,[e("div",{class:"w-3 h-3 rounded-full mr-2.5 border flex-shrink-0 shadow-sm",style:We({backgroundColor:ee(E).hex})},null,4),e("span",Ea,m(E.name),1)])],8,_a))),128))])):f("",!0)])])):f("",!0)]),_:1})]),y.value.length>0?(s(),o("div",Pa,[e("div",Ta,[ja,e("div",Ma,[(s(!0),o(fe,null,he(y.value,E=>(s(),o("div",{key:E.id,class:"group inline-flex items-center pl-2.5 pr-1.5 py-1.5 rounded-lg text-xs font-medium border shadow-sm cursor-pointer transition-all duration-200 hover:shadow-md",style:We({backgroundColor:ee(E).hex+"20",borderColor:ee(E).hex+"40",color:ee(E).dark}),onClick:te=>re(E)},[e("div",{class:"w-2 h-2 rounded-full mr-2 flex-shrink-0",style:We({backgroundColor:ee(E).hex})},null,4),e("span",La,m(E.name),1),e("div",Ia,[r(t(Te),{class:"h-3 w-3 opacity-60 group-hover:opacity-100"})])],12,Aa))),128))])])])):f("",!0)]))}},Ra=Et(Ba,[["__scopeId","data-v-d403a707"]]),za={class:"bg-white rounded-xl shadow-xl max-w-5xl w-full max-h-[90vh] overflow-hidden"},Ua={class:"border-b"},Na={class:"hidden sm:flex justify-between items-center p-6"},Oa=e("h3",{class:"text-lg font-semibold text-gray-900"},"Agregar Documentos",-1),qa={class:"text-sm text-gray-600"},Va={class:"sm:hidden p-4"},Qa={class:"flex justify-between items-start mb-2"},Wa={class:"flex-1 min-w-0 mr-3"},Ha=e("h3",{class:"text-lg font-semibold text-gray-900"},"Agregar Documentos",-1),Ga={class:"text-sm text-gray-600 truncate"},Za={class:"border-b"},Ja={class:"hidden sm:flex space-x-8 px-6","aria-label":"Tabs"},Ka=["onClick"],Ya={class:"ml-2 bg-gray-100 text-gray-600 py-0.5 px-2 rounded-full text-xs"},Xa={class:"sm:hidden relative px-4 py-3"},er={class:"flex items-center"},tr={class:"ml-2 bg-gray-100 text-gray-600 py-0.5 px-2 rounded-full text-xs"},sr=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1),or=[sr],ar={class:"absolute top-full left-4 right-4 z-50 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg overflow-hidden"},rr=["onClick"],nr={class:"border-b bg-gray-50 p-4 sm:p-6"},lr={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},ir={class:"flex-1"},dr={key:0,class:"flex items-center gap-3"},cr={class:"text-sm text-gray-600"},ur={class:"p-4 sm:p-6 overflow-y-auto max-h-[calc(90vh-350px)]"},mr={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4"},gr=["onClick"],pr=e("span",null,"Etiquetas",-1),fr=[pr],hr={key:5,class:"absolute top-2 left-2 w-6 h-6 bg-primary text-white rounded-full flex items-center justify-center shadow-sm"},yr={key:0,class:"flex items-center justify-between mt-4 pt-3 border-t border-gray-200"},vr={class:"text-sm text-gray-700"},br={class:"font-medium"},xr={class:"font-medium"},_r={class:"flex items-center gap-2"},wr=["disabled"],$r=["disabled"],kr={key:1,class:"text-center py-8 sm:py-12"},Cr={class:"text-lg font-medium text-gray-900 mb-2"},Dr={class:"text-gray-600 text-sm sm:text-base"},Fr={class:"border-t bg-gray-50"},Sr={class:"hidden sm:flex justify-between items-center p-6"},Er={class:"text-sm text-gray-600"},Pr={class:"flex gap-3"},Tr=["disabled"],jr={class:"sm:hidden p-4 space-y-3"},Mr={class:"text-center text-sm text-gray-600"},Ar={class:"flex gap-3"},Lr=["disabled"],Ir={key:0,class:"fixed inset-0 z-[60] flex items-center justify-center bg-black bg-opacity-50 p-4"},Br={class:"bg-white rounded-lg shadow-xl max-w-md w-full max-h-[80vh] flex flex-col"},Rr={class:"flex items-center justify-between px-4 py-3 border-b border-gray-200"},zr={class:"flex items-center gap-2"},Ur=e("h2",{class:"text-sm font-semibold text-gray-900"},"Etiquetas del documento",-1),Nr={class:"px-4 py-3 border-b border-gray-100 text-xs text-gray-500"},Or=e("span",{class:"font-medium text-gray-700"},"Documento:",-1),qr={class:"ml-1"},Vr={class:"px-4 py-3 overflow-y-auto"},Qr={key:0,class:"text-sm text-gray-500"},Wr={key:1,class:"space-y-2 text-sm"},Hr={class:"flex items-center gap-2 min-w-0"},Gr={key:0,class:"text-xs text-gray-500 truncate max-w-[8rem]"},Zr={__name:"AddDocumentsModal",props:{isVisible:{type:Boolean,required:!0},folder:{type:Object,default:null}},emits:["close","add-documents"],setup(a,{emit:w}){const i=a,c=w,D=Ge(),v=Xe(),y=h([]),M=h([]),p=h("my-documents"),L=h(!1),J=h(!1),ee=h(!1),G=h(null),U=h([]),re=h(!1),B=h(1),k=h(0),d=h(0),S=[{name:"my-documents",label:"Mis Documentos"},{name:"use-documents",label:"Minutas"},{name:"pending-signatures",label:"Firmas Pendientes"},{name:"signed-documents",label:"Documentos Firmados"}],E=I(()=>v.currentUser),te=async(ne,ge=1)=>{var Q;re.value=!0;try{let A={limit:10,page:ge};switch(ne){case"my-documents":A.states=["Progress","Completed"],(Q=E.value)!=null&&Q.id&&(A.clientId=E.value.id);break;case"use-documents":A.states=["Published"],A.unassigned=!0;break;case"pending-signatures":A.state="PendingSignatures",A.userRelated=!0;break;case"signed-documents":A.state="FullySigned",A.userRelated=!0,A.signerSigned=!0;break;default:U.value=[];return}const be=await D.fetchDocumentsForTab(A);U.value=be.items||[],d.value=be.totalItems||0,k.value=be.totalPages||0,B.value=be.currentPage||ge}catch(A){console.error("Error fetching documents for category:",A),U.value=[],d.value=0,k.value=0}finally{re.value=!1}};ke(()=>i.isVisible,ne=>{ne&&(y.value=[],M.value=[],p.value="my-documents",B.value=1,te("my-documents",1))}),ke(p,ne=>{y.value=[],B.value=1,te(ne,1)}),ke(M,()=>{y.value=[]},{deep:!0});const R=I(()=>{const ne=z(p.value);return ne.length===0?!1:ne.every(ge=>y.value.includes(ge.id))}),x=ne=>{if(!i.folder)return[];const ge=i.folder.documents.map(Q=>Q.id);return U.value.filter(Q=>!ge.includes(Q.id))},z=ne=>{const ge=x();if(!M.value||M.value.length===0)return ge;const Q=M.value.map(A=>A.id);return ge.filter(A=>!A.tags||A.tags.length===0?!1:A.tags.some(be=>Q.includes(be.id)))},Y=ne=>{const ge=y.value.indexOf(ne);ge>-1?y.value.splice(ge,1):y.value.push(ne)},ue=()=>{const ge=z(p.value).map(Q=>Q.id);if(R.value)y.value=y.value.filter(Q=>!ge.includes(Q));else{const Q=ge.filter(A=>!y.value.includes(A));y.value.push(...Q)}},le=()=>{c("close")},oe=async()=>{if(y.value.length!==0){L.value=!0;try{await c("add-documents",y.value)}finally{L.value=!1}}},C=ne=>{p.value=ne,J.value=!1},se=ne=>{ne.target.closest(".relative")||(J.value=!1)};He(()=>{document.addEventListener("click",se)}),yt(()=>{document.removeEventListener("click",se)});const $e=ne=>{const ge=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],Q=ne.id%ge.length;return ge[Q]},ye=ne=>{G.value=ne,ee.value=!0},_e=()=>{ee.value=!1,G.value=null};return(ne,ge)=>a.isVisible&&a.folder?(s(),de(Ke,{key:0},{default:T(()=>{var Q;return[e("div",{class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:pe(le,["self"])},[e("div",za,[e("div",Ua,[e("div",Na,[e("div",null,[Oa,e("p",qa,'Selecciona documentos para agregar a "'+m(a.folder.name)+'"',1)]),e("button",{onClick:le,class:"text-gray-400 hover:text-gray-500 hover:bg-gray-100 p-2 rounded-lg transition-colors"},[r(t(Te),{class:"w-5 h-5"})])]),e("div",Va,[e("div",Qa,[e("div",Wa,[Ha,e("p",Ga,'Para "'+m(a.folder.name)+'"',1)]),e("button",{onClick:le,class:"text-gray-400 hover:text-gray-500 hover:bg-gray-100 p-2 rounded-lg transition-colors flex-shrink-0"},[r(t(Te),{class:"w-5 h-5"})])])])]),e("div",Za,[e("nav",Ja,[(s(),o(fe,null,he(S,A=>e("button",{key:A.name,onClick:be=>p.value=A.name,class:j([p.value===A.name?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])},[K(m(A.label)+" ",1),e("span",Ya,m(p.value===A.name?d.value:"-"),1)],10,Ka)),64))]),e("div",Xa,[e("button",{onClick:ge[0]||(ge[0]=A=>J.value=!J.value),class:"w-full flex items-center justify-between py-3 px-4 bg-white border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary"},[e("div",er,[e("span",null,m(((Q=S.find(A=>A.name===p.value))==null?void 0:Q.label)||"Seleccionar categoría"),1),e("span",tr,m(d.value),1)]),(s(),o("svg",{class:j(["ml-2 h-5 w-5 transition-transform duration-200",J.value?"transform rotate-180":""]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},or,2))]),Fe(e("div",ar,[(s(),o(fe,null,he(S,A=>e("button",{key:A.name,onClick:be=>C(A.name),class:j(["w-full text-left px-4 py-3 text-sm transition-colors duration-150 flex items-center justify-between",p.value===A.name?"bg-primary text-white":"text-gray-700 hover:bg-gray-50"])},[e("span",null,m(A.label),1),e("span",{class:j(["py-0.5 px-2 rounded-full text-xs",p.value===A.name?"bg-white/20 text-white":"bg-gray-100 text-gray-600"])},m(p.value===A.name?d.value:"-"),3)],10,rr)),64))],512),[[vt,J.value]])])]),e("div",nr,[e("div",lr,[e("div",ir,[r(Ra,{modelValue:M.value,"onUpdate:modelValue":ge[1]||(ge[1]=A=>M.value=A),class:"max-w-md"},null,8,["modelValue"])]),d.value>0?(s(),o("div",dr,[e("span",cr,m(d.value)+" documento(s) disponible(s) ",1),e("button",{onClick:ue,class:j(["px-4 py-2 rounded-lg border font-medium text-sm transition-colors",R.value?"bg-red-50 border-red-200 text-red-700 hover:bg-red-100":"bg-primary text-white border-primary hover:bg-primary-dark"])},m(R.value?"Deseleccionar todos":"Seleccionar todos"),3)])):f("",!0)])]),e("div",ur,[e("div",mr,[(s(!0),o(fe,null,he(z(p.value),A=>(s(),o("div",{key:A.id,class:"relative"},[p.value==="my-documents"?(s(),de(t(As),{key:0,document:A,"highlighted-doc-id":null,"show-tags":!1,"show-client-name":!1,"menu-options":[],"disable-internal-actions":!0,"additional-classes":y.value.includes(A.id)?"ring-2 ring-primary bg-primary-50":"",onClick:be=>Y(A.id)},null,8,["document","additional-classes","onClick"])):f("",!0),p.value==="use-documents"?(s(),de(t(to),{key:1,document:A,"show-tags":!1,"menu-options":[],"show-menu-options":!1,"disable-internal-actions":!0,"additional-classes":y.value.includes(A.id)?"ring-2 ring-primary bg-primary-50":"",onClick:be=>Y(A.id)},null,8,["document","additional-classes","onClick"])):f("",!0),p.value==="pending-signatures"?(s(),de(t(ts),{key:2,document:A,"highlighted-doc-id":null,"show-tags":!1,"menu-options":[],"disable-internal-actions":!0,"additional-classes":y.value.includes(A.id)?"ring-2 ring-primary bg-primary-50":"",onClick:be=>Y(A.id)},null,8,["document","additional-classes","onClick"])):f("",!0),p.value==="signed-documents"?(s(),de(t(ts),{key:3,document:A,"highlighted-doc-id":null,"show-tags":!1,"menu-options":[],"disable-internal-actions":!0,"additional-classes":y.value.includes(A.id)?"ring-2 ring-primary bg-primary-50":"",onClick:be=>Y(A.id)},null,8,["document","additional-classes","onClick"])):f("",!0),A.tags&&A.tags.length>0?(s(),o("button",{key:4,type:"button",class:"absolute bottom-2 right-2 px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-600 hover:bg-gray-200 inline-flex items-center gap-1",onClick:pe(be=>ye(A),["stop"])},fr,8,gr)):f("",!0),y.value.includes(A.id)?(s(),o("div",hr,[r(t(Ls),{class:"w-4 h-4"})])):f("",!0)]))),128))]),k.value>1?(s(),o("div",yr,[e("p",vr,[K(" Página "),e("span",br,m(B.value),1),K(" de "),e("span",xr,m(k.value),1)]),e("nav",_r,[e("button",{onClick:ge[2]||(ge[2]=A=>B.value>1&&te(p.value,B.value-1)),disabled:B.value<=1||re.value,class:"px-3 py-1.5 text-sm font-medium rounded-md border transition-colors disabled:opacity-50 disabled:cursor-not-allowed border-gray-300 text-gray-700 hover:bg-gray-50"}," Anterior ",8,wr),e("button",{onClick:ge[3]||(ge[3]=A=>B.value<k.value&&te(p.value,B.value+1)),disabled:B.value>=k.value||re.value,class:"px-3 py-1.5 text-sm font-medium rounded-md border transition-colors disabled:opacity-50 disabled:cursor-not-allowed border-gray-300 text-gray-700 hover:bg-gray-50"}," Siguiente ",8,$r)])])):f("",!0),z(p.value).length===0&&!re.value?(s(),o("div",kr,[r(t(nt),{class:"w-12 h-12 sm:w-16 sm:h-16 text-gray-300 mx-auto mb-4"}),e("h4",Cr,m(M.value.length>0?"No hay documentos que coincidan con el filtro":"No hay documentos disponibles"),1),e("p",Dr,m(M.value.length>0?"Intenta ajustar los filtros de etiquetas o selecciona otra categoría":"No tienes documentos de esta categoría que no estén ya en la carpeta"),1)])):f("",!0)]),e("div",Fr,[e("div",Sr,[e("div",Er,m(y.value.length)+" documento(s) seleccionado(s) ",1),e("div",Pr,[e("button",{onClick:le,class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"}," Cancelar "),e("button",{onClick:oe,disabled:y.value.length===0||L.value,class:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},m(L.value?"Agregando...":`Agregar ${y.value.length} documento(s)`),9,Tr)])]),e("div",jr,[e("div",Mr,m(y.value.length)+" documento(s) seleccionado(s) ",1),e("div",Ar,[e("button",{onClick:le,class:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-center font-medium"}," Cancelar "),e("button",{onClick:oe,disabled:y.value.length===0||L.value,class:"flex-1 px-4 py-3 bg-primary text-white rounded-lg hover:bg-primary-dark disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-center font-medium"},m(L.value?"Agregando...":"Agregar"),9,Lr)])])]),ee.value&&G.value?(s(),o("div",Ir,[e("div",Br,[e("div",Rr,[e("div",zr,[r(t(nt),{class:"h-5 w-5 text-gray-500"}),Ur]),e("button",{type:"button",class:"text-gray-400 hover:text-gray-600 p-1 rounded-md hover:bg-gray-100",onClick:_e},[r(t(Te),{class:"h-5 w-5"})])]),e("div",Nr,[Or,e("span",qr,m(G.value.title||"Sin título"),1)]),e("div",Vr,[!G.value.tags||G.value.tags.length===0?(s(),o("div",Qr," Este documento no tiene etiquetas. ")):(s(),o("ul",Wr,[(s(!0),o(fe,null,he(G.value.tags,A=>(s(),o("li",{key:A.id,class:"flex items-center justify-between gap-2"},[e("div",Hr,[e("span",{class:j(["inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",$e(A)])},m(A.name),3)]),A.description?(s(),o("span",Gr,m(A.description),1)):f("",!0)]))),128))]))]),e("div",{class:"px-4 py-3 border-t border-gray-100 flex justify-end"},[e("button",{type:"button",class:"px-4 py-2 text-sm font-medium rounded-md border border-gray-300 text-gray-700 bg-white hover:bg-gray-50",onClick:_e}," Cerrar ")])])])):f("",!0)])])]}),_:1})):f("",!0)}},mt=a=>(Dt("data-v-d9a5a89f"),a=a(),Ft(),a),Jr={class:"folders-table"},Kr={key:0,class:"bg-white rounded-lg shadow-sm border border-gray-200",style:{"overflow-x":"visible","overflow-y":"hidden"}},Yr={class:"min-w-full divide-y divide-gray-200"},Xr=mt(()=>e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Carpeta "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Documentos "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Creada "),e("th",{scope:"col",class:"w-16 px-6 py-3"})])],-1)),en={class:"bg-white divide-y divide-gray-200"},tn=["onClick"],sn={class:"px-6 py-4 whitespace-nowrap"},on={class:"flex items-center"},an={class:"flex-shrink-0 h-10 w-10"},rn={class:"ml-4"},nn={class:"text-sm font-medium text-gray-900"},ln={class:"px-6 py-4 whitespace-nowrap"},dn={class:"flex items-center gap-2"},cn={class:"text-sm text-gray-900"},un={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},mn={class:"py-1"},gn=["onClick"],pn=["onClick"],fn=["onClick"],hn=["onClick"],yn={key:1,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center"},vn=mt(()=>e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No tienes carpetas aún",-1)),bn=mt(()=>e("p",{class:"text-gray-600 mb-6"},"Crea tu primera carpeta para organizar tus documentos",-1)),xn={key:2,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center"},_n=mt(()=>e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No se encontraron carpetas",-1)),wn=mt(()=>e("p",{class:"text-gray-600"},"No hay carpetas que coincidan con tu búsqueda",-1)),$n={key:3,class:"flex justify-center items-center py-12"},kn=mt(()=>e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"},null,-1)),Cn=[kn],Dn={__name:"FoldersTable",props:{sortedFolders:{type:Array,required:!0},searchQuery:{type:String,default:""},isLoading:{type:Boolean,default:!1}},emits:["folder-click","edit-folder","delete-folder","add-documents","create-folder"],setup(a,{emit:w}){const i=a,c=w,D=h({}),v=h({}),y=h(!1),M=h(-1),p=I(()=>{if(!i.searchQuery.trim())return i.sortedFolders;const R=i.searchQuery.toLowerCase();return i.sortedFolders.filter(x=>x.name.toLowerCase().includes(R))}),L=[{name:"blue",hex:"#3B82F6"},{name:"purple",hex:"#8B5CF6"},{name:"pink",hex:"#EC4899"},{name:"green",hex:"#10B981"},{name:"yellow",hex:"#F59E0B"},{name:"red",hex:"#EF4444"},{name:"indigo",hex:"#6366F1"},{name:"teal",hex:"#14B8A6"}],J=R=>{if(R.color)return L.find(z=>z.name===R.color)||L[0];const x=R.id%L.length;return L[x]},ee=R=>{if(!R)return"-";const x=new Date(R),Y=Math.abs(new Date-x),ue=Math.ceil(Y/(1e3*60*60*24));return ue===0?"Hoy":ue===1?"Ayer":ue<7?`Hace ${ue} días`:ue<30?`Hace ${Math.floor(ue/7)} semanas`:ue<365?`Hace ${Math.floor(ue/30)} meses`:x.toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"})},G=R=>{c("folder-click",R)},U=R=>{c("edit-folder",R)},re=R=>{c("delete-folder",R)},B=R=>{c("add-documents",R)},k=()=>{c("create-folder")},d=()=>y.value?p.value.length===1?"280px":p.value.length===2&&M.value===1?"340px":"280px":"auto",S=(R,x)=>{R&&(D.value[x]=R)},E=(R,x)=>{R&&(v.value[x]=R)},te=(R,x)=>{y.value=!x,M.value=x?-1:R,x||setTimeout(()=>{const z=v.value[R];if(z){const Y=z.$el||z;if(Y&&Y.getBoundingClientRect){const ue=Y.getBoundingClientRect(),le=window.innerHeight;if(R===0){if(ue.bottom>le-20){const oe=ue.bottom-le+40;window.scrollBy({top:oe,behavior:"smooth"})}}else if(ue.bottom>le-10){const oe=ue.bottom-le+30;window.scrollBy({top:oe,behavior:"smooth"})}else if(ue.top<80){const oe=ue.top-100;window.scrollBy({top:oe,behavior:"smooth"})}}}},100)};return(R,x)=>(s(),o("div",Jr,[!a.isLoading&&p.value.length>0?(s(),o("div",Kr,[e("div",{class:"overflow-x-auto",style:We({minHeight:d(),overflowY:"visible"})},[e("table",Yr,[Xr,e("tbody",en,[(s(!0),o(fe,null,he(p.value,(z,Y)=>{var ue,le;return s(),o("tr",{key:z.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:oe=>G(z)},[e("td",sn,[e("div",on,[e("div",an,[e("div",{class:"h-10 w-10 rounded-lg flex items-center justify-center",style:We({backgroundColor:J(z).hex+"20"})},[r(t(kt),{class:"h-6 w-6",style:We({color:J(z).hex})},null,8,["style"])],4)]),e("div",rn,[e("div",nn,m(z.name),1)])])]),e("td",ln,[e("div",dn,[r(t(Ve),{class:"h-5 w-5 text-gray-400"}),e("span",cn,m(((ue=z.documents)==null?void 0:ue.length)||0)+" documento"+m((((le=z.documents)==null?void 0:le.length)||0)!==1?"s":""),1)])]),e("td",un,m(ee(z.created_at)),1),e("td",{class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",onClick:x[0]||(x[0]=pe(()=>{},["stop"]))},[r(t(Le),{as:"div",class:"relative inline-block text-left"},{default:T(({open:oe})=>[r(t(Ie),{ref_for:!0,ref:C=>S(C,Y),onClick:C=>te(Y,oe),class:"inline-flex items-center justify-center w-8 h-8 rounded-md hover:bg-gray-100"},{default:T(()=>[r(t(ct),{class:"h-5 w-5 text-gray-500"})]),_:2},1032,["onClick"]),r(t(Be),{ref_for:!0,ref:C=>E(C,Y),class:j([p.value.length>2&&Y>0&&Y>=p.value.length-3?"absolute right-0 z-[9999] bottom-full mb-2 w-48 origin-bottom-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none":"absolute right-0 z-[9999] mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"])},{default:T(()=>[e("div",mn,[r(t(xe),null,{default:T(({active:C})=>[e("a",{onClick:se=>G(z),class:j([C?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Ver carpeta ",10,gn)]),_:2},1024),r(t(xe),null,{default:T(({active:C})=>[e("a",{onClick:se=>B(z),class:j([C?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Agregar documentos ",10,pn)]),_:2},1024),r(t(xe),null,{default:T(({active:C})=>[e("a",{onClick:se=>U(z),class:j([C?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Editar ",10,fn)]),_:2},1024),r(t(xe),null,{default:T(({active:C})=>[e("a",{onClick:se=>re(z),class:j([C?"bg-gray-100":"","block px-4 py-2 text-sm text-red-600 cursor-pointer"])}," Eliminar ",10,hn)]),_:2},1024)])]),_:2},1032,["class"])]),_:2},1024)])],8,tn)}),128))])])],4)])):!a.isLoading&&a.sortedFolders.length===0?(s(),o("div",yn,[r(t(kt),{class:"w-16 h-16 text-gray-300 mx-auto mb-4"}),vn,bn,e("button",{onClick:k,class:"inline-flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors"},[r(t(Ze),{class:"w-5 h-5"}),K(" Crear Primera Carpeta ")])])):!a.isLoading&&a.sortedFolders.length>0&&p.value.length===0?(s(),o("div",xn,[r(t(kt),{class:"w-16 h-16 text-gray-300 mx-auto mb-4"}),_n,wn])):f("",!0),a.isLoading?(s(),o("div",$n,Cn)):f("",!0)]))}},Fn=Et(Dn,[["__scopeId","data-v-d9a5a89f"]]),hs=a=>(Dt("data-v-8428d0f7"),a=a(),Ft(),a),Sn={class:"folder-management"},En={class:"mb-6"},Pn={class:"hidden sm:flex justify-between items-center"},Tn=hs(()=>e("div",null,[e("h2",{class:"text-xl font-semibold text-gray-900"},"Mis Carpetas"),e("p",{class:"text-sm text-gray-600 mt-1"},"Organiza tus documentos, firmas y formatos en carpetas personalizadas")],-1)),jn={class:"sm:hidden"},Mn=hs(()=>e("div",{class:"text-center mb-4"},[e("h2",{class:"text-xl font-semibold text-gray-900"},"Mis Carpetas"),e("p",{class:"text-sm text-gray-600 mt-1 px-2"},"Organiza tus documentos, firmas y formatos en carpetas personalizadas")],-1)),An={__name:"FolderManagement",props:{searchQuery:{type:String,default:""},selectedTags:{type:Array,default:()=>[]}},emits:["refresh","navigate-to-main","navigate-to-document"],setup(a,{emit:w}){const i=a,c=w,D=Jt(),v=Xe(),y=h(!1),M=h(null),p=h(null),L=h(!1),J=h(null),ee=I(()=>D.isLoading),G=I(()=>D.sortedFolders);I(()=>v.currentUser),He(async()=>{await D.init()}),ke(()=>i.searchQuery,()=>{}),ke(()=>D.folders,C=>{var se,$e;if(p.value&&C&&C.length>0){const ye=C.find(_e=>_e.id===p.value.id);ye&&((se=p.value.documents)!=null&&se.length,($e=ye.documents)!=null&&$e.length,JSON.stringify(p.value)!==JSON.stringify(ye)&&(p.value={...ye}))}},{deep:!0});const U=()=>{M.value=null,y.value=!0},re=C=>{M.value=C,y.value=!0},B=()=>{y.value=!1,M.value=null},k=()=>{B()},d=C=>{p.value=C},S=()=>{p.value=null},E=async C=>{if(confirm(`¿Estás seguro de que quieres eliminar la carpeta "${C.name}"?`))try{await D.deleteFolder(C.id),De(`Carpeta "${C.name}" eliminada correctamente`,"success")}catch(se){De("Error al eliminar la carpeta","error"),console.error("Error deleting folder:",se)}},te=C=>{J.value=C,L.value=!0},R=async(C=!1)=>{if(L.value=!1,J.value=null,C&&p.value)try{await x()}catch(se){console.warn("Error refreshing folder after adding documents:",se)}},x=async()=>{if(p.value)try{await D.fetchFolder(p.value.id);const C=D.getFolderById(p.value.id);C&&(p.value={...C},console.log("✅ Selected folder refreshed successfully"))}catch(C){throw console.error("❌ Error refreshing selected folder:",C),C}},z=async C=>{var se,$e,ye;if(!(!J.value||C.length===0))try{const _e=J.value.documents.map(Q=>Q.id).filter(Q=>Q!=null&&!isNaN(parseInt(Q))).map(Q=>parseInt(Q)),ne=C.filter(Q=>Q!=null&&!isNaN(parseInt(Q))).map(Q=>parseInt(Q)),ge=[...new Set([..._e,...ne])];if(console.log("Current document IDs:",_e),console.log("Selected document IDs:",ne),console.log("Updated document IDs:",ge),ge.some(Q=>!Number.isInteger(Q)||Q<=0))throw new Error("IDs de documentos inválidos detectados");await D.updateFolder(J.value.id,{document_ids:ge}),await R(!0),De(`${ne.length} documento(s) agregado(s) a la carpeta`,"success"),c("navigate-to-main")}catch(_e){console.error("Error adding documents to folder:",_e),console.error("Error details:",((se=_e.response)==null?void 0:se.data)||_e.message),($e=_e.response)!=null&&$e.status?De(`Error al agregar documentos: ${((ye=_e.response.data)==null?void 0:ye.detail)||_e.message}`,"error"):De("Error al agregar documentos a la carpeta","error")}},Y=async C=>{var $e,ye,_e;if(!p.value)return;const se=typeof C=="object"&&C!==null?C.documentId:C;try{const ne=parseInt(se);if(!Number.isInteger(ne)||ne<=0)throw new Error("ID de documento inválido");const ge=p.value.documents.map(Q=>Q.id).filter(Q=>Q!=null&&!isNaN(parseInt(Q))).map(Q=>parseInt(Q)).filter(Q=>Q!==ne);await D.updateFolder(p.value.id,{document_ids:ge}),De("Documento removido de la carpeta","success"),p.value=null,c("navigate-to-main")}catch(ne){console.error("Error removing document from folder:",ne),console.error("Error details:",(($e=ne.response)==null?void 0:$e.data)||ne.message),(ye=ne.response)!=null&&ye.status?De(`Error al remover documento: ${((_e=ne.response.data)==null?void 0:_e.detail)||ne.message}`,"error"):De("Error al remover el documento de la carpeta","error")}},ue=C=>{let se="legal-documents";C.state==="Published"||C.state==="Draft"?se="legal-documents":C.state==="PendingSignatures"?se="pending-signatures":C.state==="FullySigned"?se="signed-documents":C.state==="Progress"||C.state==="Completed"?se="my-documents":(C.state==="Rejected"||C.state==="Expired"||C.state==="Archived")&&(se="archived-documents"),p.value=null,c("navigate-to-document",{tab:se,searchQuery:C.title})},le=C=>{p.value=null,c("navigate-to-document",{tab:"legal-documents",searchQuery:C.title})},oe=(C,se)=>{console.log("Document action:",C,se)};return(C,se)=>(s(),o("div",Sn,[e("div",En,[e("div",Pn,[Tn,e("button",{onClick:U,class:"inline-flex items-center gap-2 px-4 py-2.5 bg-primary text-white rounded-xl hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-all duration-200 shadow-sm hover:shadow-md"},[r(t(Ze),{class:"w-5 h-5"}),K(" Nueva Carpeta ")])]),e("div",jn,[Mn,e("button",{onClick:U,class:"w-full flex items-center justify-center gap-3 px-4 py-4 bg-primary text-white rounded-xl hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-all duration-200 shadow-sm hover:shadow-md font-medium text-base"},[r(t(Ze),{class:"w-6 h-6"}),K(" Nueva Carpeta ")])])]),r(t(Fn),{"sorted-folders":G.value,"search-query":a.searchQuery,"is-loading":ee.value,onFolderClick:d,onEditFolder:re,onDeleteFolder:E,onAddDocuments:te,onCreateFolder:U},null,8,["sorted-folders","search-query","is-loading"]),r(t(vo),{"is-visible":y.value,"editing-folder":M.value,onClose:B,onSuccess:k},null,8,["is-visible","editing-folder"]),r(t(Yo),{folder:p.value,onClose:S,onAddDocuments:te,onRemoveDocument:Y,onViewDocument:ue,onUseDocument:le,onDocumentAction:oe},null,8,["folder"]),r(t(Zr),{"is-visible":L.value,folder:J.value,onClose:R,onAddDocuments:z},null,8,["is-visible","folder"])]))}},ns=Et(An,[["__scopeId","data-v-8428d0f7"]]);function Ln(a){return!a.variables||a.variables.length===0?!0:a.variables.every(w=>w.name_es&&w.name_es.trim().length>0)}function $t(a,w){var D;if(!a.requires_signature||a.state!=="PendingSignatures"||!a.signatures||a.signatures.length===0)return!1;const i=(D=w==null?void 0:w.currentUser)==null?void 0:D.email,c=a.signatures.find(v=>v.signer_email===i);return!(!c||c.signed)}const In={lawyer:{getMenuOptions:(a,w,i)=>{let c;return w==="legal-documents"&&(a.state==="Draft"||a.state==="Published")?c=[{label:"Editar",action:"edit-submenu",isGroup:!0,children:[{label:"Actualizar nombre",action:"edit"},{label:"Editar documento",action:"editDocument"},{label:"Editar configuración de variables",action:"editForm"}]},{label:"Permisos",action:"permissions"},{label:"Eliminar",action:"delete"},{label:"Previsualización",action:"preview"},{label:"Crear una Copia",action:"copy"},{label:"Gestionar Membrete",action:"letterhead"}]:c=[{label:"Editar",action:"edit"},{label:"Permisos",action:"permissions"},{label:"Eliminar",action:"delete"},{label:"Previsualización",action:"preview"},{label:"Crear una Copia",action:"copy"},{label:"Gestionar Membrete",action:"letterhead"}],a.state!=="Draft"&&a.state!=="Published"&&c.splice(2,0,{label:"Administrar Asociaciones",action:"relationships"}),a.state==="Draft"?c.push({label:"Publicar",action:"publish",disabled:!Ln(a)}):a.state==="Published"&&c.push({label:"Mover a Borrador",action:"draft"}),(a.state==="Completed"||a.state==="Published")&&c.push({label:"Descargar PDF",action:"downloadPDF"},{label:"Descargar Word",action:"downloadWord"},{label:"Enviar por Email",action:"email"}),a.requires_signature&&(a.state==="PendingSignatures"||a.state==="FullySigned")&&(c.push({label:"Ver Firmas",action:"viewSignatures"}),$t(a,i)&&c.push({label:"Firmar documento",action:"sign"})),c}},signatures:{getMenuOptions:(a,w,i)=>{const c=[{label:"Previsualizar",action:"preview"},{label:"Gestionar Membrete",action:"letterhead"}],D=a.relationships_count&&a.relationships_count>0;if(c.push({label:"Administrar Asociaciones",action:"relationships",disabled:!D}),a.requires_signature&&["PendingSignatures","FullySigned","Rejected","Expired"].includes(a.state)&&c.push({label:"Estado de las firmas",action:"viewSignatures"}),$t(a,i)&&c.push({label:"Firmar documento",action:"sign"}),a.state==="PendingSignatures"&&$t(a,i)&&c.push({label:"Rechazar documento",action:"reject"}),a.state==="FullySigned"&&c.push({label:"Descargar Documento firmado",action:"downloadSignedDocument"}),a.state==="PendingSignatures"&&c.push({label:"Descargar PDF",action:"downloadPDF"}),a.state==="Rejected"){const v=i==null?void 0:i.currentUser,y=(v==null?void 0:v.role)==="lawyer",M=a.created_by===(v==null?void 0:v.id);(y||M)&&c.push({label:"Editar y reenviar para firma",action:"editAndResend"}),Array.isArray(a.signatures)&&a.signatures.some(L=>L.rejection_comment)&&c.push({label:"Ver motivo del rechazo",action:"viewRejectionReason"})}return c}},client:{getMenuOptions:(a,w,i)=>{var ee,G,U,re;const c=[],D=((ee=i==null?void 0:i.currentUser)==null?void 0:ee.role)==="basic",v=((G=i==null?void 0:i.currentUser)==null?void 0:G.role)==="corporate_client"||((U=i==null?void 0:i.currentUser)==null?void 0:U.role)==="client",y=((re=i==null?void 0:i.currentUser)==null?void 0:re.role)==="lawyer",M=a.state==="Progress",p=w==="my-documents",J=["PendingSignatures","FullySigned","Rejected","Expired"].includes(a.state);if(p&&a.requires_signature&&J&&(a.state==="PendingSignatures"||a.state==="FullySigned"||a.state==="Expired"))return c.push({label:"Previsualizar",action:"preview"}),c.push({label:"Descargar PDF",action:"downloadPDF"}),D?c.push({label:"Descargar Word",action:"downloadWord",disabled:!0}):c.push({label:"Descargar Word",action:"downloadWord"}),a.state==="FullySigned"&&c.push({label:"Descargar Documento firmado",action:"downloadSignedDocument"}),c;if(a.state==="Completed"){const B=[{label:"Editar Formulario",action:"editForm"}];D||B.push({label:"Editar Documento",action:"editDocument"}),c.push({label:"Editar",action:"edit-submenu",isGroup:!0,children:B}),(v||D||y)&&c.push({label:"Formalizar y Agregar Firmas",action:"formalize",disabled:D})}else a.state==="Progress"?(c.push({label:"Completar",action:"editForm"}),(v||D||y)&&c.push({label:"Formalizar y Agregar Firmas",action:"formalize",disabled:!0})):c.push({label:"Completar",action:"editForm"});if((a.state==="Completed"||a.state==="Progress")&&c.push({label:"Previsualizar",action:"preview"}),c.push({label:"Eliminar",action:"delete"}),D?c.push({label:"Gestionar Membrete",action:"letterhead",disabled:!0}):c.push({label:"Gestionar Membrete",action:"letterhead"}),c.push({label:"Administrar Asociaciones",action:"relationships",disabled:D||M}),a.requires_signature){const k=["PendingSignatures","FullySigned","Rejected","Expired"].includes(a.state);w!=="my-documents"&&k&&(c.push({label:"Ver Firmas",action:"viewSignatures"}),$t(a,i)&&c.push({label:"Firmar documento",action:"sign"}))}if(a.state==="Completed"||a.state==="Progress"){const B=a.state==="Completed";c.push({label:"Descargar PDF",action:"downloadPDF",disabled:!B},{label:"Descargar Word",action:"downloadWord",disabled:D||!B},{label:"Enviar",action:"email",disabled:D||!B})}return c}}};function Bn(a,w,i="list",c=null){const D=In[a];return D?D.getMenuOptions(w,i,c):[]}function ys(){const a=Xe(),w=I(()=>{var v;return((v=a.currentUser)==null?void 0:v.role)==="basic"}),i=v=>{De("Esta funcionalidad está restringida para usuarios básicos. Por favor, contacta a tu abogado para obtener acceso completo.","warning")};return{isBasicUser:w,showRestrictionNotification:i,handleFeatureAccess:(v,y)=>w.value?(i(),!1):(y&&y(),!0),getRestrictedButtonClasses:v=>v?"opacity-60 cursor-not-allowed":""}}const Rn={class:"relative bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col"},zn={class:"px-6 py-4 border-b border-gray-200"},Un=e("h2",{class:"text-xl font-semibold text-gray-800"},"Acciones del Documento",-1),Nn={class:"text-sm text-gray-500 mt-1"},On={class:"p-6 overflow-y-auto flex-grow"},qn={class:"space-y-4"},Vn={key:0,class:"text-sm font-semibold text-gray-700 uppercase tracking-wide px-2"},Qn={class:"grid grid-cols-1 sm:grid-cols-2 gap-2"},Wn=["onClick","disabled"],Hn={class:"text-sm font-medium"},Gn={key:0,class:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none z-50 max-w-xs w-max"},Zn=e("div",{class:"absolute bottom-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-b-gray-900"},null,-1),Jn={key:1,class:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none z-50 max-w-xs w-max"},Kn=e("div",{class:"absolute bottom-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-b-gray-900"},null,-1),Yn={key:2,class:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none z-50 max-w-xs w-max"},Xn=e("div",{class:"absolute bottom-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-b-gray-900"},null,-1),el={key:3,class:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none z-50 max-w-xs w-max"},tl=e("div",{class:"absolute bottom-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-b-gray-900"},null,-1),sl={key:4,class:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none z-50 max-w-xs w-max"},ol=e("div",{class:"absolute bottom-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-b-gray-900"},null,-1),al={key:1,class:"border-t border-gray-200 my-4"},rl={key:0,class:"text-center py-12"},nl=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No hay acciones disponibles",-1),ll=e("p",{class:"mt-1 text-sm text-gray-500"}," No hay opciones disponibles para este documento. ",-1),At={__name:"DocumentActionsModal",props:{isVisible:{type:Boolean,default:!1},document:{type:Object,default:null},cardType:{type:String,required:!0,validator:a=>["lawyer","client","signatures"].includes(a)},context:{type:String,default:"table"},userStore:{type:Object,default:null}},emits:["close","action"],setup(a,{emit:w}){const i=a,c=w,D=I(()=>i.document?Bn(i.cardType,i.document,i.context,i.userStore):[]),v=I(()=>{const k=D.value;if(!k||k.length===0)return[];const d=[],S={edit:"Edición",view:"Visualización",share:"Compartir",manage:"Gestión",signatures:"Firmas",delete:"Eliminación"},E={edit:[],view:[],share:[],manage:[],signatures:[],delete:[]};return k.forEach(te=>{if(te.children&&Array.isArray(te.children))te.children.forEach(R=>{const x=R.action.toLowerCase();y(R,x,E)});else{const R=te.action.toLowerCase();y(te,R,E)}}),E.edit.length>0&&d.push({title:S.edit,options:E.edit}),E.view.length>0&&d.push({title:S.view,options:E.view}),E.share.length>0&&d.push({title:S.share,options:E.share}),E.signatures.length>0&&d.push({title:S.signatures,options:E.signatures}),E.manage.length>0&&d.push({title:S.manage,options:E.manage}),E.delete.length>0&&d.push({title:S.delete,options:E.delete}),d}),y=(k,d,S)=>{d.includes("edit")||d.includes("editar")||d==="copy"||d==="draft"||d==="publish"||d==="completar"?S.edit.push(k):d.includes("signature")||d.includes("firma")||d.includes("sign")||d==="reject"?S.signatures.push(k):d.includes("view")||d.includes("preview")||d.includes("ver")||d.includes("previsualización")?S.view.push(k):d.includes("download")||d.includes("email")||d.includes("enviar")||d.includes("descargar")?S.share.push(k):d.includes("permission")||d.includes("relationship")||d.includes("letterhead")||d.includes("permiso")||d.includes("asociación")||d.includes("membrete")||d==="formalize"?S.manage.push(k):d.includes("delete")||d.includes("eliminar")?S.delete.push(k):S.manage.push(k)},M=k=>{const d=k.toLowerCase();return d==="sign"||d.includes("firmar")?Ct:d==="editform"||d.includes("completar")?rs:d==="editdocument"||d.includes("editar documento")?ss:d.includes("edit")||d==="editar"?ss:d.includes("delete")||d==="eliminar"?Vt:d.includes("preview")||d.includes("ver")||d.includes("previsualización")?ms:d==="copy"||d.includes("copia")?Ps:d.includes("download")||d.includes("descargar")?rt:d.includes("email")||d.includes("enviar")?Cs:d.includes("permission")||d.includes("permiso")?Is:d.includes("relationship")||d.includes("asociación")?gs:d.includes("letterhead")||d.includes("membrete")?ps:d==="reject"||d.includes("rechazar")?Os:d.includes("signature")||d.includes("firma")?Ct:d==="publish"||d.includes("publicar")?Ns:d==="draft"||d.includes("borrador")?Ve:d==="formalize"||d.includes("formalizar")?rs:nt},p=k=>{const d=k.toLowerCase();return d.includes("delete")||d==="eliminar"||d==="reject"||d.includes("rechazar")?"text-red-600":d==="sign"||d.includes("firmar")?"text-green-600":d.includes("download")||d.includes("descargar")?"text-blue-600":d.includes("email")||d.includes("enviar")?"text-green-600":d.includes("signature")||d.includes("firma")?"text-purple-600":"text-gray-600"},L=k=>{const d=k.toLowerCase();return d.includes("delete")||d==="eliminar"||d==="reject"||d.includes("rechazar")?"border-red-200 bg-red-50 text-red-700 hover:bg-red-100 hover:border-red-300":d==="sign"||d.includes("firmar")?"border-green-200 bg-green-50 text-green-700 hover:bg-green-100 hover:border-green-300":d.includes("download")||d.includes("descargar")?"border-blue-200 bg-blue-50 text-blue-700 hover:bg-blue-100 hover:border-blue-300":d.includes("email")||d.includes("enviar")?"border-green-200 bg-green-50 text-green-700 hover:bg-green-100 hover:border-green-300":d.includes("signature")||d.includes("firma")?"border-purple-200 bg-purple-50 text-purple-700 hover:bg-purple-100 hover:border-purple-300":"border-gray-200 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-300"},{isBasicUser:J,handleFeatureAccess:ee}=ys(),G=["formalize","letterhead","relationships","downloadWord","email"],U=k=>{const d=k.toLowerCase();return G.some(S=>d===S.toLowerCase())},re=k=>{const d=D.value.find(E=>E.action===k?E:E.children?E.children.find(te=>te.action===k):null),S=d!=null&&d.children?d.children.find(E=>E.action===k):d;if(S!=null&&S.disabled){ee("Esta funcionalidad",null);return}c("action",k,i.document)},B=()=>{c("close")};return(k,d)=>Fe((s(),de(Ke,null,{default:T(()=>{var S;return[e("div",{class:"w-full h-full flex items-center justify-center p-4",onClick:pe(B,["self"])},[e("div",Rn,[e("div",zn,[Un,e("p",Nn,m(((S=a.document)==null?void 0:S.title)||"Cargando..."),1),e("button",{onClick:B,class:"absolute top-4 right-4 text-gray-400 hover:text-gray-500 transition-colors"},[r(t(Te),{class:"h-6 w-6"})])]),e("div",On,[e("div",qn,[(s(!0),o(fe,null,he(v.value,(E,te)=>(s(),o("div",{key:te,class:"space-y-2"},[E.title?(s(),o("h3",Vn,m(E.title),1)):f("",!0),e("div",Qn,[(s(!0),o(fe,null,he(E.options,R=>{var x,z,Y;return s(),o("div",{key:R.action,class:"relative group"},[e("button",{onClick:ue=>re(R.action),disabled:R.disabled,class:j(["flex items-center justify-start w-full px-4 py-3 rounded-lg border transition-all duration-200",R.disabled?"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed opacity-60":L(R.action),"hover:shadow-md hover:scale-[1.02]"])},[(s(),de(ks(M(R.action)),{class:j(["h-5 w-5 mr-3 flex-shrink-0",R.disabled?"text-gray-400":p(R.action)])},null,8,["class"])),e("span",Hn,m(R.label),1),R.disabled?(s(),de(t(js),{key:0,class:"h-4 w-4 ml-auto text-gray-400"})):f("",!0)],10,Wn),R.disabled&&R.action==="relationships"&&!t(J)&&((x=a.document)==null?void 0:x.state)==="Progress"?(s(),o("div",Gn,[K(" Solo puedes administrar asociaciones cuando el documento está completado. "),Zn])):R.disabled&&R.action==="relationships"&&!t(J)?(s(),o("div",Jn,[K(" Este documento no tiene documentos asociados. "),Kn])):R.disabled&&R.action==="formalize"&&((z=a.document)==null?void 0:z.state)!=="Completed"?(s(),o("div",Yn,[K(" Solo puedes formalizar y agregar firmas cuando el documento está completado. "),Xn])):R.disabled&&["downloadPDF","downloadWord","email"].includes(R.action)&&((Y=a.document)==null?void 0:Y.state)!=="Completed"?(s(),o("div",el,[K(" Solo puedes usar esta acción cuando el documento está completado. "),tl])):R.disabled&&t(J)&&U(R.action)?(s(),o("div",sl,[K(" Actualiza tu suscripción para usar esta funcionalidad "),ol])):f("",!0)])}),128))]),te<v.value.length-1?(s(),o("div",al)):f("",!0)]))),128)),v.value.length===0?(s(),o("div",rl,[r(t(nt),{class:"mx-auto h-12 w-12 text-gray-400"}),nl,ll])):f("",!0)])])])])]}),_:1},512)),[[vt,a.isVisible]])}};function Kt(a){if(a.summary_value===null||a.summary_value===void 0||a.summary_value==="")return"";const w=Number(String(a.summary_value).replace(/[^0-9.,-]/g,"").replace(/\./g,"").replace(",","."));if(Number.isNaN(w))return a.summary_value;const i=w.toLocaleString("es-CO",{maximumFractionDigits:2}),c=a.summary_value_currency||"",v={COP:"COP $",USD:"USD $",EUR:"EUR €"}[c]||c||"";return v?`${v} ${i}`:i}const il={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-3 sm:p-4 mb-6"},dl={class:"mb-4"},cl={class:"relative w-full"},ul={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-3"},ml={class:"flex items-center gap-2 min-w-0"},gl={class:"truncate"},pl={class:"py-1"},fl=["onClick"],hl={class:"flex items-center gap-2 min-w-0"},yl={class:"truncate"},vl={class:"p-2"},bl={class:"relative mb-2"},xl={class:"max-h-60 overflow-y-auto"},_l=["onClick"],wl={class:"truncate"},$l={class:"flex items-center gap-2 min-w-0"},kl={class:"truncate"},Cl={class:"p-2"},Dl={class:"relative mb-2"},Fl={class:"max-h-60 overflow-y-auto"},Sl=["onClick"],El={class:"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-4"},Pl={class:"flex flex-col gap-1"},Tl=e("label",{class:"text-xs font-medium text-gray-600"},"Fecha inicio",-1),jl={class:"flex flex-col gap-1"},Ml=e("label",{class:"text-xs font-medium text-gray-600"},"Fecha fin",-1),Al={class:"flex flex-col sm:flex-row gap-3 items-start sm:items-center justify-between"},Ll={class:"py-1"},Il=["onClick"],Bl={class:"flex gap-2 w-full sm:w-auto"},Rl=e("span",null,"Limpiar filtros",-1),zl={key:0,class:"flex justify-center items-center py-12 bg-white rounded-lg shadow-sm border border-gray-200"},Ul=e("div",{class:"text-center"},[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary mb-4"}),e("p",{class:"text-sm text-gray-500"},"Cargando documentos...")],-1),Nl=[Ul],Ol={key:1,class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},ql={class:"overflow-x-auto"},Vl={class:"min-w-full divide-y divide-gray-200"},Ql={class:"bg-gray-50"},Wl={key:0,scope:"col",class:"w-12 px-3 py-3"},Hl=["checked"],Gl=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Documento ",-1),Zl=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado ",-1),Jl=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Contraparte ",-1),Kl=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Objeto ",-1),Yl=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Valor ",-1),Xl=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Plazo ",-1),ei=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Fecha Suscripción ",-1),ti=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Fecha Inicio ",-1),si=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Fecha Terminación ",-1),oi={key:1,scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},ai=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etiquetas ",-1),ri={class:"bg-white divide-y divide-gray-200"},ni=["onClick"],li={key:0,class:"px-3 py-4"},ii=["checked","onChange"],di={class:"px-6 py-4"},ci={class:"flex items-center gap-3"},ui={class:"min-w-0"},mi={class:"text-sm font-medium text-gray-900 hover:text-secondary truncate block max-w-xs text-left"},gi={class:"px-6 py-4 whitespace-nowrap"},pi={class:"px-6 py-4 whitespace-nowrap"},fi={class:"text-sm text-gray-900"},hi={class:"px-6 py-4 whitespace-nowrap"},yi={class:"text-sm text-gray-900 line-clamp-2 max-w-xs"},vi={class:"px-6 py-4 whitespace-nowrap"},bi={class:"text-sm text-gray-900"},xi={class:"px-6 py-4 whitespace-nowrap"},_i={class:"text-sm text-gray-900"},wi={class:"px-6 py-4 whitespace-nowrap text-xs text-gray-900"},$i={key:0},ki={key:1,class:"text-gray-400"},Ci={class:"px-6 py-4 whitespace-nowrap text-xs text-gray-900"},Di={key:0},Fi={key:1,class:"text-gray-400"},Si={class:"px-6 py-4 whitespace-nowrap text-xs text-gray-900"},Ei={key:0},Pi={key:1,class:"text-gray-400"},Ti={key:1,class:"px-6 py-4 whitespace-nowrap"},ji=["onClick"],Mi={key:1,class:"text-sm text-gray-400"},Ai={class:"px-6 py-4"},Li={class:"flex flex-wrap gap-1"},Ii=["onClick"],Bi={key:0,class:"bg-gray-50 px-4 py-3 border-t border-gray-200 sm:px-6"},Ri={class:"flex items-center justify-between"},zi={class:"flex-1 flex justify-between sm:hidden"},Ui=["disabled"],Ni=["disabled"],Oi={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},qi={key:0,class:"text-sm text-gray-700"},Vi={class:"font-medium"},Qi={class:"font-medium"},Wi={class:"font-medium"},Hi={key:1,class:"text-sm text-gray-700"},Gi={class:"font-medium"},Zi={class:"font-medium"},Ji={class:"font-medium"},Ki={class:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination"},Yi=["disabled"],Xi=["onClick"],ed=["disabled"],td={key:2,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center"},sd=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No hay documentos",-1),od={class:"mt-1 text-sm text-gray-500"},ad={key:11,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4"},rd={class:"bg-white rounded-lg shadow-xl max-w-md w-full max-h-[80vh] flex flex-col"},nd={class:"flex items-center justify-between px-4 py-3 border-b border-gray-200"},ld={class:"flex items-center gap-2"},id=e("h2",{class:"text-sm font-semibold text-gray-900"},"Etiquetas del documento",-1),dd={class:"px-4 py-3 border-b border-gray-100 text-xs text-gray-500"},cd=e("span",{class:"font-medium text-gray-700"},"Documento:",-1),ud={class:"ml-1"},md={class:"px-4 py-3 overflow-y-auto"},gd={key:0,class:"text-sm text-gray-500"},pd={key:1,class:"space-y-2 text-sm"},fd={class:"flex items-center gap-2 min-w-0"},hd={key:0,class:"text-xs text-gray-500 truncate max-w-[8rem]"},Ot={__name:"DocumentListTable",props:{searchQuery:String,selectedTags:{type:Array,default:()=>[]},promptDocuments:{type:Array,default:null},cardType:{type:String,default:"lawyer",validator:a=>["lawyer","client"].includes(a)},showStateFilter:{type:Boolean,default:!0},showClientFilter:{type:Boolean,default:!1},showAssociationsColumn:{type:Boolean,default:!0},availableStates:{type:Array,default:()=>["Draft","Published","Progress","PendingSignatures","Completed","FullySigned","Rejected","Expired"]},context:{type:String,default:"legal-documents"},isLoading:{type:Boolean,default:!1}},emits:["refresh","open-electronic-signature","update:searchQuery"],setup(a,{emit:w}){const i=Ge(),c=Xe(),D=st(),v=a,y=w,{activeModals:M,openModal:p,closeModal:L}=Pt(i,c),J=I(()=>(M==null?void 0:M.value)||M||{}),ee=I(()=>{const u=J.value;return(u==null?void 0:u.relationships)||{isOpen:!1,document:null}}),{handlePreviewDocument:G,deleteDocument:U,downloadPDFDocument:re,downloadWordDocument:B,copyDocument:k,publishDocument:d,moveToDraft:S,formalizeDocument:E,signDocument:te,downloadSignedDocument:R}=Tt(i,c,y),x=h(""),z=h(""),Y=h(""),ue=h(null),le=h(null),oe=h(null),C=h(""),se=h(""),$e=h("recent"),ye=h([]),_e=h(!1),ne=h(null),ge=h(!1),Q=h(null),A=h(1),be=h(10),Ne=I(()=>v.cardType==="lawyer"&&v.context==="legal-documents");I(()=>!1);const Oe=I(()=>{if(v.promptDocuments)return v.promptDocuments;const u=c.currentUser;return v.cardType==="lawyer"&&v.context==="legal-documents"?!(u!=null&&u.id)||typeof i.getDocumentsByLawyerId!="function"?[]:i.getDocumentsByLawyerId(u.id)||[]:v.cardType==="client"&&v.context==="my-documents"?!(u!=null&&u.id)||typeof i.progressAndCompletedDocumentsByClient!="function"?[]:i.progressAndCompletedDocumentsByClient(u.id)||[]:i.documents||[]}),Me=I(()=>{const u=new Map;return Oe.value.forEach(g=>{var H;(H=g.tags)==null||H.forEach(b=>{u.has(b.id)||u.set(b.id,b)})}),Array.from(u.values())}),Re=I(()=>{if(!z.value)return Me.value;const u=z.value.toLowerCase();return Me.value.filter(g=>g.name.toLowerCase().includes(u))}),ze=I(()=>{if(!le.value)return null;const u=Me.value.find(g=>g.id===le.value);return(u==null?void 0:u.name)||null}),Z=I(()=>{if(v.cardType!=="lawyer")return[];const u=new Map;return Oe.value.forEach(g=>{g.client&&u.set(g.client.id,g.client)}),Array.from(u.values())}),ie=I(()=>{if(!Y.value)return Z.value;const u=Y.value.toLowerCase();return Z.value.filter(g=>`${g.first_name} ${g.last_name}`.toLowerCase().includes(u))}),P=I(()=>{if(!oe.value)return null;const u=Z.value.find(g=>g.id===oe.value);return u?`${u.first_name} ${u.last_name}`:null}),N=I(()=>!v.selectedTags||!v.selectedTags.length?[]:v.selectedTags.map(u=>typeof u=="object"?u.id:u)),O=I(()=>{let u=Oe.value;const g=(x.value||"").toLowerCase();return g&&(u=u.filter(H=>{var b,Ce;return((b=H.title)==null?void 0:b.toLowerCase().includes(g))||((Ce=H.code)==null?void 0:Ce.toLowerCase().includes(g))})),ue.value&&(u=u.filter(H=>H.state===ue.value)),(C.value||se.value)&&(u=u.filter(H=>{const b=H.summary_subscription_date||H.created_at||H.updated_at;if(!b)return!1;const Ce=new Date(b);if(isNaN(Ce.getTime()))return!1;if(C.value){const Ae=new Date(C.value);if(Ce<Ae)return!1}if(se.value){const Ae=new Date(se.value);if(Ae.setHours(23,59,59,999),Ce>Ae)return!1}return!0})),le.value&&(u=u.filter(H=>{var b;return(b=H.tags)==null?void 0:b.some(Ce=>Ce.id===le.value)})),N.value.length>0&&(u=u.filter(H=>{var b;return(b=H.tags)==null?void 0:b.some(Ce=>N.value.includes(Ce.id))})),oe.value&&v.cardType==="lawyer"&&(u=u.filter(H=>{var b;return((b=H.client)==null?void 0:b.id)===oe.value})),u}),ce=()=>{ue.value=null,le.value=null,oe.value=null,C.value="",se.value=""},W=I(()=>{if(v.cardType!=="lawyer"||v.context!=="legal-documents")return!1;const u=O.value;return u.length?u.every(g=>g.state==="Draft"||g.state==="Published"):!1}),V=I(()=>v.cardType==="lawyer"&&v.context==="legal-documents"),we=I(()=>v.cardType==="client"&&v.context==="my-documents"),_=I(()=>{const u=[...O.value];switch($e.value){case"recent":return u.sort((g,H)=>new Date(H.updated_at)-new Date(g.updated_at));case"oldest":return u.sort((g,H)=>new Date(g.updated_at)-new Date(H.updated_at));case"name-asc":return u.sort((g,H)=>(g.title||"").localeCompare(H.title||""));case"name-desc":return u.sort((g,H)=>(H.title||"").localeCompare(g.title||""));default:return u}}),n=I(()=>{if(v.promptDocuments){const u=(A.value-1)*be.value,g=u+be.value;return _.value.slice(u,g)}return _.value}),l=I(()=>{var u;return v.promptDocuments?Math.ceil(_.value.length/be.value):((u=i.pagination)==null?void 0:u.totalPages)||1}),X=I(()=>{const u=l.value,g=A.value,H=[];if(u<=7)for(let b=1;b<=u;b++)H.push(b);else if(g<=4){for(let b=1;b<=5;b++)H.push(b);H.push("..."),H.push(u)}else if(g>=u-3){H.push(1),H.push("...");for(let b=u-4;b<=u;b++)H.push(b)}else H.push(1),H.push("..."),H.push(g-1),H.push(g),H.push(g+1),H.push("..."),H.push(u);return H}),ve=I(()=>n.value.length>0&&n.value.every(u=>ye.value.includes(u.id))),me=[{value:"recent",label:"Más recientes"},{value:"oldest",label:"Más antiguos"},{value:"name-asc",label:"Nombre (A-Z)"},{value:"name-desc",label:"Nombre (Z-A)"}],qe=u=>{var g;return((g=me.find(H=>H.value===u))==null?void 0:g.label)||"Ordenar"},Se=u=>({Draft:"Borrador",Published:"Publicado",Progress:"En Progreso",PendingSignatures:"Pendiente de Firmas",Completed:"Completado",FullySigned:"Firmado",Rejected:"Rechazado",Expired:"Expirado"})[u]||u,Ue=u=>Se(u.state),et=u=>({Draft:"bg-gray-100 text-gray-800",Published:"bg-blue-100 text-blue-800",Progress:"bg-yellow-100 text-yellow-800",PendingSignatures:"bg-orange-100 text-orange-800",Completed:"bg-green-100 text-green-800",FullySigned:"bg-purple-100 text-purple-800",Rejected:"bg-red-100 text-red-800",Expired:"bg-gray-100 text-gray-800"})[u.state]||"bg-gray-100 text-gray-800",lt=u=>({Draft:"text-gray-500",Published:"text-blue-600",Progress:"text-yellow-600",PendingSignatures:"text-orange-600",Completed:"text-green-600",FullySigned:"text-purple-600",Rejected:"text-red-600",Expired:"text-gray-500"})[u.state]||"text-gray-400",it=u=>{if(u&&u.color)return{red:"bg-red-100 text-red-800",blue:"bg-blue-100 text-blue-800",green:"bg-green-100 text-green-800",yellow:"bg-yellow-100 text-yellow-800",purple:"bg-purple-100 text-purple-800",pink:"bg-pink-100 text-pink-800",indigo:"bg-indigo-100 text-indigo-800"}[u.color]||"bg-gray-100 text-gray-800";const g=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],H=u&&typeof u.id=="number"?u.id%g.length:0;return g[H]},gt=u=>u?new Date(u).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"}):"-",Lt=u=>u.summary_counterparty||"",It=u=>Kt(u),pt=u=>["Completed","FullySigned"].includes(u.state),Bt=u=>String(i.lastUpdatedDocumentId)===String(u),Rt=u=>{const g=ye.value.indexOf(u);g>-1?ye.value.splice(g,1):ye.value.push(u)},zt=u=>{Q.value=u,ge.value=!0},_t=()=>{ge.value=!1,Q.value=null},Ut=()=>{if(ve.value)ye.value=ye.value.filter(u=>!n.value.some(g=>g.id===u));else{const u=n.value.map(g=>g.id).filter(g=>!ye.value.includes(g));ye.value.push(...u)}},q=u=>{ne.value=u,_e.value=!0},F=()=>{const u=ye.value.length>0?_.value.filter(tt=>ye.value.includes(tt.id)):_.value,g=["Nombre Minuta","Estado","Etiquetas"],H=u.map(tt=>[tt.title||"",Ue(tt),tt.tags?tt.tags.map(Nt=>Nt.name).join(", "):""]),b=[g.join(","),...H.map(tt=>tt.map(Nt=>`"${Nt}"`).join(","))].join(`
`),Ce=new Blob([b],{type:"text/csv;charset=utf-8;"}),Ae=document.createElement("a"),Ye=URL.createObjectURL(Ce);Ae.setAttribute("href",Ye),Ae.setAttribute("download",`documentos_${new Date().toISOString().split("T")[0]}.csv`),Ae.style.visibility="hidden",document.body.appendChild(Ae),Ae.click(),document.body.removeChild(Ae)},ae=async(u,g)=>{var H;switch(u){case"preview":await G(g);break;case"edit":{const b=((H=c.currentUser)==null?void 0:H.role)||"client";v.cardType==="lawyer"&&v.context==="legal-documents"?p("edit",g,{userRole:b,renameOnly:!0}):p("edit",g,{userRole:b})}break;case"editForm":if(v.cardType==="lawyer"&&v.context==="legal-documents")try{const b=await i.fetchDocumentById(g.id,!0);i.selectedDocument=b,D.push("/dynamic_document_dashboard/lawyer/variables-config")}catch(b){console.error("Error al abrir la configuración de variables:",b)}else p("edit",g,{userRole:"client"});break;case"editDocument":v.cardType==="lawyer"&&v.context==="legal-documents"?D.push(`/dynamic_document_dashboard/lawyer/editor/edit/${g.id}`):D.push(`/dynamic_document_dashboard/client/editor/edit/${g.id}`);break;case"permissions":p("permissions",g);break;case"relationships":p("relationships",g);break;case"letterhead":p("letterhead",g);break;case"viewSignatures":case"signatures":p("signatures",g);break;case"publish":await d(g);break;case"draft":case"move-to-draft":await S(g);break;case"formalize":await E(g);break;case"sign":await te(g);break;case"delete":await U(g);break;case"downloadPDF":case"download-pdf":await re(g);break;case"downloadWord":case"download-word":await B(g);break;case"downloadSignedDocument":case"download-signed":await R(g);break;case"email":case"send":p("email",g);break;case"copy":await k(g);break;default:console.warn("Unknown action:",u)}},$=async(u,g)=>{_e.value=!1,await ae(u,g)},Ee=({documentId:u,count:g})=>{const H=i.documents.find(b=>b.id===u);H&&(H.relationships_count=g)};return ke(A,async(u,g)=>{if(!v.promptDocuments&&!(u===g||!u))try{const H=c.currentUser,b={page:u,limit:be.value,forceRefresh:!0};V.value&&(H!=null&&H.id)&&(b.lawyerId=H.id,b.states=["Draft","Published"]),we.value&&(H!=null&&H.id)&&(b.clientId=H.id,b.states=["Progress","Completed"]),await i.fetchDocuments(b)}catch(H){console.error("Error fetching documents for page change:",H)}}),ke(()=>_.value.length,()=>{A.value>l.value&&(A.value=Math.max(1,l.value))}),ke(x,u=>{y("update:searchQuery",u??"")}),ke(()=>v.searchQuery,u=>{u!=null&&(x.value=u)},{immediate:!0}),He(async()=>{if(await c.init(),!v.promptDocuments)try{const u=c.currentUser,g={page:1,limit:be.value,forceRefresh:!0};V.value&&(u!=null&&u.id)&&(g.lawyerId=u.id,g.states=["Draft","Published"]),we.value&&(u!=null&&u.id)&&(g.clientId=u.id,g.states=["Progress","Completed"]),await i.fetchDocuments(g)}catch(u){console.error("Error initializing documents for table:",u)}}),(u,g)=>{var H;return s(),o("div",null,[e("div",il,[e("div",dl,[e("div",cl,[r(t(Je),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),Fe(e("input",{"onUpdate:modelValue":g[0]||(g[0]=b=>x.value=b),type:"text",placeholder:"Buscar...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent text-sm"},null,512),[[Pe,x.value]])])]),e("div",ul,[a.showStateFilter?(s(),de(t(Le),{key:0,as:"div",class:"relative"},{default:T(()=>[r(t(Ie),{class:"w-full inline-flex items-center justify-between gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:T(()=>[e("div",ml,[r(t(at),{class:"h-4 w-4 flex-shrink-0"}),e("span",gl,m(ue.value||"Estado"),1)]),r(t(Qe),{class:"h-4 w-4 flex-shrink-0"})]),_:1}),r(t(Be),{class:"absolute left-0 z-10 mt-2 w-full min-w-[14rem] origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:T(()=>[e("div",pl,[r(t(xe),null,{default:T(({active:b})=>[e("a",{onClick:g[1]||(g[1]=Ce=>ue.value=null),class:j([b?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Todos ",2)]),_:1}),(s(!0),o(fe,null,he(a.availableStates,b=>(s(),de(t(xe),{key:b},{default:T(({active:Ce})=>[e("a",{onClick:Ae=>ue.value=b,class:j([Ce?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])},m(Se(b)),11,fl)]),_:2},1024))),128))])]),_:1})]),_:1})):f("",!0),r(t(Le),{as:"div",class:"relative"},{default:T(()=>[r(t(Ie),{class:"w-full inline-flex items-center justify-between gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:T(()=>[e("div",hl,[r(t(at),{class:"h-4 w-4 flex-shrink-0"}),e("span",yl,m(ze.value||"Etiqueta"),1)]),r(t(Qe),{class:"h-4 w-4 flex-shrink-0"})]),_:1}),r(t(Be),{class:"absolute left-0 z-10 mt-2 w-64 origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:T(()=>[e("div",vl,[e("div",bl,[r(t(Je),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),Fe(e("input",{"onUpdate:modelValue":g[2]||(g[2]=b=>z.value=b),type:"text",placeholder:"Buscar etiquetas...",class:"w-full pl-9 pr-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent",onClick:g[3]||(g[3]=pe(()=>{},["stop"]))},null,512),[[Pe,z.value]])]),e("div",xl,[r(t(xe),null,{default:T(({active:b})=>[e("a",{onClick:g[4]||(g[4]=Ce=>le.value=null),class:j([b?"bg-gray-100":"","block px-3 py-2 text-sm text-gray-700 cursor-pointer rounded-md"])}," Todos ",2)]),_:1}),(s(!0),o(fe,null,he(Re.value,b=>(s(),de(t(xe),{key:b.id},{default:T(({active:Ce})=>[e("a",{onClick:Ae=>le.value=b.id,class:j([Ce?"bg-gray-100":"","flex items-center gap-2 px-3 py-2 text-sm cursor-pointer rounded-md"])},[e("span",{class:j(["w-3 h-3 rounded-full flex-shrink-0",it(b)])},null,2),e("span",wl,m(b.name),1)],10,_l)]),_:2},1024))),128))])])]),_:1})]),_:1}),a.showClientFilter?(s(),de(t(Le),{key:1,as:"div",class:"relative"},{default:T(()=>[r(t(Ie),{class:"w-full inline-flex items-center justify-between gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:T(()=>[e("div",$l,[r(t(at),{class:"h-4 w-4 flex-shrink-0"}),e("span",kl,m(P.value||"Cliente"),1)]),r(t(Qe),{class:"h-4 w-4 flex-shrink-0"})]),_:1}),r(t(Be),{class:"absolute left-0 z-10 mt-2 w-64 origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:T(()=>[e("div",Cl,[e("div",Dl,[r(t(Je),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),Fe(e("input",{"onUpdate:modelValue":g[5]||(g[5]=b=>Y.value=b),type:"text",placeholder:"Buscar clientes...",class:"w-full pl-9 pr-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent",onClick:g[6]||(g[6]=pe(()=>{},["stop"]))},null,512),[[Pe,Y.value]])]),e("div",Fl,[r(t(xe),null,{default:T(({active:b})=>[e("a",{onClick:g[7]||(g[7]=Ce=>oe.value=null),class:j([b?"bg-gray-100":"","block px-3 py-2 text-sm text-gray-700 cursor-pointer rounded-md"])}," Todos ",2)]),_:1}),(s(!0),o(fe,null,he(ie.value,b=>(s(),de(t(xe),{key:b.id},{default:T(({active:Ce})=>[e("a",{onClick:Ae=>oe.value=b.id,class:j([Ce?"bg-gray-100":"","block px-3 py-2 text-sm text-gray-700 cursor-pointer rounded-md"])},m(b.first_name)+" "+m(b.last_name),11,Sl)]),_:2},1024))),128))])])]),_:1})]),_:1})):f("",!0)]),e("div",El,[e("div",Pl,[Tl,Fe(e("input",{"onUpdate:modelValue":g[8]||(g[8]=b=>C.value=b),type:"date",class:"w-full min-w-0 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent text-sm",placeholder:"Fecha inicio"},null,512),[[Pe,C.value]])]),e("div",jl,[Ml,Fe(e("input",{"onUpdate:modelValue":g[9]||(g[9]=b=>se.value=b),type:"date",class:"w-full min-w-0 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent text-sm",placeholder:"Fecha fin"},null,512),[[Pe,se.value]])])]),e("div",Al,[r(t(Le),{as:"div",class:"relative w-full sm:w-auto"},{default:T(()=>[r(t(Ie),{class:"w-full sm:w-auto inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:T(()=>[r(t(Bs),{class:"h-4 w-4"}),e("span",null,m(qe($e.value)),1),r(t(Qe),{class:"h-4 w-4"})]),_:1}),r(t(Be),{class:"absolute left-0 z-10 mt-2 w-56 origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:T(()=>[e("div",Ll,[(s(),o(fe,null,he(me,b=>r(t(xe),{key:b.value},{default:T(({active:Ce})=>[e("a",{onClick:Ae=>$e.value=b.value,class:j([Ce?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])},m(b.label),11,Il)]),_:2},1024)),64))])]),_:1})]),_:1}),e("div",Bl,[ye.value.length>0?(s(),o("button",{key:0,onClick:F,class:"flex-1 sm:flex-initial inline-flex items-center justify-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},[r(t(rt),{class:"h-4 w-4"}),e("span",null,"Exportar ("+m(ye.value.length)+")",1)])):f("",!0),ue.value||le.value||oe.value||C.value||se.value?(s(),o("button",{key:1,onClick:ce,class:"flex-1 sm:flex-initial inline-flex items-center justify-center gap-2 px-3 py-2 border border-gray-200 rounded-md bg-white text-xs font-medium text-gray-500 hover:bg-gray-50",title:"Limpiar filtros",type:"button"},[r(t(Te),{class:"h-4 w-4 flex-shrink-0"}),Rl])):f("",!0)])])]),a.isLoading?(s(),o("div",zl,Nl)):!a.isLoading&&n.value.length>0?(s(),o("div",Ol,[e("div",ql,[e("table",Vl,[e("thead",Ql,[e("tr",null,[Ne.value?(s(),o("th",Wl,[e("input",{type:"checkbox",checked:ve.value,onChange:Ut,class:"h-4 w-4 text-secondary focus:ring-secondary border-gray-300 rounded cursor-pointer"},null,40,Hl)])):f("",!0),Gl,Zl,Jl,Kl,Yl,Xl,ei,ti,si,a.showAssociationsColumn&&!W.value?(s(),o("th",oi," Asociaciones ")):f("",!0),ai])]),e("tbody",ri,[(s(!0),o(fe,null,he(n.value,b=>{var Ce,Ae;return s(),o("tr",{key:b.id,class:j(["hover:bg-gray-50 cursor-pointer transition-colors duration-150",Bt(b.id)?"bg-yellow-50":""]),onClick:Ye=>q(b)},[Ne.value?(s(),o("td",li,[e("input",{type:"checkbox",checked:ye.value.includes(b.id),onChange:pe(Ye=>Rt(b.id),["stop"]),class:"h-4 w-4 text-secondary focus:ring-secondary border-gray-300 rounded cursor-pointer"},null,40,ii)])):f("",!0),e("td",di,[e("div",ci,[r(t(Ve),{class:j(["h-5 w-5 flex-shrink-0",lt(b)])},null,8,["class"]),e("div",ui,[e("span",mi,m(b.title||"Sin título"),1)])])]),e("td",gi,[e("span",{class:j([et(b),"px-2 inline-flex text-xs leading-5 font-semibold rounded-full"])},m(Ue(b)),3)]),e("td",pi,[e("span",fi,m(Lt(b)||"-"),1)]),e("td",hi,[e("span",yi,m(b.summary_object||"-"),1)]),e("td",vi,[e("span",bi,m(It(b)||"-"),1)]),e("td",xi,[e("span",_i,m(b.summary_term||"-"),1)]),e("td",wi,[b.summary_subscription_date?(s(),o("span",$i,m(gt(b.summary_subscription_date)),1)):(s(),o("span",ki,"-"))]),e("td",Ci,[b.summary_start_date?(s(),o("span",Di,m(gt(b.summary_start_date)),1)):(s(),o("span",Fi,"-"))]),e("td",Si,[b.summary_end_date?(s(),o("span",Ei,m(gt(b.summary_end_date)),1)):(s(),o("span",Pi,"-"))]),a.showAssociationsColumn&&!W.value?(s(),o("td",Ti,[pt(b)?(s(),o("button",{key:0,onClick:pe(Ye=>t(p)("relationships",b),["stop"]),class:"inline-flex items-center gap-1 text-sm text-secondary hover:text-blue-700"},[r(t(gs),{class:"h-4 w-4"}),e("span",null,m(b.relationships_count||0),1)],8,ji)):(s(),o("span",Mi,m(b.relationships_count||0),1))])):f("",!0),e("td",Ai,[e("div",Li,[(s(!0),o(fe,null,he((Ce=b.tags)==null?void 0:Ce.slice(0,2),Ye=>(s(),o("span",{key:Ye.id,class:j([it(Ye),"px-2 py-1 text-xs rounded-full"])},m(Ye.name),3))),128)),((Ae=b.tags)==null?void 0:Ae.length)>2?(s(),o("button",{key:0,type:"button",class:"px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-600 hover:bg-gray-200 inline-flex items-center gap-1",onClick:pe(Ye=>zt(b),["stop"])},[e("span",null,"+"+m(b.tags.length-2),1)],8,Ii)):f("",!0)])])],10,ni)}),128))])])]),l.value>1?(s(),o("div",Bi,[e("div",Ri,[e("div",zi,[e("button",{onClick:g[10]||(g[10]=b=>A.value--),disabled:A.value===1,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Anterior ",8,Ui),e("button",{onClick:g[11]||(g[11]=b=>A.value++),disabled:A.value===l.value,class:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Siguiente ",8,Ni)]),e("div",Oi,[e("div",null,[v.promptDocuments?(s(),o("p",qi,[K(" Mostrando "),e("span",Vi,m((A.value-1)*be.value+1),1),K(" a "),e("span",Qi,m(Math.min(A.value*be.value,_.value.length)),1),K(" de "),e("span",Wi,m(_.value.length),1),K(" resultados ")])):(s(),o("p",Hi,[K(" Mostrando "),e("span",Gi,m(_.value.length===0?0:(t(i).pagination.currentPage-1)*t(i).pagination.itemsPerPage+1),1),K(" a "),e("span",Zi,m((t(i).pagination.currentPage-1)*t(i).pagination.itemsPerPage+_.value.length),1),K(" de "),e("span",Ji,m(t(i).pagination.totalItems),1),K(" resultados ")]))]),e("div",null,[e("nav",Ki,[e("button",{onClick:g[12]||(g[12]=b=>A.value--),disabled:A.value===1,class:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},[r(t(bt),{class:"h-5 w-5"})],8,Yi),(s(!0),o(fe,null,he(X.value,b=>(s(),o("button",{key:b,onClick:Ce=>typeof b=="number"?A.value=b:null,class:j([b===A.value?"z-10 bg-secondary border-secondary text-white":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50",typeof b=="string"?"cursor-default":"cursor-pointer","relative inline-flex items-center px-4 py-2 border text-sm font-medium"])},m(b),11,Xi))),128)),e("button",{onClick:g[13]||(g[13]=b=>A.value++),disabled:A.value===l.value,class:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},[r(t(ut),{class:"h-5 w-5"})],8,ed)])])])])])):f("",!0)])):!a.isLoading&&n.value.length===0?(s(),o("div",td,[r(t(Ve),{class:"mx-auto h-12 w-12 text-gray-400"}),sd,e("p",od,m(v.promptDocuments?"No se encontraron documentos":"Comienza creando un nuevo documento"),1)])):f("",!0),t(ot)?(s(),de(Ht,{key:3,"is-open":t(ot),document:t(Wt),onClose:g[14]||(g[14]=b=>ot.value=!1)},null,8,["is-open","document"])):f("",!0),t(M).edit.isOpen?(s(),de(t(Gt),{key:4,"is-open":t(M).edit.isOpen,document:t(M).edit.document,"user-role":t(M).edit.userRole||((H=t(c).currentUser)==null?void 0:H.role)||"client","show-editor-button":!t(M).edit.renameOnly,onClose:g[15]||(g[15]=b=>t(L)("edit")),onRefresh:g[16]||(g[16]=b=>y("refresh"))},null,8,["is-open","document","user-role","show-editor-button"])):f("",!0),J.value.email.isOpen?(s(),de(t(Zt),{key:5,"is-open":J.value.email.isOpen,document:J.value.email.document,onClose:g[17]||(g[17]=b=>t(L)("email")),onRefresh:g[18]||(g[18]=b=>y("refresh"))},null,8,["is-open","document"])):f("",!0),t(M).signatures.isOpen?(s(),de(t(us),{key:6,"is-open":t(M).signatures.isOpen,document:t(M).signatures.document,onClose:g[19]||(g[19]=b=>t(L)("signatures")),onRefresh:g[20]||(g[20]=b=>y("refresh"))},null,8,["is-open","document"])):f("",!0),t(M).permissions.isOpen?(s(),de(t(Ms),{key:7,"is-open":t(M).permissions.isOpen,document:t(M).permissions.document,onClose:g[21]||(g[21]=b=>t(L)("permissions")),onRefresh:g[22]||(g[22]=b=>y("refresh"))},null,8,["is-open","document"])):f("",!0),t(M).letterhead.isOpen?(s(),de(jt,{key:8,"is-visible":t(M).letterhead.isOpen,document:t(M).letterhead.document,onClose:g[23]||(g[23]=b=>t(L)("letterhead")),onRefresh:g[24]||(g[24]=b=>y("refresh"))},null,8,["is-visible","document"])):f("",!0),ee.value.isOpen?(s(),de(St,{key:9,"is-open":ee.value.isOpen,document:ee.value.document,onClose:g[25]||(g[25]=b=>t(L)("relationships")),onUpdateCount:Ee},null,8,["is-open","document"])):f("",!0),_e.value?(s(),de(At,{key:10,"is-visible":_e.value,document:ne.value,"card-type":a.cardType,context:v.context||"list","user-store":t(c),onClose:g[26]||(g[26]=b=>_e.value=!1),onRefresh:g[27]||(g[27]=b=>y("refresh")),onAction:$},null,8,["is-visible","document","card-type","context","user-store"])):f("",!0),ge.value&&Q.value?(s(),o("div",ad,[e("div",rd,[e("div",nd,[e("div",ld,[r(t(qt),{class:"h-5 w-5 text-gray-500"}),id]),e("button",{type:"button",class:"text-gray-400 hover:text-gray-600 p-1 rounded-md hover:bg-gray-100",onClick:_t},[r(t(Te),{class:"h-5 w-5"})])]),e("div",dd,[cd,e("span",ud,m(Q.value.title||"Sin título"),1)]),e("div",md,[!Q.value.tags||Q.value.tags.length===0?(s(),o("div",gd," Este documento no tiene etiquetas. ")):(s(),o("ul",pd,[(s(!0),o(fe,null,he(Q.value.tags,b=>(s(),o("li",{key:b.id,class:"flex items-center justify-between gap-2"},[e("div",fd,[e("span",{class:j(["inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",it(b)])},m(b.name),3)]),b.description?(s(),o("span",hd,m(b.description),1)):f("",!0)]))),128))]))]),e("div",{class:"px-4 py-3 border-t border-gray-100 flex justify-end"},[e("button",{type:"button",class:"px-4 py-2 text-sm font-medium rounded-md border border-gray-300 text-gray-700 bg-white hover:bg-gray-50",onClick:_t}," Cerrar ")])])])):f("",!0)])}}},yd={class:"mb-4"},vd={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6"},bd={class:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between"},xd={class:"flex flex-col sm:flex-row gap-3 flex-1 w-full lg:w-auto"},_d={class:"relative flex-1 min-w-[200px]"},wd={class:"max-w-[120px] truncate"},$d={class:"p-2"},kd={class:"relative mb-2"},Cd={class:"max-h-60 overflow-y-auto"},Dd=["onClick"],Fd={class:"truncate"},Sd={key:0,class:"px-3 py-2 text-sm text-gray-500 text-center"},Ed={class:"flex items-center gap-3 w-full lg:w-auto"},Pd={class:"text-sm text-gray-500 whitespace-nowrap"},Td={class:"py-1"},jd={key:0,class:"bg-white rounded-lg shadow-sm border border-gray-200"},Md={class:"min-w-full divide-y divide-gray-200"},Ad=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Plantilla "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etiquetas "),e("th",{scope:"col",class:"w-16 px-6 py-3"})])],-1),Ld={class:"bg-white divide-y divide-gray-200"},Id=["onClick"],Bd={class:"px-6 py-4 whitespace-nowrap"},Rd={class:"flex items-center"},zd={class:"flex-shrink-0 h-10 w-10"},Ud={class:"h-10 w-10 rounded-lg bg-purple-100 flex items-center justify-center"},Nd={class:"ml-4"},Od={class:"text-sm font-medium text-gray-900"},qd=e("td",{class:"px-6 py-4 whitespace-nowrap"},[e("span",{class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-purple-100 text-purple-700 border border-purple-200"}," Disponible ")],-1),Vd={class:"px-6 py-4 whitespace-nowrap"},Qd={class:"flex flex-wrap gap-1"},Wd={key:0,class:"px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-600"},Hd={key:1,class:"text-sm text-gray-400"},Gd={class:"py-1"},Zd=["onClick"],Jd={key:1,class:"bg-white rounded-b-lg border-t border-gray-200 px-4 py-3 sm:px-6"},Kd={class:"flex flex-col sm:flex-row items-center justify-between gap-3"},Yd={class:"text-sm text-gray-700"},Xd={class:"font-medium"},ec={class:"font-medium"},tc={class:"font-medium"},sc={class:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination"},oc=["disabled"],ac=e("span",{class:"sr-only"},"Anterior",-1),rc=["onClick"],nc={key:1,class:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700"},lc=["disabled"],ic=e("span",{class:"sr-only"},"Siguiente",-1),dc={key:2,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center"},cc=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No hay plantillas disponibles",-1),uc={class:"mt-1 text-sm text-gray-500"},mc=e("div",{class:"mt-4"},[e("div",{class:"text-xs text-gray-400 bg-gray-100 px-3 py-2 rounded-lg inline-block"},[K(" 💡 "),e("strong",null,"Tip:"),K(" Las plantillas son creadas por los abogados ")])],-1),gc={key:3,class:"text-center py-12"},pc=e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-secondary"},null,-1),fc=e("p",{class:"mt-2 text-sm text-gray-500"},"Cargando plantillas...",-1),hc=[pc,fc],ls={__name:"UseDocumentTable",props:{searchQuery:String,selectedTags:{type:Array,default:()=>[]}},emits:["go-back"],setup(a,{emit:w}){const i=Ge(),c=st(),D=w,v=h(""),y=h(""),M=h(null),p=h("recent"),L=h(!1),J=h(!1),ee=h(null),G=h({}),U=h({}),re=h(!1),B=h(-1),k=h([]),d=h({totalItems:0,totalPages:0,currentPage:1}),S=h(1),E=h(10),te=async(P=1)=>{L.value=!0;try{const N=await i.fetchDocumentsForTab({states:["Published"],unassigned:!0,page:P,limit:E.value});k.value=N.items||[],d.value={totalItems:N.totalItems||0,totalPages:N.totalPages||0,currentPage:N.currentPage||P}}catch(N){console.error("Error fetching published templates:",N),k.value=[]}finally{L.value=!1}},R=I(()=>k.value),x=I(()=>{let P=[...R.value];const N=v.value.toLowerCase();return N&&(P=P.filter(O=>{var ce,W;return((ce=O.title)==null?void 0:ce.toLowerCase().includes(N))||((W=O.tags)==null?void 0:W.some(V=>{var we;return(we=V.name)==null?void 0:we.toLowerCase().includes(N)}))})),M.value&&(P=P.filter(O=>O.tags&&O.tags.some(ce=>ce.id===M.value))),p.value==="name"?P.sort((O,ce)=>{const W=(O.title||"").toLowerCase(),V=(ce.title||"").toLowerCase();return W.localeCompare(V)}):p.value==="recent"&&P.sort((O,ce)=>ce.id-O.id),P}),z=I(()=>{const P=new Map;return R.value.forEach(N=>{N.tags&&N.tags.length>0&&N.tags.forEach(O=>{P.has(O.id)||P.set(O.id,O)})}),Array.from(P.values()).sort((N,O)=>N.name.localeCompare(O.name))}),Y=I(()=>{if(!y.value)return z.value;const P=y.value.toLowerCase();return z.value.filter(N=>N.name.toLowerCase().includes(P))}),ue=I(()=>{if(!M.value)return null;const P=z.value.find(N=>N.id===M.value);return P?P.name:null}),le=I(()=>{switch(p.value){case"name":return"Nombre (A-Z)";case"recent":default:return"Más recientes"}}),oe=I(()=>{const P=v.value&&v.value.trim().length>0,N=M.value!==null;return P&&N?"No se encontraron plantillas que coincidan con tu búsqueda y filtros":P?"No se encontraron plantillas que coincidan con tu búsqueda":N?"No se encontraron plantillas con la etiqueta seleccionada":"Aún no hay plantillas disponibles para usar"}),C=P=>{const N=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],O=P.id%N.length;return N[O]},se=P=>{const N=["bg-blue-500","bg-purple-500","bg-pink-500","bg-yellow-500","bg-green-500","bg-red-500","bg-indigo-500","bg-orange-500"],O=P.id%N.length;return N[O]},$e=()=>{M.value=null},ye=P=>{P&&(i.selectedDocument=null,ee.value=P,J.value=!0)},_e=()=>{J.value=!1,ee.value=null},ne=P=>{if(P.state==="Published"&&!P.assigned_to)ye(P.id);else{const O=`/dynamic_document_dashboard/document/use/editor/${P.id}/${encodeURIComponent(P.title.trim())}`;c.push(O)}},ge=()=>{D("go-back")},Q=I(()=>d.value.totalPages||1),A=I(()=>{const P=d.value.totalItems||0,N=P>0?(S.value-1)*E.value+1:0,O=Math.min(S.value*E.value,P);return{start:N,end:O,total:P}}),be=I(()=>{const P=[],N=Q.value,O=S.value;if(N<=7)for(let ce=1;ce<=N;ce++)P.push(ce);else{P.push(1),O>3&&P.push("...");const ce=Math.max(2,O-1),W=Math.min(N-1,O+1);for(let V=ce;V<=W;V++)P.push(V);O<N-2&&P.push("..."),P.push(N)}return P}),Ne=P=>{P>=1&&P<=Q.value&&(S.value=P)},Oe=()=>{S.value>1&&S.value--},Me=()=>{S.value<Q.value&&S.value++};ke(S,P=>{te(P)}),He(async()=>{await te(1)});const Re=()=>re.value?x.value.length===1?"280px":x.value.length===2&&B.value===1?"340px":"280px":"auto",ze=(P,N)=>{P&&(G.value[N]=P)},Z=(P,N)=>{P&&(U.value[N]=P)},ie=(P,N)=>{re.value=!N,B.value=N?-1:P,N||setTimeout(()=>{const O=U.value[P];if(O){const ce=O.$el||O;if(ce&&ce.getBoundingClientRect){const W=ce.getBoundingClientRect(),V=window.innerHeight;if(P===0){if(W.bottom>V-20){const we=W.bottom-V+40;window.scrollBy({top:we,behavior:"smooth"})}}else if(W.bottom>V-10){const we=W.bottom-V+30;window.scrollBy({top:we,behavior:"smooth"})}else if(W.top<80){const we=W.top-100;window.scrollBy({top:we,behavior:"smooth"})}}}},100)};return(P,N)=>(s(),o("div",null,[e("div",yd,[e("button",{onClick:ge,class:"inline-flex items-center gap-2 px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 rounded-lg transition-colors border border-gray-300"},[r(t(Rs),{class:"h-4 w-4"}),K(" Volver a Mis Documentos ")])]),e("div",vd,[e("div",bd,[e("div",xd,[e("div",_d,[r(t(Je),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),Fe(e("input",{"onUpdate:modelValue":N[0]||(N[0]=O=>v.value=O),type:"text",placeholder:"Buscar plantillas...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent"},null,512),[[Pe,v.value]])]),r(t(Le),{as:"div",class:"relative"},{default:T(()=>[r(t(Ie),{class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:T(()=>[r(t(at),{class:"h-4 w-4"}),e("span",wd,m(ue.value||"Etiqueta"),1),r(t(Qe),{class:"h-4 w-4"})]),_:1}),r(t(Be),{class:"absolute left-0 z-10 mt-2 w-64 origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:T(()=>[e("div",$d,[e("div",kd,[r(t(Je),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),Fe(e("input",{"onUpdate:modelValue":N[1]||(N[1]=O=>y.value=O),type:"text",placeholder:"Buscar etiquetas...",class:"w-full pl-9 pr-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent",onClick:N[2]||(N[2]=pe(()=>{},["stop"]))},null,512),[[Pe,y.value]])]),e("div",Cd,[r(t(xe),null,{default:T(({active:O})=>[e("a",{onClick:N[3]||(N[3]=ce=>M.value=null),class:j([O?"bg-gray-100":"","block px-3 py-2 text-sm text-gray-700 cursor-pointer rounded-md"])}," Todos ",2)]),_:1}),(s(!0),o(fe,null,he(Y.value,O=>(s(),de(t(xe),{key:O.id},{default:T(({active:ce})=>[e("a",{onClick:W=>M.value=O.id,class:j([ce?"bg-gray-100":"","flex items-center gap-2 px-3 py-2 text-sm cursor-pointer rounded-md"])},[e("span",{class:j(["w-3 h-3 rounded-full flex-shrink-0",se(O)])},null,2),e("span",Fd,m(O.name),1)],10,Dd)]),_:2},1024))),128)),Y.value.length===0?(s(),o("div",Sd," No se encontraron etiquetas ")):f("",!0)])])]),_:1})]),_:1}),M.value?(s(),o("button",{key:0,onClick:$e,class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",title:"Limpiar filtros"},[r(t(Te),{class:"h-4 w-4"}),K(" Limpiar ")])):f("",!0)]),e("div",Ed,[e("span",Pd," Mostrando "+m(x.value.length)+" plantillas ",1),r(t(Le),{as:"div",class:"relative"},{default:T(()=>[r(t(Ie),{class:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:T(()=>[K(" Ordenar: "+m(le.value)+" ",1),r(t(Qe),{class:"h-4 w-4"})]),_:1}),r(t(Be),{class:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:T(()=>[e("div",Td,[r(t(xe),null,{default:T(({active:O})=>[e("a",{onClick:N[4]||(N[4]=ce=>p.value="recent"),class:j([O?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Más recientes ",2)]),_:1}),r(t(xe),null,{default:T(({active:O})=>[e("a",{onClick:N[5]||(N[5]=ce=>p.value="name"),class:j([O?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Nombre (A-Z) ",2)]),_:1})])]),_:1})]),_:1})])])]),x.value.length>0?(s(),o("div",jd,[e("div",{class:"overflow-x-auto",style:We({minHeight:Re()})},[e("table",Md,[Ad,e("tbody",Ld,[(s(!0),o(fe,null,he(x.value,(O,ce)=>{var W;return s(),o("tr",{key:O.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:V=>ne(O)},[e("td",Bd,[e("div",Rd,[e("div",zd,[e("div",Ud,[r(t(Ve),{class:"h-5 w-5 text-purple-600"})])]),e("div",Nd,[e("div",Od,m(O.title),1)])])]),qd,e("td",Vd,[e("div",Qd,[(s(!0),o(fe,null,he((W=O.tags)==null?void 0:W.slice(0,2),V=>(s(),o("span",{key:V.id,class:j(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",C(V)])},m(V.name),3))),128)),O.tags&&O.tags.length>2?(s(),o("span",Wd," +"+m(O.tags.length-2),1)):f("",!0),!O.tags||O.tags.length===0?(s(),o("span",Hd,"-")):f("",!0)])]),e("td",{class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",onClick:N[6]||(N[6]=pe(()=>{},["stop"]))},[r(t(Le),{as:"div",class:"relative inline-block text-left"},{default:T(({open:V})=>[r(t(Ie),{ref_for:!0,ref:we=>ze(we,ce),onClick:we=>ie(ce,V),class:"inline-flex items-center justify-center w-8 h-8 rounded-md hover:bg-gray-100"},{default:T(()=>[r(t(ct),{class:"h-5 w-5 text-gray-500"})]),_:2},1032,["onClick"]),r(t(Be),{ref_for:!0,ref:we=>Z(we,ce),class:j([x.value.length>2&&ce>0&&ce>=x.value.length-3?"absolute right-0 z-[9999] bottom-full mb-2 w-48 origin-bottom-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none":"absolute right-0 z-[9999] mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"])},{default:T(()=>[e("div",Gd,[r(t(xe),null,{default:T(({active:we})=>[e("a",{onClick:_=>ne(O),class:j([we?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Usar plantilla ",10,Zd)]),_:2},1024)])]),_:2},1032,["class"])]),_:2},1024)])],8,Id)}),128))])])],4)])):f("",!0),Q.value>1?(s(),o("div",Jd,[e("div",Kd,[e("div",Yd,[K(" Mostrando "),e("span",Xd,m(A.value.start),1),K(" a "),e("span",ec,m(A.value.end),1),K(" de "),e("span",tc,m(A.value.total),1),K(" plantillas ")]),e("div",null,[e("nav",sc,[e("button",{onClick:Oe,disabled:S.value===1,class:j(["relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",S.value===1?"opacity-50 cursor-not-allowed":""])},[ac,r(t(bt),{class:"h-5 w-5","aria-hidden":"true"})],10,oc),(s(!0),o(fe,null,he(be.value,O=>(s(),o(fe,{key:O},[O!=="..."?(s(),o("button",{key:0,onClick:ce=>Ne(O),class:j(["relative inline-flex items-center px-4 py-2 text-sm font-semibold focus:z-20 focus:outline-offset-0",S.value===O?"z-10 bg-secondary text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-secondary":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50"])},m(O),11,rc)):(s(),o("span",nc," ... "))],64))),128)),e("button",{onClick:Me,disabled:S.value===Q.value,class:j(["relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",S.value===Q.value?"opacity-50 cursor-not-allowed":""])},[ic,r(t(ut),{class:"h-5 w-5","aria-hidden":"true"})],10,lc)])])])])):f("",!0),x.value.length===0&&!L.value?(s(),o("div",dc,[r(t(Mt),{class:"mx-auto h-12 w-12 text-gray-400"}),cc,e("p",uc,m(oe.value),1),mc])):f("",!0),L.value?(s(),o("div",gc,hc)):f("",!0),Fe(r(Ke,null,{default:T(()=>[ee.value!==null?(s(),de(fs,{key:0,"document-id":ee.value,onClose:_e},null,8,["document-id"])):f("",!0)]),_:1},512),[[vt,J.value]])]))}},yc={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-3 sm:p-4 mb-6"},vc={class:"mb-4"},bc={class:"relative w-full"},xc={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-3"},_c={class:"flex items-center gap-2 min-w-0"},wc={class:"truncate"},$c={class:"py-1"},kc=["onClick"],Cc={class:"flex items-center justify-stretch"},Dc=e("span",null,"Limpiar",-1),Fc={class:"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-4"},Sc={class:"flex flex-col gap-1"},Ec=e("label",{class:"text-xs font-medium text-gray-600"},"Fecha inicio",-1),Pc={class:"flex flex-col gap-1"},Tc=e("label",{class:"text-xs font-medium text-gray-600"},"Fecha fin",-1),jc={class:"flex flex-col gap-3 pt-4 border-t border-gray-200"},Mc={class:"flex flex-col sm:flex-row gap-3 items-start sm:items-center justify-between"},Ac={class:"flex items-center gap-2"},Lc=e("span",{class:"hidden sm:inline"},"Exportar",-1),Ic={class:"py-1"},Bc=e("span",{class:"hidden sm:inline"},"Ordenar:",-1),Rc={class:"py-1"},zc={class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",style:{"overflow-x":"visible","overflow-y":"hidden"}},Uc={class:"overflow-x-auto",style:{"overflow-y":"visible"}},Nc={class:"min-w-full divide-y divide-gray-200"},Oc={class:"bg-gray-50"},qc={scope:"col",class:"w-12 px-6 py-3"},Vc=["checked"],Qc=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Nombre Documento ",-1),Wc=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Cliente ",-1),Hc=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado ",-1),Gc=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Docs. Asociados ",-1),Zc=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etiqueta ",-1),Jc={class:"bg-white divide-y divide-gray-200"},Kc=["onClick"],Yc=["checked","onChange"],Xc={class:"px-6 py-4 whitespace-nowrap"},eu={class:"flex items-center"},tu={class:"flex-shrink-0 h-10 w-10"},su={class:"h-10 w-10 rounded-lg bg-green-100 flex items-center justify-center"},ou={class:"ml-4"},au={class:"text-sm font-medium text-gray-900"},ru={class:"px-6 py-4 whitespace-nowrap"},nu={class:"text-sm text-gray-900"},lu=e("td",{class:"px-6 py-4 whitespace-nowrap"},[e("span",{class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-700 border border-green-200"}," Completado ")],-1),iu={class:"px-6 py-4 whitespace-nowrap"},du=["onClick"],cu={class:"px-6 py-4 whitespace-nowrap"},uu={class:"flex flex-wrap gap-1"},mu={key:0,class:"px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-600"},gu={key:1,class:"text-sm text-gray-400"},pu={key:0,class:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"},fu={class:"flex flex-1 justify-between sm:hidden"},hu=["disabled"],yu=["disabled"],vu={class:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between"},bu={class:"text-sm text-gray-700"},xu={class:"font-medium"},_u={class:"font-medium"},wu={class:"font-medium"},$u={class:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination"},ku=["disabled"],Cu=e("span",{class:"sr-only"},"Anterior",-1),Du=["onClick"],Fu={key:1,class:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700"},Su=["disabled"],Eu=e("span",{class:"sr-only"},"Siguiente",-1),Pu={key:0,class:"text-center py-12"},Tu=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No hay documentos completados",-1),ju=e("p",{class:"mt-1 text-sm text-gray-500"},"Los documentos completados por clientes aparecerán aquí.",-1),Mu={key:1,class:"text-center py-12"},Au=e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-secondary"},null,-1),Lu=e("p",{class:"mt-2 text-sm text-gray-500"},"Cargando documentos...",-1),Iu=[Au,Lu],Bu={__name:"DocumentFinishedByClientListTable",props:{searchQuery:String,selectedTags:{type:Array,default:()=>[]}},emits:["refresh"],setup(a,{emit:w}){const i=Ge(),c=Xe(),D=st(),v=w,{activeModals:y,openModal:M,closeModal:p,getUserRole:L}=Pt(i,c),{handlePreviewDocument:J,deleteDocument:ee,downloadPDFDocument:G,downloadWordDocument:U}=Tt(i,c,v),re=h(""),B=h(null),k=h(""),d=h(""),S=h("recent"),E=h([]),te=h([]),R=h({totalItems:0,totalPages:0,currentPage:1}),x=h(1),z=h(10),Y=h(!1),ue=async(_=1)=>{Y.value=!0;try{const n=await i.fetchDocumentsForTab({state:"Completed",page:_,limit:z.value});te.value=n.items||[],R.value={totalItems:n.totalItems||0,totalPages:n.totalPages||0,currentPage:n.currentPage||_}}catch(n){console.error("Error fetching completed documents:",n),te.value=[]}finally{Y.value=!1}};He(async()=>{await c.init(),await ue(1)});const le=I(()=>te.value),oe=I(()=>{let _=[...le.value];const n=re.value.toLowerCase();return n&&(_=_.filter(l=>{var X,ve;return((X=l.title)==null?void 0:X.toLowerCase().includes(n))||((ve=l.tags)==null?void 0:ve.some(me=>{var qe;return(qe=me.name)==null?void 0:qe.toLowerCase().includes(n)}))})),B.value&&(_=_.filter(l=>l.tags&&l.tags.some(X=>X.id===B.value))),(k.value||d.value)&&(_=_.filter(l=>{const X=l.summary_subscription_date||l.created_at||l.updated_at;if(!X)return!1;const ve=new Date(X);if(isNaN(ve.getTime()))return!1;if(k.value){const me=new Date(k.value);if(ve<me)return!1}if(d.value){const me=new Date(d.value);if(me.setHours(23,59,59,999),ve>me)return!1}return!0})),S.value==="name"?_.sort((l,X)=>{const ve=(l.title||"").toLowerCase(),me=(X.title||"").toLowerCase();return ve.localeCompare(me)}):S.value==="recent"&&_.sort((l,X)=>{const ve=new Date(l.updated_at||l.created_at);return new Date(X.updated_at||X.created_at)-ve}),_}),C=I(()=>oe.value),se=I(()=>R.value.totalPages||1),$e=I(()=>{const _=R.value.totalItems||0,n=_>0?(x.value-1)*z.value+1:0,l=Math.min(x.value*z.value,_);return{start:n,end:l,total:_}});ke([re,B,k,d],()=>{x.value=1}),ke(x,_=>{ue(_)});const ye=I(()=>{const _=new Map;return le.value.forEach(n=>{n.tags&&n.tags.length>0&&n.tags.forEach(l=>{_.has(l.id)||_.set(l.id,l)})}),Array.from(_.values()).sort((n,l)=>n.name.localeCompare(l.name))}),_e=I(()=>{if(!B.value)return null;const _=ye.value.find(n=>n.id===B.value);return _?_.name:null}),ne=I(()=>{switch(S.value){case"name":return"Nombre (A-Z)";case"recent":default:return"Más recientes"}}),ge=_=>_.summary_counterparty?_.summary_counterparty:"Cliente",Q=_=>{const n=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],l=_.id%n.length;return n[l]},A=I(()=>oe.value.length>0&&E.value.length===oe.value.length),be=()=>{A.value?E.value=[]:E.value=oe.value.map(_=>_.id)},Ne=_=>{const n=E.value.indexOf(_);n>-1?E.value.splice(n,1):E.value.push(_)},Oe=()=>{E.value=oe.value.map(_=>_.id)},Me=()=>{E.value=[]},Re=()=>{B.value=null,k.value="",d.value=""},ze=()=>{x.value>1&&x.value--},Z=()=>{x.value<se.value&&x.value++},ie=_=>{_>=1&&_<=se.value&&(x.value=_)},P=I(()=>{const _=se.value,n=x.value,l=[];if(_<=7)for(let X=1;X<=_;X++)l.push(X);else if(n<=4){for(let X=1;X<=5;X++)l.push(X);l.push("..."),l.push(_)}else if(n>=_-3){l.push(1),l.push("...");for(let X=_-4;X<=_;X++)l.push(X)}else l.push(1),l.push("..."),l.push(n-1),l.push(n),l.push(n+1),l.push("..."),l.push(_);return l}),N=()=>{const _=E.value.length>0?oe.value.filter(Se=>E.value.includes(Se.id)):oe.value,n=["Nombre Documento","Cliente","Estado","Etiquetas"],l=_.map(Se=>[Se.title||"",ge(Se),"Completado",Se.tags?Se.tags.map(Ue=>Ue.name).join(", "):""]),X=[n.join(","),...l.map(Se=>Se.map(Ue=>`"${Ue}"`).join(","))].join(`
`),ve=new Blob([X],{type:"text/csv;charset=utf-8;"}),me=document.createElement("a"),qe=URL.createObjectURL(ve);me.setAttribute("href",qe),me.setAttribute("download",`documentos_completados_${new Date().toISOString().split("T")[0]}.csv`),me.style.visibility="hidden",document.body.appendChild(me),me.click(),document.body.removeChild(me)},O=async(_,n)=>{try{switch(_){case"editForm":M("edit",n,{userRole:L()});break;case"editDocument":D.push(`/dynamic_document_dashboard/client/editor/edit/${n.id}`);break;case"preview":await J(n);break;case"delete":await ee(n);break;case"letterhead":M("letterhead",n);break;case"relationships":M("relationships",n);break;case"downloadPDF":await G(n);break;case"downloadWord":await U(n);break;case"email":M("email",n);break;default:console.warn("Unknown action:",_)}}catch(l){console.error(`Error executing action ${_}:`,l)}},ce=h(!1),W=h(null),V=_=>{W.value=_,ce.value=!0},we=async(_,n)=>{ce.value=!1,await O(_,n)};return(_,n)=>(s(),o("div",null,[e("div",yc,[e("div",vc,[e("div",bc,[r(t(Je),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),Fe(e("input",{"onUpdate:modelValue":n[0]||(n[0]=l=>re.value=l),type:"text",placeholder:"Buscar...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent text-sm"},null,512),[[Pe,re.value]])])]),e("div",xc,[r(t(Le),{as:"div",class:"relative"},{default:T(()=>[r(t(Ie),{class:"w-full inline-flex items-center justify-between gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:T(()=>[e("div",_c,[r(t(at),{class:"h-4 w-4 flex-shrink-0"}),e("span",wc,m(_e.value||"Etiqueta"),1)]),r(t(Qe),{class:"h-4 w-4 flex-shrink-0"})]),_:1}),r(t(Be),{class:"absolute left-0 z-10 mt-2 w-full min-w-[16rem] origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none max-h-60 overflow-y-auto"},{default:T(()=>[e("div",$c,[r(t(xe),null,{default:T(({active:l})=>[e("a",{onClick:n[1]||(n[1]=X=>B.value=null),class:j([l?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Todos ",2)]),_:1}),(s(!0),o(fe,null,he(ye.value,l=>(s(),de(t(xe),{key:l.id},{default:T(({active:X})=>[e("a",{onClick:ve=>B.value=l.id,class:j([X?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])},m(l.name),11,kc)]),_:2},1024))),128))])]),_:1})]),_:1}),e("div",Cc,[B.value||k.value||d.value?(s(),o("button",{key:0,onClick:Re,class:"w-full inline-flex items-center justify-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",title:"Limpiar filtros"},[r(t(Te),{class:"h-4 w-4 flex-shrink-0"}),Dc])):f("",!0)])]),e("div",Fc,[e("div",Sc,[Ec,Fe(e("input",{"onUpdate:modelValue":n[2]||(n[2]=l=>k.value=l),type:"date",class:"w-full min-w-0 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent text-sm",placeholder:"Fecha inicio"},null,512),[[Pe,k.value]])]),e("div",Pc,[Tc,Fe(e("input",{"onUpdate:modelValue":n[3]||(n[3]=l=>d.value=l),type:"date",class:"w-full min-w-0 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent text-sm",placeholder:"Fecha fin"},null,512),[[Pe,d.value]])])]),e("div",jc,[e("div",Mc,[e("div",Ac,[e("button",{onClick:N,class:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},[r(t(rt),{class:"h-4 w-4"}),Lc]),r(t(Le),{as:"div",class:"relative"},{default:T(()=>[r(t(Ie),{class:"inline-flex items-center justify-center w-10 h-10 rounded-md hover:bg-gray-100"},{default:T(()=>[r(t(ct),{class:"h-5 w-5 text-gray-500"})]),_:1}),r(t(Be),{class:"absolute left-0 sm:left-auto sm:right-0 z-10 mt-2 w-48 origin-top-left sm:origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:T(()=>[e("div",Ic,[r(t(xe),null,{default:T(({active:l})=>[e("a",{onClick:Oe,class:j([l?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Seleccionar todo ",2)]),_:1}),r(t(xe),null,{default:T(({active:l})=>[e("a",{onClick:Me,class:j([l?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Deseleccionar todo ",2)]),_:1})])]),_:1})]),_:1})]),r(t(Le),{as:"div",class:"relative"},{default:T(()=>[r(t(Ie),{class:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:T(()=>[Bc,K(" "+m(ne.value)+" ",1),r(t(Qe),{class:"h-4 w-4"})]),_:1}),r(t(Be),{class:"absolute left-0 sm:left-auto sm:right-0 z-10 mt-2 w-48 origin-top-left sm:origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:T(()=>[e("div",Rc,[r(t(xe),null,{default:T(({active:l})=>[e("a",{onClick:n[4]||(n[4]=X=>S.value="recent"),class:j([l?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Más recientes ",2)]),_:1}),r(t(xe),null,{default:T(({active:l})=>[e("a",{onClick:n[5]||(n[5]=X=>S.value="name"),class:j([l?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Nombre (A-Z) ",2)]),_:1})])]),_:1})]),_:1})])])]),e("div",zc,[e("div",Uc,[e("table",Nc,[e("thead",Oc,[e("tr",null,[e("th",qc,[e("input",{type:"checkbox",checked:A.value,onChange:be,class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,Vc)]),Qc,Wc,Hc,Gc,Zc])]),e("tbody",Jc,[(s(!0),o(fe,null,he(C.value,(l,X)=>{var ve;return s(),o("tr",{key:l.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:me=>V(l)},[e("td",{class:"px-6 py-4 whitespace-nowrap",onClick:n[6]||(n[6]=pe(()=>{},["stop"]))},[e("input",{type:"checkbox",checked:E.value.includes(l.id),onChange:me=>Ne(l.id),class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,Yc)]),e("td",Xc,[e("div",eu,[e("div",tu,[e("div",su,[r(t(Ve),{class:"h-5 w-5 text-green-600"})])]),e("div",ou,[e("div",au,m(l.title),1)])])]),e("td",ru,[e("div",nu,m(ge(l)),1)]),lu,e("td",iu,[e("button",{type:"button",class:"inline-flex items-center px-3 py-1.5 rounded-full text-xs font-medium border border-indigo-200 text-indigo-700 bg-indigo-50 hover:bg-indigo-100",onClick:pe(me=>t(M)("relationships",l),["stop"])}," Ver asociaciones ",8,du)]),e("td",cu,[e("div",uu,[(s(!0),o(fe,null,he((ve=l.tags)==null?void 0:ve.slice(0,2),me=>(s(),o("span",{key:me.id,class:j(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",Q(me)])},m(me.name),3))),128)),l.tags&&l.tags.length>2?(s(),o("span",mu," +"+m(l.tags.length-2),1)):f("",!0),!l.tags||l.tags.length===0?(s(),o("span",gu,"-")):f("",!0)])])],8,Kc)}),128))])])]),se.value>1?(s(),o("div",pu,[e("div",fu,[e("button",{onClick:ze,disabled:x.value===1,class:j(["relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",x.value===1?"opacity-50 cursor-not-allowed":""])}," Anterior ",10,hu),e("button",{onClick:Z,disabled:x.value===se.value,class:j(["relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",x.value===se.value?"opacity-50 cursor-not-allowed":""])}," Siguiente ",10,yu)]),e("div",vu,[e("div",null,[e("p",bu,[K(" Mostrando "),e("span",xu,m($e.value.start),1),K(" a "),e("span",_u,m($e.value.end),1),K(" de "),e("span",wu,m($e.value.total),1),K(" resultados ")])]),e("div",null,[e("nav",$u,[e("button",{onClick:ze,disabled:x.value===1,class:j(["relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",x.value===1?"opacity-50 cursor-not-allowed":""])},[Cu,r(t(bt),{class:"h-5 w-5","aria-hidden":"true"})],10,ku),(s(!0),o(fe,null,he(P.value,l=>(s(),o(fe,{key:l},[l!=="..."?(s(),o("button",{key:0,onClick:X=>ie(l),class:j(["relative inline-flex items-center px-4 py-2 text-sm font-semibold focus:z-20 focus:outline-offset-0",x.value===l?"z-10 bg-secondary text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-secondary":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50"])},m(l),11,Du)):(s(),o("span",Fu," ... "))],64))),128)),e("button",{onClick:Z,disabled:x.value===se.value,class:j(["relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",x.value===se.value?"opacity-50 cursor-not-allowed":""])},[Eu,r(t(ut),{class:"h-5 w-5","aria-hidden":"true"})],10,Su)])])])])):f("",!0)]),oe.value.length===0&&!Y.value?(s(),o("div",Pu,[r(t(Mt),{class:"mx-auto h-12 w-12 text-gray-400"}),Tu,ju])):f("",!0),Y.value?(s(),o("div",Mu,Iu)):f("",!0),(s(),de(Qt,{to:"body"},[t(y).edit.isOpen?(s(),de(t(Gt),{key:0,document:t(y).edit.document,"user-role":t(L)(),onClose:n[7]||(n[7]=l=>t(p)("edit")),onRefresh:n[8]||(n[8]=l=>v("refresh"))},null,8,["document","user-role"])):f("",!0),t(y).email.isOpen?(s(),de(t(Zt),{key:1,document:t(y).email.document,onClose:n[9]||(n[9]=l=>t(p)("email"))},null,8,["document"])):f("",!0),t(y).letterhead.isOpen?(s(),de(jt,{key:2,"is-visible":t(y).letterhead.isOpen,document:t(y).letterhead.document,onClose:n[10]||(n[10]=l=>t(p)("letterhead")),onUploaded:n[11]||(n[11]=l=>v("refresh")),onDeleted:n[12]||(n[12]=l=>v("refresh"))},null,8,["is-visible","document"])):f("",!0),t(y).relationships.isOpen?(s(),de(St,{key:3,"is-open":t(y).relationships.isOpen,document:t(y).relationships.document,onClose:n[13]||(n[13]=l=>t(p)("relationships")),onRefresh:n[14]||(n[14]=l=>v("refresh"))},null,8,["is-open","document"])):f("",!0),ce.value?(s(),de(At,{key:4,"is-visible":ce.value,document:W.value,"card-type":"client",context:"table","user-store":t(c),onClose:n[15]||(n[15]=l=>ce.value=!1),onAction:we},null,8,["is-visible","document","user-store"])):f("",!0)]))]))}},Ru={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-3 sm:p-4 mb-6"},zu={class:"mb-4"},Uu={class:"relative w-full"},Nu={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-3"},Ou={class:"flex items-center gap-2 min-w-0"},qu={class:"truncate"},Vu={class:"py-1"},Qu=["onClick"],Wu={class:"flex items-center justify-stretch"},Hu=e("span",null,"Limpiar",-1),Gu={class:"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-4"},Zu={class:"flex flex-col gap-1"},Ju=e("label",{class:"text-xs font-medium text-gray-600"},"Fecha inicio",-1),Ku={class:"flex flex-col gap-1"},Yu=e("label",{class:"text-xs font-medium text-gray-600"},"Fecha fin",-1),Xu={class:"flex flex-col gap-3 pt-4 border-t border-gray-200"},em={class:"flex flex-col sm:flex-row gap-3 items-start sm:items-center justify-between"},tm={class:"flex items-center gap-2"},sm=e("span",{class:"hidden sm:inline"},"Exportar",-1),om={class:"py-1"},am=e("span",{class:"hidden sm:inline"},"Ordenar:",-1),rm={class:"py-1"},nm={class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",style:{"overflow-x":"visible","overflow-y":"hidden"}},lm={class:"overflow-x-auto",style:{"overflow-y":"visible"}},im={class:"min-w-full divide-y divide-gray-200"},dm={class:"bg-gray-50"},cm={scope:"col",class:"w-12 px-6 py-3"},um=["checked"],mm=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Nombre Documento ",-1),gm=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Cliente ",-1),pm=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado ",-1),fm=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Docs. Asociados ",-1),hm=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etiqueta ",-1),ym={class:"bg-white divide-y divide-gray-200"},vm=["onClick"],bm=["checked","onChange"],xm={class:"px-6 py-4 whitespace-nowrap"},_m={class:"flex items-center"},wm={class:"flex-shrink-0 h-10 w-10"},$m={class:"h-10 w-10 rounded-lg bg-blue-100 flex items-center justify-center"},km={class:"ml-4"},Cm={class:"text-sm font-medium text-gray-900"},Dm={class:"px-6 py-4 whitespace-nowrap"},Fm={class:"text-sm text-gray-900"},Sm=e("td",{class:"px-6 py-4 whitespace-nowrap"},[e("span",{class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-700 border border-blue-200"}," En Progreso ")],-1),Em={class:"px-6 py-4 whitespace-nowrap"},Pm=["onClick"],Tm={class:"px-6 py-4 whitespace-nowrap"},jm={class:"flex flex-wrap gap-1"},Mm={key:0,class:"px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-600"},Am={key:1,class:"text-sm text-gray-400"},Lm={key:0,class:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"},Im={class:"flex flex-1 justify-between sm:hidden"},Bm=["disabled"],Rm=["disabled"],zm={class:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between"},Um={class:"text-sm text-gray-700"},Nm={class:"font-medium"},Om={class:"font-medium"},qm={class:"font-medium"},Vm={class:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination"},Qm=["disabled"],Wm=e("span",{class:"sr-only"},"Anterior",-1),Hm=["onClick"],Gm={key:1,class:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700"},Zm=["disabled"],Jm=e("span",{class:"sr-only"},"Siguiente",-1),Km={key:0,class:"text-center py-12"},Ym=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No hay documentos en progreso",-1),Xm=e("p",{class:"mt-1 text-sm text-gray-500"},"Los documentos en progreso por clientes aparecerán aquí.",-1),e0={key:1,class:"text-center py-12"},t0=e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-secondary"},null,-1),s0=e("p",{class:"mt-2 text-sm text-gray-500"},"Cargando documentos...",-1),o0=[t0,s0],a0={__name:"DocumentInProgressByClientListTable",props:{searchQuery:String,selectedTags:{type:Array,default:()=>[]}},emits:["refresh"],setup(a,{emit:w}){const i=Ge(),c=Xe(),D=st(),v=w,{activeModals:y,openModal:M,closeModal:p,getUserRole:L}=Pt(i,c),{handlePreviewDocument:J,deleteDocument:ee,downloadPDFDocument:G,downloadWordDocument:U}=Tt(i,c,v),re=h(""),B=h(null),k=h(""),d=h(""),S=h("recent"),E=h([]),te=h([]),R=h({totalItems:0,totalPages:0,currentPage:1}),x=h(1),z=h(10),Y=h(!1),ue=async(_=1)=>{Y.value=!0;try{const n=await i.fetchDocumentsForTab({state:"Progress",page:_,limit:z.value});te.value=n.items||[],R.value={totalItems:n.totalItems||0,totalPages:n.totalPages||0,currentPage:n.currentPage||_}}catch(n){console.error("Error fetching progress documents:",n),te.value=[]}finally{Y.value=!1}};He(async()=>{await c.init(),await ue(1)});const le=I(()=>te.value),oe=I(()=>{let _=[...le.value];const n=re.value.toLowerCase();return n&&(_=_.filter(l=>{var X,ve;return((X=l.title)==null?void 0:X.toLowerCase().includes(n))||((ve=l.tags)==null?void 0:ve.some(me=>{var qe;return(qe=me.name)==null?void 0:qe.toLowerCase().includes(n)}))})),B.value&&(_=_.filter(l=>l.tags&&l.tags.some(X=>X.id===B.value))),(k.value||d.value)&&(_=_.filter(l=>{const X=l.summary_subscription_date||l.created_at||l.updated_at;if(!X)return!1;const ve=new Date(X);if(isNaN(ve.getTime()))return!1;if(k.value){const me=new Date(k.value);if(ve<me)return!1}if(d.value){const me=new Date(d.value);if(me.setHours(23,59,59,999),ve>me)return!1}return!0})),S.value==="name"?_.sort((l,X)=>{const ve=(l.title||"").toLowerCase(),me=(X.title||"").toLowerCase();return ve.localeCompare(me)}):S.value==="recent"&&_.sort((l,X)=>{const ve=new Date(l.updated_at||l.created_at);return new Date(X.updated_at||X.created_at)-ve}),_}),C=I(()=>oe.value),se=I(()=>R.value.totalPages||1),$e=I(()=>{const _=R.value.totalItems||0,n=_>0?(x.value-1)*z.value+1:0,l=Math.min(x.value*z.value,_);return{start:n,end:l,total:_}});ke([re,B,k,d],()=>{x.value=1}),ke(x,_=>{ue(_)});const ye=I(()=>{const _=new Map;return le.value.forEach(n=>{n.tags&&n.tags.length>0&&n.tags.forEach(l=>{_.has(l.id)||_.set(l.id,l)})}),Array.from(_.values()).sort((n,l)=>n.name.localeCompare(l.name))}),_e=I(()=>{if(!B.value)return null;const _=ye.value.find(n=>n.id===B.value);return _?_.name:null}),ne=I(()=>{switch(S.value){case"name":return"Nombre (A-Z)";case"recent":default:return"Más recientes"}}),ge=_=>_.summary_counterparty?_.summary_counterparty:"Cliente",Q=_=>{const n=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],l=_.id%n.length;return n[l]},A=I(()=>oe.value.length>0&&E.value.length===oe.value.length),be=()=>{A.value?E.value=[]:E.value=oe.value.map(_=>_.id)},Ne=_=>{const n=E.value.indexOf(_);n>-1?E.value.splice(n,1):E.value.push(_)},Oe=()=>{E.value=oe.value.map(_=>_.id)},Me=()=>{E.value=[]},Re=()=>{B.value=null,k.value="",d.value=""},ze=()=>{x.value>1&&x.value--},Z=()=>{x.value<se.value&&x.value++},ie=_=>{_>=1&&_<=se.value&&(x.value=_)},P=I(()=>{const _=se.value,n=x.value,l=[];if(_<=7)for(let X=1;X<=_;X++)l.push(X);else if(n<=4){for(let X=1;X<=5;X++)l.push(X);l.push("..."),l.push(_)}else if(n>=_-3){l.push(1),l.push("...");for(let X=_-4;X<=_;X++)l.push(X)}else l.push(1),l.push("..."),l.push(n-1),l.push(n),l.push(n+1),l.push("..."),l.push(_);return l}),N=()=>{const _=E.value.length>0?oe.value.filter(Se=>E.value.includes(Se.id)):oe.value,n=["Nombre Documento","Cliente","Estado","Etiquetas"],l=_.map(Se=>[Se.title||"",ge(Se),"En Progreso",Se.tags?Se.tags.map(Ue=>Ue.name).join(", "):""]),X=[n.join(","),...l.map(Se=>Se.map(Ue=>`"${Ue}"`).join(","))].join(`
`),ve=new Blob([X],{type:"text/csv;charset=utf-8;"}),me=document.createElement("a"),qe=URL.createObjectURL(ve);me.setAttribute("href",qe),me.setAttribute("download",`documentos_en_progreso_${new Date().toISOString().split("T")[0]}.csv`),me.style.visibility="hidden",document.body.appendChild(me),me.click(),document.body.removeChild(me)},O=async(_,n)=>{try{switch(_){case"editForm":M("edit",n,{userRole:L()});break;case"editDocument":D.push(`/dynamic_document_dashboard/client/editor/edit/${n.id}`);break;case"preview":await J(n);break;case"delete":await ee(n);break;case"letterhead":M("letterhead",n);break;case"relationships":M("relationships",n);break;case"downloadPDF":await G(n);break;case"downloadWord":await U(n);break;case"email":M("email",n);break;default:console.warn("Unknown action:",_)}}catch(l){console.error(`Error executing action ${_}:`,l)}},ce=h(!1),W=h(null),V=_=>{W.value=_,ce.value=!0},we=async(_,n)=>{ce.value=!1,await O(_,n)};return(_,n)=>(s(),o("div",null,[e("div",Ru,[e("div",zu,[e("div",Uu,[r(t(Je),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),Fe(e("input",{"onUpdate:modelValue":n[0]||(n[0]=l=>re.value=l),type:"text",placeholder:"Buscar...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent text-sm"},null,512),[[Pe,re.value]])])]),e("div",Nu,[r(t(Le),{as:"div",class:"relative"},{default:T(()=>[r(t(Ie),{class:"w-full inline-flex items-center justify-between gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:T(()=>[e("div",Ou,[r(t(at),{class:"h-4 w-4 flex-shrink-0"}),e("span",qu,m(_e.value||"Etiqueta"),1)]),r(t(Qe),{class:"h-4 w-4 flex-shrink-0"})]),_:1}),r(t(Be),{class:"absolute left-0 z-10 mt-2 w-full min-w-[16rem] origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none max-h-60 overflow-y-auto"},{default:T(()=>[e("div",Vu,[r(t(xe),null,{default:T(({active:l})=>[e("a",{onClick:n[1]||(n[1]=X=>B.value=null),class:j([l?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Todos ",2)]),_:1}),(s(!0),o(fe,null,he(ye.value,l=>(s(),de(t(xe),{key:l.id},{default:T(({active:X})=>[e("a",{onClick:ve=>B.value=l.id,class:j([X?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])},m(l.name),11,Qu)]),_:2},1024))),128))])]),_:1})]),_:1}),e("div",Wu,[B.value||k.value||d.value?(s(),o("button",{key:0,onClick:Re,class:"w-full inline-flex items-center justify-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",title:"Limpiar filtros"},[r(t(Te),{class:"h-4 w-4 flex-shrink-0"}),Hu])):f("",!0)])]),e("div",Gu,[e("div",Zu,[Ju,Fe(e("input",{"onUpdate:modelValue":n[2]||(n[2]=l=>k.value=l),type:"date",class:"w-full min-w-0 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent text-sm",placeholder:"Fecha inicio"},null,512),[[Pe,k.value]])]),e("div",Ku,[Yu,Fe(e("input",{"onUpdate:modelValue":n[3]||(n[3]=l=>d.value=l),type:"date",class:"w-full min-w-0 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent text-sm",placeholder:"Fecha fin"},null,512),[[Pe,d.value]])])]),e("div",Xu,[e("div",em,[e("div",tm,[e("button",{onClick:N,class:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},[r(t(rt),{class:"h-4 w-4"}),sm]),r(t(Le),{as:"div",class:"relative"},{default:T(()=>[r(t(Ie),{class:"inline-flex items-center justify-center w-10 h-10 rounded-md hover:bg-gray-100"},{default:T(()=>[r(t(ct),{class:"h-5 w-5 text-gray-500"})]),_:1}),r(t(Be),{class:"absolute left-0 sm:left-auto sm:right-0 z-10 mt-2 w-48 origin-top-left sm:origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:T(()=>[e("div",om,[r(t(xe),null,{default:T(({active:l})=>[e("a",{onClick:Oe,class:j([l?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Seleccionar todo ",2)]),_:1}),r(t(xe),null,{default:T(({active:l})=>[e("a",{onClick:Me,class:j([l?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Deseleccionar todo ",2)]),_:1})])]),_:1})]),_:1})]),r(t(Le),{as:"div",class:"relative"},{default:T(()=>[r(t(Ie),{class:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:T(()=>[am,K(" "+m(ne.value)+" ",1),r(t(Qe),{class:"h-4 w-4"})]),_:1}),r(t(Be),{class:"absolute left-0 sm:left-auto sm:right-0 z-10 mt-2 w-48 origin-top-left sm:origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:T(()=>[e("div",rm,[r(t(xe),null,{default:T(({active:l})=>[e("a",{onClick:n[4]||(n[4]=X=>S.value="recent"),class:j([l?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Más recientes ",2)]),_:1}),r(t(xe),null,{default:T(({active:l})=>[e("a",{onClick:n[5]||(n[5]=X=>S.value="name"),class:j([l?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Nombre (A-Z) ",2)]),_:1})])]),_:1})]),_:1})])])]),e("div",nm,[e("div",lm,[e("table",im,[e("thead",dm,[e("tr",null,[e("th",cm,[e("input",{type:"checkbox",checked:A.value,onChange:be,class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,um)]),mm,gm,pm,fm,hm])]),e("tbody",ym,[(s(!0),o(fe,null,he(C.value,(l,X)=>{var ve;return s(),o("tr",{key:l.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:me=>V(l)},[e("td",{class:"px-6 py-4 whitespace-nowrap",onClick:n[6]||(n[6]=pe(()=>{},["stop"]))},[e("input",{type:"checkbox",checked:E.value.includes(l.id),onChange:me=>Ne(l.id),class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,bm)]),e("td",xm,[e("div",_m,[e("div",wm,[e("div",$m,[r(t(Ve),{class:"h-5 w-5 text-blue-600"})])]),e("div",km,[e("div",Cm,m(l.title),1)])])]),e("td",Dm,[e("div",Fm,m(ge(l)),1)]),Sm,e("td",Em,[e("button",{type:"button",class:"inline-flex items-center px-3 py-1.5 rounded-full text-xs font-medium border border-indigo-200 text-indigo-700 bg-indigo-50 hover:bg-indigo-100",onClick:pe(me=>t(M)("relationships",l),["stop"])}," Ver asociaciones ",8,Pm)]),e("td",Tm,[e("div",jm,[(s(!0),o(fe,null,he((ve=l.tags)==null?void 0:ve.slice(0,2),me=>(s(),o("span",{key:me.id,class:j(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",Q(me)])},m(me.name),3))),128)),l.tags&&l.tags.length>2?(s(),o("span",Mm," +"+m(l.tags.length-2),1)):f("",!0),!l.tags||l.tags.length===0?(s(),o("span",Am,"-")):f("",!0)])])],8,vm)}),128))])])]),se.value>1?(s(),o("div",Lm,[e("div",Im,[e("button",{onClick:ze,disabled:x.value===1,class:j(["relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",x.value===1?"opacity-50 cursor-not-allowed":""])}," Anterior ",10,Bm),e("button",{onClick:Z,disabled:x.value===se.value,class:j(["relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",x.value===se.value?"opacity-50 cursor-not-allowed":""])}," Siguiente ",10,Rm)]),e("div",zm,[e("div",null,[e("p",Um,[K(" Mostrando "),e("span",Nm,m($e.value.start),1),K(" a "),e("span",Om,m($e.value.end),1),K(" de "),e("span",qm,m($e.value.total),1),K(" resultados ")])]),e("div",null,[e("nav",Vm,[e("button",{onClick:ze,disabled:x.value===1,class:j(["relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",x.value===1?"opacity-50 cursor-not-allowed":""])},[Wm,r(t(bt),{class:"h-5 w-5","aria-hidden":"true"})],10,Qm),(s(!0),o(fe,null,he(P.value,l=>(s(),o(fe,{key:l},[l!=="..."?(s(),o("button",{key:0,onClick:X=>ie(l),class:j(["relative inline-flex items-center px-4 py-2 text-sm font-semibold focus:z-20 focus:outline-offset-0",x.value===l?"z-10 bg-secondary text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-secondary":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50"])},m(l),11,Hm)):(s(),o("span",Gm," ... "))],64))),128)),e("button",{onClick:Z,disabled:x.value===se.value,class:j(["relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",x.value===se.value?"opacity-50 cursor-not-allowed":""])},[Jm,r(t(ut),{class:"h-5 w-5","aria-hidden":"true"})],10,Zm)])])])])):f("",!0)]),oe.value.length===0&&!Y.value?(s(),o("div",Km,[r(t(Mt),{class:"mx-auto h-12 w-12 text-gray-400"}),Ym,Xm])):f("",!0),Y.value?(s(),o("div",e0,o0)):f("",!0),(s(),de(Qt,{to:"body"},[t(y).edit.isOpen?(s(),de(t(Gt),{key:0,document:t(y).edit.document,"user-role":t(L)(),onClose:n[7]||(n[7]=l=>t(p)("edit")),onRefresh:n[8]||(n[8]=l=>v("refresh"))},null,8,["document","user-role"])):f("",!0),t(y).email.isOpen?(s(),de(t(Zt),{key:1,document:t(y).email.document,onClose:n[9]||(n[9]=l=>t(p)("email"))},null,8,["document"])):f("",!0),t(y).letterhead.isOpen?(s(),de(jt,{key:2,"is-visible":t(y).letterhead.isOpen,document:t(y).letterhead.document,onClose:n[10]||(n[10]=l=>t(p)("letterhead")),onUploaded:n[11]||(n[11]=l=>v("refresh")),onDeleted:n[12]||(n[12]=l=>v("refresh"))},null,8,["is-visible","document"])):f("",!0),t(y).relationships.isOpen?(s(),de(St,{key:3,"is-open":t(y).relationships.isOpen,document:t(y).relationships.document,onClose:n[13]||(n[13]=l=>t(p)("relationships")),onRefresh:n[14]||(n[14]=l=>v("refresh"))},null,8,["is-open","document"])):f("",!0),ce.value?(s(),de(At,{key:4,"is-visible":ce.value,document:W.value,"card-type":"client",context:"table","user-store":t(c),onClose:n[15]||(n[15]=l=>ce.value=!1),onAction:we},null,8,["is-visible","document","user-store"])):f("",!0)]))]))}},r0={class:"bg-white rounded-xl shadow-xl max-w-lg w-full mx-4"},n0={class:"flex items-center justify-between px-4 py-3 border-b border-gray-200"},l0=e("h2",{class:"text-sm font-semibold text-gray-900"}," Información clave del documento ",-1),i0=e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"none",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.8",d:"M6 6l8 8M6 14L14 6"})],-1),d0=[i0],c0={class:"px-4 py-4 space-y-4 text-sm text-gray-800 max-h-[70vh] overflow-y-auto"},u0={key:0},m0=e("div",{class:"text-[11px] font-medium uppercase tracking-wide text-gray-400 mb-0.5"}," Usuario / Contraparte ",-1),g0={class:"text-gray-900 break-words"},p0={key:1},f0=e("div",{class:"text-[11px] font-medium uppercase tracking-wide text-gray-400 mb-0.5"}," Objeto ",-1),h0={class:"text-gray-900 whitespace-pre-line"},y0={key:2},v0=e("div",{class:"text-[11px] font-medium uppercase tracking-wide text-gray-400 mb-0.5"}," Valor ",-1),b0={class:"text-gray-900 font-medium text-base"},x0={key:3},_0=e("div",{class:"text-[11px] font-medium uppercase tracking-wide text-gray-400 mb-0.5"}," Plazo ",-1),w0={class:"text-gray-900"},$0={key:4},k0=e("div",{class:"text-[11px] font-medium uppercase tracking-wide text-gray-400 mb-0.5"}," Fechas ",-1),C0={class:"space-y-1 text-gray-900"},D0={key:0},F0=e("span",{class:"font-medium"},"Suscripción:",-1),S0={class:"ml-1"},E0={key:1},P0=e("span",{class:"font-medium"},"Vigencia:",-1),T0={class:"ml-1"},j0={key:0},M0={key:1},A0={key:2},L0={key:5,class:"text-gray-400 text-sm"},I0={class:"px-4 py-3 border-t border-gray-100 flex justify-end"},B0={__name:"DocumentSummaryModal",props:{isVisible:{type:Boolean,default:!1},document:{type:Object,default:null}},emits:["close"],setup(a,{emit:w}){const i=a,c=I(()=>i.document&&i.document.summary_counterparty||""),D=I(()=>i.document?Kt(i.document):""),v=I(()=>i.document?!!(i.document.summary_subscription_date||i.document.summary_start_date||i.document.summary_end_date):!1),y=I(()=>i.document?!!(c.value||i.document.summary_object||D.value||i.document.summary_term||v.value):!1),M=p=>p?typeof p=="string"?p.split("T")[0]:p:"";return(p,L)=>a.isVisible&&a.document?(s(),o("div",{key:0,class:"fixed inset-0 z-[60] flex items-center justify-center bg-black/30 backdrop-blur-sm",onClick:L[2]||(L[2]=pe(J=>p.$emit("close"),["self"]))},[e("div",r0,[e("div",n0,[l0,e("button",{type:"button",class:"p-1 rounded-full text-gray-400 hover:text-gray-600 hover:bg-gray-100",onClick:L[0]||(L[0]=J=>p.$emit("close"))},d0)]),e("div",c0,[c.value?(s(),o("div",u0,[m0,e("div",g0,m(c.value),1)])):f("",!0),a.document.summary_object?(s(),o("div",p0,[f0,e("div",h0,m(a.document.summary_object),1)])):f("",!0),D.value?(s(),o("div",y0,[v0,e("div",b0,m(D.value),1)])):f("",!0),a.document.summary_term?(s(),o("div",x0,[_0,e("div",w0,m(a.document.summary_term),1)])):f("",!0),v.value?(s(),o("div",$0,[k0,e("div",C0,[a.document.summary_subscription_date?(s(),o("div",D0,[F0,e("span",S0,m(M(a.document.summary_subscription_date)),1)])):f("",!0),a.document.summary_start_date||a.document.summary_end_date?(s(),o("div",E0,[P0,e("span",T0,[a.document.summary_start_date?(s(),o("span",j0,m(M(a.document.summary_start_date)),1)):f("",!0),a.document.summary_start_date&&a.document.summary_end_date?(s(),o("span",M0," → ")):f("",!0),a.document.summary_end_date?(s(),o("span",A0,m(M(a.document.summary_end_date)),1)):f("",!0)])])):f("",!0)])])):f("",!0),y.value?f("",!0):(s(),o("div",L0," Este documento aún no tiene campos clasificados para mostrar. "))]),e("div",I0,[e("button",{type:"button",class:"inline-flex items-center px-3 py-1.5 rounded-md text-xs font-medium text-gray-700 bg-gray-100 hover:bg-gray-200",onClick:L[1]||(L[1]=J=>p.$emit("close"))}," Cerrar ")])])])):f("",!0)}},R0={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-3 sm:p-4 mb-6"},z0={class:"mb-4"},U0={class:"relative w-full"},N0={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-3"},O0={class:"flex items-center gap-2 min-w-0"},q0={class:"truncate"},V0={class:"p-2"},Q0={class:"relative mb-2"},W0={class:"max-h-60 overflow-y-auto"},H0=["onClick"],G0={class:"truncate"},Z0={key:0,class:"px-3 py-2 text-sm text-gray-500 text-center"},J0={class:"flex items-center justify-stretch"},K0=e("span",null,"Limpiar",-1),Y0={class:"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-4"},X0={class:"flex flex-col gap-1"},eg=e("label",{class:"text-xs font-medium text-gray-600"},"Fecha inicio",-1),tg={class:"flex flex-col gap-1"},sg=e("label",{class:"text-xs font-medium text-gray-600"},"Fecha fin",-1),og={class:"flex flex-col gap-3 pt-4 border-t border-gray-200"},ag={class:"flex flex-col sm:flex-row gap-3 items-start sm:items-center justify-between"},rg={class:"flex items-center gap-2"},ng=e("span",{class:"hidden sm:inline"},"Exportar",-1),lg={class:"py-1"},ig=e("span",{class:"hidden sm:inline"},"Ordenar:",-1),dg={class:"py-1"},cg={class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",style:{"overflow-x":"visible","overflow-y":"hidden"}},ug={class:"overflow-x-auto",style:{"overflow-y":"visible"}},mg={class:"min-w-full divide-y divide-gray-200"},gg={class:"bg-gray-50"},pg={scope:"col",class:"w-12 px-6 py-3"},fg=["checked"],hg=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Nombre Documento ",-1),yg=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado Firma ",-1),vg=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Contraparte ",-1),bg=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Objeto ",-1),xg=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Valor ",-1),_g=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Plazo ",-1),wg=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Fechas ",-1),$g={key:0,scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},kg={key:1,scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},Cg=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Etiqueta ",-1),Dg={class:"bg-white divide-y divide-gray-200"},Fg=["onClick"],Sg=["checked","onChange"],Eg={class:"px-6 py-4 whitespace-nowrap"},Pg={class:"flex items-center"},Tg={class:"flex-shrink-0 h-10 w-10"},jg={class:"h-10 w-10 rounded-lg bg-purple-100 flex items-center justify-center"},Mg={class:"ml-4"},Ag={class:"text-sm font-medium text-gray-900"},Lg={class:"px-6 py-4 whitespace-nowrap"},Ig={class:"px-6 py-4 whitespace-nowrap"},Bg={class:"text-sm text-gray-900"},Rg={class:"px-6 py-4 whitespace-nowrap"},zg={class:"text-sm text-gray-900 line-clamp-2 max-w-xs"},Ug={class:"px-6 py-4 whitespace-nowrap"},Ng={class:"text-sm text-gray-900"},Og={class:"px-6 py-4 whitespace-nowrap"},qg={class:"text-sm text-gray-900"},Vg={class:"px-6 py-4 whitespace-nowrap"},Qg={class:"text-xs text-gray-900 space-y-0.5"},Wg={key:0},Hg=e("span",{class:"font-medium"},"Suscripción:",-1),Gg={class:"ml-1"},Zg={key:1},Jg=e("span",{class:"font-medium"},"Vigencia:",-1),Kg={class:"ml-1"},Yg={key:0},Xg={key:1},ep={key:2},tp={key:2,class:"text-gray-400"},sp={key:0,class:"px-6 py-4 whitespace-nowrap"},op={key:0,class:"text-sm text-gray-900"},ap={key:1,class:"text-sm text-gray-400"},rp={key:1,class:"px-6 py-4 whitespace-nowrap"},np=["disabled","onClick"],lp={key:0},ip={key:1},dp={class:"px-6 py-4 whitespace-nowrap"},cp={class:"flex flex-wrap gap-1"},up={key:0,class:"px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-600"},mp={key:1,class:"text-sm text-gray-400"},gp={key:0,class:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"},pp={class:"flex flex-1 justify-between sm:hidden"},fp=["disabled"],hp=["disabled"],yp={class:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between"},vp={class:"text-sm text-gray-700"},bp={class:"font-medium"},xp={class:"font-medium"},_p={class:"font-medium"},wp={class:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination"},$p=["disabled"],kp=e("span",{class:"sr-only"},"Anterior",-1),Cp=["onClick"],Dp={key:1,class:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700"},Fp=["disabled"],Sp=e("span",{class:"sr-only"},"Siguiente",-1),Ep={key:0,class:"text-center py-12"},Pp={class:"mt-2 text-sm font-medium text-gray-900"},Tp={class:"mt-1 text-sm text-gray-500"},jp={key:1,class:"text-center py-12"},Mp=e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-secondary"},null,-1),Ap=e("p",{class:"mt-2 text-sm text-gray-500"},"Cargando documentos...",-1),Lp=[Mp,Ap],Ip={key:5,class:"fixed inset-0 z-[70] flex items-center justify-center bg-black/40"},Bp={class:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4"},Rp={class:"px-4 py-3 border-b border-gray-200 flex items-center justify-between"},zp=e("h2",{class:"text-sm font-semibold text-gray-900"},"Rechazar documento",-1),Up={class:"px-4 py-4 space-y-3 text-sm text-gray-700"},Np={class:"font-semibold"},Op=e("p",{class:"text-xs text-gray-500"}," El rechazo devolverá el documento al abogado creador para que pueda revisarlo, editarlo o archivarlo. ",-1),qp=e("label",{class:"block text-xs font-medium text-gray-600 mb-1"}," Motivo del rechazo (opcional) ",-1),Vp={key:6,class:"fixed inset-0 z-[70] flex items-center justify-center bg-black/40"},Qp={class:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4"},Wp={class:"px-4 py-3 border-b border-gray-200 flex items-center justify-between"},Hp=e("h2",{class:"text-sm font-semibold text-gray-900"},"Motivo del rechazo",-1),Gp={class:"px-4 py-4 text-sm text-gray-700 whitespace-pre-line"},Zp={class:"px-4 py-3 border-t border-gray-100 flex justify-end bg-gray-50"},dt={__name:"SignaturesListTable",props:{state:{type:String,required:!0,validator:a=>["PendingSignatures","FullySigned","Archived"].includes(a)},searchQuery:{type:String,default:""},selectedTags:{type:Array,default:()=>[]}},emits:["refresh","document-fully-signed","document-rejected","open-electronic-signature"],setup(a,{expose:w,emit:i}){const c=a,D=i,v=Xe(),y=Ge(),M=st(),{activeModals:p,openModal:L,closeModal:J,getUserRole:ee}=Pt(y,v),{handlePreviewDocument:G,downloadPDFDocument:U,signDocument:re,downloadSignedDocument:B}=Tt(y,v,D),k=h(!1),d=h(""),S=h(""),E=h(null),te=h(""),R=h(""),x=h("recent"),z=h([]),Y=h(!1),ue=h(null),le=h([]),oe=h({totalItems:0,totalPages:0,currentPage:1}),C=h(1),se=h(10),$e=async(q=1)=>{k.value=!0;try{const F={page:q,limit:se.value,userRelated:!0};c.state==="PendingSignatures"?F.state="PendingSignatures":c.state==="FullySigned"?(F.state="FullySigned",F.signerSigned=!0):c.state==="Archived"&&(F.states=["Rejected","Expired"]);const ae=await y.fetchDocumentsForTab(F);le.value=ae.items||[],oe.value={totalItems:ae.totalItems||0,totalPages:ae.totalPages||0,currentPage:ae.currentPage||q}}catch(F){console.error("Error fetching tab data:",F),le.value=[]}finally{k.value=!1}},ye=I(()=>c.state==="PendingSignatures"?"No tienes documentos pendientes por firmar":c.state==="FullySigned"?"No tienes documentos firmados":"No tienes documentos archivados"),_e=I(()=>c.state==="PendingSignatures"?"Cuando tengas documentos que requieran tu firma electrónica aparecerán aquí.":c.state==="FullySigned"?"Una vez que firmes documentos electrónicamente, aparecerán aquí.":"Aquí aparecerán los documentos rechazados o expirados relacionados contigo."),ne=I(()=>{let q=[...le.value];const F=d.value.toLowerCase();return F&&(q=q.filter(ae=>{var $,Ee;return(($=ae.title)==null?void 0:$.toLowerCase().includes(F))||((Ee=ae.tags)==null?void 0:Ee.some(u=>{var g;return(g=u.name)==null?void 0:g.toLowerCase().includes(F)}))})),E.value&&(q=q.filter(ae=>ae.tags&&ae.tags.some($=>$.id===E.value))),(te.value||R.value)&&(q=q.filter(ae=>{const $=ae.summary_subscription_date||ae.created_at||ae.updated_at;if(!$)return!1;const Ee=new Date($);if(isNaN(Ee.getTime()))return!1;if(te.value){const u=new Date(te.value);if(Ee<u)return!1}if(R.value){const u=new Date(R.value);if(u.setHours(23,59,59,999),Ee>u)return!1}return!0})),x.value==="name"?q.sort((ae,$)=>{const Ee=(ae.title||"").toLowerCase(),u=($.title||"").toLowerCase();return Ee.localeCompare(u)}):x.value==="recent"&&q.sort((ae,$)=>{const Ee=new Date(ae.updated_at||ae.created_at);return new Date($.updated_at||$.created_at)-Ee}),q}),ge=I(()=>ne.value),Q=I(()=>oe.value.totalPages||1),A=I(()=>{const q=oe.value.totalItems||0,F=q>0?(C.value-1)*se.value+1:0,ae=Math.min(C.value*se.value,q);return{start:F,end:ae,total:q}});ke([d,E,te,R],()=>{C.value=1});const be=I(()=>{const q=new Map;return le.value.forEach(F=>{F.tags&&F.tags.length>0&&F.tags.forEach(ae=>{q.has(ae.id)||q.set(ae.id,ae)})}),Array.from(q.values()).sort((F,ae)=>F.name.localeCompare(ae.name))}),Ne=I(()=>{if(!S.value)return be.value;const q=S.value.toLowerCase();return be.value.filter(F=>F.name.toLowerCase().includes(q))}),Oe=I(()=>{if(!E.value)return null;const q=be.value.find(F=>F.id===E.value);return q?q.name:null}),Me=q=>{const F=["bg-blue-500","bg-purple-500","bg-pink-500","bg-yellow-500","bg-green-500","bg-red-500","bg-indigo-500","bg-orange-500"],ae=q.id%F.length;return F[ae]},Re=I(()=>{switch(x.value){case"name":return"Nombre (A-Z)";case"recent":default:return"Más recientes"}}),ze=q=>{const F=["bg-blue-100 text-blue-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-yellow-100 text-yellow-700","bg-green-100 text-green-700"],ae=q.id%F.length;return F[ae]},Z=q=>c.state==="FullySigned"?"bg-green-100 text-green-700 border border-green-200":c.state==="Archived"?q.state==="Rejected"?"bg-red-100 text-red-700 border border-red-200":(q.state==="Expired","bg-gray-100 text-gray-700 border border-gray-200"):"bg-yellow-100 text-yellow-700 border border-yellow-200",ie=q=>c.state==="FullySigned"?"Firmado":c.state==="Archived"?q.state==="Rejected"?"Rechazado":q.state==="Expired"?"Expirado":"Archivado":"Pendiente",P=I(()=>ne.value.length>0&&z.value.length===ne.value.length),N=()=>{P.value?z.value=[]:z.value=ne.value.map(q=>q.id)},O=q=>{const F=z.value.indexOf(q);F>-1?z.value.splice(F,1):z.value.push(q)},ce=()=>{z.value=ne.value.map(q=>q.id)},W=()=>{z.value=[]},V=()=>{E.value=null,te.value="",R.value=""},we=()=>{C.value>1&&C.value--},_=()=>{C.value<Q.value&&C.value++},n=q=>{q>=1&&q<=Q.value&&(C.value=q)},l=q=>q?typeof q=="string"?q.split("T")[0]:q:"",X=I(()=>{const q=Q.value,F=C.value,ae=[];if(q<=7)for(let $=1;$<=q;$++)ae.push($);else if(F<=4){for(let $=1;$<=5;$++)ae.push($);ae.push("..."),ae.push(q)}else if(F>=q-3){ae.push(1),ae.push("...");for(let $=q-4;$<=q;$++)ae.push($)}else ae.push(1),ae.push("..."),ae.push(F-1),ae.push(F),ae.push(F+1),ae.push("..."),ae.push(q);return ae}),ve=()=>{const q=z.value.length>0?ne.value.filter(H=>z.value.includes(H.id)):ne.value,F=["Nombre Documento","Estado Firma","Etiquetas"],ae=q.map(H=>[H.title||"",ie(H),H.tags?H.tags.map(b=>b.name).join(", "):""]),$=[F.join(","),...ae.map(H=>H.map(b=>`"${b}"`).join(","))].join(`
`),Ee=new Blob([$],{type:"text/csv;charset=utf-8;"}),u=document.createElement("a"),g=URL.createObjectURL(Ee);u.setAttribute("href",g),u.setAttribute("download",`documentos_firmas_${new Date().toISOString().split("T")[0]}.csv`),u.style.visibility="hidden",document.body.appendChild(u),u.click(),document.body.removeChild(u)},me=h(!1),qe=h(null),Se=h(!1),Ue=h(null),et=h(""),lt=h(!1),it=h(""),gt=q=>{qe.value=q,me.value=!0},Lt=async(q,F)=>{me.value=!1,await It(q,F)},It=async(q,F)=>{try{switch(q){case"preview":await G(F);break;case"letterhead":L("letterhead",F);break;case"relationships":L("relationships",F);break;case"viewSignatures":L("signatures",F);break;case"sign":await re(F,L);break;case"reject":Ue.value=F,et.value="",Se.value=!0;break;case"viewRejectionReason":{const ae=(F.signatures||[]).find($=>$.rejection_comment);ae&&ae.rejection_comment?(it.value=ae.rejection_comment,lt.value=!0):await De("Este documento no tiene un motivo de rechazo registrado.","info");break}case"downloadSignedDocument":await B(F);break;case"downloadPDF":await U(F);break;case"editAndResend":{if(F&&F.id&&F.title){const ae=encodeURIComponent(F.title.trim()),$=`/dynamic_document_dashboard/document/use/correction/${F.id}/${ae}`;M.push($)}else console.warn("Cannot navigate to correction mode: invalid document data",F);break}default:console.warn("Unknown action:",q)}}catch(ae){console.error(`Error executing action ${q}:`,ae)}},pt=()=>{Se.value=!1,Ue.value=null,et.value=""},Bt=async()=>{if(!Ue.value)return;const q=Ue.value,F=q.id,ae=v.currentUser.id;try{const $=`dynamic-documents/${F}/reject/${ae}/`,Ee=et.value?{comment:et.value}:{},u=await cs($,Ee);u&&(u.status===200||u.status===201)?(pt(),D("document-rejected",q),Promise.all([De("Documento rechazado correctamente.","success"),Ds(Fs.FINISH,`Rechazaste el documento "${q.title}"`).catch(g=>console.warn("No se pudo registrar la actividad de rechazo:",g)),$e(C.value)]).then(()=>{D("refresh")})):await De("Error al rechazar el documento.","error")}catch($){console.error("Error rejecting document:",$),await De("Error al rechazar el documento.","error")}},Rt=async()=>{await $e(C.value)},zt=async()=>{await Rt(),D("refresh")};He(async()=>{await $e(1)}),w({refresh:zt});const _t=q=>{var ae;if(!q.summary_counterparty)return null;const F=(ae=q.variables)==null?void 0:ae.find($=>$.summary_field==="counterparty");return(F==null?void 0:F.value)||q.summary_counterparty},Ut=q=>Kt(q)||null;return ke(()=>v.currentUser,()=>{$e(1)}),ke(C,q=>{$e(q)}),(q,F)=>{var ae;return s(),o("div",null,[e("div",R0,[e("div",z0,[e("div",U0,[r(t(Je),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),Fe(e("input",{"onUpdate:modelValue":F[0]||(F[0]=$=>d.value=$),type:"text",placeholder:"Buscar...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent text-sm"},null,512),[[Pe,d.value]])])]),e("div",N0,[r(t(Le),{as:"div",class:"relative"},{default:T(()=>[r(t(Ie),{class:"w-full inline-flex items-center justify-between gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:T(()=>[e("div",O0,[r(t(at),{class:"h-4 w-4 flex-shrink-0"}),e("span",q0,m(Oe.value||"Etiqueta"),1)]),r(t(Qe),{class:"h-4 w-4 flex-shrink-0"})]),_:1}),r(t(Be),{class:"absolute left-0 z-10 mt-2 w-full min-w-[16rem] origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:T(()=>[e("div",V0,[e("div",Q0,[r(t(Je),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),Fe(e("input",{"onUpdate:modelValue":F[1]||(F[1]=$=>S.value=$),type:"text",placeholder:"Buscar etiquetas...",class:"w-full pl-9 pr-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent",onClick:F[2]||(F[2]=pe(()=>{},["stop"]))},null,512),[[Pe,S.value]])]),e("div",W0,[r(t(xe),null,{default:T(({active:$})=>[e("a",{onClick:F[3]||(F[3]=Ee=>E.value=null),class:j([$?"bg-gray-100":"","block px-3 py-2 text-sm text-gray-700 cursor-pointer rounded-md"])}," Todos ",2)]),_:1}),(s(!0),o(fe,null,he(Ne.value,$=>(s(),de(t(xe),{key:$.id},{default:T(({active:Ee})=>[e("a",{onClick:u=>E.value=$.id,class:j([Ee?"bg-gray-100":"","flex items-center gap-2 px-3 py-2 text-sm cursor-pointer rounded-md"])},[e("span",{class:j(["w-3 h-3 rounded-full flex-shrink-0",Me($)])},null,2),e("span",G0,m($.name),1)],10,H0)]),_:2},1024))),128)),Ne.value.length===0?(s(),o("div",Z0," No se encontraron etiquetas ")):f("",!0)])])]),_:1})]),_:1}),e("div",J0,[E.value||te.value||R.value?(s(),o("button",{key:0,onClick:V,class:"w-full inline-flex items-center justify-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",title:"Limpiar filtros"},[r(t(Te),{class:"h-4 w-4 flex-shrink-0"}),K0])):f("",!0)])]),e("div",Y0,[e("div",X0,[eg,Fe(e("input",{"onUpdate:modelValue":F[4]||(F[4]=$=>te.value=$),type:"date",class:"w-full min-w-0 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent text-sm",placeholder:"Fecha inicio"},null,512),[[Pe,te.value]])]),e("div",tg,[sg,Fe(e("input",{"onUpdate:modelValue":F[5]||(F[5]=$=>R.value=$),type:"date",class:"w-full min-w-0 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-secondary focus:border-transparent text-sm",placeholder:"Fecha fin"},null,512),[[Pe,R.value]])])]),e("div",og,[e("div",ag,[e("div",rg,[e("button",{onClick:ve,class:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},[r(t(rt),{class:"h-4 w-4"}),ng]),r(t(Le),{as:"div",class:"relative"},{default:T(()=>[r(t(Ie),{class:"inline-flex items-center justify-center w-10 h-10 rounded-md hover:bg-gray-100"},{default:T(()=>[r(t(ct),{class:"h-5 w-5 text-gray-500"})]),_:1}),r(t(Be),{class:"absolute left-0 sm:left-auto sm:right-0 z-10 mt-2 w-48 origin-top-left sm:origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:T(()=>[e("div",lg,[r(t(xe),null,{default:T(({active:$})=>[e("a",{onClick:ce,class:j([$?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Seleccionar todo ",2)]),_:1}),r(t(xe),null,{default:T(({active:$})=>[e("a",{onClick:W,class:j([$?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Deseleccionar todo ",2)]),_:1})])]),_:1})]),_:1})]),r(t(Le),{as:"div",class:"relative"},{default:T(()=>[r(t(Ie),{class:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},{default:T(()=>[ig,K(" "+m(Re.value)+" ",1),r(t(Qe),{class:"h-4 w-4"})]),_:1}),r(t(Be),{class:"absolute left-0 sm:left-auto sm:right-0 z-10 mt-2 w-48 origin-top-left sm:origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:T(()=>[e("div",dg,[r(t(xe),null,{default:T(({active:$})=>[e("a",{onClick:F[6]||(F[6]=Ee=>x.value="recent"),class:j([$?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Más recientes ",2)]),_:1}),r(t(xe),null,{default:T(({active:$})=>[e("a",{onClick:F[7]||(F[7]=Ee=>x.value="name"),class:j([$?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700 cursor-pointer"])}," Nombre (A-Z) ",2)]),_:1})])]),_:1})]),_:1})])])]),e("div",cg,[e("div",ug,[e("table",mg,[e("thead",gg,[e("tr",null,[e("th",pg,[e("input",{type:"checkbox",checked:P.value,onChange:N,class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,fg)]),hg,yg,vg,bg,xg,_g,wg,c.state==="PendingSignatures"?(s(),o("th",$g," Fecha Expiración ")):f("",!0),c.state==="PendingSignatures"||c.state==="FullySigned"?(s(),o("th",kg," Docs. Asociados ")):f("",!0),Cg])]),e("tbody",Dg,[(s(!0),o(fe,null,he(ge.value,($,Ee)=>{var u;return s(),o("tr",{key:$.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:g=>gt($)},[e("td",{class:"px-6 py-4 whitespace-nowrap",onClick:F[8]||(F[8]=pe(()=>{},["stop"]))},[e("input",{type:"checkbox",checked:z.value.includes($.id),onChange:g=>O($.id),class:"h-4 w-4 text-secondary border-gray-300 rounded focus:ring-secondary cursor-pointer"},null,40,Sg)]),e("td",Eg,[e("div",Pg,[e("div",Tg,[e("div",jg,[r(t(Ve),{class:"h-5 w-5 text-purple-600"})])]),e("div",Mg,[e("div",Ag,m($.title),1)])])]),e("td",Lg,[e("span",{class:j(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",Z($)])},m(ie($)),3)]),e("td",Ig,[e("span",Bg,m(_t($)||"-"),1)]),e("td",Rg,[e("span",zg,m($.summary_object||"-"),1)]),e("td",Ug,[e("span",Ng,m(Ut($)||"-"),1)]),e("td",Og,[e("span",qg,m($.summary_term||"-"),1)]),e("td",Vg,[e("div",Qg,[$.summary_subscription_date?(s(),o("div",Wg,[Hg,e("span",Gg,m(l($.summary_subscription_date)),1)])):f("",!0),$.summary_start_date||$.summary_end_date?(s(),o("div",Zg,[Jg,e("span",Kg,[$.summary_start_date?(s(),o("span",Yg,m(l($.summary_start_date)),1)):f("",!0),$.summary_start_date&&$.summary_end_date?(s(),o("span",Xg," → ")):f("",!0),$.summary_end_date?(s(),o("span",ep,m(l($.summary_end_date)),1)):f("",!0)])])):f("",!0),!$.summary_subscription_date&&!$.summary_start_date&&!$.summary_end_date?(s(),o("span",tp," - ")):f("",!0)])]),c.state==="PendingSignatures"?(s(),o("td",sp,[$.signature_due_date?(s(),o("span",op,m(l($.signature_due_date)),1)):(s(),o("span",ap," - "))])):f("",!0),c.state==="PendingSignatures"||c.state==="FullySigned"?(s(),o("td",rp,[e("button",{type:"button",disabled:!$.relationships_count||$.relationships_count===0,class:j(["inline-flex items-center px-3 py-1.5 rounded-full text-xs font-medium border transition-colors",$.relationships_count&&$.relationships_count>0?"border-indigo-200 text-indigo-700 bg-indigo-50 hover:bg-indigo-100 cursor-pointer":"border-gray-200 text-gray-400 bg-gray-50 cursor-not-allowed opacity-60"]),onClick:pe(g=>t(L)("relationships",$),["stop"])},[$.relationships_count&&$.relationships_count>0?(s(),o("span",lp," Ver asociaciones ("+m($.relationships_count)+") ",1)):(s(),o("span",ip," Sin asociaciones "))],10,np)])):f("",!0),e("td",dp,[e("div",cp,[(s(!0),o(fe,null,he((u=$.tags)==null?void 0:u.slice(0,2),g=>(s(),o("span",{key:g.id,class:j(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",ze(g)])},m(g.name),3))),128)),$.tags&&$.tags.length>2?(s(),o("span",up," +"+m($.tags.length-2),1)):f("",!0),!$.tags||$.tags.length===0?(s(),o("span",mp,"-")):f("",!0)])])],8,Fg)}),128))])])]),Q.value>1?(s(),o("div",gp,[e("div",pp,[e("button",{onClick:we,disabled:C.value===1,class:j(["relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",C.value===1?"opacity-50 cursor-not-allowed":""])}," Anterior ",10,fp),e("button",{onClick:_,disabled:C.value===Q.value,class:j(["relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",C.value===Q.value?"opacity-50 cursor-not-allowed":""])}," Siguiente ",10,hp)]),e("div",yp,[e("div",null,[e("p",vp,[K(" Mostrando "),e("span",bp,m(A.value.start),1),K(" a "),e("span",xp,m(A.value.end),1),K(" de "),e("span",_p,m(A.value.total),1),K(" resultados ")])]),e("div",null,[e("nav",wp,[e("button",{onClick:we,disabled:C.value===1,class:j(["relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",C.value===1?"opacity-50 cursor-not-allowed":""])},[kp,r(t(bt),{class:"h-5 w-5","aria-hidden":"true"})],10,$p),(s(!0),o(fe,null,he(X.value,$=>(s(),o(fe,{key:$},[$!=="..."?(s(),o("button",{key:0,onClick:Ee=>n($),class:j(["relative inline-flex items-center px-4 py-2 text-sm font-semibold focus:z-20 focus:outline-offset-0",C.value===$?"z-10 bg-secondary text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-secondary":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50"])},m($),11,Cp)):(s(),o("span",Dp," ... "))],64))),128)),e("button",{onClick:_,disabled:C.value===Q.value,class:j(["relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0",C.value===Q.value?"opacity-50 cursor-not-allowed":""])},[Sp,r(t(ut),{class:"h-5 w-5","aria-hidden":"true"})],10,Fp)])])])])):f("",!0)]),ne.value.length===0&&!k.value?(s(),o("div",Ep,[r(t(Mt),{class:"mx-auto h-12 w-12 text-gray-400"}),e("h3",Pp,m(ye.value),1),e("p",Tp,m(_e.value),1)])):f("",!0),k.value?(s(),o("div",jp,Lp)):f("",!0),r(Ht,{isVisible:t(ot),documentData:t(Wt),onClose:F[9]||(F[9]=$=>ot.value=!1)},null,8,["isVisible","documentData"]),(s(),de(Qt,{to:"body"},[t(p).signatures.isOpen?(s(),de(t(us),{key:0,"document-id":(ae=t(p).signatures.document)==null?void 0:ae.id,onClose:F[10]||(F[10]=$=>t(J)("signatures")),onRefresh:F[11]||(F[11]=$=>D("refresh")),onOpenElectronicSignature:F[12]||(F[12]=$=>D("open-electronic-signature"))},null,8,["document-id"])):f("",!0),t(p).letterhead.isOpen?(s(),de(jt,{key:1,"is-visible":t(p).letterhead.isOpen,document:t(p).letterhead.document,onClose:F[13]||(F[13]=$=>t(J)("letterhead")),onRefresh:F[14]||(F[14]=$=>D("refresh"))},null,8,["is-visible","document"])):f("",!0),me.value?(s(),de(At,{key:2,"is-visible":me.value,document:qe.value,"card-type":"signatures",context:"table","user-store":t(v),onClose:F[15]||(F[15]=$=>me.value=!1),onAction:Lt},null,8,["is-visible","document","user-store"])):f("",!0),t(p).relationships.isOpen?(s(),de(St,{key:3,"is-open":t(p).relationships.isOpen,document:t(p).relationships.document,readonly:c.state==="PendingSignatures"||c.state==="FullySigned",onClose:F[16]||(F[16]=$=>t(J)("relationships")),onRefresh:F[17]||(F[17]=$=>D("refresh"))},null,8,["is-open","document","readonly"])):f("",!0),Y.value?(s(),de(B0,{key:4,"is-visible":Y.value,document:ue.value,onClose:F[18]||(F[18]=$=>Y.value=!1)},null,8,["is-visible","document"])):f("",!0),Se.value&&Ue.value?(s(),o("div",Ip,[e("div",Bp,[e("div",Rp,[zp,e("button",{type:"button",class:"p-1 rounded-full text-gray-400 hover:text-gray-600 hover:bg-gray-100",onClick:pt},[r(t(Te),{class:"h-5 w-5"})])]),e("div",Up,[e("p",null,[K(" Estás a punto de rechazar el documento "),e("span",Np,'"'+m(Ue.value.title)+'"',1),K(". ")]),Op,e("div",null,[qp,Fe(e("textarea",{"onUpdate:modelValue":F[19]||(F[19]=$=>et.value=$),rows:"4",class:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-secondary focus:border-transparent resize-none",placeholder:"Describe brevemente por qué no estás de acuerdo con el documento..."},null,512),[[Pe,et.value]])])]),e("div",{class:"px-4 py-3 border-t border-gray-100 flex justify-end gap-2 bg-gray-50"},[e("button",{type:"button",class:"px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-100",onClick:pt}," Cancelar "),e("button",{type:"button",class:"px-3 py-1.5 text-xs font-medium text-white bg-red-600 rounded-md hover:bg-red-700",onClick:Bt}," Rechazar documento ")])])])):f("",!0),lt.value?(s(),o("div",Vp,[e("div",Qp,[e("div",Wp,[Hp,e("button",{type:"button",class:"p-1 rounded-full text-gray-400 hover:text-gray-600 hover:bg-gray-100",onClick:F[20]||(F[20]=$=>lt.value=!1)},[r(t(Te),{class:"h-5 w-5"})])]),e("div",Gp,m(it.value||"No se encontró un motivo de rechazo para este documento."),1),e("div",Zp,[e("button",{type:"button",class:"px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-100",onClick:F[21]||(F[21]=$=>lt.value=!1)}," Cerrar ")])])])):f("",!0)]))])}}},Jp={class:"bg-white rounded-lg p-6 shadow-xl max-w-lg w-full"},Kp={class:"flex justify-end"},Yp=e("label",{for:"document-name",class:"block text-base font-medium leading-6 text-primary"},[K(" Nombre "),e("span",{class:"text-red-500"},"*")],-1),Xp={class:"mt-2"},ef={class:"flex flex-col sm:flex-row gap-3 mt-6 pt-4 border-t border-gray-200"},tf=["disabled"],sf=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),of=e("span",null,"Actualizar nombre",-1),af=[sf,of],rf=["disabled"],nf=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 7l5 5m0 0l-5 5m5-5H6"})],-1),lf={__name:"CreateDocumentByLawyer",emits:["close"],setup(a,{emit:w}){const i=st(),c=Ge(),D=w,v=h(""),y=h("");is(()=>{var U;(U=c.selectedDocument)!=null&&U.title?(v.value=c.selectedDocument.title,y.value=c.selectedDocument.title):(v.value="",y.value="")});const M=U=>{U.key==="Escape"&&D("close")};He(()=>{document.addEventListener("keydown",M)}),yt(()=>{document.removeEventListener("keydown",M)});const p=I(()=>v.value.trim().length>0),L=I(()=>{var U;return!!((U=c.selectedDocument)!=null&&U.id)}),J=I(()=>L.value&&v.value.trim()!==y.value.trim()&&v.value.trim().length>0);async function ee(){if(L.value&&J.value)try{const U={title:v.value.trim()};await c.updateDocument(c.selectedDocument.id,U),y.value=v.value.trim(),c.selectedDocument.title=v.value.trim(),c.lastUpdatedDocumentId=c.selectedDocument.id,localStorage.setItem("lastUpdatedDocumentId",c.selectedDocument.id);const re=c.selectedDocument.id;D("close",{updatedDocId:re});const B=window.location.pathname;B==="/dynamic_document_dashboard"||B==="/dynamic_document_dashboard/"?setTimeout(()=>{window.forceDocumentHighlight&&window.forceDocumentHighlight(re)},100):setTimeout(()=>{window.location.href="/dynamic_document_dashboard"},1e3)}catch(U){console.error("Error updating document name:",U)}}const G=async()=>{if(!p.value)return;const U=encodeURIComponent(v.value.trim());L.value?(c.selectedDocument.title=v.value,c.selectedDocument.id&&(c.lastUpdatedDocumentId=c.selectedDocument.id,localStorage.setItem("lastUpdatedDocumentId",c.selectedDocument.id.toString())),i.push(`/dynamic_document_dashboard/lawyer/editor/edit/${c.selectedDocument.id}`)):(c.selectedDocument={title:v.value.trim()},i.push(`/dynamic_document_dashboard/lawyer/editor/create/${U}`))};return(U,re)=>(s(),o("div",Jp,[e("div",Kp,[e("button",{onClick:re[0]||(re[0]=B=>D("close"))},[r(t(Te),{class:"size-6"})])]),e("form",{onSubmit:pe(G,["prevent"])},[e("div",null,[Yp,e("div",Xp,[Fe(e("input",{"onUpdate:modelValue":re[1]||(re[1]=B=>v.value=B),type:"text",name:"document-name",id:"document-name",class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-secondary sm:text-sm sm:leading-6",required:""},null,512),[[Pe,v.value]])])]),e("div",ef,[L.value?(s(),o("button",{key:0,type:"button",onClick:ee,disabled:!J.value,class:j(["inline-flex items-center justify-center px-6 py-3 text-sm font-semibold rounded-lg shadow-sm transition-all duration-200",J.value?"bg-blue-600 text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500":"bg-gray-100 text-gray-400 border-2 border-dashed border-gray-300 cursor-not-allowed"])},af,10,tf)):f("",!0),e("button",{type:"submit",class:j(["inline-flex items-center justify-center px-6 py-3 text-sm font-semibold rounded-lg shadow-sm transition-all duration-200",p.value?"bg-green-600 text-white hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500":"bg-gray-100 text-gray-400 border-2 border-dashed border-gray-300 cursor-not-allowed"]),disabled:!p.value},[nf,e("span",null,m(L.value?"Editar Documento":"Continuar"),1)],10,rf)])],32)]))}},je=a=>(Dt("data-v-60420c9d"),a=a(),Ft(),a),df={class:"relative bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col"},cf={class:"px-6 py-4 border-b border-gray-200"},uf=je(()=>e("h2",{class:"text-xl font-semibold text-gray-800"},"Gestión de Membrete Global para PDF",-1)),mf=je(()=>e("p",{class:"text-sm text-gray-500 mt-1"}," La imagen de membrete se usará por defecto solo al generar documentos en PDF. Para documentos Word, se utiliza la plantilla .docx configurada más abajo. ",-1)),gf={class:"p-6 overflow-y-auto flex-grow"},pf={key:0,class:"text-center py-10"},ff=je(()=>e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1)),hf={class:"mt-4 text-gray-500"},yf={key:1,class:"space-y-6"},vf={key:0,class:"space-y-4"},bf=je(()=>e("h3",{class:"text-lg font-medium text-gray-900"},"Membrete de imagen para PDF actual",-1)),xf={class:"border border-gray-200 rounded-lg p-4 bg-gray-50"},_f=["src"],wf={class:"mt-4 flex justify-center space-x-3"},$f=["disabled"],kf={key:1,class:"text-center py-8"},Cf=je(()=>e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"Sin Membrete para PDF",-1)),Df=je(()=>e("p",{class:"mt-1 text-sm text-gray-500"}," No tienes una imagen de membrete global configurada para los documentos PDF. ",-1)),Ff=je(()=>e("p",{class:"mt-1 text-xs text-gray-400"}," Este membrete de imagen se aplicará solo a los PDF que no tengan un membrete específico. ",-1)),Sf={class:"space-y-4"},Ef={class:"text-lg font-medium text-gray-900"},Pf={class:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-gray-400 transition-colors"},Tf={key:0},jf={class:"mt-4"},Mf=je(()=>e("p",{class:"mt-2 text-sm text-gray-500"}," Solo archivos PNG, máximo 10MB. Se usa únicamente para los PDF. ",-1)),Af=je(()=>e("p",{class:"text-xs text-gray-400 mt-1"},' Dimensiones ideales: 2550 × 3300 píxeles (tamaño carta, 8.5" × 11" a 300 DPI) ',-1)),Lf={key:1,class:"space-y-4"},If={class:"flex items-center justify-center space-x-2 text-sm text-gray-600"},Bf={class:"text-gray-400"},Rf={key:0,class:"mt-4"},zf=["src"],Uf={class:"flex justify-center space-x-3"},Nf=["disabled"],Of={key:1,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},qf={class:"space-y-4 border-t border-gray-200 pt-6"},Vf=je(()=>e("h3",{class:"text-lg font-medium text-gray-900"},"Plantilla Word para documentos (.docx)",-1)),Qf=je(()=>e("p",{class:"text-sm text-gray-500"}," Esta plantilla se usará al descargar documentos en Word. Debe ser un archivo .docx con tu membrete configurado (header, footer o watermark). El contenido del documento se añadirá sobre esa plantilla. ",-1)),Wf={key:0,class:"border border-gray-200 rounded-lg p-4 bg-gray-50"},Hf={class:"text-sm text-gray-700"},Gf=je(()=>e("div",{class:"font-medium"},"Plantilla actual:",-1)),Zf={class:"mt-1 break-words"},Jf={class:"font-mono break-all"},Kf={key:0,class:"text-gray-400 ml-2"},Yf={class:"mt-3 flex flex-wrap gap-3"},Xf=["disabled"],eh={key:1,class:"text-sm text-gray-500"},th={class:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-gray-400 transition-colors"},sh={key:0},oh={class:"mt-4"},ah=je(()=>e("p",{class:"mt-2 text-sm text-gray-500"}," Solo archivos .docx, máximo 10MB. ",-1)),rh={key:1,class:"space-y-4"},nh={class:"flex items-center justify-center space-x-2 text-sm text-gray-600"},lh={class:"text-gray-400"},ih={class:"flex justify-center space-x-3"},dh=["disabled"],ch={key:1,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},uh={key:2,class:"bg-blue-50 border border-blue-200 rounded-lg p-6 space-y-6"},mh={class:"flex items-center space-x-2"},gh=je(()=>e("h3",{class:"text-lg font-semibold text-blue-900"},"Especificaciones del Membrete para PDF",-1)),ph=je(()=>e("div",{class:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},[e("h4",{class:"font-medium text-yellow-800 mb-2"},"🔄 Prioridad de Membrete"),e("div",{class:"text-sm text-yellow-700 space-y-1"},[e("div",null,[e("strong",null,"1º Prioridad:"),K(" Membrete específico del documento")]),e("div",null,[e("strong",null,"2º Prioridad:"),K(" Membrete global de imagen para PDF del usuario (este)")]),e("div",null,[e("strong",null,"3º Prioridad:"),K(" Sin membrete")])])],-1)),fh=je(()=>e("div",{class:"space-y-3"},[e("h4",{class:"font-medium text-gray-900"},"📐 Dimensiones Exactas"),e("div",{class:"bg-white rounded-lg p-4 border border-blue-200"},[e("div",{class:"grid grid-cols-2 gap-4 text-sm"},[e("div",null,[e("span",{class:"font-medium text-gray-700"},"Ancho:"),e("span",{class:"ml-2 text-blue-600 font-mono"},"2550 píxeles")]),e("div",null,[e("span",{class:"font-medium text-gray-700"},"Alto:"),e("span",{class:"ml-2 text-blue-600 font-mono"},"3300 píxeles")]),e("div",null,[e("span",{class:"font-medium text-gray-700"},"Proporción:"),e("span",{class:"ml-2 text-blue-600"},"8.5:11 (Carta, 300 DPI)")]),e("div",null,[e("span",{class:"font-medium text-gray-700"},"Tolerancia:"),e("span",{class:"ml-2 text-orange-600"},"±10%")])])])],-1)),hh=je(()=>e("div",{class:"space-y-3"},[e("h4",{class:"font-medium text-gray-900"},"🎨 Distribución Recomendada"),e("div",{class:"bg-white rounded-lg p-4 border border-blue-200"},[e("div",{class:"space-y-4"},[e("div",{class:"mx-auto w-40 h-44 border-2 border-gray-300 rounded bg-gradient-to-b from-blue-100 via-yellow-50 to-green-100 relative text-xs"},[e("div",{class:"absolute top-0 left-0 right-0 h-12 bg-blue-200 bg-opacity-70 border-b border-blue-300 flex items-center justify-center text-blue-800 font-medium"}," HEADER ZONE "),e("div",{class:"absolute top-10 left-1 text-blue-700 text-[10px]"},"120-150px"),e("div",{class:"absolute top-12 left-0 right-0 bottom-12 bg-yellow-100 bg-opacity-50 border-y border-yellow-300 flex items-center justify-center text-yellow-800 font-medium"},[e("div",{class:"text-center"},[e("div",null,"BODY ZONE"),e("div",{class:"text-[10px] mt-1"},"⚠️ ZONA CRÍTICA")])]),e("div",{class:"absolute top-20 left-1 text-yellow-700 text-[10px]"},"300-400px"),e("div",{class:"absolute bottom-0 left-0 right-0 h-12 bg-green-200 bg-opacity-70 border-t border-green-300 flex items-center justify-center text-green-800 font-medium"}," FOOTER ZONE "),e("div",{class:"absolute bottom-10 left-1 text-green-700 text-[10px]"},"80-120px")]),e("div",{class:"space-y-3 text-sm"},[e("div",{class:"flex items-start space-x-3"},[e("div",{class:"w-4 h-4 bg-blue-200 border border-blue-300 rounded mt-0.5 flex-shrink-0"}),e("div",null,[e("span",{class:"font-medium text-blue-800"},"Header (Superior):"),e("span",{class:"text-gray-600 ml-1"},"Logos, nombre de empresa. Puede tener mayor intensidad visual.")])]),e("div",{class:"flex items-start space-x-3"},[e("div",{class:"w-4 h-4 bg-yellow-100 border border-yellow-300 rounded mt-0.5 flex-shrink-0"}),e("div",null,[e("span",{class:"font-medium text-yellow-800"},"Body (Centro):"),e("span",{class:"text-gray-600 ml-1"},"Mantén semi-transparente. El texto del documento se superpone aquí.")])]),e("div",{class:"flex items-start space-x-3"},[e("div",{class:"w-4 h-4 bg-green-200 border border-green-300 rounded mt-0.5 flex-shrink-0"}),e("div",null,[e("span",{class:"font-medium text-green-800"},"Footer (Inferior):"),e("span",{class:"text-gray-600 ml-1"},"Direcciones, teléfonos, emails, información de contacto.")])])])])])],-1)),yh=je(()=>e("div",{class:"space-y-3"},[e("h4",{class:"font-medium text-gray-900"},"🔧 Consideraciones Técnicas"),e("div",{class:"bg-white rounded-lg p-4 border border-blue-200"},[e("div",{class:"space-y-2 text-sm text-gray-700"},[e("div",{class:"flex items-start space-x-2"},[e("span",{class:"text-blue-600 font-medium"},"•"),e("span",null,[e("strong",null,"Posicionamiento:"),K(" La imagen se centra automáticamente en el documento")])]),e("div",{class:"flex items-start space-x-2"},[e("span",{class:"text-blue-600 font-medium"},"•"),e("span",null,[e("strong",null,"Transparencia:"),K(" Usa PNG con canal alpha para efectos de transparencia")])]),e("div",{class:"flex items-start space-x-2"},[e("span",{class:"text-blue-600 font-medium"},"•"),e("span",null,[e("strong",null,"Márgenes:"),K(" Deja 30-50px de margen en los lados para seguridad")])]),e("div",{class:"flex items-start space-x-2"},[e("span",{class:"text-blue-600 font-medium"},"•"),e("span",null,[e("strong",null,"Resolución:"),K(" 72-150 DPI es suficiente para documentos digitales")])]),e("div",{class:"flex items-start space-x-2"},[e("span",{class:"text-orange-600 font-medium"},"⚠️"),e("span",null,[e("strong",null,"Zona crítica:"),K(" Evita elementos gráficos densos en el centro (300-400px de altura)")])])])])],-1)),vh=je(()=>e("div",{class:"bg-gradient-to-r from-green-50 to-blue-50 border border-green-200 rounded-lg p-4"},[e("h4",{class:"font-medium text-green-800 mb-2"},"💡 Tips de Diseño Rápido"),e("div",{class:"text-sm text-green-700 space-y-1"},[e("div",null,"• Si solo tienes header, ubícalo en los primeros 120-150px"),e("div",null,"• El resto de la imagen debe ser transparente o blanco"),e("div",null,"• Para footer, usa los últimos 80-120px"),e("div",null,"• El texto se superpone en toda la imagen, mantén el centro claro")])],-1)),bh={key:3,class:"space-y-2"},xh={class:"flex"},_h={class:"text-sm text-yellow-700"},wh={__name:"GlobalLetterheadModal",props:{isVisible:{type:Boolean,default:!1}},emits:["close","uploaded","deleted"],setup(a,{emit:w}){const i=a,c=w;ke(()=>i.isVisible,Z=>{});const D=Ge(),v=h(!1),y=h(""),M=h(!1),p=h(!1),L=h(null),J=h(null),ee=h(null),G=h([]),U=h(null),re=h(!1),B=h(!1),k=h(null),d=h(!1),S=h(null),E=h(""),te=h(null),R=h(!1),x=h(!1),z=h(null),Y=()=>{oe(),c("close")},ue=Z=>{const ie=Z.target.files[0];if(!ie)return;if(!ie.type.includes("png")){alert("Solo se permiten archivos PNG");return}if(ie.size>10*1024*1024){alert("El archivo no puede ser mayor a 10MB");return}L.value=ie,G.value=[];const P=new FileReader;P.onload=N=>{J.value=N.target.result;const O=new Image;O.onload=()=>{le(O.width,O.height)},O.src=N.target.result},P.readAsDataURL(ie)},le=(Z,ie)=>{const ce=Z/ie,W=2550/3300,V=Math.abs(ce-W)/W;if(Z===2550&&ie===3300){G.value.push("✅ Dimensiones perfectas: 2550 × 3300 píxeles");return}V<=.1?(G.value.push(`ℹ️ Buenas proporciones detectadas: ${Z} × ${ie} píxeles (${ce.toFixed(3)})`),(Z!==2550||ie!==3300)&&G.value.push('💡 Para mejores resultados, usa exactamente 2550 × 3300 píxeles (tamaño carta, 8.5" × 11" a 300 DPI)')):(G.value.push(`⚠️ Proporciones no ideales: ${Z} × ${ie} píxeles (${ce.toFixed(3)})`),G.value.push(`🎯 Proporciones recomendadas: ${W.toFixed(3)} (8.5:11, tamaño carta)`),G.value.push("📐 Considera redimensionar tu imagen a 2550 × 3300 píxeles (tamaño carta)")),(Z<1200||ie<1600)&&G.value.push("⚠️ Imagen muy pequeña - puede verse pixelada en documentos PDF tamaño carta"),(Z>4e3||ie>5e3)&&G.value.push("ℹ️ Imagen muy grande - se redimensionará automáticamente para ajustarse al tamaño carta")},oe=()=>{L.value=null,J.value=null,G.value=[],re.value=!1,U.value&&(U.value.value="")},C=async()=>{var Z;if(L.value){M.value=!0,G.value=[];try{const ie=await D.uploadGlobalLetterheadImage(L.value);(Z=ie.data)!=null&&Z.warnings&&ie.data.warnings.length>0&&(G.value=ie.data.warnings),B.value=!1,await se(),oe(),c("uploaded",ie.data)}catch(ie){console.error("Error uploading global letterhead:",ie),alert("Error al subir la imagen. Por favor intenta nuevamente.")}finally{M.value=!1}}},se=async()=>{if(!(ee.value===null&&B.value)){B.value=!0;try{const Z=await D.getGlobalLetterheadImage();Z.data&&(ee.value=URL.createObjectURL(Z.data))}catch{ee.value=null}}},$e=async()=>{await es("¿Estás seguro de que deseas eliminar la imagen de membrete global?")&&ye()},ye=async()=>{p.value=!0;try{await D.deleteGlobalLetterheadImage(),ee.value&&URL.revokeObjectURL(ee.value),ee.value=null,B.value=!0,c("deleted")}catch(Z){console.error("Error deleting global letterhead:",Z),alert("Error al eliminar la imagen. Por favor intenta nuevamente.")}finally{p.value=!1}},_e=Z=>{const ie=Z.target.files[0];if(ie){if(!ie.name.toLowerCase().endsWith(".docx")){alert("Solo se permiten archivos .docx para la plantilla Word");return}if(ie.size>10*1024*1024){alert("El archivo de plantilla no puede ser mayor a 10MB");return}k.value=ie}},ne=()=>{k.value=null,z.value&&(z.value.value="")},ge=async()=>{var Z;if(k.value){R.value=!0;try{const P=(Z=(await D.uploadGlobalLetterheadWordTemplate(k.value)).data)==null?void 0:Z.template_info;d.value=!0,E.value=(P==null?void 0:P.filename)||k.value.name,te.value=(P==null?void 0:P.size_bytes)||k.value.size,await Q(),ne()}catch(ie){console.error("Error uploading global Word template:",ie),alert("Error al subir la plantilla Word. Por favor intenta nuevamente.")}finally{R.value=!1}}},Q=async()=>{var Z,ie;try{const P=await D.getGlobalLetterheadWordTemplate("blob");if(!P){d.value=!1,S.value&&URL.revokeObjectURL(S.value),S.value=null,E.value="",te.value=null;return}if(P&&P.data){d.value=!0,S.value&&URL.revokeObjectURL(S.value),S.value=URL.createObjectURL(P.data);const N=((Z=P.headers)==null?void 0:Z["content-disposition"])||((ie=P.headers)==null?void 0:ie["Content-Disposition"]);let O="plantilla_word.docx";if(N){const ce=N.match(/filename="?([^";]+)"?/i);ce&&ce[1]&&(O=ce[1])}E.value=O,te.value=P.data.size||null}}catch(P){console.error("Error loading global Word template:",P)}},A=async()=>{await es("¿Estás seguro de que deseas eliminar la plantilla Word de membrete global?")&&be()},be=async()=>{x.value=!0;try{await D.deleteGlobalLetterheadWordTemplate(),S.value&&URL.revokeObjectURL(S.value),S.value=null,E.value="",te.value=null,d.value=!1}catch(Z){console.error("Error deleting global Word template:",Z),alert("Error al eliminar la plantilla Word. Por favor intenta nuevamente.")}finally{x.value=!1}},Ne=()=>{if(S.value){const Z=document.createElement("a");Z.href=S.value,Z.download=E.value||"membrete-word.docx",document.body.appendChild(Z),Z.click(),document.body.removeChild(Z)}},Oe=()=>{if(ee.value){const Z=document.createElement("a");Z.href=ee.value,Z.download="membrete-global.png",document.body.appendChild(Z),Z.click(),document.body.removeChild(Z)}},Me=()=>{ee.value=null},Re=Z=>{if(Z===0)return"0 Bytes";const ie=1024,P=["Bytes","KB","MB","GB"],N=Math.floor(Math.log(Z)/Math.log(ie));return parseFloat((Z/Math.pow(ie,N)).toFixed(2))+" "+P[N]};ke(()=>i.isVisible,Z=>{Z&&(se(),Q())});const ze=()=>{ee.value&&URL.revokeObjectURL(ee.value),J.value&&URL.revokeObjectURL(J.value),S.value&&URL.revokeObjectURL(S.value)};return He(()=>{i.isVisible&&se()}),yt(ze),(Z,ie)=>Fe((s(),de(Ke,null,{default:T(()=>[e("div",{class:"w-full h-full flex items-center justify-center p-4",onClick:pe(Y,["self"])},[e("div",df,[e("div",cf,[uf,mf,e("button",{onClick:Y,class:"absolute top-4 right-4 text-gray-400 hover:text-gray-500"},[r(t(Te),{class:"h-6 w-6"})])]),e("div",gf,[v.value?(s(),o("div",pf,[ff,e("p",hf,m(y.value),1)])):(s(),o("div",yf,[ee.value?(s(),o("div",vf,[bf,e("div",xf,[e("img",{src:ee.value,alt:"Membrete de imagen para PDF actual",class:"max-w-full h-auto max-h-64 mx-auto shadow-sm",onError:Me},null,40,_f),e("div",wf,[e("button",{onClick:Oe,class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},[r(t(rt),{class:"h-4 w-4 mr-2"}),K(" Descargar ")]),e("button",{onClick:$e,disabled:p.value,class:"inline-flex items-center px-3 py-2 border border-transparent shadow-sm text-sm leading-4 font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50"},[r(t(Vt),{class:"h-4 w-4 mr-2"}),K(" "+m(p.value?"Eliminando...":"Eliminar"),1)],8,$f)])])])):(s(),o("div",kf,[r(t(nt),{class:"mx-auto h-12 w-12 text-gray-400"}),Cf,Df,Ff])),e("div",Sf,[e("h3",Ef,m(ee.value?"Reemplazar Membrete de imagen para PDF":"Subir Membrete de imagen para PDF"),1),e("div",Pf,[e("input",{ref_key:"fileInput",ref:U,type:"file",accept:".png",onChange:ue,class:"hidden"},null,544),L.value?(s(),o("div",Lf,[e("div",If,[r(t(Ct),{class:"h-5 w-5 text-green-500"}),e("span",null,m(L.value.name),1),e("span",Bf,"("+m(Re(L.value.size))+")",1)]),J.value?(s(),o("div",Rf,[e("img",{src:J.value,alt:"Vista previa",class:"max-w-full h-auto max-h-32 mx-auto border border-gray-200 rounded"},null,8,zf)])):f("",!0),e("div",Uf,[e("button",{onClick:oe,class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"}," Cancelar "),e("button",{onClick:C,disabled:M.value,class:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50"},[M.value?(s(),o("div",Of)):(s(),de(t(as),{key:0,class:"h-4 w-4 mr-2"})),K(" "+m(M.value?"Subiendo...":"Subir Imagen para PDF"),1)],8,Nf)])])):(s(),o("div",Tf,[r(t(ps),{class:"mx-auto h-12 w-12 text-gray-400"}),e("div",jf,[e("button",{onClick:ie[0]||(ie[0]=P=>Z.$refs.fileInput.click()),class:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}," Seleccionar Imagen PNG para PDF "),e("button",{onClick:ie[1]||(ie[1]=P=>re.value=!re.value),class:"ml-3 inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"},[r(t(os),{class:"h-4 w-4 mr-2"}),K(" "+m(re.value?"Ocultar":"Ver")+" Especificaciones ",1)])]),Mf,Af]))])]),e("div",qf,[Vf,Qf,d.value?(s(),o("div",Wf,[e("div",Hf,[Gf,e("div",Zf,[e("span",Jf,m(E.value||"plantilla_word.docx"),1),te.value?(s(),o("span",Kf,"("+m(Re(te.value))+")",1)):f("",!0)])]),e("div",Yf,[S.value?(s(),o("button",{key:0,onClick:Ne,class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},[r(t(rt),{class:"h-4 w-4 mr-2"}),K(" Descargar ")])):f("",!0),e("button",{onClick:A,disabled:x.value,class:"inline-flex items-center px-3 py-2 border border-transparent shadow-sm text-sm leading-4 font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50"},[r(t(Vt),{class:"h-4 w-4 mr-2"}),K(" "+m(x.value?"Eliminando...":"Eliminar"),1)],8,Xf)])])):(s(),o("div",eh," No tienes una plantilla Word configurada. Puedes subir un archivo .docx con tu membrete. ")),e("div",th,[e("input",{ref_key:"wordTemplateInput",ref:z,type:"file",accept:".docx",onChange:_e,class:"hidden"},null,544),k.value?(s(),o("div",rh,[e("div",nh,[r(t(Ct),{class:"h-5 w-5 text-green-500"}),e("span",null,m(k.value.name),1),e("span",lh,"("+m(Re(k.value.size))+")",1)]),e("div",ih,[e("button",{onClick:ne,class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"}," Cancelar "),e("button",{onClick:ge,disabled:R.value,class:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50"},[R.value?(s(),o("div",ch)):(s(),de(t(as),{key:0,class:"h-4 w-4 mr-2"})),K(" "+m(R.value?"Subiendo...":"Subir Plantilla"),1)],8,dh)])])):(s(),o("div",sh,[r(t(nt),{class:"mx-auto h-12 w-12 text-gray-400"}),e("div",oh,[e("button",{onClick:ie[2]||(ie[2]=P=>Z.$refs.wordTemplateInput.click()),class:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}," Seleccionar Plantilla .docx (Word) ")]),ah]))])]),re.value?(s(),o("div",uh,[e("div",mh,[r(t(os),{class:"h-6 w-6 text-blue-600"}),gh]),ph,fh,hh,yh,vh])):f("",!0),G.value.length>0?(s(),o("div",bh,[(s(!0),o(fe,null,he(G.value,(P,N)=>(s(),o("div",{key:N,class:"bg-yellow-50 border border-yellow-200 rounded-md p-3"},[e("div",xh,[r(t(zs),{class:"h-5 w-5 text-yellow-400 mr-2 flex-shrink-0 mt-0.5"}),e("p",_h,m(P),1)])]))),128))])):f("",!0)]))])])])]),_:1},512)),[[vt,a.isVisible]])}},$h=Et(wh,[["__scopeId","data-v-60420c9d"]]),kh={class:"min-h-screen bg-gray-50"},Ch={class:"sticky top-0 z-40 flex h-16 shrink-0 items-center gap-x-4 border-b border-gray-200 bg-white px-4 shadow-sm sm:gap-x-6 sm:px-6 lg:px-8"},Dh={class:"p-4 sm:p-6 lg:p-8"},Fh={key:0},Sh={key:0},Eh={key:1},Ph={class:"mb-6 border-b border-gray-200 pb-4"},Th={class:"hidden md:block"},jh={class:"flex flex-wrap gap-x-4 gap-y-2 md:gap-x-8 mb-4","aria-label":"Tabs"},Mh=["onClick"],Ah={class:"flex gap-3"},Lh=["disabled"],Ih=e("span",null,"Firma Electrónica",-1),Bh=e("span",null,"Membrete Global",-1),Rh=e("span",null,"Nueva Minuta",-1),zh=e("span",null,"Nuevo Documento",-1),Uh={class:"md:hidden space-y-3 relative"},Nh=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1),Oh=[Nh],qh={key:0,class:"absolute z-20 mt-2 bg-white border border-gray-300 rounded-lg shadow-lg overflow-hidden w-full"},Vh=["onClick"],Qh=["disabled"],Wh=e("span",{class:"font-medium text-xs leading-tight"},"Firma",-1),Hh=e("span",{class:"font-medium text-xs leading-tight"},"Membrete",-1),Gh=e("span",{class:"font-medium text-xs leading-tight"},"Nueva Minuta",-1),Zh=e("span",{class:"font-medium text-xs leading-tight"},"Nuevo Doc.",-1),Jh={key:0},Kh={key:1},Yh={key:2},Xh={key:3},ey={key:4},ty={key:5},sy={key:6},oy={key:7},ay={key:1},ry={class:"mb-6 border-b border-gray-200"},ny={class:"hidden md:flex md:flex-col"},ly={class:"-mb-px flex flex-wrap gap-x-4 gap-y-2 md:gap-x-8","aria-label":"Tabs"},iy=["onClick"],dy={class:"flex flex-wrap items-center gap-2 mt-3 mb-4 md:justify-end"},cy={class:"relative"},uy={class:"relative group"},my=["disabled"],gy={key:0,class:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50"},py=e("div",{class:"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"},null,-1),fy={class:"md:hidden relative"},hy=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1),yy=[hy],vy={key:0,class:"absolute top-full left-0 right-0 z-50 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg overflow-hidden"},by=["onClick"],xy={class:"md:hidden mt-4 mb-4 flex flex-col gap-2"},_y={class:"relative"},wy={class:"relative group"},$y=["disabled"],ky={key:0,class:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50"},Cy=e("div",{class:"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"},null,-1),Dy={key:0},Fy={key:1},Sy={class:"bg-white rounded-xl shadow-xl max-w-3xl w-full mx-auto"},Ey={class:"flex justify-between items-center p-4 border-b"},Py=e("h2",{class:"text-lg font-medium text-primary"},"Firma Electrónica",-1),Ty={class:"p-4 sm:p-6"},jy={class:"bg-white rounded-xl shadow-xl max-w-3xl w-full mx-auto"},My={class:"flex justify-between items-center p-4 border-b"},Ay=e("h2",{class:"text-lg font-medium text-primary"},"Firma Electrónica",-1),Ly={class:"p-4 sm:p-6"},uv={__name:"Dashboard",setup(a){const w=Xe(),i=Ge(),c=Jt(),D=st(),v=Ss(),{isBasicUser:y,handleFeatureAccess:M}=ys(),p=h(""),L=h("default"),J=h(!1);ke(L,(W,V)=>{});const ee=h(!1),G=h("folders"),U=h("legal-documents"),re=h(!1),B=h(!1),k=h(!1),d=h(!1),S=h(!1),E=h(null),te=h([]),R=h("recent");ke(U,(W,V)=>{},{immediate:!0}),I(()=>[]),I(()=>R.value==="recent"?"Más recientes":"Nombre (A-Z)");const x=I(()=>w.currentUser),z=I(()=>x.value?x.value.role:(D.push("/login"),null)),Y=async W=>{L.value=W,J.value=!0,z.value!=="lawyer"&&(G.value=null),i.selectedDocument=null,J.value=!1},ue=()=>{ee.value=!1,L.value!=="useDocument"&&(L.value="default"),i.selectedDocument=null},le=async()=>{await i.init(!0)},oe=()=>{if(!x.value){console.error("Cannot open signature modal: currentUser is not loaded");return}B.value=!0},C=()=>{if(!x.value){console.error("Cannot open signature modal: currentUser is not loaded");return}re.value=!0},se=()=>{if(!x.value){console.error("Cannot open signature modal: currentUser is not loaded");return}re.value=!0},$e=async W=>{U.value="signed-documents"},ye=async W=>{G.value="signed-documents"},_e=async W=>{try{W&&W.id?await i.fetchDocumentById(W.id,!0):await i.init(!0)}catch(V){console.error("Error refreshing rejected document for lawyer:",V)}U.value="archived-documents"},ne=async W=>{try{W&&W.id?await i.fetchDocumentById(W.id,!0):await i.init(!0)}catch(V){console.error("Error refreshing rejected document for client:",V)}G.value="archived-documents"},ge=()=>{i.selectedDocument=null,ee.value=!0},Q=()=>{Y("useDocument")},A=W=>{const{tab:V,searchQuery:we}=W;U.value=V,p.value=we,setTimeout(()=>{},100)},be=()=>{if(!x.value){console.error("Cannot open letterhead modal: currentUser is not loaded");return}M("Membrete Global",()=>{k.value=!0})},Ne=W=>{De("Membrete global subido correctamente","success")},Oe=()=>{De("Membrete global eliminado correctamente","success")},Me=async()=>{if(L.value==="useDocument"){L.value="default",z.value==="lawyer"?U.value="my-documents":G.value="my-documents";return}if(!J.value){z.value==="lawyer"?U.value="folders":G.value="folders";try{await new Promise(W=>setTimeout(W,100)),await c.fetchFolders(!0)}catch{}}};ke(()=>i.lastUpdatedDocumentId,(W,V)=>{if(W&&W!==V&&L.value==="default"){const we=Date.now();(!ke.lastExecutionTime||we-ke.lastExecutionTime>100)&&(ke.lastExecutionTime=we,L.value)}},{immediate:!1}),ke(d,W=>{}),ke(S,W=>{}),ke(E,W=>{}),ke(()=>v.path,(W,V)=>{W==="/dynamic_document_dashboard"&&V&&V.includes("/document/use/")&&i.init()}),ke(()=>v.query,W=>{W.lawyerTab&&(U.value=W.lawyerTab),W.tab&&(G.value=W.tab)},{immediate:!0});const Re=[{name:"folders",label:"Carpetas"},{name:"my-documents",label:"Mis Documentos"},{name:"pending-signatures",label:"Dcs. Por Firmar"},{name:"signed-documents",label:"Dcs. Firmados"},{name:"archived-documents",label:"Dcs. Archivados"}],ze=[{name:"legal-documents",label:"Minutas"},{name:"folders",label:"Carpetas"},{name:"my-documents",label:"Mis Documentos"},{name:"pending-signatures",label:"Dcs. Por Firmar"},{name:"signed-documents",label:"Dcs. Firmados"},{name:"archived-documents",label:"Dcs. Archivados"},{name:"finished-documents",label:"Dcs. Clientes"},{name:"in-progress-documents",label:"Dcs. Clientes en Progreso"}],Z=h(!1),ie=h(!1),P=()=>{Z.value=!1,ie.value=!1},N=W=>{p.value="",U.value=W,Z.value=!1,L.value==="useDocument"&&(L.value="default"),P()},O=W=>{p.value="",G.value=W,ie.value=!1,L.value==="useDocument"&&(L.value="default"),P()};He(async()=>{try{await Promise.all([w.init(),c.init()])}catch(V){console.error("Error initializing dynamic document dashboard:",V)}i.selectedDocument=null,L.value!=="useDocument"&&(L.value="default");const W=localStorage.getItem("lastUpdatedDocumentId");W&&i.documents.some(we=>we.id.toString()===W)&&(i.lastUpdatedDocumentId=parseInt(W))});const ce=async W=>{w.currentUser&&(w.currentUser.has_signature=!0),De("Firma electrónica guardada correctamente","success"),setTimeout(()=>{B.value=!1,re.value=!1},500)};return(W,V)=>{var we,_;return s(),o(fe,null,[e("div",kh,[e("div",Ch,[ds(W.$slots,"default")]),e("div",Dh,[z.value==="lawyer"?(s(),o("div",Fh,[L.value==="useDocument"?(s(),o("div",Sh,[r(ls,{searchQuery:p.value,selectedTags:te.value,onGoBack:Me},null,8,["searchQuery","selectedTags"])])):(s(),o("div",Eh,[e("div",Ph,[e("div",Th,[e("nav",jh,[(s(),o(fe,null,he(ze,n=>e("button",{key:n.name,onClick:pe(l=>N(n.name),["stop"]),class:j([U.value===n.name?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm cursor-pointer"])},m(n.label),11,Mh)),64))]),e("div",Ah,[e("button",{onClick:pe(oe,["stop"]),disabled:!x.value,class:j(["inline-flex items-center gap-2 px-4 py-2 rounded-lg border border-purple-200 text-sm font-medium transition-all duration-200",x.value?"bg-white text-gray-700 hover:bg-purple-50 hover:border-purple-300":"bg-gray-50 text-gray-400 cursor-not-allowed opacity-60"])},[r(t(wt),{class:"size-5 text-purple-500"}),Ih],10,Lh),e("button",{onClick:V[0]||(V[0]=pe(n=>k.value=!0,["stop"])),class:"inline-flex items-center gap-2 px-4 py-2 rounded-lg border border-green-200 bg-white text-sm font-medium text-gray-700 hover:bg-green-50 hover:border-green-300 transition-all duration-200"},[r(t(Ve),{class:"size-5 text-green-500"}),Bh]),U.value==="legal-documents"?(s(),o("button",{key:0,onClick:pe(ge,["stop"]),class:"inline-flex items-center gap-2 px-4 py-2 rounded-lg border border-secondary bg-secondary text-sm font-medium text-white hover:bg-blue-700 transition-all duration-200"},[r(t(Ze),{class:"size-5"}),Rh])):f("",!0),U.value==="my-documents"?(s(),o("button",{key:1,onClick:pe(Q,["stop"]),class:"inline-flex items-center gap-2 px-4 py-2 rounded-lg border border-secondary bg-secondary text-sm font-medium text-white hover:bg-blue-700 transition-all duration-200"},[r(t(Ze),{class:"size-5"}),zh])):f("",!0)])]),e("div",Uh,[e("button",{onClick:V[1]||(V[1]=pe(n=>Z.value=!Z.value,["stop"])),class:"dropdown-button w-full flex items-center justify-between py-4 px-3 bg-white border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary"},[e("span",null,m(((we=ze.find(n=>n.name===U.value))==null?void 0:we.label)||"Seleccionar sección"),1),(s(),o("svg",{class:j(["ml-2 h-5 w-5 transition-transform duration-200",Z.value?"transform rotate-180":""]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Oh,2))]),Z.value?(s(),o("div",qh,[(s(),o(fe,null,he(ze,n=>e("button",{key:n.name,onClick:pe(l=>N(n.name),["stop"]),class:j(["w-full text-left px-4 py-3 text-sm transition-colors duration-150",U.value===n.name?"bg-primary text-white":"text-gray-700 hover:bg-gray-50"])},m(n.label),11,Vh)),64))])):f("",!0),e("div",{class:j(["grid gap-2",U.value==="legal-documents"||U.value==="my-documents"?"grid-cols-3":"grid-cols-2"])},[e("button",{onClick:pe(oe,["stop"]),disabled:!x.value,class:j(["flex flex-col items-center justify-center py-3 px-2 rounded-lg border border-purple-200 text-center transition-all duration-200",x.value?"bg-white hover:bg-purple-50":"bg-gray-50 cursor-not-allowed opacity-60"])},[r(t(wt),{class:"size-6 text-purple-500 mb-1"}),Wh],10,Qh),e("button",{onClick:V[2]||(V[2]=pe(n=>k.value=!0,["stop"])),class:"flex flex-col items-center justify-center py-3 px-2 rounded-lg border border-green-200 bg-white text-center transition-all duration-200 hover:bg-green-50"},[r(t(Ve),{class:"size-6 text-green-500 mb-1"}),Hh]),U.value==="legal-documents"?(s(),o("button",{key:0,onClick:pe(ge,["stop"]),class:"flex flex-col items-center justify-center py-3 px-2 rounded-lg border border-secondary bg-secondary text-white text-center transition-all duration-200 hover:bg-blue-700"},[r(t(Ze),{class:"size-6 mb-1"}),Gh])):f("",!0),U.value==="my-documents"?(s(),o("button",{key:1,onClick:pe(Q,["stop"]),class:"flex flex-col items-center justify-center py-3 px-2 rounded-lg border border-secondary bg-secondary text-white text-center transition-all duration-200 hover:bg-blue-700"},[r(t(Ze),{class:"size-6 mb-1"}),Zh])):f("",!0)],2)])]),U.value==="legal-documents"?(s(),o("div",Jh,[r(Ot,{searchQuery:p.value,"onUpdate:searchQuery":V[3]||(V[3]=n=>p.value=n),selectedTags:te.value,"is-loading":t(i).isLoading,"card-type":"lawyer","show-state-filter":!0,"show-client-filter":!0,"show-associations-column":!0,context:"legal-documents",onRefresh:le},null,8,["searchQuery","selectedTags","is-loading"])])):f("",!0),U.value==="my-documents"?(s(),o("div",Kh,[r(Ot,{searchQuery:p.value,"onUpdate:searchQuery":V[4]||(V[4]=n=>p.value=n),selectedTags:te.value,"is-loading":t(i).isLoading,"card-type":"client","show-state-filter":!0,"show-client-filter":!1,"show-associations-column":!0,context:"my-documents",onRefresh:le},null,8,["searchQuery","selectedTags","is-loading"])])):f("",!0),U.value==="folders"?(s(),o("div",Yh,[r(ns,{searchQuery:p.value,selectedTags:te.value,onRefresh:le,onNavigateToMain:Me,onNavigateToDocument:A},null,8,["searchQuery","selectedTags"])])):f("",!0),U.value==="pending-signatures"?(s(),o("div",Xh,[r(dt,{state:"PendingSignatures",searchQuery:p.value,selectedTags:te.value,onRefresh:le,onOpenElectronicSignature:oe,onDocumentFullySigned:$e,onDocumentRejected:_e},null,8,["searchQuery","selectedTags"])])):f("",!0),U.value==="signed-documents"?(s(),o("div",ey,[r(dt,{state:"FullySigned",searchQuery:p.value,selectedTags:te.value,onRefresh:le,onOpenElectronicSignature:oe},null,8,["searchQuery","selectedTags"])])):f("",!0),U.value==="archived-documents"?(s(),o("div",ty,[r(dt,{state:"Archived",searchQuery:p.value,selectedTags:te.value,onRefresh:le,onOpenElectronicSignature:oe},null,8,["searchQuery","selectedTags"])])):f("",!0),U.value==="finished-documents"?(s(),o("div",sy,[r(Bu,{searchQuery:p.value,selectedTags:te.value},null,8,["searchQuery","selectedTags"])])):f("",!0),U.value==="in-progress-documents"?(s(),o("div",oy,[r(a0,{searchQuery:p.value,selectedTags:te.value},null,8,["searchQuery","selectedTags"])])):f("",!0)]))])):f("",!0),z.value==="client"||z.value==="basic"||z.value==="corporate_client"?(s(),o("div",ay,[e("div",ry,[e("div",ny,[e("nav",ly,[(s(),o(fe,null,he(Re,n=>e("button",{key:n.name,onClick:pe(l=>O(n.name),["stop"]),class:j([G.value===n.name?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])},m(n.label),11,iy)),64))]),e("div",dy,[e("div",cy,[e("button",{onClick:pe(C,["stop"]),class:"inline-flex items-center gap-2 px-3 py-2 text-sm font-medium rounded-lg transition-colors border text-purple-600 hover:bg-purple-50 border-purple-200"},[r(t(wt),{class:"h-4 w-4"}),K(" Firma Electrónica ")])]),e("div",uy,[e("button",{onClick:pe(be,["stop"]),disabled:t(y),class:j(["inline-flex items-center gap-2 px-3 py-2 text-sm font-medium rounded-lg transition-colors border",t(y)?"text-green-400 bg-gray-50 border-gray-200 cursor-not-allowed opacity-60":"text-green-600 hover:bg-green-50 border-green-200"])},[r(t(Ve),{class:"h-4 w-4"}),K(" Membrete Global ")],10,my),t(y)?(s(),o("div",gy,[K(" Actualiza tu suscripción para usar esta funcionalidad "),py])):f("",!0)]),e("button",{onClick:V[5]||(V[5]=pe(n=>Y("useDocument"),["stop"])),class:"inline-flex items-center gap-2 px-3 py-2 text-sm font-medium text-white bg-secondary hover:bg-blue-700 rounded-lg transition-colors",type:"button"},[r(t(Ze),{class:"h-4 w-4"}),K(" Nuevo Documento ")])])]),e("div",fy,[e("button",{onClick:V[6]||(V[6]=pe(n=>ie.value=!ie.value,["stop"])),class:"w-full flex items-center justify-between py-4 px-3 bg-white border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary"},[e("span",null,m(((_=Re.find(n=>n.name===G.value))==null?void 0:_.label)||"Seleccionar sección"),1),(s(),o("svg",{class:j(["ml-2 h-5 w-5 transition-transform duration-200",ie.value?"transform rotate-180":""]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},yy,2))]),ie.value?(s(),o("div",vy,[(s(),o(fe,null,he(Re,n=>e("button",{key:n.name,onClick:pe(l=>O(n.name),["stop"]),class:j(["w-full text-left px-4 py-3 text-sm transition-colors duration-150",G.value===n.name?"bg-primary text-white":"text-gray-700 hover:bg-gray-50"])},m(n.label),11,by)),64))])):f("",!0)]),e("div",xy,[e("div",_y,[e("button",{onClick:pe(C,["stop"]),class:"w-full flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium rounded-lg transition-colors text-purple-600 bg-purple-50 hover:bg-purple-100"},[r(t(wt),{class:"h-5 w-5"}),K(" Firma Electrónica ")])]),e("div",wy,[e("button",{onClick:pe(be,["stop"]),disabled:t(y),class:j(["w-full flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium rounded-lg transition-colors",t(y)?"text-green-400 bg-gray-50 cursor-not-allowed opacity-60":"text-green-600 bg-green-50 hover:bg-green-100"])},[r(t(Ve),{class:"h-5 w-5"}),K(" Membrete Global ")],10,$y),t(y)?(s(),o("div",ky,[K(" Actualiza tu suscripción para usar esta funcionalidad "),Cy])):f("",!0)]),e("button",{onClick:V[7]||(V[7]=pe(n=>Y("useDocument"),["stop"])),class:"w-full flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium text-white bg-secondary hover:bg-blue-700 rounded-lg transition-colors",type:"button"},[r(t(Ze),{class:"h-5 w-5"}),K(" Nuevo Documento ")])])]),L.value==="useDocument"?(s(),o("div",Dy,[r(ls,{searchQuery:p.value,selectedTags:te.value,onGoBack:Me},null,8,["searchQuery","selectedTags"])])):(s(),o("div",Fy,[G.value==="folders"?(s(),de(ns,{key:0,searchQuery:p.value,selectedTags:te.value,onRefresh:le,onNavigateToMain:Me},null,8,["searchQuery","selectedTags"])):G.value==="my-documents"?(s(),de(Ot,{key:1,searchQuery:p.value,"onUpdate:searchQuery":V[8]||(V[8]=n=>p.value=n),selectedTags:te.value,"is-loading":t(i).isLoading,"card-type":"client","show-state-filter":!0,"show-client-filter":!1,"show-associations-column":!0,context:"my-documents",onRefresh:le},null,8,["searchQuery","selectedTags","is-loading"])):G.value==="pending-signatures"?(s(),de(dt,{key:2,state:"PendingSignatures",searchQuery:p.value,selectedTags:te.value,onRefresh:le,onOpenElectronicSignature:se,onDocumentFullySigned:ye,onDocumentRejected:ne},null,8,["searchQuery","selectedTags"])):G.value==="signed-documents"?(s(),de(dt,{key:3,state:"FullySigned",searchQuery:p.value,selectedTags:te.value,onRefresh:le,onOpenElectronicSignature:se},null,8,["searchQuery","selectedTags"])):G.value==="archived-documents"?(s(),de(dt,{key:4,state:"Archived",searchQuery:p.value,selectedTags:te.value,onRefresh:le,onOpenElectronicSignature:se},null,8,["searchQuery","selectedTags"])):f("",!0)]))])):f("",!0)])]),ee.value?(s(),de(Ke,{key:0},{default:T(()=>[e("div",{class:"w-full h-full flex items-center justify-center p-4",onClick:pe(ue,["self"])},[r(lf,{onClose:ue})])]),_:1})):f("",!0),B.value&&x.value?(s(),de(Ke,{key:1},{default:T(()=>[e("div",{class:"w-full h-full flex items-center justify-center p-4 sm:p-6",onClick:V[11]||(V[11]=pe(n=>B.value=!1,["self"]))},[e("div",Sy,[e("div",Ey,[Py,e("button",{onClick:V[9]||(V[9]=n=>B.value=!1),class:"text-gray-400 hover:text-gray-500 p-1 rounded-full hover:bg-gray-100"},[r(t(Te),{class:"h-6 w-6"})])]),e("div",Ty,[r(Xt,{"user-id":x.value.id,"initial-show-options":!x.value.has_signature,onSignatureSaved:ce,onCancel:V[10]||(V[10]=n=>B.value=!1)},null,8,["user-id","initial-show-options"])])])])]),_:1})):f("",!0),re.value&&x.value?(s(),de(Ke,{key:2},{default:T(()=>[e("div",{class:"w-full h-full flex items-center justify-center p-4 sm:p-6",onClick:V[14]||(V[14]=pe(n=>re.value=!1,["self"]))},[e("div",jy,[e("div",My,[Ay,e("button",{onClick:V[12]||(V[12]=n=>re.value=!1),class:"text-gray-400 hover:text-gray-500 p-1 rounded-full hover:bg-gray-100"},[r(t(Te),{class:"h-6 w-6"})])]),e("div",Ly,[r(Xt,{"user-id":x.value.id,"initial-show-options":!x.value.has_signature,onSignatureSaved:ce,onCancel:V[13]||(V[13]=n=>re.value=!1)},null,8,["user-id","initial-show-options"])])])])]),_:1})):f("",!0),r(Ht,{isVisible:t(ot),documentData:t(Wt),onClose:V[15]||(V[15]=n=>ot.value=!1)},null,8,["isVisible","documentData"]),r($h,{isVisible:k.value,onClose:V[16]||(V[16]=n=>k.value=!1),onUploaded:Ne,onDeleted:Oe},null,8,["isVisible"])],64)}}};export{uv as default};
