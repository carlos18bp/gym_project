import{e as r,f as n,g as e,L as le,S as k,C as ke,D as Ce,H as Se,r as C,c as B,I as Ie,a as Ee,b as Ve,o as Ae,W as Z,ac as Be,w as h,v as x,h as c,i as _,j as l,F as S,J as I,n as f,l as E,p as b,y as T,a7 as K,k as U,t as g,m as Pe,s as Y}from"./index.js";import{a as Q,i as ee,n as te,r as se,b as oe,u as ae,l as re}from"./combobox.js";import{r as F}from"./TrashIcon.js";import{r as Te}from"./EyeIcon.js";function ie(v,u){return r(),n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{d:"M10.75 4.75a.75.75 0 0 0-1.5 0v4.5h-4.5a.75.75 0 0 0 0 1.5h4.5v4.5a.75.75 0 0 0 1.5 0v-4.5h4.5a.75.75 0 0 0 0-1.5h-4.5v-4.5Z"})])}async function ne(v,u,y){const m=le();k.fire({title:"Procesando...",text:"Por favor espere, estamos procesando la solicitud.",allowOutsideClick:!1,showConfirmButton:!1,didOpen:()=>{k.showLoading()}});const V=await(y?m.updateProcess(v):m.createProcess(v));if(k.close(),V==201||y&&V==200)k.fire({icon:"success",title:"Exitoso",text:u,confirmButtonText:"OK!"}).then(P=>{if(P.isConfirmed)return!0});else return k.fire({icon:"error",title:"Oops...",text:"Something went wrong!",footer:"<a>Try again or later.</a>"}),!1}const Ue=ke("case_type",{state:()=>({caseTypes:[],dataLoaded:!1}),getters:{caseTypeById:v=>u=>v.caseTypes.find(y=>y.id==u)},actions:{async init(){this.dataLoaded||await this.fetchCaseTypesData()},async fetchCaseTypesData(){try{let u=(await Ce("case_types/")).data;if(u&&typeof u=="string")try{u=JSON.parse(u)}catch(y){console.error("JSON parse error:",y.message),u=[]}this.caseTypes=u??[],this.dataLoaded=!0}catch(v){console.error("Error fetching caseTypes data:",v.message),this.caseTypes=[],this.dataLoaded=!1}}}}),Fe={class:"sticky top-0 z-40 flex h-16 shrink-0 items-center gap-x-4 border-b border-gray-200 bg-white px-4 shadow-sm sm:gap-x-6 sm:px-6 lg:px-8 lg:hidden"},je={class:"pb-10 px-4 sm:px-6 lg:px-8 lg:pt-10"},qe={class:"w-full p-5 rounded-lg border-2 border-stroke bg-terciary"},De=e("div",null,[e("h1",{class:"text-primary text-xl font-semibold"}," Información del proceso ")],-1),Le={class:"mt-4 space-y-3"},$e={class:"grid md:grid-cols-2 xl:grid-cols-4 gap-3"},Me=e("label",{for:"plaintiff",class:"block text-base font-medium leading-6 text-primary"},[b(" Dte./Accionante "),e("span",{class:"text-red-500"},"*")],-1),Oe={class:"mt-2"},Je=e("label",{for:"defendant",class:"block text-base font-medium leading-6 text-primary"},[b(" Ddo./Accionado "),e("span",{class:"text-red-500"},"*")],-1),Ne={class:"mt-2"},ze=e("span",{class:"text-red-500"},"*",-1),Ge={class:"relative mt-2"},He=e("label",{for:"defendant",class:"block text-base font-medium leading-6 text-primary"},[b(" Subclase "),e("span",{class:"text-red-500"},"*")],-1),Re={class:"mt-2"},We={class:"grid md:grid-cols-4 gap-3"},Xe=e("label",{for:"plaintiff",class:"block text-base font-medium leading-6 text-primary"},[b(" Radicado "),e("span",{class:"text-red-500"},"*")],-1),Ze={class:"mt-2"},Ke=e("label",{for:"authority",class:"block text-base font-medium leading-6 text-primary"},[b(" Autoridad "),e("span",{class:"text-red-500"},"*")],-1),Ye={class:"mt-2"},Qe=e("label",{for:"authorityEmail",class:"block text-base font-medium leading-6 text-primary"}," Email de Autoridad ",-1),et={class:"mt-2"},tt=e("label",{for:"progress",class:"block text-base font-medium leading-6 text-primary"}," Avance (%) ",-1),st={class:"mt-2"},ot=e("span",{class:"text-red-500"},"*",-1),at={class:"relative mt-2"},rt={class:"flex items-center"},it=["src"],nt={key:1,class:"h-6 w-6 flex-shrink-0 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center text-white font-semibold text-xs"},lt={class:"ml-3 flex-1 min-w-0"},dt={class:"mt-4"},ct={class:"qflow-root"},ut={class:"-my-2 overflow-x-auto sm:-mx-3 lg:-mx-4"},mt={class:"inline-block min-w-full py-2 align-middle sm:px-3 lg:px-4"},pt={key:0,class:"min-w-full divide-y divide-gray-200"},ft=e("thead",null,[e("tr",{class:"text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},[e("th",{scope:"col",class:"py-2 pr-3 w-2/5"},"Usuario"),e("th",{scope:"col",class:"px-3 py-2 w-2/5"},"Email"),e("th",{scope:"col",class:"px-3 py-2 w-1/5"},"Acción")])],-1),gt={class:"divide-y divide-gray-200"},yt={class:"py-2 pr-3 text-sm text-primary flex items-center gap-2"},ht=["src"],xt={key:1,class:"h-7 w-7 flex-shrink-0 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center text-white font-semibold text-xs"},_t={class:"min-w-0"},bt={class:"font-medium truncate"},vt={class:"text-xs text-gray-500"},wt={class:"px-3 py-2 text-sm text-gray-700 truncate"},kt={class:"px-3 py-2 text-sm text-primary"},Ct=["onClick"],St={key:1,class:"py-2 text-xs text-gray-500"},It={class:"qflow-root"},Et={class:"-my-2 overflow-x-auto sm:-mx-6 lg:-mx-8"},Vt={class:"block md:hidden space-y-3"},At={class:"space-y-3"},Bt=e("label",{class:"block text-xs font-medium text-gray-700 mb-1"}," Etapa Procesal ",-1),Pt=["onUpdate:modelValue"],Tt={class:"flex items-end gap-2"},Ut={class:"flex-1"},Ft=e("label",{class:"block text-xs font-medium text-gray-700 mb-1"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 inline mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})]),b(" Fecha ")],-1),jt=["onUpdate:modelValue"],qt=["onClick","disabled"],Dt={class:"hidden md:block"},Lt={class:"inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8"},$t={class:"min-w-full divide-y divide-gray-300"},Mt={class:"text-left text-base font-regular text-primary"},Ot={scope:"col",class:"py-3.5 pr-3 w-3/5"},Jt={class:"flex items-center gap-3"},Nt=e("span",null,[b("Etapa Procesal"),e("span",{class:"text-red-500 ml-1"},"*")],-1),zt=e("span",{class:"ml-1"},"Nuevo",-1),Gt=e("th",{scope:"col",class:"px-3 py-3.5 w-1/5"},"Fecha",-1),Ht=e("th",{scope:"col",class:"px-3 py-3.5 w-1/5"},"Acción",-1),Rt={class:"divide-y divide-gray-200"},Wt={class:"w-3/5 py-4 pr-3 text-sm font-medium text-primary sm:pl-0 break-words"},Xt=["onUpdate:modelValue"],Zt={class:"whitespace-nowrap w-1/5 px-3 py-4 text-sm text-primary"},Kt=["onUpdate:modelValue"],Yt={class:"whitespace-nowrap w-1/5 px-3 py-4 text-sm text-primary flex gap-2"},Qt=["onClick","disabled"],es={class:"qflow-root"},ts={class:"-my-2 overflow-x-auto sm:-mx-6 lg:-mx-8"},ss={class:"inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8"},os={class:"min-w-full divide-y divide-gray-300"},as={class:"text-left text-base font-regular text-primary"},rs={scope:"col",class:"py-3.5 pr-3 w-3/5"},is={class:"flex items-center gap-3"},ns=e("span",null,"Documento",-1),ls=e("span",{class:"ml-1"},"Nuevo",-1),ds=e("th",{scope:"col",class:"px-3 py-3.5 w-1/5"},"Acción",-1),cs={class:"divide-y divide-gray-200"},us={class:"w-4/5 py-4 pr-3 text-sm font-medium text-primary sm:pl-0 break-words"},ms={key:0},ps=["href"],fs={key:1,class:"text-gray-500"},gs={key:2,class:"text-gray-500"},ys=["id","onChange"],hs=["onClick"],xs=["onClick"],_s={class:"flex flex-col sm:flex-row gap-3 sm:gap-4 pt-6 border-t border-gray-200"},bs=["disabled"],vs=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),ws=e("span",null,"Guardar Proceso",-1),ks=[vs,ws],Cs=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})],-1),Ss=e("span",null,"Archivar Proceso",-1),Is=[Cs,Ss],Es=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),Vs=e("span",null,"Cancelar",-1),As=[Es,Vs],Bs=50*1024*1024,js={__name:"ProcessForm",setup(v){const u=Se(),y=C(""),m=C(""),V=le(),P=Ue(),D=B(()=>P.caseTypes),L=Ie(),$=B(()=>L.allClientTypes),M=Ee(),s=Ve({plaintiff:"",defendant:"",caseTypeId:"",subcase:"",ref:"",authority:"",authorityEmail:"",clientIds:[],lawyerId:"",progress:0,stages:[{status:"",date:""}],caseFiles:[{file:null}]}),j=C(!1);let O={};Ae(async()=>{if(y.value=u.params.action,m.value=u.params.process_id,m.value){await V.init();const a=V.processById(m.value);a&&(ce(a),O=JSON.parse(JSON.stringify(s)))}try{await Promise.all([P.init(),L.init()])}catch(a){console.error("Error initializing process form auxiliary data:",a)}}),Z(s,()=>{de(s,O)?j.value=!1:j.value=!0},{deep:!0}),Z(()=>u.params.action,a=>{a==="add"&&ve()});function de(a,o){return JSON.stringify(a)===JSON.stringify(o)}const J=B(()=>s.plaintiff.trim()&&s.defendant.trim()&&s.subcase.trim()&&s.ref.trim()&&s.authority.trim()&&s.stages.every(a=>a.status.trim()));function ce(a){s.processIdParam=a.id||"",s.plaintiff=a.plaintiff||"",s.defendant=a.defendant||"",A.value=a.case||"",s.subcase=a.subcase||"",s.ref=a.ref||"",s.authority=a.authority||"",s.authorityEmail=a.authority_email||"",p.value=Array.isArray(a.clients)?[...a.clients]:[],s.clientIds=p.value.map(o=>o.id),s.lawyerId=a.lawyer.id||"",s.progress=typeof a.progress=="number"?a.progress:0,s.stages=a.stages.map(o=>({status:o.status||"",date:o.date||""})),s.caseFiles=a.case_files.map(o=>({file:o.file,id:o.id||""})),j.value=!1}const N=()=>{const a={Accionante:s.plaintiff,Accionado:s.defendant,"Tipo de Caso":s.caseTypeId,"Sub Caso":s.subcase,Radicado:s.ref,Autoridad:s.authority,Clientes:s.clientIds&&s.clientIds.length||"",Abogado:s.lawyerId};for(const[o,t]of Object.entries(a))if(!t||String(t).trim()==="")return k.fire({title:"Campo requerido!",text:`El campo "${o}" es obligatorio.`,icon:"warning"}),!1;for(const[o,t]of s.stages.entries())if(!t.status||t.status.trim()==="")return k.fire({title:"Estado requerido!",text:`El estado de la etapa procesal en la fila ${o+1} es obligatorio o debe ser eliminado si no es necesario.`,icon:"warning"}),!1;for(const[o,t]of s.caseFiles.entries())if(!t.file)return k.fire({title:"¡Archivo requerido!",text:`El archivo en la fila ${o+1} es obligatorio o debe ser eliminado si no es necesario.`,icon:"warning"}),!1;return!0},ue=async()=>{var a,o;s.caseTypeId=((a=A.value)==null?void 0:a.id)||"",s.clientIds=p.value.map(t=>t.id),s.lawyerId=((o=M.userAuth)==null?void 0:o.id)||"",y.value==="edit"&&m.value&&(console.log("Submitting with process ID:",m.value),s.processIdParam=m.value),N()&&(await ne(s,"La información del proceso se ha guardado exitosamente!",!!m.value),y.value=="add"?T.push({name:"process_list",params:{user_id:"",display:""}}):T.back())},me=async()=>{var o,t;(await k.fire({title:"¿Archivar este proceso?",text:"Esta acción marcará el proceso como archivado. ¿Desea continuar?",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, archivar proceso",cancelButtonText:"Cancelar",buttonsStyling:!1,customClass:{confirmButton:"inline-flex items-center justify-center px-6 py-3 text-sm font-semibold rounded-lg shadow-sm bg-amber-500 text-white hover:bg-amber-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-amber-500 mr-2",cancelButton:"inline-flex items-center justify-center px-6 py-3 text-sm font-semibold rounded-lg shadow-sm bg-white text-gray-700 hover:text-gray-900 border border-gray-300 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500"}})).isConfirmed&&(s.stages.push({status:"Fallo"}),s.processIdParam=m.value,s.caseTypeId=((o=A.value)==null?void 0:o.id)||"",s.clientIds=p.value.map(i=>i.id),s.lawyerId=((t=M.userAuth)==null?void 0:t.id)||"",s.isArchiving=!0,N()&&(await ne(s,"El proceso ha sido archivado exitosamente!",!0),T.back()))},w=C(""),A=C(null),z=B(()=>w.value===""?D.value:D.value.filter(a=>a.type.toLowerCase().includes(w.value.toLowerCase()))),q=C(null),p=C([]),G=B(()=>w.value===""?$.value:$.value.filter(a=>["first_name","last_name","identification","email"].some(o=>{var t;return(t=a[o])==null?void 0:t.toLowerCase().includes(w.value.toLowerCase())}))),pe=a=>{if(!a)return;p.value.some(t=>t.id===a.id)||p.value.push(a),q.value=null},H=a=>a?p.value.some(o=>o.id===a.id):!1,fe=a=>{p.value=p.value.filter(o=>o.id!==a),s.clientIds=p.value.map(o=>o.id)},ge=()=>{const a=new Date().toISOString().slice(0,10);s.stages.push({status:"",date:a})},R=a=>{s.stages.splice(a,1)},ye=["png","jpg","jpeg","pdf","docx"],he=(a,o)=>{const t=a.target.files[0];if(!t)return;if(t.size>Bs){Y(`El archivo "${t.name}" excede el límite de 50 MB. Por favor, selecciona un archivo más pequeño.`,"warning");return}const i=t.name.split(".").pop().toLowerCase();if(!ye.includes(i)){Y("¡Ups! Ese tipo de archivo no es compatible. Asegúrate de que el archivo sea PDF, DOCX, JPG, PNG, JPEG.","warning");return}s.caseFiles[o].file=t},xe=()=>{s.caseFiles.push({file:null,id:""})};function _e(a){window.open(a,"_blank")}const be=a=>{s.caseFiles.splice(a,1)},W=(a,o)=>{var d,X;const t=((d=a==null?void 0:a.charAt(0))==null?void 0:d.toUpperCase())||"",i=((X=o==null?void 0:o.charAt(0))==null?void 0:X.toUpperCase())||"";return`${t}${i}`||"?"},ve=()=>{s.plaintiff="",s.defendant="",s.caseTypeId="",s.subcase="",s.ref="",s.authority="",s.authorityEmail="",s.clientIds=[],s.lawyerId="";const a=new Date().toISOString().slice(0,10);s.stages=[{status:"",date:a}],s.caseFiles=[{file:null}]},we=()=>{T.back()};return(a,o)=>(r(),n(S,null,[e("div",Fe,[Be(a.$slots,"default")]),e("div",je,[e("div",qe,[De,e("div",Le,[e("div",$e,[e("div",null,[Me,e("div",Oe,[h(e("input",{"onUpdate:modelValue":o[0]||(o[0]=t=>s.plaintiff=t),type:"text",name:"plaintiff",id:"plaintiff",class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-secondary sm:text-sm sm:leading-6",required:""},null,512),[[x,s.plaintiff]])])]),e("div",null,[Je,e("div",Ne,[h(e("input",{"onUpdate:modelValue":o[1]||(o[1]=t=>s.defendant=t),type:"text",name:"defendant",id:"defendant",class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-secondary sm:text-sm sm:leading-6",required:""},null,512),[[x,s.defendant]])])]),e("div",null,[c(l(re),{as:"div",modelValue:A.value,"onUpdate:modelValue":[o[4]||(o[4]=t=>A.value=t),o[5]||(o[5]=t=>w.value="")]},{default:_(()=>[c(l(Q),{class:"block text-base font-medium leading-6 text-primary"},{default:_(()=>[b(" Tipo Proceso "),ze]),_:1}),e("div",Ge,[c(l(ee),{class:"w-full rounded-md border-0 bg-white py-1.5 pl-3 pr-10 text-primary shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-secondary sm:text-sm sm:leading-6",onChange:o[2]||(o[2]=t=>w.value=t.target.value),onBlur:o[3]||(o[3]=t=>w.value=""),"display-value":t=>t==null?void 0:t.type},null,8,["display-value"]),c(l(te),{class:"absolute inset-y-0 right-0 flex items-center gap-2 rounded-r-md px-2 focus:outline-none border-l border-gray-300"},{default:_(()=>[b(" Seleccionar "),c(l(K),{class:"h-5 w-5 text-gray-400","aria-hidden":"true"})]),_:1}),z.value.length>0?(r(),U(l(ae),{key:0,class:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm"},{default:_(()=>[(r(!0),n(S,null,I(z.value,t=>(r(),U(l(se),{key:t.id,value:t,as:"template"},{default:_(({active:i,selected:d})=>[e("li",{class:f(["relative cursor-default select-none py-2 pl-3 pr-9",i?"bg-secondary text-white":"text-primary"])},[e("span",{class:f(["block truncate",d&&"font-semibold"])},g(t.type),3),d?(r(),n("span",{key:0,class:f(["absolute inset-y-0 right-0 flex items-center pr-4",i?"text-white":"text-secondary"])},[c(l(oe),{class:"h-5 w-5","aria-hidden":"true"})],2)):E("",!0)],2)]),_:2},1032,["value"]))),128))]),_:1})):E("",!0)])]),_:1},8,["modelValue"])]),e("div",null,[He,e("div",Re,[h(e("input",{"onUpdate:modelValue":o[6]||(o[6]=t=>s.subcase=t),type:"text",name:"defendant",id:"defendant",class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-secondary sm:text-sm sm:leading-6",required:""},null,512),[[x,s.subcase]])])])]),e("div",We,[e("div",null,[Xe,e("div",Ze,[h(e("input",{"onUpdate:modelValue":o[7]||(o[7]=t=>s.ref=t),type:"text",name:"plaintiff",id:"plaintiff",class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-secondary sm:text-sm sm:leading-6",required:""},null,512),[[x,s.ref]])])]),e("div",null,[Ke,e("div",Ye,[h(e("input",{"onUpdate:modelValue":o[8]||(o[8]=t=>s.authority=t),type:"text",name:"authority",id:"authority",class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-secondary sm:text-sm sm:leading-6",required:""},null,512),[[x,s.authority]])])]),e("div",null,[Qe,e("div",et,[h(e("input",{"onUpdate:modelValue":o[9]||(o[9]=t=>s.authorityEmail=t),type:"email",name:"authorityEmail",id:"authorityEmail",class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-secondary sm:text-sm sm:leading-6",placeholder:"ejemplo@autoridad.gov.co"},null,512),[[x,s.authorityEmail]])])]),e("div",null,[tt,e("div",st,[h(e("input",{"onUpdate:modelValue":o[10]||(o[10]=t=>s.progress=t),type:"number",name:"progress",id:"progress",min:"0",max:"100",class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-secondary sm:text-sm sm:leading-6",placeholder:"0 - 100"},null,512),[[x,s.progress,void 0,{number:!0}]])])])]),e("div",null,[c(l(re),{as:"div",modelValue:q.value,"onUpdate:modelValue":[o[13]||(o[13]=t=>q.value=t),pe]},{default:_(()=>[c(l(Q),{class:"block text-sm font-medium leading-6 text-primary"},{default:_(()=>[b(" Usuarios "),ot]),_:1}),e("div",at,[c(l(ee),{class:"w-full rounded-md border-0 bg-white py-1.5 pl-3 pr-12 text-primary shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-secondary sm:text-sm sm:leading-6",onChange:o[11]||(o[11]=t=>w.value=t.target.value),onBlur:o[12]||(o[12]=t=>w.value=""),"display-value":()=>"",placeholder:"Buscar y agregar usuarios"}),c(l(te),{class:"absolute inset-y-0 right-0 flex items-center rounded-r-md px-2 focus:outline-none"},{default:_(()=>[c(l(K),{class:"h-5 w-5 text-gray-400","aria-hidden":"true"})]),_:1}),G.value.length>0?(r(),U(l(ae),{key:0,class:"absolute z-10 mt-1 max-h-56 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm"},{default:_(()=>[(r(!0),n(S,null,I(G.value,t=>(r(),U(l(se),{key:t.id,value:t,as:"template"},{default:_(({active:i})=>[e("li",{class:f(["relative cursor-default select-none py-2 pl-3 pr-9",i?"bg-secondary text-white":"text-primary"])},[e("div",rt,[t.photo_profile?(r(),n("img",{key:0,src:t.photo_profile,alt:"Foto de perfil",class:"h-6 w-6 flex-shrink-0 rounded-full object-cover"},null,8,it)):(r(),n("div",nt,g(W(t.first_name,t.last_name)),1)),e("div",lt,[e("span",{class:f(["truncate block",H(t)&&"font-semibold"])},g(t.last_name)+" "+g(t.first_name),3),e("span",{class:f(["text-xs truncate block",i?"text-blue-200":"text-gray-500"])},g(t.role==="client"?"Cliente":t.role==="basic"?"Básico":"Corporativo"),3)])]),H(t)?(r(),n("span",{key:0,class:f(["absolute inset-y-0 right-0 flex items-center pr-4",i?"text-white":"text-secondary"])},[c(l(oe),{class:"h-5 w-5","aria-hidden":"true"})],2)):E("",!0)],2)]),_:2},1032,["value"]))),128))]),_:1})):E("",!0)]),e("div",dt,[e("div",ct,[e("div",ut,[e("div",mt,[p.value.length?(r(),n("table",pt,[ft,e("tbody",gt,[(r(!0),n(S,null,I(p.value,t=>(r(),n("tr",{key:t.id},[e("td",yt,[t.photo_profile?(r(),n("img",{key:0,src:t.photo_profile,alt:"Foto de perfil",class:"h-7 w-7 flex-shrink-0 rounded-full object-cover"},null,8,ht)):(r(),n("div",xt,g(W(t.first_name,t.last_name)),1)),e("div",_t,[e("div",bt,g(t.last_name)+" "+g(t.first_name),1),e("div",vt,g(t.role==="client"?"Cliente":t.role==="basic"?"Básico":"Corporativo"),1)])]),e("td",wt,g(t.email),1),e("td",kt,[e("button",{type:"button",class:"p-1 rounded-md text-red-600 hover:bg-red-50",onClick:Pe(i=>fe(t.id),["stop"])},[c(l(F),{class:"h-5 w-5"})],8,Ct)])]))),128))])])):(r(),n("div",St," Selecciona al menos un usuario. "))])])])])]),_:1},8,["modelValue"])]),e("div",null,[e("div",It,[e("div",Et,[e("div",Vt,[(r(!0),n(S,null,I(s.stages,(t,i)=>(r(),n("div",{key:i,class:"bg-gray-50 rounded-lg p-4 border border-gray-200"},[e("div",At,[e("div",null,[Bt,h(e("input",{"onUpdate:modelValue":d=>t.status=d,type:"text",name:"stage",placeholder:"Nombre de la etapa",class:"block w-full rounded-md border-0 py-2 text-primary shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-secondary text-sm",required:""},null,8,Pt),[[x,t.status]])]),e("div",Tt,[e("div",Ut,[Ft,h(e("input",{"onUpdate:modelValue":d=>t.date=d,type:"date",name:"stage_date",class:"block w-full rounded-md border-0 py-2 text-primary shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-secondary text-sm"},null,8,jt),[[x,t.date]])]),e("button",{onClick:d=>R(i),disabled:i==0,class:f(["p-2 rounded-md",i==0?"text-gray-400 cursor-not-allowed":"text-red-600 hover:bg-red-50"])},[c(l(F),{class:"h-6 w-6"})],10,qt)])])]))),128))]),e("div",Dt,[e("div",Lt,[e("table",$t,[e("thead",null,[e("tr",Mt,[e("th",Ot,[e("div",Jt,[Nt,e("button",{onClick:ge,type:"button",class:"flex items-center px-2 py-1 rounded-md text-sm text-secondary bg-selected-background hover:bg-blue-100 transition-colors"},[c(l(ie),{class:"h-4 w-4"}),zt])])]),Gt,Ht])]),e("tbody",Rt,[(r(!0),n(S,null,I(s.stages,(t,i)=>(r(),n("tr",{key:i},[e("td",Wt,[h(e("input",{"onUpdate:modelValue":d=>t.status=d,type:"text",name:"stage",id:"stage",class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-secondary sm:text-sm sm:leading-6",required:""},null,8,Xt),[[x,t.status]])]),e("td",Zt,[h(e("input",{"onUpdate:modelValue":d=>t.date=d,type:"date",name:"stage_date",class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-secondary sm:text-sm sm:leading-6"},null,8,Kt),[[x,t.date]])]),e("td",Yt,[e("button",{onClick:d=>R(i),disabled:i==0},[c(l(F),{class:f(["mx-3 h-7 w-7",i==0?"text-gray-500 cursor-not-allowed":"text-red-600/80"])},null,8,["class"])],8,Qt)])]))),128))])])])])])])]),e("div",null,[e("div",es,[e("div",ts,[e("div",ss,[e("table",os,[e("thead",null,[e("tr",as,[e("th",rs,[e("div",is,[ns,e("button",{onClick:xe,type:"button",class:"flex items-center px-2 py-1 rounded-md text-sm text-secondary bg-selected-background hover:bg-blue-100 transition-colors"},[c(l(ie),{class:"h-4 w-4"}),ls])])]),ds])]),e("tbody",cs,[(r(!0),n(S,null,I(s.caseFiles,(t,i)=>(r(),n("tr",{key:i},[e("td",us,[typeof t.file=="string"?(r(),n("span",ms,[e("a",{href:t.file,target:"_blank",class:"text-blue-500 hover:underline"},g(t.file.split("/").pop()),9,ps)])):t.file?(r(),n("span",fs," Archivo cargado: "+g(t.file.name),1)):(r(),n("span",gs,"Ningún archivo subido")),e("input",{type:"file",id:"file-"+i,onChange:d=>he(d,i),class:"block w-full rounded-md border-0 py-1.5 text-primary shadow-sm placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-secondary sm:text-sm sm:leading-6",required:""},null,40,ys)]),e("td",{class:f(["whitespace-nowrap w-1/5 py-4 text-sm text-primary flex gap-2",t.file?"":"px-3"])},[t.file?(r(),n("button",{key:0,onClick:d=>_e(t.file)},[c(l(Te),{class:"h-7 w-7 text-primary"})],8,hs)):E("",!0),e("button",{onClick:d=>be(i)},[c(l(F),{class:f(["h-7 w-7 text-red-600/80",t.file?"":"mx-3"])},null,8,["class"])],8,xs)],2)]))),128))])])])])])]),e("div",_s,[e("button",{onClick:ue,type:"button",class:f(["inline-flex items-center justify-center px-6 py-3 text-sm font-semibold rounded-lg shadow-sm transition-all duration-200",J.value?"bg-blue-600 text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500":"bg-gray-100 text-gray-400 border-2 border-dashed border-gray-300 cursor-not-allowed"]),disabled:!J.value},ks,10,bs),y.value==="edit"&&m.value?(r(),n("button",{key:0,onClick:me,type:"button",class:"inline-flex items-center justify-center px-6 py-3 text-sm font-semibold rounded-lg shadow-sm bg-amber-500 text-white hover:bg-amber-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-amber-500 transition-all duration-200"},Is)):E("",!0),e("button",{onClick:we,type:"button",class:"inline-flex items-center justify-center px-6 py-3 text-sm font-semibold rounded-lg shadow-sm bg-white text-gray-700 border border-gray-300 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-all duration-200 sm:ml-auto"},As)])])])])],64))}};export{js as default};
